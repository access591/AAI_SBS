package aims.dao;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Collections;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Locale;
import java.util.ResourceBundle;
import java.util.Set;

import jxl.Workbook;
import jxl.WorkbookSettings;
import jxl.write.WritableWorkbook;
import aims.bean.EmpMasterBean;
import aims.bean.EmployeePensionCardInfo;
import aims.bean.EmployeeValidateInfo;
import aims.bean.EmployeePersonalInfo;
import aims.bean.FinacialDataBean;
import aims.bean.NomineeBean;
import aims.common.CommonUtil;
import aims.common.Constants;
import aims.common.DBUtils;
import aims.common.DateValidation;
import aims.common.InvalidDataException;
import aims.common.Log;
import aims.common.StringUtility;
import aims.service.PersonalService;
/* 
##########################################
#Date					Developed by			Issue description
#27-Aug-2012	        Prasanthi				Changes Done for transferin/out Report
#5-MAy-2012-14-May-2012	Prasanthi				Changes Done for supplomentory,arrearbreakupimporting,singlevalueimporting
#23-Apr-2012			Prasanthi				adding the new column in aaiepf4
#09-Apr-2012			Prasanthi				exception not checking while emoluments is null in supplumentory
#07-Apr-2012			Radha					Removing the  Adj Corrections related Methods 
#06-Apr-2012            prasanthi               Getting the paiddate as 01 while date was given 30/31
#05-Apr-2012            prasanthi               Getting the monthyear as 01 while date was given 30/31
#02-Apr-2012            prasanthi               exception removing while pc not caliculated for the arrears and employee arttained 58
#30-Mar-2012			Radha					Modifying getEmolumentsBeanFor78PsAdjCrtn(), renaming the method pentionContributionProcess2008to11For78PsAdjCRTN()
#27-Mar-2012            prasanthi               throwing the exception if seperation reason or seperation date not submitted in creation of pfids
#21-Mar-2012            prasanthi               throwing the exception while pc not caliculated for the arrears
#02-Mar-2012            Prasad                  Add username field for Impact.Cal Upload sheet
#24-Feb-2012			Radha					Correcting the changes due to seperation of methods  from FinancialReportDAO to CommonDAO
#23-Feb-2012            Prasad                  For implementing the uploaded data when the uploaded data was deleted through screen.
#17-Feb-2012			Suresh					Modifing of   Uploading of Mapping Data 
#16-Feb-2012			Prasad					Modifing of   Uploading of Mapping Data 
#14-Feb-2012			Prasad					Implementaing Uploading of Mapping Data 
#02-Feb-2012			Radha					Modifying(removing rowid based cond) the code according to the condition getting prev Mnth Details
#31-Jan-2012 			Radha					maintain the log in employee_supplimontory table
#)9-Jan-2012 			Radha					Implementing upto 2011-12 Fin Year(pentionContributionProcessAfterOptionChange)
#05-Jan-2012			Radha					For Restricting the automatic Calc of Pc for all the Months i.e., from Apr 2008 to till(pensionContributionProcess2008to11ForAdjCRTN)
#03-Jan-2012			Prasanthi               adding the metod for single values
#27-Dec-2011			Prasanthi               Adding the Excception for seperation date
#23-Dec-2011			Prasanthi               Changing form-4 method topensioncontri addition
#22-Dec-2011			Prasanthi               Adding the Excception for VRS,Death case
#22-Dec-2011			Prasanthi               adding the supplimentory log 
#17-Dec-2011			Radha   				For modifying the code according to the condition getting prev Mnth Details
#13-Dec-2011			Radha                   For adding Noof Months in AdjCal Screen , Rounding  pensionCalculation For Option B Cases when emolument Mnths given
#######################################
*/
public class ImportDao {
	Log log = new Log(ImportDao.class);

	DBUtils commonDB = new DBUtils();
	CommonUtil commonUtil = new CommonUtil();
	PensionDAO PDAO = new PensionDAO();
	PersonalDAO PersonalDAO = new PersonalDAO();
	FinancialReportDAO fDao = new FinancialReportDAO();
	CommonDAO commonDAO = new CommonDAO();
	AdjCrtnDAO adjCrtnDAO = new AdjCrtnDAO();

	public void readXLSData(String xlsData) {
		log.info("ImportDao :readXLSData() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		String xlsWhetherOption = "";
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
		} catch (Exception e) {
			log.printStackTrace(e);
		}
		for (int i = 1; i < xlsDataList.size(); i++) {
			bean = new EmpMasterBean();
			tempData = xlsDataList.get(i).toString();
			tempInfo = tempData.split("@");
			try {
				if (!tempInfo[0].equals("XXX")) {
					bean.setSrno(tempInfo[0]);
				} else {
					bean.setSrno("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setAirportSerialNumber(tempInfo[1]);
				} else {
					bean.setAirportSerialNumber("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[3].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}

				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				if (!tempInfo[4].equals("XXX")) {
					if (tempInfo[4].trim().indexOf("'") != -1) {
						delimiter = "'";
						xlsDesignation = StringUtility.replace(
								tempInfo[4].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setDesegnation(xlsDesignation);
					} else {
						bean.setDesegnation(tempInfo[4].trim());
					}
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpLevel(tempInfo[5].trim());
				} else {
					bean.setEmpLevel("");
				}
				if (!tempInfo[6].equals("XXX")) {
					log.info("tempInfo[6]" + tempInfo[6]);
					bean.setCpfAcNo(tempInfo[6].trim());
				} else {
					bean.setCpfAcNo(PDAO.getMaxValue());
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].trim().indexOf("'") != -1) {
						int index = tempInfo[7].trim().indexOf("'");
						tempInfo[7] = tempInfo[7].trim().substring(index + 1,
								tempInfo[7].length());
					}
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[8].equals("XXX")) {
					if (tempInfo[8].trim().indexOf("'") != -1) {
						int index = tempInfo[8].trim().indexOf("'");
						tempInfo[8] = tempInfo[8].trim().substring(index + 1,
								tempInfo[8].length());
					}
					bean.setDateofJoining(tempInfo[8].toString().trim());

				} else {
					bean.setDateofJoining("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setSeperationReason(tempInfo[9]);
				} else {
					bean.setSeperationReason("");
				}
				if (!tempInfo[10].equals("XXX") && tempInfo[10].length() > 8) {
					if (tempInfo[10].trim().indexOf("'") != -1) {
						int index = tempInfo[10].trim().indexOf("'");
						tempInfo[10] = tempInfo[10].trim().substring(index + 1,
								tempInfo[10].length());
					}
					bean
							.setDateofSeperationDate(tempInfo[10].toString()
									.trim());
				} else {
					bean.setDateofSeperationDate("");
				}

				if (!tempInfo[11].equals("XXX")) {
					if (tempInfo[11].indexOf("*") != -1) {
						delimiter = "*";
						xlsWhetherOption = StringUtility.replace(
								tempInfo[11].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setWhetherOptionA(xlsWhetherOption);
					} else {
						bean.setWhetherOptionA(tempInfo[11]);
					}
				} else {
					bean.setWhetherOptionA("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setWhetherOptionB(tempInfo[12]);
				} else {
					bean.setWhetherOptionB("");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setWhetherOptionNO(tempInfo[13]);
				} else {
					bean.setWhetherOptionNO("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setForm2Nomination(tempInfo[14]);
				} else {
					bean.setForm2Nomination("");
				}
				if (!tempInfo[16].equals("XXX")) {
					bean.setRemarks(tempInfo[16]);
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[17].equals("XXX")) {
					bean.setStation(tempInfo[17].trim());
				} else {
					bean.setStation("");
				}
				if (!bean.getWhetherOptionA().trim().equals("")) {
					bean.setWetherOption("A");
				} else if (!bean.getWhetherOptionB().trim().equals("")) {
					bean.setWetherOption("B");
				} else if (!bean.getWhetherOptionNO().trim().equals("")) {
					bean.setWetherOption("No");
				} else {
					bean.setWetherOption("");
				}

				if (!bean.getEmpName().equals("")
						&& !bean.getDesegnation().equals("")) {
					PDAO.addPensionRecord(bean);
				}

			} catch (InvalidDataException e) {
				log.printStackTrace(e);
				try {
					fw.write(tempData + "***");
					fw.flush();
				} catch (FileNotFoundException fe) {
					log.printStackTrace(fe);
					// System.err.println("FileStreamsTest: " + fe);
				} catch (IOException io) {
					// System.err.println("FileStreamsTest: " + io);
					log.printStackTrace(io);
				}
			}
		}
		log.info("ImportDao :readXLSData() leaving method");
		pensionList.add(bean);

	}

	public void igiCpfaccnoUpdate(String xlsData) throws InvalidDataException {

		log.info("ImportDao :igiCpfaccnoUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setStation(tempInfo[3].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setNewCpfAcNo(tempInfo[4].trim());
				} else {
					bean.setNewCpfAcNo("");
				}

				String sql3 = "";
				if (bean.getCpfAcNo() != "") {
					sql3 = "update employee_pension_validate set cpfaccno='"
							+ bean.getNewCpfAcNo().trim()
							+ "', REMARKS=REMARKS||'CPF CHAGED TO D-00' where region='CHQIAD' and airportcode='"
							+ bean.getStation() + "' and cpfaccno='"
							+ bean.getCpfAcNo() + "'";
					log.info(sql3);
					st.execute(sql3);
				}
				// st.execute(sql3);
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(conn, st, null);
		}

		log.info("ImportDao :igiCpfaccnoUpdate leaving method");

	}

	public void updateMasterNmtoTrans(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :updateMasterNmtoTrans() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		String tempName = "", sql3 = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setRegion(tempInfo[3].trim());
				} else {
					bean.setRegion("");
				}

				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}

				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					sql3 = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='" + bean.getCpfAcNo() + "' ";
					log.info(sql3);
					// st.execute(sql3);
				} else if (bean.getCpfAcNo() != "") {
					sql3 = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='" + bean.getCpfAcNo() + "'  ";
				} else {
					sql3 = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and employeeno='" + bean.getEmpNumber() + "'";
				}
				st.execute(sql3);
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(conn, st, null);
		}

		log.info("ImportDao :updateMasterNmtoTrans leaving method");

	}

	public String[] readLables(String xlsData) throws Exception {

		log.info("ImportDao :readLables() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :deleteTransactions leaving method");
		return tempInfo;
	}

	public void deleteTransactions(String xlsData) throws InvalidDataException {

		log.info("ImportDao :deleteTransactions() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("hedername" + tempInfo[1].trim());
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmpNumber(tempInfo[0].trim());
				} else {
					bean.setEmpNumber("");
				}
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				String deleteTransaction = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					deleteTransaction = "delete from  employee_pension_validate  where region='East Region' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ monthYear + "'";
					log.info(deleteTransaction);
					// st.execute(sql3);
				}
				st.execute(deleteTransaction);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :deleteTransactions leaving method");

	}

	public void deleteDuplicateRecorsRausap(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {

		log.info("ImportDao :deleteDuplicateRecorsRausap() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setStation(tempInfo[6].trim());
				} else {
					bean.setStation("");
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setRegion(tempInfo[7].trim());
				} else {
					bean.setRegion("");
				}

				String sql = "";
				if (bean.getCpfAcNo() != "") {
					sql = "update employee_info set empflag='N',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='" + bean.getRegion()
							+ "'  AND airportcode='" + bean.getStation()
							+ "' and cpfacno='" + bean.getCpfAcNo() + "' ";
					log.info(sql);
					// st.execute(sql3);
				}
				st.execute(sql);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :deleteDuplicateRecorsRausap leaving method");

	}

	public void processinPersonalInfoMissingRecords(String xlsData)
			throws InvalidDataException {

		log
				.info("ImportDao :processinPersonalInfoMissingRecords() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setRegion(tempInfo[1].trim());
				} else {
					bean.setRegion("");
				}
				PersonalDAO pDAO = new PersonalDAO();
				pDAO.processinPersonalInfoMissingRecords(bean.getCpfAcNo(),
						bean.getRegion());
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log
				.info("ImportDao :processinPersonalInfoMissingRecords leaving method");

	}

	public void deleteFinaceDuplicateData(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :deleteFinaceDuplicateData() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			int count = 0, totalCount = 0;
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setRegion(tempInfo[15].trim());
				} else {
					bean.setRegion("");
				}

				String sql3 = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					sql3 = "update employee_pension_validate set empflag='N' where region='"
							+ bean.getRegion().trim()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "' and airportcode='"
							+ bean.getStation()
							+ "' AND  TO_CHAR(MONTHYEAR,'dd-Mon-yyyy') like '%-Sep-2007'";

				} else {
					sql3 = "update employee_pension_validate set empflag='N' where region='"
							+ bean.getRegion().trim()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and employeeno is null and airportcode='"
							+ bean.getStation()
							+ "' AND  TO_CHAR(MONTHYEAR,'dd-Mon-yyyy') like '%-Sep-2007'";

				}
				log.info("Query is" + sql3);
				count = st.executeUpdate(sql3);
				totalCount = totalCount + count;
				log.info("Total No.of Records is " + totalCount + "coutn is"
						+ count);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :updateMasterNmtoTrans leaving method");

	}

	public void readXLSWestData(String xlsData) throws InvalidDataException {
		log.info("ImportDao :readXLSWestData() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0]);
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());

				if (!tempInfo[2].equals("XXX")) {
					if (tempInfo[2].trim().indexOf("'") != -1) {
						delimiter = "'";
						xlsDesignation = StringUtility.replace(
								tempInfo[2].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setDesegnation(xlsDesignation);

					} else {
						bean.setDesegnation(tempInfo[2].trim());
					}

				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setFhName(tempInfo[3].trim());
				} else {
					bean.setFhName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					if (tempInfo[4].trim().indexOf("'") != -1) {
						int index = tempInfo[4].trim().indexOf("'");
						tempInfo[4] = tempInfo[4].trim().substring(index + 1,
								tempInfo[4].length());
					}
					bean.setDateofBirth(tempInfo[4].trim());
				} else {
					bean.setDateofBirth("");
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setSex(tempInfo[5].trim());
				} else {
					bean.setSex("");
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setSeperationReason(tempInfo[7].trim());
				} else {
					bean.setSeperationReason("");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setDateofSeperationDate(tempInfo[8].trim());
				} else {
					bean.setDateofSeperationDate("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setRemarks(tempInfo[9].trim());
				} else {
					bean.setRemarks("");
				}

				String dtOfJoining = "";

				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].trim().indexOf("'") != -1) {
						int index = tempInfo[6].trim().indexOf("'");
						tempInfo[6] = tempInfo[6].trim().substring(index + 1,
								tempInfo[6].length());
					}
					bean.setDateofJoining(tempInfo[6].trim());

				} else {
					bean.setDateofJoining("");
				}
				String dtOfApt = "";
				/*
				 * if (!tempInfo[7].equals("XXX")) { if
				 * (tempInfo[7].trim().indexOf("'") != -1) { int index =
				 * tempInfo[7].trim().indexOf("'"); tempInfo[7] =
				 * tempInfo[7].trim().substring(index + 1,
				 * tempInfo[7].length()); }
				 * 
				 * dtOfApt = commonUtil.converDBToAppFormat( tempInfo[7].trim(),
				 * "dd/MM/yyyy", "dd-MMM-yyyy"); bean.setDateofApt(dtOfApt); }
				 * else { bean.setDateofApt(""); }
				 * 
				 * if (!tempInfo[9].equals("XXX")) { log.info("temp9 is " +
				 * tempInfo[9]); bean.setStation(tempInfo[9].trim()); } else {
				 * bean.setStation(""); }
				 */

				String sql3 = "update employee_info set DATEOFJOINING='"
						+ bean.getDateofJoining()
						+ "' where region='West Region' and cpfacno='"
						+ bean.getCpfAcNo() + "' and DATEOFJOINING is null";
				log.info(sql3);
				st.execute(sql3);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :readXLSWestData leaving method");
	}

	public void readXLSEastPersonalData(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :readXLSEastData() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		String xlsWhetherOption = "";
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };

		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0]);
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}

				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmpName());
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());

				if (!tempInfo[3].equals("XXX")) {
					if (tempInfo[3].trim().indexOf("'") != -1) {
						delimiter = "'";
						xlsDesignation = StringUtility.replace(
								tempInfo[3].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setDesegnation(xlsDesignation);

					} else {
						bean.setDesegnation(tempInfo[3].trim());
					}
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setSex(tempInfo[5].trim());
				} else {
					bean.setSex("");
				}
				if (!tempInfo[4].equals("XXX")) {
					if (tempInfo[4].trim().indexOf("'") != -1) {
						int index = tempInfo[4].trim().indexOf("'");
						tempInfo[4] = tempInfo[4].trim().substring(index + 1,
								tempInfo[4].length());
					}
					bean.setDateofBirth(tempInfo[4].trim());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].trim().indexOf("'") != -1) {
						int index = tempInfo[6].trim().indexOf("'");
						tempInfo[6] = tempInfo[6].trim().substring(index + 1,
								tempInfo[6].length());
					}
					bean.setDateofJoining(tempInfo[6].trim());
				} else {
					bean.setDateofJoining("");
				}
				log.info("DateofBirth" + bean.getDateofBirth()
						+ "DateofJoining" + bean.getDateofJoining());
				if (!tempInfo[7].equals("XXX")) {
					log.info("temp7 is " + tempInfo[7]);
					bean.setStation(tempInfo[7].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[8].equals("XXX")) {
					log.info("temp8 is " + tempInfo[8]);
					bean.setFhName(tempInfo[8].trim());
				} else {
					bean.setFhName("");
				}
				log.info("before add pensionRecord empname" + bean.getEmpName()
						+ " cpfacno " + bean.getCpfAcNo() + "desegnation "
						+ bean.getDesegnation() + "dateofbirth"
						+ bean.getDateofBirth() + "station "
						+ bean.getStation() + "fhName " + bean.getFhName());
				String region = "East Region".trim();
				String sql = "insert into employee_westinfo(cpfacno,employeeName,"
						+ "desegnation,dateofbirth,dateofjoining,dateofApt,airportcode,"
						+ "sex,fhname,region,employeeno)" + " VALUES " + "('"
						+ bean.getCpfAcNo().trim()
						+ "','"
						+ bean.getEmpName().trim()
						+ "','"
						+ bean.getDesegnation()
						+ "','"
						+ bean.getDateofBirth()
						+ "','"
						+ bean.getDateofJoining()
						+ "','"
						+ bean.getDateofApt()
						+ "','"
						+ bean.getStation()
						+ "','"
						+ bean.getSex()
						+ "','"
						+ bean.getFhName()
						+ "', '" + region + "','" + bean.getEmpNumber() + "')";
				log.info(sql);
				st.execute(sql);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}
		log.info("ImportDao :readXLSEastData leaving method");
	}

	public void readXLSChqIadData(String xlsData) throws InvalidDataException {
		log.info("ImportDao :readXLSChqIadData() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmpNumber(tempInfo[0]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1]);
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				if (!tempInfo[3].equals("XXX")) {
					if (tempInfo[3].trim().indexOf("'") != -1) {
						delimiter = "'";
						xlsDesignation = StringUtility.replace(
								tempInfo[3].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setDesegnation(xlsDesignation);

					} else {
						bean.setDesegnation(tempInfo[3].trim());
					}
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					//bean.setDateofBirth(commonUtil.converDBToAppFormat(tempInfo
					// [4].trim(),
					// "dd/MM/yyyy","dd-MMM-yyyy"));
					bean.setDateofBirth(tempInfo[4].trim());
				} else {
					bean.setDateofBirth("");
				}

				if (!tempInfo[5].equals("XXX")) {
					// bean.setDateofJoining(commonUtil.converDBToAppFormat(
					// tempInfo[5].trim(),
					// "dd/MM/yyyy","dd-MMM-yyyy"));
					bean.setDateofJoining(tempInfo[5].trim());
				} else {
					bean.setDateofJoining("");
				}
				log.info("before add pensionRecord empname" + bean.getEmpName()
						+ " cpfacno " + bean.getCpfAcNo() + "desegnation "
						+ bean.getDesegnation());
				if (!tempInfo[6].equals("XXX")) {
					bean.setSex(tempInfo[6]);
				} else {
					bean.setSex("");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setFhName(tempInfo[7]);
				} else {
					bean.setFhName("");
				}

				/*
				 * if (!tempInfo[0].equals("XXX")) {
				 * bean.setEmpNumber(tempInfo[0]); } else {
				 * bean.setEmpNumber(""); }
				 * 
				 * if (!tempInfo[1].equals("XXX")) {
				 * bean.setEmpLevel(tempInfo[1]); } else { bean.setEmpLevel("");
				 * } if (!tempInfo[2].equals("XXX")) {
				 * bean.setFhName(tempInfo[2]); } else { bean.setFhName(""); }
				 * if (!tempInfo[3].equals("XXX")) { bean.setSex(tempInfo[3]); }
				 * else { bean.setSex(""); }
				 */

				String station = "OFFICE COMPLEX";
				String region = "CHQIAD";
				String pensionNumber = "";
				int countEmployeeInfo = 0;
				// String updateSql="update employee_pension_validate set
				// employeename=
				// '"+bean.getEmpName().trim()+"',cpfaccno='"+bean.getCpfAcNo().trim()+"',desegnation
				// ='"+bean.getDesegnation()+"' where cpfaccno is null and
				// employeename is null and region='CHQNAD' and
				// employeeno='"+bean.getEmpNumber().trim()+"'";

				// String updateSql="update employee_pension_validate set
				// employeename=
				// '"+bean.getEmpName().trim()+"',cpfaccno='"+bean.getCpfAcNo().trim()+"',desegnation
				// ='"+bean.getDesegnation()+"' where cpfaccno is null and
				// employeename is not null and region='CHQNAD' and
				// employeeno='"+bean.getEmpNumber().trim()+"'";
				// log.info("update sql "+updateSql);
				// st.executeUpdate(updateSql);
				FinancialDAO fDAO = new FinancialDAO();
				// for new update of sex and fhname , emplevel
				// countEmployeeInfo= fDAO.checkEmployeeInfo(conn ,
				// bean.getEmpNumber(),bean.getCpfAcNo(),bean.getEmpNumber(),
				// "RAUSAP");
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(),
						bean.getEmpNumber(), "CHQIAD");
				// st.executeUpdate(updateSql);
				if (countEmployeeInfo == 0) {
					if (bean.getDateofBirth() != "") {
						// pensionNumber=this.getPensionNumberError(bean.
						// getEmpName
						// ().trim(),bean.getDateofBirth().trim(),bean.
						// getCpfAcNo().trim(),"");
						// pensionNumber=
						//this.checkPensionNumber(pensionNumber,bean.getCpfAcNo(
						// )
						// .trim(),bean.getEmpNumber(),bean.getEmpName().trim(),
						// "CHQNAD",bean.getDateofBirth().trim());
						pensionNumber = commonDAO.getPensionNumber(bean
								.getEmpName(), bean.getDateofBirth(), bean
								.getCpfAcNo(), true);

						// }
						String sql = "insert into employee_info(cpfacno,employeeno,employeeName,"
								+ "desegnation,airportcode,"
								+ "region,dateofbirth,dateofjoining,pensionNumber,sex,fhname)"
								+ " VALUES " + "('"
								+ bean.getCpfAcNo().trim()
								+ "','"
								+ bean.getEmpNumber().trim()
								+ "','"
								+ bean.getEmpName().trim()
								+ "','"
								+ bean.getDesegnation()
								+ "','"
								+ station
								+ "','"
								+ region
								+ "','"
								+ bean.getDateofBirth()
								+ "','"
								+ bean.getDateofJoining()
								+ "','"
								+ pensionNumber.toUpperCase()
								+ "','"
								+ bean.getSex()
								+ "','"
								+ bean.getFhName()
								+ "')";
						log.info(sql);
						// String updateMastersql="update employee_info set
						// fhname=
						// '"+bean.getFhName()+"',sex='"+bean.getSex()+"',dateofbirth='"+bean.getDateofBirth()+"',dateofjoining='"+bean.getDateofJoining()+"',
						// pensionNumber='"+pensionNumber+"', WETHEROPTION
						// ='"+bean.getWetherOption()+"' where
						// cpfacno='"+bean.getCpfAcNo()+"' and
						// employeeno='"+bean.getEmpNumber()+"' and
						// region='CHQNAD'";

						// String updateSql="update employee_pension_validate
						// set
						// employeename=
						// '"+bean.getEmpName().trim()+"',cpfaccno='"+bean.getCpfAcNo().trim()+"',desegnation
						// ='"+bean.getDesegnation()+"' where cpfaccno is null
						// and employeename is null and region='CHQNAD' and
						// employeeno='"+bean.getEmpNumber().trim()+"'";

						// String updateSql="update employee_pension_validate
						// set
						// employeename=
						// '"+bean.getEmpName().trim()+"',cpfaccno='"+bean.getCpfAcNo().trim()+"',desegnation
						// ='"+bean.getDesegnation()+"' where cpfaccno is null
						// and employeename is not null and region='CHQNAD' and
						// employeeno='"+bean.getEmpNumber().trim()+"'";
						log.info("update sql " + sql);

						st.execute(sql);
						log.info("record update");
					}
				}
			}
		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				conn.close();
			} catch (Exception e) {
			}
		}
		log.info("ImportDao :readXLSChqIadData leaving method");
	}

	public void readXLSChqNadData(String xlsData) throws Exception {
		log.info("ImportDao :readXLSChqNadData() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		ResultSet rs = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "", tempName = "";
		;
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmpNumber(tempInfo[0]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1]);
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}

				for (int j = 0; j < quats.length; j++) {
					// log.info("getName " + bean.getEmpName());
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				if (!tempInfo[3].equals("XXX")) {
					if (tempInfo[3].trim().indexOf("'") != -1) {
						delimiter = "'";
						xlsDesignation = StringUtility.replace(
								tempInfo[3].trim().toCharArray(),
								delimiter.toCharArray(), "").toString();
						bean.setDesegnation(xlsDesignation);

					} else {
						bean.setDesegnation(tempInfo[3].trim());
					}
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDateofBirth(commonUtil.converDBToAppFormat(
							tempInfo[4].trim(), "dd/MM/yyyy", "dd-MMM-yyyy"));
					// bean.setDateofBirth(tempInfo[4].trim());
				} else {
					bean.setDateofBirth("");
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setDateofJoining(commonUtil.converDBToAppFormat(
							tempInfo[5].trim(), "dd/MM/yyyy", "dd-MMM-yyyy"));
					// bean.setDateofJoining(tempInfo[5].trim());
				} else {
					bean.setDateofJoining("");
				}

				String station = "CHQNAD";
				String region = "CHQNAD";
				String pensionNumber = "";
				int countEmployeeInfo = 0;

				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(),
						bean.getEmpNumber(), "CHQNAD");
				// st.executeUpdate(updateSql);
				log.info("date of birth " + bean.getDateofBirth() + "doj  "
						+ bean.getDateofJoining());
				// if (bean.getDateofBirth() != "") {
				// pensionNumber = commonDAO.getPensionNumber(bean.getEmpName(),
				// bean.getDateofBirth(), bean.getCpfAcNo(), true);

				if (countEmployeeInfo == 0) {
					// }
					String sql = "insert into employee_info(cpfacno,employeeno,employeeName,"
							+ "desegnation,airportcode,"
							+ "region,dateofbirth,dateofjoining,pensionNumber,sex,fhname)"
							+ " VALUES " + "('"
							+ bean.getCpfAcNo().trim()
							+ "','"
							+ bean.getEmpNumber().trim()
							+ "','"
							+ bean.getEmpName().trim()
							+ "','"
							+ bean.getDesegnation()
							+ "','"
							+ station
							+ "','"
							+ region
							+ "','"
							+ bean.getDateofBirth()
							+ "','"
							+ bean.getDateofJoining()
							+ "','"
							+ pensionNumber.toUpperCase()
							+ "','"
							+ bean.getSex() + "','" + bean.getFhName() + "')";
					log.info(sql);

					String updateTrasaction = "update employee_pension_validate set MASTER_EMPNAME='"
							+ bean.getEmpName().trim()
							+ "' where cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  region='CHQNAD'";
					/*
					 * String updateMastersql = "update employee_info set
					 * dateofbirth='" + bean.getDateofBirth() +
					 * "',dateofjoining='" + bean.getDateofJoining() +
					 * "',pensionNumber='" + pensionNumber + "'" + " where
					 * cpfacno='" + bean.getCpfAcNo() + "' and employeeno='" +
					 * bean.getEmpNumber() + "' and region='CHQNAD'";
					 * log.info("update sql " + sql);
					 */
					st.execute(updateTrasaction);
					log.info("updateTrasaction " + updateTrasaction);
					st.execute(sql);
					log.info("record inserted , transaction updated");
				} else {
					String updateMastersql = "update employee_info set dateofbirth='"
							+ bean.getDateofBirth()
							+ "',dateofjoining='"
							+ bean.getDateofJoining()
							+ "',pensionNumber='"
							+ pensionNumber
							+ "',employeeno='"
							+ bean.getEmpNumber()
							+ "',employeename ='"
							+ bean.getEmpName().trim()
							+ "'"
							+ "where   cpfacno='"
							+ bean.getCpfAcNo()
							+ "' and  region='CHQNAD'";
					log.info("record updated " + updateMastersql);
					st.execute(updateMastersql);
				}

			}

			// }
		} catch (Exception e) {
			log.printStackTrace(e);

		} finally {
			conn.close();
		}
		log.info("ImportDao :readXLSChqIadData leaving method");
	}

	public void readXLSChqNadData1(String xlsData) throws InvalidDataException {
		log.info("ImportDao :readXLSChqNadData1() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			int count = 0;
			for (int i = 1; i < xlsDataList.size(); i++) {
				count++;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0]);
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					// log.info("getName " + bean.getEmpName());
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmpName(tempName);
					}
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setDesegnation(tempInfo[2]);
				} else {
					bean.setDesegnation("");
				}

				String station = "CHQNAD";
				String region = "CHQNAD";
				String pensionNumber = "";
				int countEmployeeInfo = 0;

				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(),
						bean.getEmpNumber(), "CHQNAD");
				// st.executeUpdate(updateSql);
				log.info("date of birth " + bean.getDateofBirth() + "doj  "
						+ bean.getDateofJoining());
				// if (bean.getDateofBirth() != "") {
				// pensionNumber = commonDAO.getPensionNumber(bean.getEmpName(),
				// bean.getDateofBirth(), bean.getCpfAcNo(), true);

				if (countEmployeeInfo == 0) {
					// }
					String sql = "insert into employee_info(cpfacno,employeeno,employeeName,"
							+ "desegnation,airportcode,"
							+ "region,dateofbirth,dateofjoining,pensionNumber,sex,fhname)"
							+ " VALUES " + "('"
							+ bean.getCpfAcNo().trim()
							+ "','"
							+ bean.getEmpNumber().trim()
							+ "','"
							+ bean.getEmpName().trim()
							+ "','"
							+ bean.getDesegnation()
							+ "','"
							+ station
							+ "','"
							+ region
							+ "','"
							+ bean.getDateofBirth()
							+ "','"
							+ bean.getDateofJoining()
							+ "','"
							+ pensionNumber.toUpperCase()
							+ "','"
							+ bean.getSex() + "','" + bean.getFhName() + "')";
					log.info(sql);

					String updateTrasaction = "update employee_pension_validate set MASTER_EMPNAME='"
							+ bean.getEmpName().trim().toUpperCase()
							+ "' where cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  region='CHQNAD'";
					/*
					 * String updateMastersql = "update employee_info set
					 * dateofbirth='" + bean.getDateofBirth() +
					 * "',dateofjoining='" + bean.getDateofJoining() +
					 * "',pensionNumber='" + pensionNumber + "'" + " where
					 * cpfacno='" + bean.getCpfAcNo() + "' and employeeno='" +
					 * bean.getEmpNumber() + "' and region='CHQNAD'";
					 * log.info("update sql " + sql);
					 */
					st.execute(updateTrasaction);
					log.info("updateTrasaction " + updateTrasaction);
					st.execute(sql);
					log.info("record inserted , transaction updated");
				} else {
					String updateMastersql = "update employee_info set employeename ='"
							+ bean.getEmpName().trim().toUpperCase()
							+ "',desegnation='"
							+ bean.getDesegnation()
							+ "'"
							+ "where   cpfacno='"
							+ bean.getCpfAcNo()
							+ "' and  region='CHQNAD'";
					String updateTrasaction = "update employee_pension_validate set MASTER_EMPNAME='"
							+ bean.getEmpName().trim().toUpperCase()
							+ "' where cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  region='CHQNAD'";

					log.info("record updated " + updateMastersql);
					st.execute(updateTrasaction);
					log.info("updateTrasaction " + updateTrasaction);
					st.execute(updateMastersql);
					log.info("count " + count);
				}

			}

			// }
		} catch (Exception e) {
			log.printStackTrace(e);

		} finally {
			try {
				conn.close();
			} catch (Exception e) {
			}
		}
		log.info("ImportDao :readXLSChqNadData1 leaving method");
	}

	public void readXLSSouthFinalcialData(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSSouthFinalcialData() entering method");
		log.info("readXLSData");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", cpfInterest = "";
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		int countEmployeeInfo = 0;
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[4].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[4].equals("XXX")) {
					String empName = tempInfo[4];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[7].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}
				String salary = "";
				if (!tempInfo[8].equals("XXX")) {
					salary = tempInfo[8].trim();
				} else {
					salary = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setCpfArriers(tempInfo[10].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				/*
				 * Flag "Y" Should be edit the basic or dailyallowanc values
				 * Flag "N" The values are available
				 */

				log.info("basic " + bean.getBasic() + "dailyAllowance "
						+ bean.getDailyAllowance() + "salary  " + salary
						+ "cpfarrear " + bean.getCpfArriers());
				DateFormat df = new SimpleDateFormat("dd-MMM-yy");

				Date transdate = df.parse(bean.getMonthYear());
				float cpfarrear = 0;
				/*
				 * if (transdate.after(new Date("31-Mar-98"))) { cpfarrear =
				 * Float.parseFloat(bean.getCpfArriers().trim()) 100 / 12; }
				 * else { cpfarrear =
				 * Float.parseFloat(bean.getCpfArriers().trim()) 100 / 10; }
				 */
				String emoluments = String.valueOf(Float.parseFloat(salary)
						+ cpfarrear);

				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);
				String cpf = "";
				if (!tempInfo[9].equals("XXX")) {
					cpf = tempInfo[9].trim();
				} else {
					cpf = "0.00";
				}

				bean.setEmpPfStatuary(String.valueOf(Float.parseFloat(bean
						.getCpfArriers())
						+ Float.parseFloat(cpf)));

				log.info("pfstatutory " + bean.getEmpPfStatuary());
				if (!tempInfo[12].equals("XXX")) {
					bean.setEmpVpf(tempInfo[12]);
				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setPfAdvance(tempInfo[14].trim());
				} else {
					bean.setPfAdvance("0.00");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setCpfInterest(tempInfo[15].trim());
				} else {
					bean.setCpfInterest("0.00");
				}

				if (!tempInfo[3].equals("XXX")) {
					bean.setAirportCode(tempInfo[3].trim());
				} else {
					bean.setAirportCode("");
				}

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "South Region");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getAirportCode());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "South Region");
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,DAILYALLOWANCE,PFADVANCE,employeeno,DESEGNATION,cpfarrear,region,cpf)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + bean.getEmployeeName()
						+ "Designation" + bean.getDesignation() + "CpfAccNo "
						+ bean.getCpfAccNo().trim() + "airport code "
						+ bean.getAirportCode());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "South Region");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, bean.getAirportCode());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getDailyAllowance());
					pst.setString(12, bean.getPfAdvance());
					pst.setString(13, bean.getEmployeeNewNo());
					pst.setString(14, bean.getDesignation());
					pst.setString(15, bean.getCpfArriers());
					pst.setString(16, "South Region");
					pst.setString(17, cpf);
					try {
						pst.executeUpdate();

					} catch (Exception e) {
						log.printStackTrace(e);
					}
					// count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.0")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getBasic()
								+ "')), DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
								+ bean.getDailyAllowance()
								+ "')) ,SPECIALBASIC=to_char(TO_NUMBER(nvl(SPECIALBASIC,0)+'"
								+ bean.getSpecialBasic()
								+ "')), emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='South Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					} else {
						float pfstaturoty = Float.parseFloat(bean
								.getEmpPfStatuary().trim()) * 100 / 10;
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ cpfarrear
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getCpfArriers().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='South Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}

				// this.addFinancialDataRecord(bean);

				log
						.info("FinaceDAO :readXLSSouthFinalcialData() end method========= count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	public void readXLSFinalcialData(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSEastFinalcialData() entering method");
		log.info("readXLSData");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", cpfInterest = "";
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		int countEmployeeInfo = 0;
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					if ((bean.getEmployeeNewNo() != "")
							|| (bean.getCpfAccNo() != "")) {
						employeeName = this.checkEmployeeMaster(con, bean
								.getEmployeeNewNo(), bean.getCpfAccNo());
						bean.setEmployeeName(employeeName);
					} else {
						bean.setEmployeeName("");
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[7].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setSpecialBasic(tempInfo[8].trim());
				} else {
					bean.setSpecialBasic("0.00");
				}
				/*
				 * Flag "Y" Should be edit the basic or dailallowanc values Flag
				 * "N" The values are available
				 */

				log.info("basic " + bean.getBasic() + "dailyAllowance "
						+ bean.getDailyAllowance() + "specialBasic  "
						+ bean.getSpecialBasic());

				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic().trim())
						+ Float.parseFloat(bean.getDailyAllowance())
						+ Float.parseFloat(bean.getSpecialBasic()));
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[9]);
				} else {
					bean.setEmpPfStatuary("0.00");
				}
				String cpf = "";
				if (!tempInfo[9].equals("XXX")) {
					cpf = tempInfo[9].trim();
				} else {
					cpf = "0.00";
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setEmpVpf(tempInfo[10]);
				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setPfAdvance(tempInfo[11].trim());
				} else {
					bean.setPfAdvance("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setAdvanceDrawn(tempInfo[12].trim());
				} else {
					bean.setAdvanceDrawn("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setPartFinal(tempInfo[13].trim());
				} else {
					bean.setPartFinal("0.00");
				}
				log.info("pfadvance " + bean.getPfAdvance() + "advanceDrawn"
						+ bean.getAdvanceDrawn() + "partFinal"
						+ bean.getPartFinal());
				float pfAdvance1 = Math.abs(Float.parseFloat(bean
						.getPfAdvance())
						- Float.parseFloat(bean.getAdvanceDrawn())
						- Float.parseFloat(bean.getPartFinal()));

				if (!tempInfo[14].equals("XXX")) {

					bean.setCpfInterest(tempInfo[14].trim());
				} else {
					bean.setCpfInterest("0.00");
				}
				log.info("pfstaturay " + bean.getEmpPfStatuary() + " vpf "
						+ bean.getEmpVpf() + "cpfInterest" + cpfInterest
						+ "pfAdvance1" + pfAdvance1);
				if (!tempInfo[15].equals("XXX")) {
					bean.setGpf(tempInfo[15].trim());
				} else {
					bean.setGpf("0.00");
				}
				if (!tempInfo[16].equals("XXX")) {
					bean.setRemarks(tempInfo[16].trim());
				} else {
					bean.setRemarks("");
				}

				// cpf Arriers for southern RegionData only
				/*
				 * if (!tempInfo[17].equals("XXX")) {
				 * 
				 * bean.setCpfArriers(tempInfo[17].trim()); } else {
				 * bean.setCpfArriers(""); }
				 */

				/* For Easter Region empTotal calculation */
				log.info(" " + bean.getEmpPfStatuary() + " " + bean.getEmpVpf()
						+ " " + cpfInterest + " " + pfAdvance1);

				float empTotal = Float.parseFloat(bean.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getCpfInterest()) + pfAdvance1;
				log.info("empTotal " + empTotal);

				/* For Southern Region */

				/*
				 * log.info("pfstatury " + bean.getEmpPfStatuary() + "vpf" +
				 * bean.getEmpVpf() + " PfAdvance " + bean.getPfAdvance() +
				 * "AdvanceDrawn" + bean.getAdvanceDrawn()); float empTotal =
				 * Float.parseFloat(bean.getEmpPfStatuary()) +
				 * Float.parseFloat(bean.getEmpVpf()) +
				 * Float.parseFloat(bean.getPfAdvance()) +
				 * Float.parseFloat(bean.getAdvanceDrawn());
				 */

				bean.setEmpTotal(String.valueOf(empTotal));
				bean.setAaiTotal(bean.getEmpTotal());

				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				// String
				//Dateformat=commonUtil.converDBToAppFormat(bean.getMonthYear(),
				// "dd-MMM-yyyy",
				// "dd-MM-yyyy");
				// String incrementDate=commonUtil.AddMonth(Dateformat);
				// bean.setMonthYear(incrementDate);

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "East Region");
				if (countEmployeeInfo == 0) {

					/*
					 * String sql = "insert into
					 * employee_info(cpfacno,airportCode,
					 * employeeno,employeeName,desegnation) VALUES " + "('" +
					 * bean.getCpfAccNo().trim() + "','" + bean.getAirportCode()
					 * + "','" + bean.getEmployeeNewNo() + "','" +
					 * tempInfo[3].toString().trim() + "','" +
					 * bean.getDesignation() + "'" + ")";
					 */
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getAirportCode());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "East Region");
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,DAILYALLOWANCE,SPECIALBASIC,PFADVANCE,ADVANCEDRWAN,PARTFINAL,"
						+ "CPFINTEREST,MISSINGFLAG,employeeno,DESEGNATION,gpf,remarks,cpfarrear,region,cpf)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo "
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region
				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "East Region");
				bean.setMonthYear("01-" + bean.getMonthYear());
				log.info(" dd" + bean.getMonthYear());
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, bean.getAirportCode());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getDailyAllowance());
					pst.setString(12, bean.getSpecialBasic());
					pst.setString(13, bean.getPfAdvance());
					pst.setString(14, bean.getAdvanceDrawn());
					pst.setString(15, bean.getPartFinal());
					pst.setString(16, bean.getCpfInterest());
					pst.setString(17, bean.getMissingFlag());
					pst.setString(18, bean.getEmployeeNewNo());
					pst.setString(19, bean.getDesignation());
					pst.setString(20, bean.getGpf());
					pst.setString(21, bean.getRemarks());
					pst.setString(22, bean.getCpfArriers());
					pst.setString(23, "East Region");
					pst.setString(24, cpf);
					try {
						pst.executeUpdate();

					} catch (Exception e) {
						log.printStackTrace(e);
					}
					// count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.0")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getBasic()
								+ "')), DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
								+ bean.getDailyAllowance()
								+ "')) ,SPECIALBASIC=to_char(TO_NUMBER(nvl(SPECIALBASIC,0)+'"
								+ bean.getSpecialBasic()
								+ "')), emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='East Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					} else {

						DateFormat df = new SimpleDateFormat("dd-MMM-yy");

						Date transdate = df.parse(bean.getMonthYear());
						float cpfarrear = 0, pfstaturoty = 0;
						if (transdate.after(new Date("31-Mar-98"))) {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 12;
						} else {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 10;
						}

						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ pfstaturoty
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='East Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}

				// this.addFinancialDataRecord(bean);

				log
						.info("FinaceDAO :readXLSEastFinalcialData() end method========= count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	public void readXLSFinalcialDataNRegion(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataNRegion() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", dailyAllowance = "", specialBasic = "", cpfAccno = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;

			for (int i = 0; i < xlsDataList.size(); i++) {

				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					basic = tempInfo[6];
					bean.setBasic(basic);
				} else {
					basic = "0.00";
					bean.setBasic(basic);
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[7].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}

				// for Da_arriers
				if (!tempInfo[8].equals("XXX")) {
					bean.setSpecialBasic(tempInfo[8].trim());
				} else {
					bean.setSpecialBasic("0.00");
				}
				if (!tempInfo[18].equals("XXX")) {
					bean.setCpfArriers(tempInfo[18].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				log.info("basic " + basic + "dailyAllowance " + dailyAllowance
						+ "specialBasic  " + specialBasic);
				// logic chaged for 1995-1996 shheet Emoul. :- BASIC + DA +
				// DA+ARR + (CPF_ARR/10%)
				// CPF :- PF_CONT + ARR_CONT + CPF_ARR

				String emoluments = String.valueOf(Float.parseFloat(basic)
						+ Float.parseFloat(bean.getDailyAllowance())
						+ Float.parseFloat(bean.getSpecialBasic()));
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// for Pf_count
				String pfCount = "";
				if (!tempInfo[9].equals("XXX")) {
					pfCount = tempInfo[9];
				} else {
					pfCount = "0.00";
				}

				String arrCount = "";
				if (!tempInfo[10].equals("XXX")) {
					arrCount = tempInfo[10];
				} else {
					arrCount = "0.00";
				}

				log.info("pfCount " + pfCount + "arrCount " + arrCount
						+ "cpfarrears " + bean.getCpfArriers());
				String pfStatuary = String.valueOf(Float.parseFloat(pfCount)
						+ Float.parseFloat(arrCount));
				log.info("pfStatuary " + pfStatuary);
				bean.setEmpPfStatuary(pfStatuary);

				String optCpf = "";
				if (!tempInfo[11].equals("XXX")) {
					optCpf = tempInfo[11];
				} else {
					optCpf = "0.00";
				}
				String adDa = "";
				if (!tempInfo[12].equals("XXX")) {
					adDa = tempInfo[12];

				} else {
					adDa = "0.00";
				}
				String vpf = String.valueOf(Float.parseFloat(optCpf)
						+ Float.parseFloat(adDa));
				bean.setEmpVpf(vpf);

				String refAdv = "";
				if (!tempInfo[13].equals("XXX")) {
					refAdv = tempInfo[13];
				} else {
					refAdv = "0.00";
				}

				String dedAdv = "";
				if (!tempInfo[14].equals("XXX")) {
					dedAdv = tempInfo[14];

				} else {
					dedAdv = "0.00";
				}

				String principal = String.valueOf(Float.parseFloat(refAdv)
						- Float.parseFloat(dedAdv));

				bean.setPrincipal(principal);

				String empTotal = String.valueOf(Float.parseFloat(pfCount)
						+ Float.parseFloat(arrCount)
						+ Float.parseFloat(bean.getEmpVpf())
						+ Math.abs(Float.parseFloat(bean.getPrincipal())));
				bean.setEmpTotal(empTotal);
				String dedFemp = "";

				if (!tempInfo[15].equals("XXX")) {
					dedFemp = tempInfo[15];

				} else {
					dedFemp = "0.00";
				}

				String dedFnaa = "";
				if (!tempInfo[16].equals("XXX")) {
					dedFnaa = tempInfo[16];

				} else {
					dedFnaa = "0.00";

				}
				if (!tempInfo[17].equals("XXX")) {
					bean.setRemarks(tempInfo[17].trim());

				} else {
					bean.setRemarks("");
				}

				bean.setAaiTotal(bean.getEmpTotal());

				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}

				log.info("cpfaccno " + bean.getCpfAccNo());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = this.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "North Region");
				if (countEmployeeInfo == 0) {

					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getAirportCode());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "North Region");
					// pst.setString(7,String.valueOf(sequenceNumber));
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,DAILYALLOWANCE,DAARREAR,pfCount,arrCount,optCpf,"
						+ "adDa,refAdv,dedAdv,dedFemp,dedFnaa,employeeno,DESEGNATION,remarks,region,CPFARREAR)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "North Region");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, bean.getAirportCode());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getDailyAllowance());
					pst.setString(12, bean.getSpecialBasic());
					pst.setString(13, pfCount);
					pst.setString(14, arrCount);
					pst.setString(15, optCpf);
					pst.setString(16, adDa);
					pst.setString(17, refAdv);
					pst.setString(18, dedAdv);
					pst.setString(19, dedFemp);
					pst.setString(20, dedFnaa);
					pst.setString(21, bean.getEmployeeNewNo());
					pst.setString(22, bean.getDesignation());
					pst.setString(23, bean.getRemarks());
					pst.setString(24, "North Region");
					pst.setString(25, bean.getCpfArriers());
					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						basicDaSum = Float.parseFloat(bean.getBasic())
								+ Float.parseFloat(bean.getDailyAllowance()
										+ Float.parseFloat(bean
												.getSpecialBasic()));
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getBasic()
								+ "')), DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
								+ bean.getDailyAllowance()
								+ "')) , emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ basicDaSum
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='North Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and  monthyear='"
								+ bean.getMonthYear()
								+ "'";

					}
					// this.addFinancialDataRecord(bean);

					log
							.info("FinaceDAO :readXLSFinalcialDataNRegion() end method count"
									+ count);
				}
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	public void readXLSFinalcialDataWRegion(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataWRegion() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", dailyAllowance = "", specialBasic = "", cpfAccno = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[7].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}
				log.info("basic " + basic + "dailyAllowance " + dailyAllowance);
				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic())
						+ Float.parseFloat(bean.getDailyAllowance()));
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);
				String cpf = "";
				if (!tempInfo[8].equals("XXX")) {
					cpf = tempInfo[8];
				} else {
					cpf = "0.00";
				}
				String fpf = "";
				if (!tempInfo[9].equals("XXX")) {
					fpf = tempInfo[9];
				} else {
					fpf = "0.00";
				}

				log.info("cpf " + cpf + "fpf " + fpf);
				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(fpf));
				log.info("pfStatuary " + pfStatuary);
				bean.setEmpPfStatuary(pfStatuary);

				String vpf = "";
				if (!tempInfo[10].equals("XXX")) {
					vpf = tempInfo[10];
				} else {
					vpf = "0.00";
				}
				bean.setEmpVpf(vpf);
				String advRec = "";
				if (!tempInfo[11].equals("XXX")) {
					advRec = tempInfo[11];
				} else {
					advRec = "0.00";
				}
				String advGiv = "";
				if (!tempInfo[12].equals("XXX")) {
					advGiv = tempInfo[12];
				} else {
					advGiv = "0.00";
				}
				String empTotal = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(fpf)
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(advRec));
				bean.setEmpTotal(empTotal);
				if (!tempInfo[13].equals("XXX")) {
					bean.setRemarks(tempInfo[13].trim());

				} else {
					bean.setRemarks("");
				}
				bean.setAaiTotal(bean.getEmpTotal());
				String shortRec = "";
				if (!tempInfo[14].equals("XXX")) {
					shortRec = tempInfo[14].trim();

				} else {
					shortRec = "0.00";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				log.info("cpfaccno " + bean.getCpfAccNo());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "West Region");
				if (countEmployeeInfo == 0) {

					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,dateofbirth) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getAirportCode());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "West Region");
					pst.setString(7, bean.getDateofBirth());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,DAILYALLOWANCE,cpf,fpf,advRec,advGiv,shortRec,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "West Region");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, bean.getAirportCode());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getDailyAllowance());
					pst.setString(12, cpf);
					pst.setString(13, fpf);
					pst.setString(14, advRec);
					pst.setString(15, advGiv);
					pst.setString(16, shortRec);
					pst.setString(17, bean.getEmployeeNewNo());
					pst.setString(18, bean.getDesignation());
					pst.setString(19, bean.getRemarks());
					pst.setString(20, "West Region");

					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						basicDaSum = Float.parseFloat(bean.getBasic())
								+ Float.parseFloat(bean.getDailyAllowance());
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getBasic()
								+ "')), DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
								+ bean.getDailyAllowance()
								+ "')) , emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ basicDaSum
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "'+'"
								+ fpf
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='West Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and  monthyear='"
								+ bean.getMonthYear()
								+ "'";

					} else {
						float pfstaturoty = Float.parseFloat(bean
								.getEmpPfStatuary().trim()) * 100 / 10;
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ pfstaturoty
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='West Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and monthyear='"
								+ bean.getMonthYear()
								+ "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}

				// this.addFinancialDataRecord(bean);

				log
						.info("FinaceDAO :readXLSFinalcialDataWRegion() end method========= count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	public void readXLSFinalcialDataChqNad(String xlsData) throws Exception {
		log.info("FinaceDAO :readXLSFinalcialDataChqNad() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		String fpf = "", ptw = "", adDa = "", advance = "", daArrear = "", cpfArrear = "";
		;
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			// logic for CHQNAD FROM 95 TO 9900

			for (int i = 0; i < xlsDataList.size(); i++) {
				st = con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6]);
				} else {
					bean.setBasic("0.00");
				}
				String pfCount = "", refAdv = "";
				if (!tempInfo[7].equals("XXX")) {
					pfCount = tempInfo[7];
				} else {
					pfCount = "0.00";
				}
				String emoluments = String.valueOf(Float.parseFloat(basic));
				bean.setEmoluments(emoluments);
				if (!tempInfo[8].equals("XXX")) {
					refAdv = tempInfo[8];
				} else {
					refAdv = "0.00";
				}

				String pfStatuary = String.valueOf(Float.parseFloat(bean
						.getBasic()) * 12 / 100);
				log.info("pfStatuary " + pfStatuary);
				if (!pfStatuary.endsWith("0.0")) {
					bean.setEmpPfStatuary(pfStatuary);
				} else
					bean.setEmpPfStatuary("0.00");

				String vpf = String.valueOf(Float.parseFloat(pfCount)
						- Float.parseFloat(pfStatuary));

				if (!tempInfo[9].equals("XXX")) {
					adDa = tempInfo[9];
				} else {
					adDa = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					fpf = tempInfo[10];
				} else {
					fpf = "0.00";
				}

				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(vpf) + Float.parseFloat(refAdv));

				bean.setEmpTotal(empTotal);
				if (!tempInfo[11].equals("XXX")) {
					advance = tempInfo[11].trim();
				} else {
					advance = "0.00";
				}
				if (!tempInfo[12].equals("XXX")) {
					daArrear = tempInfo[12].trim();
				} else {
					daArrear = "0.00";
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setCpfArriers(tempInfo[13].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setRemarks(tempInfo[14].trim());
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[15].equals("XXX")) {
					ptw = tempInfo[15].trim();
				} else {
					ptw = "";
				}

				bean.setAaiTotal(bean.getEmpTotal());

				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}

				log.info("cpfaccno " + bean.getCpfAccNo()); // for Northern
				// Region checking cpfaccno instead employeename // employeeName
				// = commonDAO.checkEmployeeInfo(con, //
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(), //
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQNAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,dateofbirth) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "CHQNAD".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation()); // for southern
					// region Data
					pst.setString(6, "CHQNAD".trim());
					pst.setString(7, bean.getDateofBirth());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into  employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,pfCount,advRec,adDa,fpf,advance,daArrear,cpfArrear,employeeno,DESEGNATION,remarks,region)   values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "CHQNAD".trim());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, pfCount);
					pst.setString(12, refAdv);
					pst.setString(13, adDa);
					pst.setString(14, fpf);
					pst.setString(15, advance);
					pst.setString(16, daArrear);
					pst.setString(17, cpfArrear);
					pst.setString(18, bean.getEmployeeNewNo());
					pst.setString(19, bean.getDesignation());
					pst.setString(20, bean.getRemarks());
					pst.setString(21, "CHQNAD".trim());

					count = pst.executeUpdate();
					count++;
					pst.close();
				} //
				// this.addFinancialDataRecord(bean);

				log
						.info("FinaceDAO :readXLSFinalcialDataChqNad() end   method========= count"
								+ count);

				// Logic from 2000 to 2008 CHQNAD REGION
				/*
				 * for (int i = 0; i < xlsDataList.size(); i++) { //
				 * st=con.createStatement(); bean = new FinacialDataBean();
				 * tempData = xlsDataList.get(i).toString(); tempInfo =
				 * tempData.split("@"); log.info("Employee Code" +
				 * tempInfo[0].toString().trim() + "CPFACCNO" +
				 * tempInfo[1].toString().trim() + "Employee Name" +
				 * tempInfo[3].toString().trim());
				 * 
				 * if (!tempInfo[0].equals("XXX")) {
				 * bean.setEmployeeNewNo(tempInfo[0]); } else {
				 * bean.setEmployeeNewNo(""); }
				 * 
				 * if (!tempInfo[1].equals("XXX")) {
				 * bean.setCpfAccNo(tempInfo[1].trim()); } else {
				 * bean.setCpfAccNo(""); } if (!tempInfo[2].equals("XXX")) {
				 * bean.setMonthYear(tempInfo[2]); } else {
				 * bean.setMonthYear(""); } log.info("year " +
				 * bean.getMonthYear()); if (!tempInfo[3].equals("XXX")) {
				 * String empName = tempInfo[3]; int empNameLength =
				 * empName.length();
				 * 
				 * if (empName.charAt(empNameLength - 1) == '.') { empName =
				 * empName.substring(0, empNameLength - 1); }
				 * bean.setEmployeeName(empName); } else {
				 * bean.setEmployeeName(""); }
				 * 
				 * int startIndxName = 0; int endIndxName = 1;
				 * 
				 * String tempName = ""; for (int j = 0; j < quats.length; j++)
				 * { log.info("getName " + bean.getEmployeeName()); if
				 * (bean.getEmployeeName().toLowerCase().indexOf(
				 * quats[j].toLowerCase()) != -1) { tempName =
				 * bean.getEmployeeName().toLowerCase()
				 * .replaceAll(quats[j].toLowerCase(), "").trim();
				 * log.info("tempName " + tempName); //
				 * tempName=empName.substring(index+1,empName.length());
				 * bean.setEmployeeName(tempName); } } log.info("emp name " +
				 * bean.getEmployeeName());
				 * 
				 * if (!tempInfo[4].equals("XXX")) {
				 * bean.setDesignation(tempInfo[4]); } else {
				 * bean.setDesignation(""); }
				 * 
				 * if (!tempInfo[6].equals("XXX")) { basic = tempInfo[6]; } else
				 * { basic = "0.00"; } bean.setBasic(basic);
				 * 
				 * String vda = ""; if (!tempInfo[7].equals("XXX")) { vda =
				 * tempInfo[7]; } else { vda = "0.00"; }
				 * 
				 * log.info("salary " + basic + "vda " + vda);
				 * 
				 * String cpf = ""; if (!tempInfo[8].equals("XXX")) { cpf =
				 * tempInfo[8]; } else { cpf = "0.00"; }
				 * 
				 * log.info("cpf " + cpf); String vpf = "";
				 * 
				 * if (!tempInfo[9].equals("XXX")) { vpf = tempInfo[9]; } else {
				 * vpf = "0.00"; }
				 * 
				 * String cpfArrear = ""; if (!tempInfo[10].equals("XXX")) {
				 * cpfArrear = tempInfo[10]; } else { cpfArrear = "0.00"; }
				 * bean.setCpfArriers(cpfArrear);
				 * 
				 * String pfStatuary = String.valueOf(Float.parseFloat(cpf) +
				 * Float.parseFloat(bean.getCpfArriers()));
				 * log.info("pfStatuary " + pfStatuary); if
				 * (!pfStatuary.endsWith("0.0")) {
				 * bean.setEmpPfStatuary(pfStatuary); } else
				 * bean.setEmpPfStatuary("0.00");
				 * 
				 * String emoluments = String
				 * .valueOf(Float.parseFloat(pfStatuary) 100 / 12);
				 * log.info("emoluments " + emoluments);
				 * bean.setEmoluments(emoluments); String cpfAdvance = ""; if
				 * (!tempInfo[11].equals("XXX")) { cpfAdvance =
				 * tempInfo[11].trim(); } else { cpfAdvance = "0.00"; }
				 * 
				 * String empTotal = String.valueOf(Float.parseFloat(bean
				 * .getEmpPfStatuary()) + Float.parseFloat(vpf) +
				 * Float.parseFloat(cpfAdvance));
				 * 
				 * bean.setEmpTotal(empTotal);
				 * 
				 * if (!tempInfo[12].equals("XXX")) {
				 * bean.setRemarks(tempInfo[12].trim()); } else {
				 * bean.setRemarks(""); }
				 * 
				 * bean.setAaiTotal(bean.getEmpTotal()); if
				 * (!tempInfo[5].equals("XXX")) {
				 * bean.setAirportCode(tempInfo[5].trim()); } else {
				 * bean.setAirportCode(""); }
				 * 
				 * DateValidation dateValidation = new DateValidation(); if
				 * (!tempInfo[2].equals("XXX")) {
				 * bean.setMonthYear(tempInfo[2].toString()); } else {
				 * bean.setMonthYear(""); } // log.info("cpfaccno " +
				 * bean.getCpfAccNo());
				 * 
				 * FinacialDataBean bean1 = this.getEmployeeInfo(bean
				 * .getEmployeeNewNo()); // for Northern Region checking
				 * cpfaccno nstead employeename // employeeName =
				 * commonDAO.checkEmployeeInfo(con, // bean.getEmployeeNewNo(),
				 * bean.getCpfAccNo(), // bean.getEmployeeName());
				 * countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
				 * .getEmployeeNewNo(), bean.getCpfAccNo(), bean
				 * .getEmployeeName(), "CHQNAD"); log.info("empName" +
				 * bean1.getEmployeeName() + "deseg " + bean1.getDesignation() +
				 * "cpfacno " + bean1.getCpfAccNo()); if (countEmployeeInfo ==
				 * 0) { String sql = "insert into
				 * employee_info(cpfacno,airportCode,
				 * employeeno,employeeName,desegnation,region,dateofbirth)
				 * VALUES " + "(?,?,?,?,?,?,?)"; pst =
				 * con.prepareStatement(sql); pst.setString(1,
				 * bean1.getCpfAccNo().trim()); pst.setString(2,
				 * "CHQNAD".trim()); pst.setString(3, bean.getEmployeeNewNo());
				 * pst.setString(4, bean1.getEmployeeName()); pst.setString(5,
				 * bean1.getDesignation()); // for southern region Data
				 * pst.setString(6, "CHQNAD".trim()); pst.setString(7,
				 * bean.getDateofBirth()); pst.executeUpdate(); pst.close(); }
				 * String finaceInsert = "insert into
				 * employee_pension_validate(cpfaccno
				 * ,emoluments,emppfstatuary,empvpf
				 * ,emptotal,aaitotal,AIRPORTCODE," +
				 * "MONTHYEAR,employeeName,BASIC,vda,cpf,cpfArrear,cpfAdvance,employeeno,DESEGNATION,remarks,region)"
				 * + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				 * 
				 * log.info(" employeeName" + employeeName + "Designation" +
				 * bean.getDesignation() + "CpfAccNo" +
				 * bean.getCpfAccNo().trim());
				 * 
				 * String foundSalaryDate = this.checkFinanceDuplicate(con, bean
				 * .getMonthYear().trim(), bean.getCpfAccNo(), bean
				 * .getEmployeeNewNo(), "CHQNAD");
				 * 
				 * if (foundSalaryDate.equals("")) { pst =
				 * con.prepareStatement(finaceInsert); pst.setString(1,
				 * bean1.getCpfAccNo().trim()); pst.setString(2,
				 * bean.getEmoluments()); pst.setString(3,
				 * bean.getEmpPfStatuary().trim()); pst.setString(4,
				 * bean.getEmpVpf().trim()); pst.setString(5,
				 * bean.getEmpTotal().trim()); pst.setString(6,
				 * bean.getAaiTotal().trim()); pst.setString(7,
				 * "CHQNAD".trim()); pst.setString(8, bean.getMonthYear());
				 * pst.setString(9, bean1.getEmployeeName()); pst.setString(10,
				 * bean.getBasic()); pst.setString(11, vda); pst.setString(12,
				 * cpf); pst.setString(13, bean.getCpfArriers());
				 * pst.setString(14, cpfAdvance); pst.setString(15,
				 * bean.getEmployeeNewNo()); pst.setString(16,
				 * bean1.getDesignation()); pst.setString(17,
				 * bean.getRemarks()); pst.setString(18, "CHQNAD".trim());
				 * 
				 * count = pst.executeUpdate(); count++; pst.close(); } //
				 * this.addFinancialDataRecord(bean); log .info("FinaceDAO
				 * :readXLSFinalcialDataChqNad() End method count" + count); }
				 */

				finalcialDataList.add(bean);

			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			con.close();
		}

	}

	public void readXLSFinalcialDataChqNadKamalDeep(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataChqNad Kamldeep() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", empName = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString(), tempName = "";
		;
		String monthYear = xlsDataList.get(1).toString(), cpf = "", cpfArrear = "", pfStatuary = "", emoluments = "", empTotal = "";
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			// logic for CHQNAD FROM 95 TO 9900

			for (int i = 0; i < xlsDataList.size(); i++) {
				st = con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					empName = tempInfo[3];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				/*
				 * if (!tempInfo[6].equals("XXX")) { basic = tempInfo[6]; } else
				 * { basic = "0.00"; } bean.setBasic(basic); String vda = ""; if
				 * (!tempInfo[7].equals("XXX")) { vda = tempInfo[7]; } else {
				 * vda = "0.00"; }
				 * 
				 * log.info("salary " + basic + "vda " + vda);
				 */
				if (!tempInfo[13].equals("XXX")) {
					cpf = tempInfo[13];
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setEmpVpf(tempInfo[14]);
				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[15].equals("XXX")) {
					cpfArrear = tempInfo[15];
				} else {
					cpfArrear = "0.00";
				}
				bean.setCpfArriers(cpfArrear);

				pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(bean.getCpfArriers()));
				log.info("pfStatuary " + pfStatuary);
				if (!pfStatuary.endsWith("0.0")) {
					bean.setEmpPfStatuary(pfStatuary);
				} else
					bean.setEmpPfStatuary("0.00");
				emoluments = String
						.valueOf(Float.parseFloat(pfStatuary) * 100 / 12);
				bean.setEmoluments(emoluments);
				String cpfAdvance = "";
				if (!tempInfo[16].equals("XXX")) {
					cpfAdvance = tempInfo[16].trim();
				} else {
					cpfAdvance = "0.00";
				}

				empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(cpfAdvance));

				bean.setEmpTotal(empTotal);

				if (!tempInfo[12].equals("XXX")) {
					bean.setRemarks(tempInfo[12].trim());
				} else {
					bean.setRemarks("");
				}

				bean.setAaiTotal(bean.getEmpTotal());

				if (!tempInfo[5].equals("XXX")) {
					bean.setDateofBirth(tempInfo[5].trim());
				} else {
					bean.setDateofBirth("");
				}

				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				// log.info("cpfaccno " + bean.getCpfAccNo());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQNAD");

				log.info("empName" + bean.getEmployeeName() + "deseg "
						+ bean.getDesignation() + "cpfacno "
						+ bean.getCpfAccNo());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,dateofbirth,WETHEROPTION) VALUES "
							+ "(?,?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "CHQNAD".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation()); // for southern
					// region Data
					pst.setString(6, "CHQNAD".trim());
					pst.setString(7, bean.getDateofBirth());
					pst.setString(8, "B");

					// pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into  employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,vda,cpf,cpfArrear,cpfAdvance,employeeno,DESEGNATION,remarks,region)  values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "CHQNAD".trim());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, "0.00");
					pst.setString(12, cpf);
					pst.setString(13, bean.getCpfArriers());
					pst.setString(14, cpfAdvance);
					pst.setString(15, bean.getEmployeeNewNo());
					pst.setString(16, bean.getDesignation());
					pst.setString(17, bean.getRemarks());
					pst.setString(18, "CHQNAD".trim());

					// count = pst.executeUpdate();
					count++;
					pst.close();
				}

			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			// con.close();
		}

	}

	public void readXLSFinalcialDataChqNadAllahabad(String xlsData)
			throws Exception {
		log
				.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", advance = "", cpf = "", arrCount = "", refAdvance = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[0].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setMonthYear(tempInfo[1]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				String tempName = "";
				for (int j = 0; j < quats.length; j++) {

					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					basic = tempInfo[4];
				} else {
					basic = "0.00";
				}
				bean.setBasic(basic);
				if (!tempInfo[5].equals("XXX")) {
					cpf = tempInfo[5];
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					arrCount = tempInfo[6];

				} else {
					arrCount = "0.00";
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpVpf(tempInfo[7]);
				} else {
					bean.setEmpVpf("0.00");
				}

				if (!tempInfo[8].equals("XXX")) {
					refAdvance = tempInfo[8].trim();
				} else {
					refAdvance = "0.00";
				}
				if (!tempInfo[9].equals("XXX")) {
					advance = tempInfo[9].trim();

				} else {
					advance = "0.00";
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setRemarks(tempInfo[10].trim());

				} else {
					bean.setRemarks("");
				}

				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(arrCount));
				log.info("pfStatuary " + pfStatuary);
				// LOGIC FROM 95-98
				// String emoluments =
				// String.valueOf(Float.parseFloat(pfStatuary) * 100 / 10);

				// LOGIC FROM 98-2001
				String emoluments = String
						.valueOf(Float.parseFloat(pfStatuary) * 100 / 12);
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// FinacialDataBean bean1 =
				// this.getEmployeeInfo(bean.getCpfAccNo().trim());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQNAD");
				log.info("empName" + bean.getEmployeeName() + "deseg "
						+ bean.getDesignation() + "cpfacno "
						+ bean.getCpfAccNo());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "Allahabad".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "CHQNAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,arrCount,REFADV,advance,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "Allahabad".trim());
					pst.setString(6, bean.getMonthYear());
					pst.setString(7, bean.getEmployeeName());
					pst.setString(8, bean.getBasic());
					pst.setString(9, cpf);
					pst.setString(10, arrCount);
					pst.setString(11, refAdvance);
					pst.setString(12, advance);
					pst.setString(13, bean.getDesignation());
					pst.setString(14, bean.getRemarks());
					pst.setString(15, "CHQNAD".trim());

					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				// this.addFinancialDataRecord(bean);
				log
						.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad() End method count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			con.close();
		}

	}

	public void readXLSFinalcialDataChqNadAllahabad20012003(String xlsData)
			throws Exception {
		log
				.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20012003() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", tempName = "", cpf = "", cpfArrear = "", cpfAdv = "", advance = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("CPFACCNO" + tempInfo[0].toString().trim()
						+ "Employee Name" + tempInfo[2].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[0].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setMonthYear(tempInfo[1]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setBasic(tempInfo[4]);
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[5].equals("XXX")) {
					cpf = tempInfo[5];
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					cpfArrear = tempInfo[6].trim();
				} else {
					cpfArrear = "0.00";
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpVpf(tempInfo[7].trim());
				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[9].equals("XXX")) {
					cpfAdv = tempInfo[9].trim();

				} else {
					cpfAdv = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					advance = tempInfo[10].trim();

				} else {
					advance = "0.00";
				}

				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(cpfArrear));
				String emoluments = String
						.valueOf(Float.parseFloat(pfStatuary) * 100 / 12);

				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// FinacialDataBean bean1 =
				// this.getEmployeeInfo(bean.getCpfAccNo().trim());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQNAD");
				log.info("empName" + bean.getEmployeeName() + "deseg "
						+ bean.getDesignation() + "cpfacno "
						+ bean.getCpfAccNo());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "Allahabad".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "CHQNAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,CPFARREAR,REFADV,advrec,advance,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "Allahabad".trim());
					pst.setString(6, bean.getMonthYear());
					pst.setString(7, bean.getEmployeeName());
					pst.setString(8, bean.getBasic());
					pst.setString(9, cpf.trim());
					pst.setString(10, cpfArrear.trim());
					pst.setString(11, cpfAdv.trim());
					String advrec = "";
					pst.setString(12, advrec);
					pst.setString(13, advance.trim());
					pst.setString(14, bean.getDesignation());
					pst.setString(15, bean.getRemarks());
					pst.setString(16, "CHQNAD".trim());

					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				// this.addFinancialDataRecord(bean);
				log
						.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20012003() End method count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			con.close();
		}

	}

	public void readXLSFinalcialDataChqNadAllahabad20062007(String xlsData)
			throws Exception {
		log
				.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20062007() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };

		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[0].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setMonthYear(tempInfo[1]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {

					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					basic = tempInfo[4];
				} else {
					basic = "0.00";
				}
				bean.setBasic(basic);
				String total = "", cpf = "", pfAdvance = "", advrec = "";
				if (!tempInfo[5].equals("XXX")) {
					total = tempInfo[5];
				} else {
					total = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					cpf = tempInfo[6];
				} else {
					cpf = "0.00";
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpVpf(tempInfo[7]);

				} else {
					bean.setEmpVpf("0.00");
				}

				if (!tempInfo[8].equals("XXX")) {
					pfAdvance = tempInfo[8].trim();

				} else {
					pfAdvance = "0.00";
				}
				if (!tempInfo[9].equals("XXX")) {
					advrec = tempInfo[9].trim();

				} else {
					advrec = "0.00";
				}
				String pfStatuary = String.valueOf(Float.parseFloat(cpf));
				log.info("pfStatuary " + pfStatuary);
				// LOGIC FROM 95-98
				// String emoluments =
				// String.valueOf(Float.parseFloat(pfStatuary) * 100 / 10);

				// LOGIC FROM 98-2001
				String emoluments = String.valueOf(Float.parseFloat(total));
				bean.setEmoluments(emoluments);

				// FinacialDataBean bean1 =
				// this.getEmployeeInfo(bean.getCpfAccNo().trim());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQNAD");
				log.info("empName" + bean.getEmployeeName() + "deseg "
						+ bean.getDesignation() + "cpfacno "
						+ bean.getCpfAccNo());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "Allahabad".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "CHQNAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,PFADVANCE,advrec,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "Allahabad".trim());
					pst.setString(6, bean.getMonthYear());
					pst.setString(7, bean.getEmployeeName());
					pst.setString(8, bean.getBasic());
					pst.setString(9, cpf);
					pst.setString(10, pfAdvance);
					pst.setString(11, advrec);
					pst.setString(12, bean.getDesignation());
					pst.setString(13, bean.getRemarks());
					pst.setString(14, "CHQNAD".trim());

					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				// this.addFinancialDataRecord(bean);
				log						.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20062007() End method count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			con.close();
		}

	}

	public void readXLSFinalcialDataChqNadAllahabad01020203(String xlsData)
			throws InvalidDataException {
		log
				.info("ImportDao :readXLSFinalcialDataChqNadAllahabad0102-0203() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String cpf = "", cpfArrear = "", vpf = "", pfAdvance = "", emoluments = "", pfStatuary = "", tempName = "";
		;

		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[0].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[1].trim());
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				for (int j = 0; j < quats.length; j++) {

					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					basic = tempInfo[5];
				} else {
					basic = "0.00";
				}
				bean.setBasic(basic);
				if (!tempInfo[6].equals("XXX")) {
					cpf = tempInfo[6];
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[7].equals("XXX")) {
					cpfArrear = tempInfo[7];
				} else {
					cpfArrear = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setEmpVpf(tempInfo[8]);

				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[9].equals("XXX")) {
					pfAdvance = tempInfo[9].trim();
				} else {
					pfAdvance = "0.00";
				}
				pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(cpfArrear));
				bean.setEmpPfStatuary(pfStatuary);
				emoluments = String
						.valueOf(Float.parseFloat(pfStatuary) * 100 / 12);
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// FinacialDataBean bean1 =
				// this.getEmployeeInfo(bean.getCpfAccNo().trim());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "North Region");
				log.info("empName" + bean.getEmployeeName() + "deseg "
						+ bean.getDesignation() + "cpfacno "
						+ bean.getCpfAccNo());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "Allahabad".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "North Region".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,PFADVANCE,CPFARREAR,DESEGNATION,remarks,region,EMPLOYEENO)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "North Region");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "Allahabad".trim());
					pst.setString(6, bean.getMonthYear());
					pst.setString(7, bean.getEmployeeName());
					pst.setString(8, bean.getBasic());
					pst.setString(9, cpf);
					pst.setString(10, pfAdvance);
					pst.setString(11, cpfArrear);
					pst.setString(12, bean.getDesignation());
					pst.setString(13, bean.getRemarks());
					pst.setString(14, "North Region".trim());
					pst.setString(15, bean.getEmployeeNewNo().trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				// this.addFinancialDataRecord(bean);
				log
						.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad0102-0203() End method count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	public void readXLSFinalcialDataChqNadAllahabad20072008(String xlsData)
			throws Exception {
		log
				.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20072008() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", dailyAllowance = "", specialBasic = "", cpfAccno = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString(), cpf = "", optCpf = "", emoluments = "";
		String monthYear = xlsDataList.get(1).toString();
		String vpf = "", pfAdvance = "", interest = "", pfStatuary = "";
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("CPFACCNO" + tempInfo[0].toString().trim()
						+ "Employee Name" + tempInfo[2].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[0].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setMonthYear(tempInfo[1]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				int startIndxName = 0;
				int endIndxName = 1;

				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setBasic(tempInfo[4]);
				} else {
					bean.setBasic("0.00");
				}

				if (!tempInfo[5].equals("XXX")) {
					cpf = tempInfo[5];
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					optCpf = tempInfo[6];
				} else {
					optCpf = "0.00";
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpVpf(tempInfo[7]);

				} else {
					bean.setEmpVpf("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					pfAdvance = tempInfo[8].trim();

				} else {
					pfAdvance = "0.00";
				}

				if (!tempInfo[9].equals("XXX")) {
					interest = tempInfo[9].trim();

				} else {
					interest = "0.00";
				}
				pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(optCpf));
				log.info("pfStatuary " + pfStatuary);
				bean.setEmpPfStatuary(pfStatuary);
				emoluments = String
						.valueOf(Float.parseFloat(pfStatuary) * 100 / 12);

				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// FinacialDataBean bean1 =
				// this.getEmployeeInfo(bean.getCpfAccNo().trim());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "North Region");

				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "Allahabad".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "North Region".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,PFADVANCE,ADDCPF,CPFINTEREST,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());

				// String foundSalaryDate = this.checkFinanceDuplicate(con,
				// bean.getMonthYear().trim(), bean.getCpfAccNo(),
				// bean.getEmployeeNewNo(), "North Region");

				// if (foundSalaryDate.equals("")) {
				pst = con.prepareStatement(finaceInsert);
				pst.setString(1, bean.getCpfAccNo().trim());
				pst.setString(2, bean.getEmoluments());
				pst.setString(3, bean.getEmpPfStatuary().trim());
				pst.setString(4, bean.getEmpVpf().trim());
				pst.setString(5, "Allahabad".trim());
				pst.setString(6, bean.getMonthYear());
				pst.setString(7, bean.getEmployeeName());
				pst.setString(8, bean.getBasic());
				pst.setString(9, cpf);
				pst.setString(10, pfAdvance);
				pst.setString(11, optCpf);
				pst.setString(12, interest);
				pst.setString(13, bean.getDesignation());
				pst.setString(14, "one month escalated");
				pst.setString(15, "North Region".trim());

				count = pst.executeUpdate();
				count++;
				pst.close();
				// }

				// this.addFinancialDataRecord(bean);
				log
						.info("FinaceDAO :readXLSFinalcialDataChqNadAllahabad20072008() End method count"
								+ count);
			}

			finalcialDataList.add(bean);

		} catch (SQLException e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block

			log.printStackTrace(e);
		} finally {

			con.close();
		}

	}

	public void readXLSFinalcialDataNERegion(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataNERegion() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "", empName = "", tempName = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();

			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					empName = tempInfo[3];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				int startIndxName = 0;
				int endIndxName = 1;
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					basic = tempInfo[6];
					bean.setBasic(basic);
				} else {
					basic = "0.00";
					bean.setBasic(basic);
				}
				String vda = "", cpf = "", empTotal = "";
				if (!tempInfo[7].equals("XXX")) {
					vda = tempInfo[7];
				} else {
					vda = "0.00";
				}

				if (!tempInfo[8].equals("XXX")) {
					cpf = tempInfo[8];
				} else {
					cpf = "0.00";

				}
				bean.setEmpPfStatuary(cpf);
				log.info("basic " + basic + "vda " + vda);

				String emoluments = String.valueOf(Float.parseFloat(basic)
						+ Float.parseFloat(vda));
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				// new column added for NER REGION
				/*
				 * String addCpf = ""; if (!tempInfo[9].equals("XXX")) { addCpf
				 * = tempInfo[9]; } else { addCpf = "0.00"; }
				 * 
				 * String pfAdvance = ""; if (!tempInfo[10].equals("XXX")) {
				 * bean.setPfAdvance(tempInfo[10].trim()); } else {
				 * bean.setPfAdvance("0.00"); }
				 * 
				 * log.info("addCpf " + addCpf + "pfAdvance " +
				 * bean.getPfAdvance()); String pfStatuary =
				 * String.valueOf(Float.parseFloat(cpf) +
				 * Float.parseFloat(addCpf)); log.info("pfStatuary " +
				 * pfStatuary); if (!pfStatuary.endsWith("0.0")) {
				 * bean.setEmpPfStatuary(pfStatuary); } else
				 * bean.setEmpPfStatuary("0.00"); String vpf =
				 * String.valueOf(Float.parseFloat(bean .getPfAdvance()));
				 * bean.setEmpVpf(vpf); String advance = ""; if
				 * (!tempInfo[11].equals("XXX")) { advance = tempInfo[11]; }
				 * else { advance = "0.00"; }
				 */
				empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}

				log.info("cpfaccno " + bean.getCpfAccNo() + "month year "
						+ bean.getMonthYear());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "North-East Region");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,dateofbirth) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getAirportCode());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "North-East Region");
					pst.setString(7, bean.getDateofBirth());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,vda,cpf,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "North-East Region");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, bean.getAirportCode());
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, vda);
					pst.setString(12, cpf);
					pst.setString(13, bean.getEmployeeNewNo());
					pst.setString(14, bean.getDesignation());
					pst.setString(15, bean.getRemarks());
					pst.setString(16, "North-East Region");

					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yy", "-MMM-yy");
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.0")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getBasic()
								+ "')), vda=to_char(TO_NUMBER(nvl(vda,0)+'"
								+ vda
								+ "')), emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='North-East Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";

					} else {
						DateFormat df = new SimpleDateFormat("dd-MMM-yy");

						Date transdate = df.parse(bean.getMonthYear());
						float pfstaturoty = 0;
						if (transdate.after(new Date("31-Mar-98"))) {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 12;
						} else {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 10;
						}
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ pfstaturoty
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "'))  where region='North-East Region' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}

				// this.addFinancialDataRecord(bean);

				log
						.info("FinaceDAO :readXLSFinalcialDataNERegion() end method========= count"
								+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataCHQIADChennaiRegion(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataCHQIADChennaiRegion() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		PensionDAO PensionDao = new PensionDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String whetherOption = "", month = "", year = "", fullMonthYear = "", whetherOptionA = "", whetherOptionB = "";
			String employeeName = "";
			String pensionNumber = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(commonUtil
							.validateEmployeeName(tempInfo[0].toCharArray()));
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(commonUtil
							.validateEmployeeName(tempInfo[1].trim()
									.toCharArray()));
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					empName = commonUtil.replaceAllWords2(empName, " .", "");
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}

				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setBasic(tempInfo[9].trim());
				} else {
					bean.setBasic("0.00");
				}

				/*
				 * log.info("basic " + basic ); String emoluments =
				 * String.valueOf(bean.getBasic()); log.info("emoluments " +
				 * emoluments);
				 */
				bean.setEmoluments(bean.getBasic());
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[10].trim());
				} else
					bean.setEmpPfStatuary("0.00");

				if (!tempInfo[16].equals("XXX")) {
					bean.setCpfArriers(tempInfo[16].trim());
				} else {
					bean.setCpfArriers("0.00");
				}

				bean.setEmpPfStatuary(String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getCpfArriers())));
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmpVpf(tempInfo[11].trim());
				} else
					bean.setEmpVpf("0.00");

				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else
					bean.setPrincipal("0.00");
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setAdvanceDrawn(tempInfo[14].trim());
				} else {
					bean.setAdvanceDrawn("0.00");
				}

				if (!tempInfo[15].equals("XXX")) {
					bean.setPartFinal(tempInfo[15].trim());
				} else {
					bean.setPartFinal("0.00");
				}

				if (!tempInfo[4].equals("XXX")) {
					whetherOption = tempInfo[4].toString();
				} else {
					whetherOption = "";
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setDateofBirth(tempInfo[5].toString());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDateofJoining(tempInfo[6].toString());
				} else {
					bean.setDateofJoining("");
				}
				if (!tempInfo[7].equals("XXX")) {
					month = tempInfo[7].toString().trim();
				} else {
					month = "";
				}
				if (!tempInfo[8].equals("XXX")) {
					year = tempInfo[8].toString().trim();
				} else {
					year = "";
				}
				if (!year.equals("") && !month.equals("")) {
					fullMonthYear = "01-" + month + "-" + year;
					fullMonthYear = commonUtil.converDBToAppFormat(
							fullMonthYear, "dd-MM-yyyy", "dd-MMM-yyyy");
					bean.setMonthYear(fullMonthYear);
				}
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				bean.setAirportCode("CHENNAI IAD");

				if (!bean.getDateofBirth().equals("")
						&& !bean.getCpfAccNo().equals("")) {
					pensionNumber = commonDAO.getPensionNumber(bean
							.getEmployeeName().trim(), bean.getDateofBirth(),
							bean.getCpfAccNo(), "CHQIAD");
				} else {
					pensionNumber = "";
				}

				log
						.info("==========================Final Parameters Chennai IAD==========================================================");
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,pensionnumber,airportCode, employeeno,employeeName,desegnation,region,dateofbirth,dateofJoining,WETHEROPTION) VALUES "
							+ "(?,?,?,?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, pensionNumber.trim());
					pst.setString(3, "CHENNAI IAD".trim());
					pst.setString(4, bean.getEmployeeNewNo().trim());
					pst.setString(5, bean.getEmployeeName().trim());
					pst.setString(6, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(7, "CHQIAD");
					pst.setString(8, bean.getDateofBirth().trim());
					pst.setString(9, bean.getDateofJoining().trim());
					pst.setString(10, whetherOption);

					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,advance,PARTFINAL,employeeno,DESEGNATION,remarks,region,CPFARREAR)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "CHENNAI IAD");
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getPrincipal());
					pst.setString(12, bean.getInterest());
					pst.setString(13, bean.getAdvanceDrawn());
					pst.setString(14, bean.getPartFinal());
					pst.setString(15, bean.getEmployeeNewNo());
					pst.setString(16, bean.getDesignation());
					pst.setString(17, bean.getRemarks());
					pst.setString(18, "CHQIAD");
					pst.setString(19, bean.getCpfArriers());
					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yy", "-MMM-yy");
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.0")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";

					} else {
						DateFormat df = new SimpleDateFormat("dd-MMM-yy");

						Date transdate = df.parse(bean.getMonthYear());
						float pfstaturoty = 0;
						if (transdate.after(new Date("31-Mar-98"))) {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 12;
						} else {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 10;
						}
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ pfstaturoty
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataCHQIADChennaiRegion() end method "
								+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataCHQIADKolProjRegion(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataCHQIADRegion() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		String empName = "", tempName = "";
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					empName = tempInfo[3];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}

				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				String emoluments = String.valueOf(bean.getBasic());
				bean.setEmoluments(emoluments);
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[7].trim());
				} else
					bean.setEmpPfStatuary("0.00");
				if (!tempInfo[8].equals("XXX")) {
					bean.setEmpVpf(tempInfo[8].trim());
				} else
					bean.setEmpVpf("0.00");
				if (!tempInfo[9].equals("XXX")) {
					bean.setPrincipal(tempInfo[9].trim());
				} else
					bean.setPrincipal("0.00");

				if (!tempInfo[10].equals("XXX")) {
					bean.setInterest(tempInfo[10].trim());
				} else {
					bean.setInterest("0.00");

				}
				String advance = "", nonrefMem = "", nonrefCom = "", partFinal = "", pensionNumber = "", empTotal = "";
				if (!tempInfo[11].equals("XXX")) {
					advance = tempInfo[11];
				} else {
					advance = "0.00";
				}

				if (!tempInfo[12].equals("XXX")) {
					nonrefMem = tempInfo[12];
				} else {
					nonrefMem = "0.00";
				}
				if (!tempInfo[13].equals("XXX")) {
					nonrefCom = tempInfo[13];
				} else {
					nonrefCom = "0.00";
				}

				partFinal = String.valueOf(Float.parseFloat(nonrefMem)
						+ Float.parseFloat(nonrefCom));
				bean.setPartFinal(partFinal);

				if (!tempInfo[15].equals("XXX")) {
					bean.setDateofBirth(tempInfo[15].toString());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setPensionNumber(commonUtil
							.getSearchPFID1(tempInfo[5]).trim());
				}
				log.info("pension number is " + bean.getPensionNumber());
				if (!tempInfo[16].equals("XXX")) {
					bean.setDateofJoining(tempInfo[16].toString());
				} else {
					bean.setDateofJoining("");
				}
				empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth"
						+ bean.getDateofBirth() + " dateofjoin "
						+ bean.getDateofJoining());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,dateofbirth,dateofJoining,pensionnumber) VALUES "
							+ "(?,?,?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "KOLKATA PROJ".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					// for southern region Data
					pst.setString(6, "CHQIAD");
					pst.setString(7, bean.getDateofBirth());
					pst.setString(8, bean.getDateofJoining());
					pst.setString(9, bean.getPensionNumber());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,advance,nonrefMem,nonrefCom,PARTFINAL,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region
				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "KOLKATA PROJ");
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getPrincipal());
					pst.setString(12, bean.getInterest());
					pst.setString(13, advance);
					pst.setString(14, nonrefMem);
					pst.setString(15, nonrefCom);
					pst.setString(16, bean.getPartFinal());
					pst.setString(17, bean.getEmployeeNewNo());
					pst.setString(18, bean.getDesignation());
					pst.setString(19, bean.getRemarks());
					pst.setString(20, "CHQIAD");

					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				log
						.info("FinaceDAO :readXLSFinalcialDataCHQIADRegion() end method========= count"
								+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataCHQIADKolRegion(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataCHQIADKolRegion() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "", basic = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();

					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}

				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				String emoluments = String.valueOf(bean.getBasic());
				bean.setEmoluments(emoluments);
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[7].trim());
				} else
					bean.setEmpPfStatuary("0.00");
				if (!tempInfo[12].equals("XXX")) {
					bean.setDateofBirth(tempInfo[12].toString());
				} else {
					bean.setDateofBirth("");
				}
				String pensionNumber = "";
				if (!bean.getDateofBirth().equals("")) {
					pensionNumber = commonDAO.getPensionNumber(bean
							.getEmployeeName().toUpperCase(), bean
							.getDateofBirth(), bean.getCpfAccNo(), "");
				} else
					pensionNumber = "";
				if (!tempInfo[13].equals("XXX")) {
					bean.setDateofJoining(tempInfo[13].toString());
				} else {
					bean.setDateofJoining("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setPensionOption(tempInfo[14].toString());
				} else {
					bean.setPensionOption("");
				}
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth"
						+ bean.getDateofBirth() + " dateofjoin "
						+ bean.getDateofJoining());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,PENSIONNUMBER,region,dateofbirth,dateofJoining,WETHEROPTION) VALUES "
							+ "(?,?,?,?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "KOLKATA".trim());
					pst.setString(3, bean.getEmployeeNewNo());
					pst.setString(4, bean.getEmployeeName());
					pst.setString(5, bean.getDesignation());
					pst.setString(6, pensionNumber);

					// for southern region Data
					pst.setString(7, "CHQIAD");
					pst.setString(8, bean.getDateofBirth());
					pst.setString(9, bean.getDateofJoining());
					pst.setString(10, bean.getPensionOption());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "KOLKATA");
					pst.setString(8, bean.getMonthYear());
					pst.setString(9, bean.getEmployeeName());
					pst.setString(10, bean.getBasic());
					pst.setString(11, bean.getEmployeeNewNo());
					pst.setString(12, bean.getDesignation());
					pst.setString(13, bean.getRemarks());
					pst.setString(14, "CHQIAD");

					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					st = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yy", "-MMM-yy");
					if (!bean.getBasic().equals("0.00")
							&& !bean.getBasic().equals("0.0")
							&& !bean.getBasic().equals("0")
							&& !bean.getBasic().equals("")) {
						insertArrearCount = "update employee_pension_validate set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getEmoluments()
								+ "')), emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";

					} else {
						DateFormat df = new SimpleDateFormat("dd-MMM-yy");

						Date transdate = df.parse(bean.getMonthYear());
						float pfstaturoty = 0;
						if (transdate.after(new Date("31-Mar-98"))) {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 12;
						} else {
							pfstaturoty = Float.parseFloat(bean
									.getEmpPfStatuary().trim()) * 100 / 10;
						}
						insertArrearCount = "update employee_pension_validate  set basic=to_char(TO_NUMBER(nvl(basic,0)+'"
								+ bean.getEmoluments()
								+ "')), emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ pfstaturoty
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear + "'";
					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}

			}

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataAmritsarIADCPF(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataAmritsarIADCPF() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {

				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {

					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}

				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				String emoluments = String.valueOf(bean.getBasic());
				bean.setEmoluments(emoluments);
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[7].trim());
				} else
					bean.setEmpPfStatuary("0.00");
				if (!tempInfo[8].equals("XXX")) {
					bean.setEmpVpf(tempInfo[8].trim());
				} else
					bean.setEmpVpf("0.00");

				if (!tempInfo[9].equals("XXX")) {
					bean.setPrincipal(tempInfo[9].trim());
				} else
					bean.setPrincipal("0.00");
				if (!tempInfo[10].equals("XXX")) {
					bean.setInterest(tempInfo[10].trim());
				} else
					bean.setInterest("0.00");
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				DateValidation dateValidation = new DateValidation();
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2].toString());
				} else {
					bean.setMonthYear("");
				}
				log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth"
						+ bean.getDateofBirth() + " dateofjoin "
						+ bean.getDateofJoining());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "AmritsarIAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "AmritsarIAD".trim());
					pst.setString(8, bean.getMonthYear().trim());
					pst.setString(9, bean.getEmployeeName().trim());
					pst.setString(10, bean.getBasic().trim());
					pst.setString(11, bean.getPrincipal().trim());
					pst.setString(12, bean.getInterest().trim());
					pst.setString(13, bean.getEmployeeNewNo().trim());
					pst.setString(14, bean.getDesignation().trim());
					pst.setString(15, bean.getRemarks().trim());
					pst.setString(16, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log.info("FinaceDAO :readXLSFinalcialDataAmritsarIADCPF count"
						+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialIGICargoIADCPF(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialIGICargoIADCPF() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {

				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					monthYear = commonUtil.converDBToAppFormat(tempInfo[2]
							.trim(), "yyyyMM", "dd-MMM-yyyy");
					bean.setMonthYear(monthYear);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}
				String vda = "", fda = "";
				if (!tempInfo[9].equals("XXX")) {
					vda = tempInfo[9].trim();
				} else {
					vda = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					fda = tempInfo[10].trim();
				} else {
					fda = "0.00";
				}
				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic())
						+ Float.parseFloat(vda) + Float.parseFloat(fda));
				bean.setEmoluments(emoluments);

				if (!tempInfo[11].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[11].trim());
				} else
					bean.setEmpPfStatuary("0.00");

				if (!tempInfo[12].equals("XXX")) {
					bean.setEmpVpf(tempInfo[12].trim());
				} else
					bean.setEmpVpf("0.00");

				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].trim());
				} else
					bean.setPrincipal("0.00");

				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].trim());
				} else
					bean.setInterest("0.00");
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				log.info("vpf" + bean.getEmpVpf() + "principle "
						+ bean.getPrincipal() + "interest "
						+ bean.getInterest() + "pfstatutory"
						+ bean.getEmpPfStatuary());
				log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth"
						+ bean.getDateofBirth() + " dateofjoin "
						+ bean.getDateofJoining() + "empToal "
						+ bean.getEmpTotal());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "IGICargo IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,vda,fda,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "IGICargo IAD".trim());
					pst.setString(8, bean.getMonthYear().trim());
					pst.setString(9, bean.getEmployeeName().trim());
					pst.setString(10, bean.getBasic().trim());
					pst.setString(11, vda.trim());
					pst.setString(12, fda.trim());

					pst.setString(13, bean.getPrincipal().trim());
					pst.setString(14, bean.getInterest().trim());
					pst.setString(15, bean.getEmployeeNewNo().trim());
					pst.setString(16, bean.getDesignation().trim());
					pst.setString(17, bean.getRemarks().trim());
					pst.setString(18, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialIGICargoIADCPF leaving method ");
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataCSIAIAD(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataCSIAIAD() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setMonthYear(tempInfo[2]);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[6].trim());
				} else
					bean.setEmpPfStatuary("0.00");
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmoluments(tempInfo[7].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setPensionOption(tempInfo[8].trim());
				} else
					bean.setPensionOption("");

				log.info("cpfaccno " + bean.getCpfAccNo());
				// for Northern Region checking cpfaccno instead employeename
				// employeeName = commonDAO.checkEmployeeInfo(con,
				// bean.getEmployeeNewNo(), bean.getCpfAccNo(),
				// bean.getEmployeeName());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,WETHEROPTION) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "CSIA IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.setString(7, bean.getPensionOption().trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region)"
						+ " values(?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, "CSIA IAD".trim());
					pst.setString(5, bean.getMonthYear().trim());
					pst.setString(6, bean.getEmployeeName().trim());
					pst.setString(7, bean.getEmployeeNewNo().trim());
					pst.setString(8, bean.getDesignation().trim());
					pst.setString(9, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataCSIAIAD count"
								+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataDPOIAD(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataDPOIAD() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					monthYear = commonUtil.converDBToAppFormat(tempInfo[2]
							.trim(), "yyyyMM", "dd-MMM-yyyy");
					bean.setMonthYear(monthYear);
				} else {
					bean.setMonthYear("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else
					bean.setBasic("0.00");

				String pPay = "";
				if (!tempInfo[7].equals("XXX")) {
					pPay = tempInfo[7].trim();
				} else {
					pPay = "0.00";
				}
				String sPay = "";
				if (!tempInfo[8].equals("XXX")) {
					sPay = tempInfo[8].trim();
				} else
					sPay = "0.00";

				String vda = "";
				if (!tempInfo[9].equals("XXX")) {
					vda = tempInfo[9].trim();
				} else
					vda = "0.00";
				String fda = "";
				if (!tempInfo[10].equals("XXX")) {
					fda = tempInfo[10].trim();
				} else
					fda = "0.00";
				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic())
						+ Float.parseFloat(vda)
						+ Float.parseFloat(fda)
						+ Float.parseFloat(sPay) + Float.parseFloat(pPay));
				bean.setEmoluments(emoluments);

				log.info("Emoluments " + bean.getEmoluments());
				String cpf = "";
				if (!tempInfo[11].equals("XXX")) {
					cpf = tempInfo[11].trim();
					bean.setEmpPfStatuary(cpf);
				} else
					bean.setEmpPfStatuary("0.00");

				if (!tempInfo[12].equals("XXX")) {
					bean.setEmpVpf(tempInfo[12].trim());
				} else
					bean.setEmpVpf("0.00");
				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].trim());
				} else
					bean.setPrincipal("0.00");
				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].trim());
				} else
					bean.setInterest("0.00");

				// TOTAL=PFSTATUTARY+VPF+CPF ADV RECOVERY(O)+INTEREST
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				log.info("emp total " + bean.getEmpTotal());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "DPO IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					pst.setString(6, "CHQIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,vda,fda,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,dnspay,spay,employeeno,DESEGNATION,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region
				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, "DPO IAD".trim());
					pst.setString(5, bean.getMonthYear().trim());
					pst.setString(6, bean.getEmployeeName().trim());
					pst.setString(7, bean.getBasic().trim());
					pst.setString(8, vda.trim());
					pst.setString(9, fda.trim());
					pst.setString(10, bean.getPrincipal().trim());
					pst.setString(11, bean.getInterest().trim());
					pst.setString(12, pPay.trim());
					pst.setString(13, sPay.trim());
					pst.setString(14, bean.getEmployeeNewNo().trim());
					pst.setString(15, bean.getDesignation().trim());
					pst.setString(16, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log.info("FinaceDAO :readXLSFinalcialDataDPOIAD count" + count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataCAPIAD(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataCAPIAD() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[2].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				String month = "";
				if (!tempInfo[4].equals("XXX")) {
					month = tempInfo[4].toString().trim();
				} else {
					month = "";
				}
				String year = "";
				if (!tempInfo[5].equals("XXX")) {
					year = tempInfo[5].toString().trim();
				} else {
					year = "";
				}
				String fullMonthYear = "";
				if (!year.equals("") && !month.equals("")) {
					fullMonthYear = "01-" + month + "-" + year;
					fullMonthYear = commonUtil.converDBToAppFormat(
							fullMonthYear, "dd-MM-yyyy", "dd-MMM-yyyy");
					bean.setMonthYear(fullMonthYear);
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}

				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesignation(tempInfo[3]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setEmoluments(tempInfo[6].trim());
				} else
					bean.setEmoluments("0.00");
				log.info("Emoluments " + bean.getEmoluments());
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[7].trim());
				} else {
					bean.setEmpPfStatuary("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setEmpVpf(tempInfo[8].trim());
				} else
					bean.setEmpVpf("0.00");
				if (!tempInfo[9].equals("XXX")) {
					bean.setCpfArriers(tempInfo[9].trim());
				} else
					bean.setCpfArriers("0.00");
				if (!tempInfo[10].equals("XXX")) {
					bean.setPrincipal(tempInfo[10].trim());
				} else
					bean.setPrincipal("0.00");
				if (!tempInfo[11].equals("XXX")) {
					bean.setInterest(tempInfo[11].trim());
				} else
					bean.setInterest("0.00");
				if (!tempInfo[12].equals("XXX")) {
					bean.setPensionOption(tempInfo[12].trim());
				} else
					bean.setPensionOption("");
				if (!tempInfo[13].equals("XXX")) {
					bean.setDateofBirth(tempInfo[13].trim());
				} else
					bean.setDateofBirth("");
				if (!tempInfo[14].equals("XXX")) {
					bean.setDateofJoining(tempInfo[14].trim());
				} else
					bean.setDateofJoining("");
				log.info("pensionOption " + bean.getPensionOption() + "dob "
						+ bean.getDateofBirth() + "doj"
						+ bean.getDateofJoining());
				// TOTAL=PFSTATUTARY+VPF+CPF ADV RECOVERY(O)+INTEREST
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				log.info("emp total " + bean.getEmpTotal());

				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo().trim(), bean.getCpfAccNo().trim(),
						bean.getEmployeeName().trim(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String pensionNumber = "";
					if (bean.getDateofBirth() != "") {
						pensionNumber = commonDAO.getPensionNumberError(bean
								.getEmployeeName().trim(), bean
								.getDateofBirth().trim(), bean.getCpfAccNo()
								.trim(), "");
						pensionNumber = commonDAO.checkPensionNumber(
								pensionNumber, bean.getCpfAccNo().trim(), bean
										.getEmployeeNewNo(), bean
										.getEmployeeName().trim(), "CHQIAD",
								bean.getDateofBirth().trim());
					}
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,WETHEROPTION,dateofbirth,dateofjoining,pensionnumber) VALUES "
							+ "(?,?,?,?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "CAP IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					pst.setString(6, "CHQIAD".trim());
					pst.setString(7, bean.getPensionOption());
					pst.setString(8, bean.getDateofBirth());
					pst.setString(9, bean.getDateofJoining());
					pst.setString(10, pensionNumber);
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,CPFARREAR,employeeno,DESEGNATION,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?)";
				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, "CAP IAD".trim());
					pst.setString(5, bean.getMonthYear().trim());
					pst.setString(6, bean.getEmployeeName().trim());
					pst.setString(7, bean.getPrincipal().trim());
					pst.setString(8, bean.getInterest().trim());
					pst.setString(9, bean.getCpfArriers());
					pst.setString(10, bean.getEmployeeNewNo().trim());
					pst.setString(11, bean.getDesignation().trim());
					pst.setString(12, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log.info("FinaceDAO :readXLSFinalcialDataCAPIAD count" + count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataVOTVIAD(String xlsData)
			throws InvalidDataException {
		log.info("FinaceDAO :readXLSFinalcialDataVOTVIAD() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {

				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[2].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					String empName = tempInfo[2];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				// Emoluments=Pay(G)
				// PFSTATUTARY=CPFDED(H)
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmoluments(tempInfo[7].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				log.info("Emoluments " + bean.getEmoluments());
				if (!tempInfo[8].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[8].trim());
				} else
					bean.setEmpPfStatuary("0.00");
				String month = "";
				if (!tempInfo[4].equals("XXX")) {
					month = tempInfo[4].toString().trim();
				} else {
					month = "";
				}
				String year = "";
				if (!tempInfo[5].equals("XXX")) {
					year = tempInfo[5].toString().trim();
				} else {
					year = "";
				}
				String fullMonthYear = "";
				if (!year.equals("") && !month.equals("")) {
					fullMonthYear = "01-" + month + "-" + year;
					fullMonthYear = commonUtil.converDBToAppFormat(
							fullMonthYear, "dd-MM-yyyy", "dd-MMM-yyyy");
					bean.setMonthYear(fullMonthYear);
				}
				log.info("year  " + bean.getMonthYear());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,region) VALUES "
							+ "(?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "TRIVANDRUM IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, "CHQIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,region)"
						+ " values(?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region
				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, "TRIVANDRUM IAD".trim());
					pst.setString(5, bean.getMonthYear().trim());
					pst.setString(6, bean.getEmployeeName().trim());
					pst.setString(7, bean.getEmployeeNewNo().trim());
					pst.setString(8, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataVOTVIAD count"
								+ count);
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}

	}

	/*
	 * For IGI IAD 2002-2009
	 */

	public void readXLSFinalcialIGIIADCPF(String xlsData) throws Exception {
		log.info("FinaceDAO :readXLSFinalcialIGIIADCPF() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					monthYear = commonUtil.converDBToAppFormat(tempInfo[2]
							.trim(), "yyMM", "dd-MMM-yyyy");
					bean.setMonthYear(monthYear);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}

				log.info("emp name " + bean.getEmployeeName());

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}

				String dnspay = "";
				if (!tempInfo[7].equals("XXX")) {
					dnspay = tempInfo[7].trim();
				} else {
					dnspay = "0.00";
				}

				String spay = "";
				if (!tempInfo[8].equals("XXX")) {
					spay = tempInfo[8].trim();
				} else {
					spay = "0.00";
				}

				String vda = "";
				if (!tempInfo[9].equals("XXX")) {
					vda = tempInfo[9].trim();
				} else {
					vda = "0.00";
				}

				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic())
						+ Float.parseFloat(dnspay)
						+ Float.parseFloat(spay)
						+ Float.parseFloat(vda));
				log.info("emoluments  " + emoluments);
				bean.setEmoluments(emoluments);

				if (!tempInfo[10].equals("XXX")) {
					bean.setEmpPfStatuary(tempInfo[10].trim());
				} else
					bean.setEmpPfStatuary("0.00");

				if (!tempInfo[11].equals("XXX")) {
					bean.setEmpVpf(tempInfo[11].trim());
				} else
					bean.setEmpVpf("0.00");

				if (!tempInfo[12].equals("XXX")) {
					bean.setPfAdvance(tempInfo[12].trim());
				} else
					bean.setPfAdvance("0.00");

				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else
					bean.setInterest("0.00");
				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPfAdvance())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				if (!tempInfo[5].equals("XXX")) {
					bean.setAirportCode(tempInfo[5].trim());
				} else {
					bean.setAirportCode("");
				}
				log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth"
						+ bean.getDateofBirth() + " dateofjoin "
						+ bean.getDateofJoining() + "empToal "
						+ bean.getEmpTotal());
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "IGI IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,dnspay,spay,vda,advance,EMPADVRECINTEREST,employeeno,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "IGI IAD".trim());
					pst.setString(8, bean.getMonthYear().trim());
					pst.setString(9, bean.getEmployeeName().trim());
					pst.setString(10, bean.getBasic().trim());
					pst.setString(11, dnspay.trim());
					pst.setString(12, spay.trim());
					pst.setString(13, vda.trim());
					pst.setString(14, bean.getPfAdvance().trim());
					pst.setString(15, bean.getInterest().trim());
					pst.setString(16, bean.getEmployeeNewNo().trim());
					pst.setString(17, bean.getRemarks().trim());
					pst.setString(18, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialIGIIADCPF leaving method ");
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			con.close();
		}
	}

	public void readXLSFinalcialIGIIADCPF1995to2000(String xlsData,
			String username, String computername) throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialIGIIADCPF1995to2000() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}

		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			st = con.createStatement();
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					// monthYear =
					// commonUtil.converDBToAppFormat(tempInfo[3].trim(),
					// "yyMM", "dd-MMM-yyyy");
					bean.setMonthYear(tempInfo[2].trim());
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}

				log.info("emp name " + bean.getEmployeeName());

				if (!tempInfo[4].equals("XXX")) {
					bean.setBasic(tempInfo[4].trim());
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[5].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setPrincipal(tempInfo[8].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setInterest(tempInfo[9].trim());
				} else {
					bean.setInterest("0.00");
				}
				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic()));
				bean.setEmoluments(emoluments);

				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");

				Date transdate = df.parse(bean.getMonthYear());
				float cpfarrear = 0;
				if (transdate.after(new Date("31-Mar-1998"))) {
					bean.setEmpPfStatuary(String.valueOf(Float.parseFloat(bean
							.getEmoluments()) * 12 / 100));
				} else {
					bean.setEmpPfStatuary(String.valueOf(Float.parseFloat(bean
							.getEmoluments()) * 10 / 100));
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmpVpf(tempInfo[7].trim());
				} else
					bean.setEmpVpf("0.00");

				String empTotal = String.valueOf(Float.parseFloat(bean
						.getEmpPfStatuary())
						+ Float.parseFloat(bean.getEmpVpf())
						+ Float.parseFloat(bean.getPrincipal())
						+ Float.parseFloat(bean.getInterest()));
				bean.setEmpTotal(empTotal.trim());
				bean.setAaiTotal(bean.getEmpTotal());
				log.info("aaiTotal " + bean.getAaiTotal());
				double pensioncontri = 0.00, pf = 0.00;
				if (!bean.getCpfAccNo().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption from employee_info where cpfacno='"
							+ bean.getCpfAccNo() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);
					/*
					 * while(rs.next()){ if
					 * (!rs.getString("wetheroption").equals(null)&&
					 * rs.getString("wetheroption").trim()!="") {
					 * log.info("wether option " +rs.getString("wetheroption"));
					 * bean.setPensionOption(rs.getString("wetheroption")); } }
					 */

					pensioncontri = commonDAO.pensionCalculation(
							bean.getMonthYear(), bean.getEmoluments(), bean
									.getPensionOption(), bean.getRegion(), "");
					log.info("pensioncontri... " + pensioncontri);
					log.info("pf " + bean.getEmpPfStatuary().toString());
					pf = Double.parseDouble(bean.getEmpPfStatuary().toString())
							- pensioncontri;

				}
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "IGI IAD".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.setString(7, "new records from IGIIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,empvpf,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,employeeno,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				// two perameters added for southern region for checking
				// duplicate record i.e employeeno, region

				String foundSalaryDate = this.checkFinanceDuplicate(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "CHQIAD");
				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, bean.getEmpTotal().trim());
					pst.setString(6, bean.getAaiTotal().trim());
					pst.setString(7, "IGI IAD".trim());
					pst.setString(8, bean.getMonthYear().trim());
					pst.setString(9, bean.getEmployeeName().trim());
					pst.setString(10, bean.getBasic().trim());
					pst.setString(11, bean.getPrincipal().trim());
					pst.setString(12, bean.getInterest().trim());
					pst.setString(13, bean.getEmployeeNewNo().trim());
					pst.setString(14, bean.getRemarks().trim());
					pst.setString(15, "CHQIAD".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					Statement st1 = con.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					log.info("month year " + bean.getMonthYear());
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getMonthYear().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					if (!bean.getEmpVpf().equals("0.00")) {
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ bean.getEmoluments()
								+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmpPfStatuary().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmpVpf().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAccNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";
						log.info("update emolumentss " + insertArrearCount);
						count = st.executeUpdate(insertArrearCount);

					}
					st1.close();
				}

				log
						.info("FinaceDAO :readXLSFinalcialIGIIADCPF1995to2000 leaving method ");
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataRAUSAP(String xlsData) throws Exception {
		log.info("FinaceDAO :readXLSFinalcialDataRAUSAP() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					monthYear = commonUtil.converDBToAppFormat(tempInfo[2]
							.trim(), "MM/yy", "dd-MMM-yyyy");
					bean.setMonthYear(monthYear);
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}

				/*
				 * String cpfCount = ""; if (!tempInfo[8].equals("XXX")) {
				 * cpfCount = tempInfo[8].trim(); } else { cpfCount = "0.00"; }
				 * 
				 * String cpfArriers = ""; if (!tempInfo[9].equals("XXX")) {
				 * bean.setCpfArriers(tempInfo[9].trim()); } else {
				 * bean.setCpfArriers("0.00"); } log.info("basic " +
				 * bean.getBasic());
				 * 
				 * 
				 * if (!tempInfo[10].equals("XXX")) {
				 * bean.setPfAdvance(tempInfo[10].trim()); } else
				 * bean.setPfAdvance("0.00");
				 * 
				 * String pfwPaid = ""; if (!tempInfo[10].equals("XXX")) {
				 * pfwPaid=tempInfo[10].trim(); } else{ pfwPaid="0.00"; }
				 * 
				 * String advanceRecovery = ""; if (!tempInfo[11].equals("XXX"))
				 * { advanceRecovery=tempInfo[11].trim(); } else{
				 * advanceRecovery="0.00"; }
				 * 
				 * if (!tempInfo[12].equals("XXX")) {
				 * bean.setRemarks(tempInfo[12].trim()); } else {
				 * bean.setRemarks(""); }
				 * 
				 * String emoluments =
				 * String.valueOf(((Float.parseFloat(cpfCount)+
				 * Float.parseFloat(bean.getCpfArriers()))100)/12);
				 * 
				 * log.info("emoluments " + emoluments);
				 * bean.setEmoluments(emoluments);
				 * 
				 * String pfStatuary=String.valueOf(Float.parseFloat(cpfCount)+
				 * Float.parseFloat(bean.getCpfArriers()));
				 * 
				 * log.info("pfStatuary " + pfStatuary);
				 * bean.setEmpPfStatuary(pfStatuary); String empTotal =
				 * String.valueOf(Float.parseFloat(cpfCount) +
				 * Float.parseFloat(bean.getCpfArriers()) +
				 * Float.parseFloat(advanceRecovery) -
				 * Float.parseFloat(bean.getPfAdvance()));
				 * bean.setEmpTotal(empTotal.trim());
				 * bean.setAaiTotal(bean.getEmpTotal());
				 * 
				 * log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth" +
				 * bean.getDateofBirth() + " dateofjoin " +
				 * bean.getDateofJoining() + "empToal " + bean.getEmpTotal());
				 */

				// logic from 01-07
				String cpf = "";
				if (!tempInfo[7].equals("XXX")) {
					cpf = tempInfo[7].trim();
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setCpfArriers(tempInfo[8].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				String emoluments = String
						.valueOf(((Float.parseFloat(cpf) + Float
								.parseFloat(bean.getCpfArriers())) * 100) / 12);
				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(bean.getCpfArriers()));
				log.info("emoluments  " + emoluments);
				log.info("pfStatuary  " + pfStatuary);
				bean.setEmpPfStatuary(pfStatuary);
				// update emoulements done on 8th Apr09(added update method
				// below)
				bean.setEmoluments(emoluments);

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmpVpf(tempInfo[9].trim());
				} else {
					bean.setEmpVpf("0.00");
				}
				String cpfadv = "";
				if (!tempInfo[10].equals("XXX")) {
					cpfadv = tempInfo[10].trim();
				} else {
					cpfadv = "0.00";
				}

				if (!tempInfo[11].equals("XXX")) {
					bean.setAdvanceDrawn(tempInfo[11].trim());
				} else {
					bean.setAdvanceDrawn("0.00");
				}
				String partAdv = "";
				if (!tempInfo[12].equals("XXX")) {
					partAdv = tempInfo[12].trim();
				} else {
					partAdv = "0.00";
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setRemarks(tempInfo[13].trim());
				} else {
					bean.setRemarks("");
				}

				String cpfacno = this.getCpfAccnoDetails(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "RAUSAP");
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "RAUSAP");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "RAUSAP".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "RAUSAP".trim());
					pst.executeUpdate();
					pst.close();
				}

				// logic from 95 -01
				/*
				 * String finaceInsert = "insert into
				 * employee_pension_validate(cpfaccno
				 * ,emoluments,emppfstatuary,emptotal,aaitotal,AIRPORTCODE," +
				 * "MONTHYEAR,employeeName,BASIC,PFCOUNT,CPFARREAR,ADVANCE,REFADV,employeeno,DESEGNATION,remarks,region)"
				 * + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				 * 
				 * log.info(" employeeName" + employeeName + "Designation" +
				 * bean.getDesignation() + "CpfAccNo" +
				 * bean.getCpfAccNo().trim()); // two perameters added for
				 * southern region for checking // duplicate record i.e
				 * employeeno, region
				 * 
				 * String foundSalaryDate =
				 * this.checkFinanceDuplicateRAUSAP(con, bean
				 * .getMonthYear().trim(), bean.getCpfAccNo(), bean
				 * .getEmployeeNewNo(), "RAUSAP","");
				 * 
				 * if (foundSalaryDate.equals("")) { pst =
				 * con.prepareStatement(finaceInsert); pst.setString(1,
				 * bean.getCpfAccNo().trim()); pst.setString(2,
				 * bean.getEmoluments().trim()); pst.setString(3,
				 * bean.getEmpPfStatuary().trim()); pst.setString(4,
				 * bean.getEmpTotal().trim()); pst.setString(5,
				 * bean.getAaiTotal().trim()); pst.setString(6,
				 * "RAUSAP".trim()); pst.setString(7,
				 * bean.getMonthYear().trim()); pst.setString(8,
				 * bean.getEmployeeName().trim()); pst.setString(9,
				 * bean.getBasic().trim()); pst.setString(10, cpfCount.trim());
				 * pst.setString(11,bean.getCpfArriers().trim());
				 * pst.setString(12, bean.getPfAdvance().trim());
				 * pst.setString(13, advanceRecovery.trim()); pst.setString(14,
				 * bean.getEmployeeNewNo().trim()); pst.setString(15,
				 * bean.getDesignation().trim()); pst.setString(16,
				 * bean.getRemarks().trim()); pst.setString(17,
				 * "RAUSAP".trim()); count = pst.executeUpdate(); count++;
				 * pst.close(); }
				 */

				// logic from 01-08
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,EMPVPF,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,CPFARREAR,REFADV,ADVANCE,pfw,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				String foundSalaryDate = this.checkFinanceDuplicateRAUSAP(con,
						bean.getMonthYear().trim(), cpfacno.trim(), bean
								.getEmployeeNewNo(), "RAUSAP", "");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, cpfacno.trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "RAUSAP".trim());
					pst.setString(6, bean.getMonthYear().trim());
					pst.setString(7, bean.getEmployeeName().trim());
					pst.setString(8, bean.getBasic().trim());
					pst.setString(9, cpf.trim());
					pst.setString(10, bean.getCpfArriers());
					pst.setString(11, cpfadv.trim());
					pst.setString(12, bean.getAdvanceDrawn());
					pst.setString(13, partAdv.trim());
					pst.setString(14, bean.getEmployeeNewNo().trim());
					pst.setString(15, bean.getDesignation().trim());
					pst.setString(16, bean.getRemarks().trim());
					pst.setString(17, "RAUSAP".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					try {
						String finaceUpdate = "update employee_pension_validate set emoluments='"
								+ bean.getEmoluments()
								+ "'  where cpfaccno='"
								+ cpfacno.trim()
								+ "' and "
								+ "employeeno='"
								+ bean.getEmployeeNewNo()
								+ "' and monthyear='"
								+ bean.getMonthYear().trim()
								+ "' and region='RAUSAP'";
						log.info(" finaceUpdate Rausap " + finaceUpdate);
						st = con.createStatement();
						count = st.executeUpdate(finaceUpdate);
						count++;
						st.close();
					} catch (Exception e) {
						log.printStackTrace(e);
					}
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataRAUSAP Leaving Method");
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			con.close();
		}
	}

	public void readXLSFinalcialDataRAUSAPMissing(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataRAUSAPMissing() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					// monthYear =
					// commonUtil.converDBToAppFormat(tempInfo[2].trim(),
					// "MM/yy", "dd-MMM-yyyy");
					bean.setMonthYear(tempInfo[2].trim());
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0.00");
				}

				/*
				 * String cpfCount = ""; if (!tempInfo[8].equals("XXX")) {
				 * cpfCount = tempInfo[8].trim(); } else { cpfCount = "0.00"; }
				 * 
				 * String cpfArriers = ""; if (!tempInfo[9].equals("XXX")) {
				 * bean.setCpfArriers(tempInfo[9].trim()); } else {
				 * bean.setCpfArriers("0.00"); } log.info("basic " +
				 * bean.getBasic());
				 * 
				 * 
				 * if (!tempInfo[10].equals("XXX")) {
				 * bean.setPfAdvance(tempInfo[10].trim()); } else
				 * bean.setPfAdvance("0.00");
				 * 
				 * String pfwPaid = ""; if (!tempInfo[10].equals("XXX")) {
				 * pfwPaid=tempInfo[10].trim(); } else{ pfwPaid="0.00"; }
				 * 
				 * String advanceRecovery = ""; if (!tempInfo[11].equals("XXX"))
				 * { advanceRecovery=tempInfo[11].trim(); } else{
				 * advanceRecovery="0.00"; }
				 * 
				 * if (!tempInfo[12].equals("XXX")) {
				 * bean.setRemarks(tempInfo[12].trim()); } else {
				 * bean.setRemarks(""); }
				 * 
				 * String emoluments =
				 * String.valueOf(((Float.parseFloat(cpfCount)+
				 * Float.parseFloat(bean.getCpfArriers()))100)/12);
				 * 
				 * log.info("emoluments " + emoluments);
				 * bean.setEmoluments(emoluments);
				 * 
				 * String pfStatuary=String.valueOf(Float.parseFloat(cpfCount)+
				 * Float.parseFloat(bean.getCpfArriers()));
				 * 
				 * log.info("pfStatuary " + pfStatuary);
				 * bean.setEmpPfStatuary(pfStatuary); String empTotal =
				 * String.valueOf(Float.parseFloat(cpfCount) +
				 * Float.parseFloat(bean.getCpfArriers()) +
				 * Float.parseFloat(advanceRecovery) -
				 * Float.parseFloat(bean.getPfAdvance()));
				 * bean.setEmpTotal(empTotal.trim());
				 * bean.setAaiTotal(bean.getEmpTotal());
				 * 
				 * log.info("cpfaccno " + bean.getCpfAccNo() + "dateofbirth" +
				 * bean.getDateofBirth() + " dateofjoin " +
				 * bean.getDateofJoining() + "empToal " + bean.getEmpTotal());
				 */

				// logic from 01-07
				String cpf = "";
				if (!tempInfo[7].equals("XXX")) {
					cpf = tempInfo[7].trim();
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setCpfArriers(tempInfo[8].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				String emoluments = String
						.valueOf(((Float.parseFloat(cpf) + Float
								.parseFloat(bean.getCpfArriers())) * 100) / 10);
				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(bean.getCpfArriers()));
				log.info("emoluments  " + emoluments);
				log.info("pfStatuary  " + pfStatuary);
				bean.setEmpPfStatuary(pfStatuary);
				// update emoulements done on 8th Apr09(added update method
				// below)
				bean.setEmoluments(emoluments);

				/*
				 * if (!tempInfo[9].equals("XXX")) {
				 * bean.setEmpVpf(tempInfo[9].trim()); } else {
				 * bean.setEmpVpf("0.00"); } String cpfadv = ""; if
				 * (!tempInfo[10].equals("XXX")) { cpfadv = tempInfo[10].trim();
				 * } else { cpfadv = "0.00"; }
				 * 
				 * if (!tempInfo[11].equals("XXX")) {
				 * bean.setAdvanceDrawn(tempInfo[11].trim()); } else {
				 * bean.setAdvanceDrawn("0.00"); } String partAdv = ""; if
				 * (!tempInfo[12].equals("XXX")) { partAdv =
				 * tempInfo[12].trim(); } else { partAdv = "0.00"; } if
				 * (!tempInfo[13].equals("XXX")) {
				 * bean.setRemarks(tempInfo[13].trim()); } else {
				 * bean.setRemarks(""); }
				 */

				// String cpfacno = this.getCpfAccnoDetails(con,
				// bean.getMonthYear().trim(), bean.getCpfAccNo(),
				// bean.getEmployeeNewNo(), "RAUSAP");
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "RAUSAP");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "RAUSAP".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "RAUSAP".trim());
					pst.executeUpdate();
					pst.close();
				}

				// logic from 95 -01

				String finaceInsert = "insert into  employee_pension_validate(cpfaccno,emoluments,emppfstatuary,emptotal,aaitotal,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,cpf,CPFARREAR,employeeno,DESEGNATION,remarks,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim()); // two perameters added
				// for

				String foundSalaryDate = this.checkFinanceDuplicateRAUSAP(con,
						bean.getMonthYear().trim(), bean.getCpfAccNo(), bean
								.getEmployeeNewNo(), "RAUSAP", "");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpTotal().trim());
					pst.setString(5, bean.getAaiTotal().trim());
					pst.setString(6, "RAUSAP".trim());
					pst.setString(7, bean.getMonthYear().trim());
					pst.setString(8, bean.getEmployeeName().trim());
					pst.setString(9, bean.getBasic().trim());
					pst.setString(10, cpf.trim());
					pst.setString(11, bean.getCpfArriers().trim());
					pst.setString(12, bean.getEmployeeNewNo().trim());
					pst.setString(13, bean.getDesignation().trim());
					pst.setString(14, bean.getRemarks().trim());
					pst.setString(15, "RAUSAP".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}

				// logic from 01-08
				/*
				 * String finaceInsert = "insert into
				 * employee_pension_validate(cpfaccno
				 * ,emoluments,emppfstatuary,EMPVPF,AIRPORTCODE," +
				 * "MONTHYEAR,employeeName,BASIC,cpf,CPFARREAR,REFADV,ADVANCE,pfw,employeeno,DESEGNATION,remarks,region)"
				 * + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"; log.info("
				 * employeeName" + employeeName + "Designation" +
				 * bean.getDesignation() + "CpfAccNo" +
				 * bean.getCpfAccNo().trim()); String foundSalaryDate =
				 * this.checkFinanceDuplicateRAUSAP(con,
				 * bean.getMonthYear().trim(), cpfacno.trim(), bean
				 * .getEmployeeNewNo(), "RAUSAP", "");
				 * 
				 * if (foundSalaryDate.equals("")) { pst =
				 * con.prepareStatement(finaceInsert); pst.setString(1,
				 * cpfacno.trim()); pst.setString(2,
				 * bean.getEmoluments().trim()); pst.setString(3,
				 * bean.getEmpPfStatuary().trim()); pst.setString(4,
				 * bean.getEmpVpf().trim()); pst.setString(5, "RAUSAP".trim());
				 * pst.setString(6, bean.getMonthYear().trim());
				 * pst.setString(7, bean.getEmployeeName().trim());
				 * pst.setString(8, bean.getBasic().trim()); pst.setString(9,
				 * cpf.trim()); pst.setString(10, bean.getCpfArriers());
				 * pst.setString(11, cpfadv.trim()); pst.setString(12,
				 * bean.getAdvanceDrawn()); pst.setString(13, partAdv.trim());
				 * pst.setString(14, bean.getEmployeeNewNo().trim());
				 * pst.setString(15, bean.getDesignation().trim());
				 * pst.setString(16, bean.getRemarks().trim());
				 * pst.setString(17, "RAUSAP".trim()); count =
				 * pst.executeUpdate(); count++; pst.close(); } else { try {
				 * String finaceUpdate = "update employee_pension_validate set
				 * emoluments='" + bean.getEmoluments() + "' where cpfaccno='" +
				 * cpfacno.trim() + "' and " + "employeeno='" +
				 * bean.getEmployeeNewNo() + "' and monthyear='" +
				 * bean.getMonthYear().trim() + "' and region='RAUSAP'";
				 * log.info(" finaceUpdate Rausap " + finaceUpdate); st =
				 * con.createStatement(); count =
				 * st.executeUpdate(finaceUpdate); count++; st.close(); } catch
				 * (Exception e) { log.printStackTrace(e); } } log
				 * .info("FinaceDAO :readXLSFinalcialDataRAUSAP Leaving
				 * Method"); }
				 */
				finalcialDataList.add(bean);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataRAUSAP200708(String xlsData)
			throws Exception {
		log
				.info("FinaceDAO :readXLSFinalcialDataRAUSAP200708() entering method");
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {
				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("Employee Code" + tempInfo[0].toString().trim()
						+ "CPFACCNO" + tempInfo[1].toString().trim()
						+ "Employee Name" + tempInfo[3].toString().trim());

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					// monthYear =
					// commonUtil.converDBToAppFormat(tempInfo[2].trim(),
					// "MM/yy", "dd-MMM-yyyy");
					bean.setMonthYear(tempInfo[2].trim());
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {
					bean.setEmployeeName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					// log.info("getName " + bean.getEmployeeName());
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						log.info("tempName " + tempName);
						// tempName=empName.substring(index+1,empName.length());
						bean.setEmployeeName(tempName);
					}
				}
				log.info("emp name " + bean.getEmployeeName());
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}
				String payforCpf = "";
				if (!tempInfo[6].equals("XXX")) {
					payforCpf = tempInfo[6].trim();
				} else {
					payforCpf = "0.00";
				}
				String cpf = "";
				if (!tempInfo[7].equals("XXX")) {
					cpf = tempInfo[7].trim();
				} else {
					cpf = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setCpfArriers(tempInfo[8].trim());
				} else {
					bean.setCpfArriers("0.00");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmpVpf(tempInfo[9].trim());
				} else {
					bean.setEmpVpf("0.00");
				}
				log.info("vpf " + bean.getEmpVpf());
				String payArrear = "";
				if (!tempInfo[10].equals("XXX")) {
					payArrear = tempInfo[10].trim();
				} else {
					payArrear = "0.00";
				}
				String emoluments = String
						.valueOf((Float.parseFloat(payforCpf) + Float
								.parseFloat(payArrear)));
				String pfStatuary = String.valueOf(Float.parseFloat(cpf)
						+ Float.parseFloat(bean.getCpfArriers()));
				bean.setEmpPfStatuary(pfStatuary);
				bean.setEmoluments(emoluments);
				String cpfacno = this.getCpfAccnoDetails(con, bean
						.getMonthYear().trim(), bean.getCpfAccNo(), bean
						.getEmployeeNewNo(), "RAUSAP");
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "RAUSAP");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region) VALUES "
							+ "(?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "RAUSAP".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					pst.setString(6, "RAUSAP".trim());
					pst.executeUpdate();
					pst.close();
				}

				// logic from 01-08
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,EMPVPF,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,cpf,CPFARREAR,payforcpf,payArrear,employeeno,DESEGNATION,region)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				String foundSalaryDate = this.checkFinanceDuplicateRAUSAP(con,
						bean.getMonthYear().trim(), cpfacno.trim(), bean
								.getEmployeeNewNo(), "RAUSAP", "");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, bean.getEmpVpf().trim());
					pst.setString(5, "RAUSAP".trim());
					pst.setString(6, bean.getMonthYear().trim());
					pst.setString(7, bean.getEmployeeName().trim());
					// pst.setString(8, bean.getBasic().trim());
					pst.setString(8, cpf.trim());
					pst.setString(9, bean.getCpfArriers().trim());
					pst.setString(10, payforCpf.trim());
					pst.setString(11, payArrear.trim());
					// pst.setString(11,bean.getBasic().trim());
					pst.setString(12, bean.getEmployeeNewNo().trim());
					pst.setString(13, bean.getDesignation().trim());
					pst.setString(14, "RAUSAP".trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				} else {
					try {
						String finaceUpdate = "update employee_pension_validate set emoluments='"
								+ bean.getEmoluments()
								+ "'  where cpfaccno='"
								+ cpfacno.trim()
								+ "' and "
								+ "employeeno='"
								+ bean.getEmployeeNewNo()
								+ "' and monthyear='"
								+ bean.getMonthYear().trim()
								+ "' and region='RAUSAP'";
						log.info(" finaceUpdate Rausap " + finaceUpdate);
						st = con.createStatement();
						count = st.executeUpdate(finaceUpdate);
						count++;
						st.close();
					} catch (Exception e) {
						log.printStackTrace(e);
					}
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataRAUSAP Leaving Method");
			}
			// finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			con.close();
		}
	}

	public void readXLSFinalcialDataOfficeComplex(String xlsData)
			throws InvalidDataException {
		log
				.info("FinaceDAO :readXLSFinalcialDataOfficeComplex() entering method");
		int maxValue = 0;
		Connection con = null;
		Statement st = null;
		PreparedStatement pst = null;
		ArrayList xlsDataList = new ArrayList();
		ArrayList finalcialDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinacialDataBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String airportCode = xlsDataList.get(0).toString();
		String monthYear = xlsDataList.get(1).toString();
		if (airportCode.lastIndexOf(",") != -1) {
			airportCode = airportCode.substring(
					airportCode.lastIndexOf(",") + 1, airportCode.length() - 1);
		}
		if (monthYear.lastIndexOf("MONTH OF") != -1) {
			monthYear = monthYear.substring(
					monthYear.lastIndexOf("MONTH OF") + 8,
					monthYear.length() - 1);
		}
		try {
			con = commonDB.getConnection();
			String employeeName = "";
			int count = 0, countEmployeeInfo = 0;
			for (int i = 0; i < xlsDataList.size(); i++) {

				// st=con.createStatement();
				bean = new FinacialDataBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				if (!tempInfo[0].equals("XXX")) {
					bean.setEmployeeNewNo(tempInfo[0]);
				} else {
					bean.setEmployeeNewNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAccNo(tempInfo[1].trim());
				} else {
					bean.setCpfAccNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					//monthYear=commonUtil.converDBToAppFormat(tempInfo[2].trim(
					// ),"MM/yy",
					// "dd-MMM-yyyy");
					bean.setMonthYear(tempInfo[2].trim());
				} else {
					bean.setMonthYear("");
				}
				log.info("year  " + bean.getMonthYear());
				if (!tempInfo[3].equals("XXX")) {
					String empName = tempInfo[3];
					int empNameLength = empName.length();
					if (empName.charAt(empNameLength - 1) == '.') {
						empName = empName.substring(0, empNameLength - 1);
					}
					bean.setEmployeeName(empName);
				} else {

					bean.setEmployeeName("");
				}
				int startIndxName = 0;
				int endIndxName = 1;
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmployeeName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmployeeName().toLowerCase()
								.replaceAll(quats[j].toLowerCase(), "").trim();
						bean.setEmployeeName(tempName);
					}
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setDesignation(tempInfo[4]);
				} else {
					bean.setDesignation("");
				}

				if (!tempInfo[6].equals("XXX")) {
					bean.setBasic(tempInfo[6].trim());
				} else {
					bean.setBasic("0");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[10].trim());
				} else {
					bean.setDailyAllowance("0");
				}
				String daArrear = "";
				if (!tempInfo[11].equals("XXX")) {
					daArrear = tempInfo[11].trim();
				} else {
					daArrear = "0";
				}
				log.info(bean.getBasic() + "  " + bean.getDailyAllowance()
						+ " " + daArrear);
				String emoluments = String.valueOf((Float.parseFloat(bean
						.getBasic()) + Float.parseFloat(bean
						.getDailyAllowance()
						+ Float.parseFloat(daArrear))));
				bean.setEmoluments(emoluments);

				String pfCount = "";
				if (!tempInfo[7].equals("XXX")) {
					pfCount = tempInfo[7].trim();
				} else {
					pfCount = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setCpfArriers(tempInfo[8].trim());
				} else {
					bean.setCpfArriers("0.00");
				}

				String pfStatuary = String.valueOf(Float.parseFloat(pfCount)
						+ Float.parseFloat(bean.getCpfArriers()));
				bean.setEmpPfStatuary(pfStatuary);
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmpVpf(tempInfo[9].trim());
				} else {
					bean.setEmpVpf("0.00");
				}
				String refAdv = "";
				if (!tempInfo[22].equals("XXX")) {
					refAdv = tempInfo[22].trim();
				} else {
					refAdv = "0.00";
				}
				String dedAdv = "";
				if (!tempInfo[24].equals("XXX")) {
					dedAdv = tempInfo[24].trim();
				} else {
					dedAdv = "0.00";
				}

				String empAdvanceReCPrincipal = "";
				empAdvanceReCPrincipal = String.valueOf(Float
						.parseFloat(refAdv)
						+ Float.parseFloat(dedAdv));

				String empAdvrecInterest = "";
				if (!tempInfo[25].equals("XXX")) {
					empAdvrecInterest = tempInfo[25].trim();
				} else {
					empAdvrecInterest = "0.00";
				}

				// String cpfacno= this.getCpfAccnoDetails(con,
				// bean.getMonthYear().trim(), bean.getCpfAccNo(),
				// bean.getEmployeeNewNo(), "RAUSAP");
				log.info("emoluments  " + emoluments + "pfStatuary  "
						+ pfStatuary + "empAdvanceReCPrincipal "
						+ empAdvanceReCPrincipal + "empAdvrecInterest "
						+ empAdvrecInterest + "dedAdv" + dedAdv + "refAdv"
						+ refAdv);
				countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
						.getEmployeeNewNo(), bean.getCpfAccNo(), bean
						.getEmployeeName(), "CHQIAD");
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = con.prepareStatement(sql);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, "OFFICE COMPLEX".trim());
					pst.setString(3, bean.getEmployeeNewNo().trim());
					pst.setString(4, bean.getEmployeeName().trim());
					pst.setString(5, bean.getDesignation().trim());
					// for southern region Data
					pst.setString(6, "CHQIAD".trim());
					pst.setString(7, "new records from IGIIAD".trim());
					pst.executeUpdate();
					pst.close();
				}
				// logic from 01-08
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,BASIC,PFCOUNT ,CPFARREAR,employeeno,DESEGNATION,region,EMPVPF,DAILYALLOWANCE,DAARREAR,EMPADVRECPRINCIPAL,REFADV,DEDADV,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				log.info(" employeeName" + employeeName + "Designation"
						+ bean.getDesignation() + "CpfAccNo"
						+ bean.getCpfAccNo().trim());
				String foundSalaryDate = this.checkFinanceDuplicateRAUSAP(con,
						bean.getMonthYear().trim(), bean.getCpfAccNo(), bean
								.getEmployeeNewNo(), "CHQIAD", "");

				if (foundSalaryDate.equals("")) {
					pst = con.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAccNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmpPfStatuary().trim());
					pst.setString(4, "OFFICE COMPLEX".trim());
					pst.setString(5, bean.getMonthYear().trim());
					pst.setString(6, bean.getEmployeeName().trim());
					pst.setString(7, bean.getBasic().trim());
					pst.setString(8, pfCount.trim());
					pst.setString(9, bean.getCpfArriers());
					pst.setString(10, bean.getEmployeeNewNo().trim());
					pst.setString(11, bean.getDesignation().trim());
					pst.setString(12, "CHQIAD".trim());
					pst.setString(13, bean.getEmpVpf().trim());

					pst.setString(14, bean.getDailyAllowance().trim());
					pst.setString(15, daArrear.trim());
					pst.setString(16, empAdvanceReCPrincipal.trim());
					pst.setString(17, refAdv.trim());
					pst.setString(18, dedAdv.trim());
					pst.setString(19, empAdvrecInterest.trim());
					count = pst.executeUpdate();
					count++;
					pst.close();
				}
				log
						.info("FinaceDAO :readXLSFinalcialDataOfficeComplex Leaving Method");
			}
			finalcialDataList.add(bean);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
		} finally {
			try {
				con.close();
			} catch (Exception e) {
			}
		}
	}

	public void readXLSFinalcialDataOfficeComplex1(String xlsData)
			throws Exception {
		// old logic commented
		/*
		 * log .info("FinaceDAO :readXLSFinalcialDataOfficeComplex() entering
		 * method"); int maxValue = 0; Connection con = null; Statement st =
		 * null; PreparedStatement pst = null; ArrayList xlsDataList = new
		 * ArrayList(); ArrayList finalcialDataList = new ArrayList();
		 * xlsDataList = commonUtil.getTheList(xlsData, "***"); FinacialDataBean
		 * bean = null; String tempInfo[] = null; String tempData = ""; String
		 * quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." }; String
		 * airportCode = xlsDataList.get(0).toString(); String monthYear =
		 * xlsDataList.get(1).toString(); if (airportCode.lastIndexOf(",") !=
		 * -1) { airportCode = airportCode.substring(
		 * airportCode.lastIndexOf(",") + 1, airportCode.length() - 1); }
		 * 
		 * if (monthYear.lastIndexOf("MONTH OF") != -1) { monthYear =
		 * monthYear.substring( monthYear.lastIndexOf("MONTH OF") + 8,
		 * monthYear.length() - 1); } try { con = commonDB.getConnection();
		 * String employeeName = ""; int count = 0, countEmployeeInfo = 0; for
		 * (int i = 0; i < xlsDataList.size(); i++) { //
		 * st=con.createStatement(); bean = new FinacialDataBean(); tempData =
		 * xlsDataList.get(i).toString(); tempInfo = tempData.split("@");
		 * log.info("Employee Code" + tempInfo[0].toString().trim() + "CPFACCNO"
		 * + tempInfo[1].toString().trim() + "Employee Name" +
		 * tempInfo[3].toString().trim());
		 * 
		 * if (!tempInfo[0].equals("XXX")) { bean.setEmployeeNewNo(tempInfo[0]);
		 * } else { bean.setEmployeeNewNo(""); }
		 * 
		 * if (!tempInfo[1].equals("XXX")) {
		 * bean.setCpfAccNo(tempInfo[1].trim()); } else { bean.setCpfAccNo("");
		 * } if (!tempInfo[2].equals("XXX")) { //
		 * monthYear=commonUtil.converDBToAppFormat(tempInfo[2].trim(),"MM/yy",
		 * // "dd-MMM-yyyy"); bean.setMonthYear(tempInfo[2].trim()); } else {
		 * bean.setMonthYear(""); } log.info("year " + bean.getMonthYear()); if
		 * (!tempInfo[3].equals("XXX")) { String empName = tempInfo[3]; int
		 * empNameLength = empName.length(); if (empName.charAt(empNameLength -
		 * 1) == '.') { empName = empName.substring(0, empNameLength - 1); }
		 * bean.setEmployeeName(empName); } else {
		 * 
		 * bean.setEmployeeName(""); } int startIndxName = 0; int endIndxName =
		 * 1; String tempName = ""; for (int j = 0; j < quats.length; j++) {
		 * 
		 * if (bean.getEmployeeName().toLowerCase().indexOf(
		 * quats[j].toLowerCase()) != -1) { tempName =
		 * bean.getEmployeeName().toLowerCase()
		 * .replaceAll(quats[j].toLowerCase(), "").trim(); log.info("tempName "
		 * + tempName); // tempName=empName.substring(index+1,empName.length());
		 * bean.setEmployeeName(tempName); } } log.info("emp name " +
		 * bean.getEmployeeName()); if (!tempInfo[4].equals("XXX")) {
		 * bean.setDesignation(tempInfo[4]); } else { bean.setDesignation(""); }
		 * 
		 * if (!tempInfo[6].equals("XXX")) { bean.setBasic(tempInfo[6].trim());
		 * } else { bean.setBasic("0.00"); } String pfCount = ""; if
		 * (!tempInfo[7].equals("XXX")) { pfCount = tempInfo[7].trim(); } else {
		 * pfCount = "0.00"; } if (!tempInfo[8].equals("XXX")) {
		 * bean.setCpfArriers(tempInfo[8].trim()); } else {
		 * bean.setCpfArriers("0.00"); }
		 * 
		 * String emoluments = String .valueOf(((Float.parseFloat(pfCount) +
		 * Float .parseFloat(bean.getCpfArriers())) 100) / 12); String
		 * pfStatuary = String .valueOf((Float.parseFloat(pfCount) + Float
		 * .parseFloat(bean.getCpfArriers()) 10) / 12); log.info("emoluments " +
		 * emoluments); log.info("pfStatuary " + pfStatuary);
		 * bean.setEmoluments(emoluments); bean.setEmpPfStatuary(pfStatuary); if
		 * (!tempInfo[9].equals("XXX")) { bean.setEmpVpf(tempInfo[9].trim()); }
		 * else { bean.setEmpVpf("0.00"); } // String cpfacno=
		 * this.getCpfAccnoDetails(con, // bean.getMonthYear().trim(),
		 * bean.getCpfAccNo(), // bean.getEmployeeNewNo(), "RAUSAP");
		 * 
		 * countEmployeeInfo = commonDAO.checkEmployeeInfo(con, bean
		 * .getEmployeeNewNo(), bean.getCpfAccNo(), bean .getEmployeeName(),
		 * "CHQIAD"); if (countEmployeeInfo == 0) { String sql = "insert into
		 * employee_info(cpfacno,airportCode,
		 * employeeno,employeeName,desegnation,region) VALUES " +
		 * "(?,?,?,?,?,?)"; pst = con.prepareStatement(sql); pst.setString(1,
		 * bean.getCpfAccNo().trim()); pst.setString(2, "OFFICE
		 * COMPLEX".trim()); pst.setString(3, bean.getEmployeeNewNo().trim());
		 * pst.setString(4, bean.getEmployeeName().trim()); pst.setString(5,
		 * bean.getDesignation().trim()); // for southern region Data
		 * pst.setString(6, "CHQIAD".trim()); pst.executeUpdate(); pst.close();
		 * } // logic from 01-08 String finaceInsert = "insert into
		 * employee_pension_validate
		 * (cpfaccno,emoluments,emppfstatuary,AIRPORTCODE," +
		 * "MONTHYEAR,employeeName,BASIC,PFCOUNT
		 * ,CPFARREAR,employeeno,DESEGNATION,region,EMPVPF)" + "
		 * values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
		 * 
		 * log.info(" employeeName" + employeeName + "Designation" +
		 * bean.getDesignation() + "CpfAccNo" + bean.getCpfAccNo().trim());
		 * String foundSalaryDate = this.checkFinanceDuplicateRAUSAP(con,
		 * bean.getMonthYear().trim(), bean.getCpfAccNo(), bean
		 * .getEmployeeNewNo(), "CHQIAD", "");
		 * 
		 * if (foundSalaryDate.equals("")) { pst =
		 * con.prepareStatement(finaceInsert); pst.setString(1,
		 * bean.getCpfAccNo().trim()); pst.setString(2,
		 * bean.getEmoluments().trim()); pst.setString(3,
		 * bean.getEmpPfStatuary().trim()); pst.setString(4, "OFFICE
		 * COMPLEX".trim()); pst.setString(5, bean.getMonthYear().trim());
		 * pst.setString(6, bean.getEmployeeName().trim()); pst.setString(7,
		 * bean.getBasic().trim()); pst.setString(8, pfCount.trim());
		 * pst.setString(9, bean.getCpfArriers()); pst.setString(10,
		 * bean.getEmployeeNewNo().trim()); pst.setString(11,
		 * bean.getDesignation().trim()); pst.setString(12, "CHQIAD".trim());
		 * pst.setString(13, bean.getEmpVpf().trim()); count =
		 * pst.executeUpdate(); count++; pst.close(); } log .info("FinaceDAO
		 * :readXLSFinalcialDataOfficeComplex Leaving Method"); }
		 * finalcialDataList.add(bean); } catch (SQLException e) { // TODO
		 * Auto-generated catch block log.printStackTrace(e); } catch (Exception
		 * e) { // TODO Auto-generated catch block log.printStackTrace(e); }
		 * finally { con.close(); }
		 */}

	public String checkFinanceDuplicate(Connection con, String fromDate,
			String pensionno, String employeeNo, String region) {

		// log.info("PensionDAO :checkPensionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;

		ResultSet rs = null;
		// System.out.println("fromDate" + fromDate + "cpfaccno" + cpfaccno);
		/** for Eastern Region and Northern region* */
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "";
			if (region.equals("CHQIAD")) {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pensionno
						+ "' and region='" + region + "'  and empflag='Y' ";
			} else {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pensionno
						+ "' and region='" + region + "' and empflag='Y' ";
			}

			/* and activeflag = 'N'"; */

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public String checkFinanceDuplicate2(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String airportcode, String pfid) {

		// log.info("PensionDAO :checkPensionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		// System.out.println("fromDate" + fromDate + "cpfaccno" + cpfaccno);
		/** for Eastern Region and Northern region* */
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "";
			if (region.equals("CHQIAD")) {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pfid
						+ "' and region='"
						+ region
						+ "' and lower(airportcode)='"
						+ airportcode.toLowerCase() + "'  and empflag='Y' ";
			} else {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pfid
						+ "' and region='"
						+ region
						+ "' and lower(airportcode)='"
						+ airportcode.toLowerCase() + "' and empflag='Y'";
			}

			log.info("query" + query);

			/* and activeflag = 'N'"; */

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public FinacialDataBean getEmolumentsBean(Connection con, String fromDate,
			String cpfaccno, String employeeno, String region, String Pensionno,String recoverieTable) {

		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		FinacialDataBean bean = new FinacialDataBean();
		String tableName = "Employee_pension_validate";
		if (recoverieTable.trim().equals("true")) {
			tableName = "employee_pension_final_recover";
		}
		try {
			DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");

			Date transdate = df.parse(fromDate);

			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "";
			if ((Pensionno == "" || transdate.before(new Date("31-Mar-2008"))) && !recoverieTable.trim().equals("true")) {				
				query = "select emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI from " + tableName + " where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='" + region + "' and empflag='Y' ";
				log.info("query"+query);
			} else {
				query = "select emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI from " + tableName + " where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ Pensionno
						+ "'  and empflag='Y' ";
				log.info("query"+query);
			}
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					bean.setEmoluments(rs.getString("emoluments"));
				}
				if (rs.getString("EMPPFSTATUARY") != null) {
					bean.setEmpPfStatuary(rs.getString("EMPPFSTATUARY"));
				}
				if (rs.getString("EMPVPF") != null) {
					bean.setEmpVpf(rs.getString("EMPVPF"));
				}
				if (rs.getString("EMPADVRECPRINCIPAL") != null) {
					bean.setPrincipal(rs.getString("EMPADVRECPRINCIPAL"));
				}
				if (rs.getString("EMPADVRECINTEREST") != null) {
					bean.setInterest(rs.getString("EMPADVRECINTEREST"));
				}
				if (rs.getString("PENSIONCONTRI") != null) {
					bean.setPenContri(rs.getString("PENSIONCONTRI"));
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return bean;
	}

	public String checkArrears(Connection con, String fromDate,
			String cpfaccno, String employeeno, String region, String Pensionno) {

		String foundEmpFlag = "", arrearamt = "";
		Statement st = null;
		ResultSet rs = null;
		try {
			DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
			Date transdate = df.parse(fromDate);
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "";
			if (Pensionno == "" || transdate.before(new Date("31-Mar-2008"))) {
				query = "select ARREARAMT from employee_pension_arrear where to_char(ARREARDATE,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='" + region + "' ";
			} else {
				query = "select ARREARAMT from employee_pension_arrear where to_char(ARREARDATE,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ Pensionno
						+ "'  ";
			}

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("ARREARAMT") != null) {
					arrearamt = rs.getString("ARREARAMT");
				}

			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return arrearamt;
	}

	public FinacialDataBean getEmolumentsBean1(Connection con, String fromYear,
			String toYear, String employeeNo, String region, String Pensionno) {

		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		FinacialDataBean bean = new FinacialDataBean();
		try {
			String query = "";
			query = "select emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI from employee_Pension_validate where monthyear BETWEEN '"
					+ fromYear
					+ "' AND last_day('"
					+ toYear
					+ "') and pensionno='" + Pensionno + "'  and empflag='Y' ";

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					bean.setEmoluments(rs.getString("emoluments").trim());
				}
				if (rs.getString("EMPPFSTATUARY") != null) {
					bean.setEmpPfStatuary(rs.getString("EMPPFSTATUARY").trim());
				}
				if (rs.getString("EMPVPF") != null) {
					bean.setEmpVpf(rs.getString("EMPVPF").trim());
				}

				if (rs.getString("EMPADVRECPRINCIPAL") != null) {
					bean
							.setPrincipal(rs.getString("EMPADVRECPRINCIPAL")
									.trim());
				}

				if (rs.getString("EMPADVRECINTEREST") != null) {
					bean.setInterest(rs.getString("EMPADVRECINTEREST").trim());
				}

				if (rs.getString("PENSIONCONTRI") != null) {
					bean.setPenContri(rs.getString("PENSIONCONTRI").trim());
				}

			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return bean;
	}

	public String getEmolumentsBesedonPFID(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region, String PFID) {

		String foundEmpFlag = "";
		Statement st = null;

		ResultSet rs = null;
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "select emoluments as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ PFID
					+ "'  and empflag='Y' ";
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public String checkFinanceDuplicate1(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String pensionno, String airportcode, String flag) {

		// log.info("PensionDAO :checkPensionDuplicate() entering method ");
		String foundEmpFlag = "", tbl_name = "";
		Statement st = null;

		ResultSet rs = null;
		if (flag.equals("temp")) {
			tbl_name = "employee_pension_Validate_temp";
		} else {
			tbl_name = "employee_Pension_validate";
		}

		try {
			String query = "";
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yy", "-MMM-yy");
			if (region.equals("CHQIAD")) {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pensionno
						+ "' and empflag='Y' and airportcode='"
						+ airportcode
						+ "'";
			} else {
				query = "select pensionno as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pensionno
						+ "' and empflag='Y' and region='" + region + "' ";
			}
			log.info(query);
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public String trasactionDuplicate(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String pensionno, String airportcode, String flag) {
		log.info("PensionDAO :trasactionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		String pensionno1 = "", airportcode1 = "", region1 = "";
		try {
			String query = "";
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate.trim(), "dd-MMM-yy", "-MMM-yy");
			query = "select pensionno,airportcode,region from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ pensionno
					+ "' and empflag='Y'";

			log.info("trasactionDuplicate====="+query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("pensionno") != null) {
					pensionno1 = rs.getString("pensionno");
				}
				if (rs.getString("airportcode") != null) {
					airportcode1 = rs.getString("airportcode");
				} else {
					airportcode1 = "";
				}
				if (rs.getString("region") != null) {
					region1 = rs.getString("region");
				} else {
					region1 = "";
				}
				foundEmpFlag = pensionno1 + "_" + airportcode1 + "_" + region1;	
				if(rs!=null) rs.close();
				if(st!=null) st.close();
			}if(foundEmpFlag.equals("")){
			String	query1 = "select pensionno,airportcode,region from employee_form3_temporary where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and pensionno='"
						+ pensionno
						+ "'";
				log.info("trasactionDuplicate====="+query1);
				if(rs!=null) rs.close();
				if(st!=null) st.close();
				st = con.createStatement();
				rs1 = st.executeQuery(query1);
				if (rs1.next()) {
					if (rs1.getString("pensionno") != null) {
						pensionno1 = rs1.getString("pensionno");
					}
					if (rs1.getString("airportcode") != null) {
						airportcode1 = rs1.getString("airportcode");
					} else {
						airportcode1 = "";
					}
					if (rs1.getString("region") != null) {
						region1 = rs1.getString("region");
					} else {
						region1 = "";
					}
					foundEmpFlag = pensionno1 + "_" + airportcode1 + "_" + region1;
			}
				if(rs1!=null) rs1.close();
				if(st!=null) st.close();	
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (rs1 != null) {
				try {
					rs1.close();
					rs1 = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}

		return foundEmpFlag;
	}
	public String trasactionDuplicateSuppli(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String pensionno, String airportcode, String flag) {
		log.info("PensionDAO :trasactionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		String pensionno1 = "", airportcode1 = "", region1 = "";
		try {
			String query = "";
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate.trim(), "dd-MMM-yy", "-MMM-yy");
			query = "select pensionno,airportcode,region from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ pensionno
					+ "' and empflag='Y'";

			log.info("trasactionDuplicate====="+query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("pensionno") != null) {
					pensionno1 = rs.getString("pensionno");
				}
				if (rs.getString("airportcode") != null) {
					airportcode1 = rs.getString("airportcode");
				} else {
					airportcode1 = "";
				}
				if (rs.getString("region") != null) {
					region1 = rs.getString("region");
				} else {
					region1 = "";
				}
				foundEmpFlag = pensionno1 + "_" + airportcode1 + "_" + region1;				
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}

		return foundEmpFlag;
	}
	public String prevEmoluments(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String pensionno, String airportcode, String flag) {

		log.info("PensionDAO :trasactionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		Statement st1 = null;
		ResultSet rs1 = null;
		ResultSet rs2= null;
		String emoluments = "", airportcode1 = "", region1 = "",suppliFlag="";;
		try {
			String query = "",suppliquery="";			
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate.trim(), "dd-MMM-yy", "-MMM-yy");
			suppliquery="select suppliflag from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
				+ transMonthYear
				+ "' and pensionno='"
				+ pensionno
				+ "' and empflag='Y'";
			st1 = con.createStatement();
			log.info(suppliquery);
			rs1 = st1.executeQuery(suppliquery);
			if(rs1.next()){
				suppliFlag=rs1.getString("suppliflag");
			}
			if(rs1!=null) rs1.close();
			if(st1!=null) st1.close();
			log.info("suppliflag"+suppliFlag);
			if(suppliFlag.equals("Y")){
			query = "select emoluments from employee_supplimentory_data  where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ pensionno
					+ "' and empflag='Y' and suppliflag='N'";
			} else {
				query = "select emoluments from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ pensionno
					+ "' and empflag='Y' and suppliflag='N'";
			}
			log.info("trasactionDuplicate====="+query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					emoluments = rs.getString("emoluments");
				}else{
					emoluments="";
				}				
			}
			if(rs!=null) rs.close();
			if(st!=null) st.close();
			log.info("emoluments"+ emoluments);
			if(emoluments.equals("")){
				query = "select emoluments from employee_supplimentory_data  where SALMONTH=to_char(add_months('01"+transMonthYear+"',-1)) and pensionno='"
					+ pensionno
					+ "' and empflag='Y' and suppliflag='S'";
				log.info("query"+query);
				st = con.createStatement();
				rs2 = st.executeQuery(query);
				
				if (rs2.next()) {
					if (rs2.getString("emoluments") != null) {
						emoluments = rs2.getString("emoluments");
					}else{
						emoluments="";
					}
			}
				if(rs2!=null) rs2.close();
				if(st!=null) st.close();
				}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {		
			if (rs != null) {
				try {
					rs.close();	
					rs=null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (rs1 != null) {
				try {
					rs1.close();	
					rs1=null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (rs2 != null) {
				try {
					rs2.close();	
					rs2=null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();	
					st=null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}
			if (st1 != null) {
				try {
					st1.close();	
					st1=null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}
			
		}
		return emoluments;
	}
	public String getPensionContri(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String pensionno, String airportcode, String flag) {

		log.info("PensionDAO :getPensionContri() entering method ");
		String foundpensioncontri = "";
		Statement st = null;
		ResultSet rs = null;
		String pensioncontri = "";
		try {
			String query = "";
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate.trim(), "dd-MMM-yy", "-MMM-yy");
			query = "select to_number(pensioncontri) as pensioncontri from employee_pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ pensionno
					+ "' and empflag='Y'";

			log.info(query);
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("pensioncontri") != null) {
					pensioncontri = rs.getString("pensioncontri");
				}				
				foundpensioncontri = pensioncontri;
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
    log.info("foundpensioncontri"+foundpensioncontri);
		return foundpensioncontri;
	}

	public String checkFinanceArrear(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region) {

		log.info("PensionDAO :checkFinanceArrear() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
   
		ResultSet rs = null;
		System.out.println("fromDate" + fromDate + "cpfaccno" + cpfaccno);
		/** for Eastern Region and Northern region* */
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yy", "-MMM-yy");
			String query = "select CPFACCNO as COLUMNNM from employee_pension_arrear where to_char(ARREARDATE,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and cpfaccno='"
					+ cpfaccno
					+ "' and region='" + region + "'";/* and activeflag='N'"; */

			/*
			 * String query = "select CPFACCNO as COLUMNNM from
			 * employee_Pension_validate where monthyear='" + fromDate + "' and
			 * cpfaccno='" + cpfaccno + "' and region='"+region+"'";
			 */

			log.info("query is " + query);

			// con = commonDB.getConnection();
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");

				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		log.info("PensionDAO :checkFinanceArrear() leaving method");
		return foundEmpFlag;
	}

	public FinacialDataBean getEmployeeInfo(String employeeNo) {
		Statement st = null;
		ResultSet rs = null;
		FinacialDataBean bean = new FinacialDataBean();
		String query = "";
		try {
			Connection con = commonDB.getConnection();

			if (!employeeNo.equals("")) {
				query = "select employeeNo,employeeName,cpfacno,DESEGNATION from employee_info where employeeNo='"
						+ employeeNo + "' and region='CHQNAD'";
			}

			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {

				log.info("employee no" + rs.getString("employeeno"));
				if (rs.getString("employeeno") != null) {
					bean.setEmployeeNewNo(rs.getString("employeeno"));
				} else {
					bean.setEmployeeNewNo("");
				}

				if (rs.getString("desegnation") != null) {
					bean.setDesignation(rs.getString("desegnation"));
				} else {
					bean.setDesignation("");
				}

				if (rs.getString("cpfacno") != null) {
					bean.setCpfAccNo(rs.getString("cpfacno"));
				} else {
					bean.setCpfAccNo("");
				}

				if (rs.getString("employeename") != null) {
					bean.setEmployeeName(rs.getString("employeename"));
				} else {
					bean.setEmployeeName("");
				}

			}
		} catch (Exception e) {
			log.printStackTrace(e);

		}
		log.info("deseg " + bean.getDesignation());
		return bean;
	}

	private String getCpfAccnoDetails(Connection con, String monthYear,
			String cpfaccno, String employeeNo, String region) {
		String cpfacno = "";
		Statement st = null;
		ResultSet rs = null;
		String query = "select CPFACNO as COLUMNNM from employee_info where   region='"
				+ region + "'  and employeeno='" + employeeNo + "'";

		log.info("query is " + query);
		try {
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					cpfacno = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(null, st, rs);
		}
		return cpfacno;
	}

	public String checkFinanceDuplicateRAUSAP(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String airportcode) {
		log.info("PensionDAO :checkPensionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		System.out.println("fromDate" + fromDate + "cpfaccno" + cpfaccno);
		String query = "select CPFACCNO as COLUMNNM from employee_Pension_validate where monthyear='"
				+ fromDate
				+ "' and cpfaccno='"
				+ cpfaccno
				+ "' and region='"
				+ region + "'";// and employeeno='" + employeeNo + "'";

		log.info("query is " + query);
		try {
			// con = commonDB.getConnection();
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(null, st, rs);
		}
		log.info("FinanceDao :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	private String checkEmployeeMaster(Connection con, String empCode,
			String cpfaccno) {
		log.info("FinanceDAO :checkEmployeeMaster() entering method ");
		String foundEmpFlag = "", query = "";
		Statement st = null;

		ResultSet rs = null;
		if (!cpfaccno.equals("")) {
			query = "select EMPLOYEENAME as EMPLOYEENAME from employee_info where  CPFACNO='"
					+ cpfaccno + "' and EMPLOYEENO='" + empCode + "'";
		} else {
			query = "select EMPLOYEENAME as EMPLOYEENAME from employee_info where EMPLOYEENO='"
					+ empCode + "'";
		}
		log.info("query is " + query);
		try {

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("EMPLOYEENAME") != null) {
					foundEmpFlag = rs.getString("EMPLOYEENAME");
				}
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}
		}
		log.info("FinanceDAO :checkEmployeeInfo() leaving method"
				+ foundEmpFlag);
		return foundEmpFlag.trim();
	}

	public void readXLSPersonalForm3updateSeparation(String xlsData) {
		log
				.info("PensionDAO :readXLSPersonalForm3updateSeparation() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		for (int i = 1; i < xlsDataList.size(); i++) {
			bean = new EmpMasterBean();
			tempData = xlsDataList.get(i).toString();
			tempInfo = tempData.split("@");
			try {
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(),
							"'".toCharArray(), "").toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}

				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setDesegnation(tempInfo[3].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setFhName(tempInfo[4].trim());
				} else {
					bean.setFhName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					if (tempInfo[5].trim().indexOf("'") != -1) {
						int index = tempInfo[5].trim().indexOf("'");
						tempInfo[5] = tempInfo[5].trim().substring(index + 1,
								tempInfo[5].length());
					}
					bean.setDateofBirth(tempInfo[5].trim());

				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].trim().indexOf("'") != -1) {
						int index = tempInfo[6].trim().indexOf("'");
						tempInfo[6] = tempInfo[6].trim().substring(index + 1,
								tempInfo[6].length());
					}
					bean.setDateofJoining(tempInfo[6].toString().trim());

				} else {
					bean.setDateofJoining("");
				}

				log.info("DateofBirth" + bean.getDateofBirth()
						+ "DateofJoining" + bean.getDateofJoining());

				if (!tempInfo[7].equals("XXX")) {
					bean.setSex(tempInfo[7].trim());
				} else {
					bean.setSex("");
				}
				/*
				 * if (!tempInfo[8].equals("XXX")) {
				 * bean.setSeperationReason(tempInfo[8].trim()); } else {
				 * bean.setSeperationReason(""); } if
				 * (!tempInfo[9].equals("XXX")) {
				 * bean.setOtherReason(tempInfo[9].trim()); } else {
				 * bean.setOtherReason(""); } if (!tempInfo[10].equals("XXX")) {
				 * bean.setDateofSeperationDate(tempInfo[10].trim()); } else {
				 * bean.setDateofSeperationDate(""); }
				 */

				PDAO.updatePersional(bean, "South Region");

			} catch (Exception e) {
				log.printStackTrace(e);
				try {
					fw.write(tempData + "***");
					fw.flush();

				} catch (FileNotFoundException fe) {
					log.printStackTrace(fe);
					// System.err.println("FileStreamsTest: " + fe);
				} catch (IOException io) {
					// System.err.println("FileStreamsTest: " + io);
					log.printStackTrace(io);
				}
			}
		}
		log
				.info("PensionDAO :readXLSPersonalForm3updateSeparation() leaving method");
	}

	public void updateEmployeePersonalInfo(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :updateEmployeePersonalinfo() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			int count = 0, totalCount = 0;
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpName(tempInfo[1].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setRegion(tempInfo[3].trim());
				} else {
					bean.setRegion("");
				}
				EmpMasterBean editBean = new EmpMasterBean();
				editBean = PDAO.editPensionMaster1(bean.getCpfAcNo(), bean
						.getEmpName(), true, bean.getEmpNumber(), bean
						.getRegion());
				PDAO.updatePensionMaster1(editBean, "true");
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :updateEmployeePersonalinfo leaving method");

	}

	public void readXLSPersonalData(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		log.info("ImportDao :personalCount() entering method");
		ArrayList xlsDataList = new ArrayList();
		ArrayList pensionList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String delimiter = "", xlsEmpName = "", xlsDesignation = "";
		int count = 0, personalCount = 0;
		log.debug("xlsData" + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmpNumber(tempInfo[0]);
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1]);
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}

				if (!tempInfo[3].equals("XXX")) {
					bean.setWetherOption(tempInfo[3]);
				} else {
					bean.setWetherOption("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setForm2Nomination(tempInfo[4]);
				} else {
					bean.setForm2Nomination("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setStation(tempInfo[5]);
				} else {
					bean.setStation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setRegion(tempInfo[6]);
				} else {
					bean.setRegion("");
				}
				String remarks = " Pension is updated from Final AAI Sheet";
				String updatePersonalsql = "", updatePersonalInfosql = "";
				if (!bean.getStation().equals("")
						|| !bean.getEmpNumber().equals("")) {
					updatePersonalsql = "update employee_info set WETHEROPTION='"
							+ bean.getWetherOption()
							+ "',WHETHER_FORM1_NOM_RECEIVED='"
							+ bean.getForm2Nomination()
							+ "',"
							+ "username='"
							+ userName
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "',REMARKS=REMARKS||'"
							+ remarks
							+ "'"
							+ " where cpfacno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  employeeno='"
							+ bean.getEmpNumber().trim()
							+ "' and airportcode='"
							+ bean.getStation().trim()
							+ "' and  region='" + bean.getRegion().trim() + "'";
					updatePersonalInfosql = "update employee_personal_info set WETHEROPTION='"
							+ bean.getWetherOption()
							+ "',WHETHER_FORM1_NOM_RECEIVED='"
							+ bean.getForm2Nomination()
							+ "',"
							+ "username='"
							+ userName
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "',REMARKS=REMARKS||'"
							+ remarks
							+ "',IPADDRESS='"
							+ ipAddress
							+ "' "
							+ " where cpfacno='"
							+ bean.getCpfAcNo()
							+ "' and  employeeno='"
							+ bean.getEmpNumber()
							+ "' and airportcode='"
							+ bean.getStation()
							+ "' and  region='" + bean.getRegion() + "'";
				} else {
					updatePersonalsql = "update employee_info set WETHEROPTION='"
							+ bean.getWetherOption()
							+ "',WHETHER_FORM1_NOM_RECEIVED='"
							+ bean.getForm2Nomination()
							+ "',"
							+ "username='"
							+ userName
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "',REMARKS=REMARKS||'"
							+ remarks
							+ "'"
							+ " where cpfacno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  region='" + bean.getRegion().trim() + "'";
					updatePersonalInfosql = "update employee_personal_info set WETHEROPTION='"
							+ bean.getWetherOption()
							+ "',WHETHER_FORM1_NOM_RECEIVED='"
							+ bean.getForm2Nomination()
							+ "',"
							+ "username='"
							+ userName
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "',REMARKS=REMARKS||'"
							+ remarks
							+ "',IPADDRESS='"
							+ ipAddress
							+ "' "
							+ " where cpfacno='"
							+ bean.getCpfAcNo()
							+ "'  and  region='" + bean.getRegion() + "'";
				}

				log.info("update sql " + updatePersonalsql);
				count = st.executeUpdate(updatePersonalsql);
				personalCount = st.executeUpdate(updatePersonalInfosql);
				count = count + 1;
				personalCount = personalCount + 1;
				log.info("record update employee_info" + count
						+ "employee_personal_Info" + personalCount);

			}
		} catch (Exception e) {
			log.printStackTrace(e);

		} finally {
			try {
				conn.close();
			} catch (Exception e) {
			}
		}
		log.info("ImportDao :readXLSChqIadData leaving method");
	}

	public void advanceTable(String xlsData) throws Exception {

		log.info("ImportDao :advanceTable() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				String amount = "", aaiPartAmount = "", advTransDate = "", tempName = "", advPurpose = "";
				;
				if (!tempInfo[3].equals("XXX")) {
					amount = tempInfo[3].trim();
				} else {
					amount = "0.00";
				}
				String partAmount = "";
				if (!tempInfo[4].equals("XXX")) {
					partAmount = tempInfo[4].trim();
				} else {
					partAmount = "0.00";
				}
				if (!tempInfo[5].equals("XXX")) {
					aaiPartAmount = tempInfo[5].trim();
				} else {
					aaiPartAmount = "0.00";
				}

				String advance = String.valueOf((Float.parseFloat(amount)
						+ Float.parseFloat(partAmount) + Float
						.parseFloat(aaiPartAmount)));
				if (!tempInfo[6].equals("XXX")) {
					advTransDate = tempInfo[6].trim();
				} else {
					advTransDate = "0.00";
				}
				if (!tempInfo[7].equals("XXX")) {
					advPurpose = tempInfo[7].trim();
				} else {
					advPurpose = "";
				}
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}

				String updateTransaction = "";
				String insertAdvanceTabledata = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					insertAdvanceTabledata = "insert into  employee_pension_advances (cpfaccno,employeeno,employeename,amount,Partamt,aaipartamt,advPurpose,AdvTransDate)values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getEmpNumber()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ Float.parseFloat(amount)
							+ "','"
							+ Float.parseFloat(partAmount)
							+ "','"
							+ Float.parseFloat(aaiPartAmount)
							+ "','"
							+ advPurpose + "','" + advTransDate + "')";
					String transMonthYear = commonUtil.converDBToAppFormat(
							advTransDate, "dd-MMM-yyyy", "-MMM-yyyy");
					String remarks = "CHQNAD ADVANCES UPDATED";
					updateTransaction = "UPDATE EMPLOYEE_PENSION_VALIDATE SET ADVANCE='"
							+ Float.parseFloat(advance)
							+ "' ,EMPADVRECPRINCIPAL=TO_NUMBER(CPFADVANCE)-nvl(TO_NUMBER('"
							+ advance
							+ "'),0),REMARKS=REMARKS||'"
							+ remarks
							+ "' WHERE to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo() + "' and region='CHQNAD' ";

				}

				log.info(insertAdvanceTabledata);
				log.info(updateTransaction);
				st.execute(insertAdvanceTabledata);
				st.execute(updateTransaction);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :advanceTable leaving method");

	}

	public void IgiCargoAdvanceTable(String xlsData, String region)
			throws InvalidDataException {

		log.info("ImportDao :IgiCargoAdvanceTable() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", advTransDate = "", amount = "", advPurpose = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				/*
				 * if (!tempInfo[1].equals("XXX")) {
				 * bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				 * } else { bean.setPfid(""); }
				 */
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[3].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}

				if (!tempInfo[4].equals("XXX")) {

					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[5].equals("XXX")) {
					// advTransDate =
					// commonUtil.converDBToAppFormat(tempInfo[5].
					// trim(),"dd.MM.yyyy", "dd-MMM-yyyy");
					advTransDate = tempInfo[5].trim();
					log.info("advTransDate " + advTransDate);

				} else {
					advTransDate = "";
				}

				if (!tempInfo[6].equals("XXX")) {
					advPurpose = tempInfo[6].trim();
				} else {
					advPurpose = "";
				}

				if (!tempInfo[7].equals("XXX")) {
					amount = tempInfo[7].trim();
				} else {
					amount = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setStation(tempInfo[8].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[9].trim()));
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setRegion(tempInfo[10].trim());
				}
				String updateTransaction = "";
				String insertAdvanceTabledata = "";
				log.info(bean.getCpfAcNo());
				if (bean.getCpfAcNo() != "") {
					/*
					 * insertAdvanceTabledata =
					 * "insert into  employee_pension_advances (cpfaccno,employeeno,employeename,amount,advPurpose,AdvTransDate,airportcode,region,PARTAMT)values('"
					 * + bean.getCpfAcNo() + "','" + bean.getEmpNumber() + "','"
					 * + bean.getEmpName() + "','" + Float.parseFloat(amount) +
					 * "','" + advPurpose + "','" + advTransDate +
					 * "','IGICargo IAD','CHQIAD','0.00')";
					 */
					insertAdvanceTabledata = "insert into  employee_pension_advances (cpfaccno,employeeno,employeename,amount,advPurpose,AdvTransDate,airportcode,region,PARTAMT,PENSIONNO)values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getEmpNumber()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ Float.parseFloat(amount)
							+ "','"
							+ advPurpose
							+ "','"
							+ advTransDate
							+ "','"
							+ bean.getStation().trim()
							+ "','"
							+ bean.getRegion()
							+ "','0.00','"
							+ bean.getPfid()
							+ "')";
					log.info(insertAdvanceTabledata);
					st.execute(insertAdvanceTabledata);
				}

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :IgiCargoAdvanceTable leaving method");

	}

	public void IgiCargoPFwTable(String xlsData, String region)
			throws InvalidDataException {

		log.info("ImportDao :IgiCargoPFwTable() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[3].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					// advTransDate =
					// commonUtil.converDBToAppFormat(tempInfo[5].
					// trim(),"dd.MM.yyyy", "dd-MMM-yyyy");
					advTransDate = tempInfo[5].trim();
					log.info("advTransDate " + advTransDate);

				} else {
					advTransDate = "";
				}

				if (!tempInfo[6].equals("XXX")) {
					advPurpose = tempInfo[6].trim();
				} else {
					advPurpose = "";
				}

				if (!tempInfo[7].equals("XXX")) {
					empShare = tempInfo[7].trim();
				} else {
					empShare = "0.00";
				}
				if (!tempInfo[8].equals("XXX")) {
					aaiShare = tempInfo[8].trim();
				} else {
					aaiShare = "0.00";
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setStation(tempInfo[9].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean
							.setPfid(commonUtil.getSearchPFID1(tempInfo[10]
									.trim()));
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setRegion(tempInfo[11].trim());
				}
				String updateTransaction = "";
				String insertPfwTabledata = "";
				log.info(bean.getCpfAcNo());
				if (bean.getCpfAcNo() != "") {
					/*
					 * insertAdvanceTabledata =
					 * "insert into  employee_pension_loans (cpfaccno,employeeno,employeename,SUB_AMT,CONT_AMT,LOANPURPOSE,LOANDATE,airportcode,region,LOANTYPE)values('"
					 * + bean.getCpfAcNo() + "','" + bean.getEmpNumber() + "','"
					 * + bean.getEmpName() + "','" + Float.parseFloat(empShare)
					 * + "','" + Float.parseFloat(aaiShare) + "','" + advPurpose
					 * + "','" + advTransDate +
					 * "','IGICargo IAD','CHQIAD','NRF')";
					 */
					insertPfwTabledata = "insert into  employee_pension_loans(cpfaccno,employeeno,employeename,SUB_AMT,CONT_AMT,LOANPURPOSE,LOANDATE,airportcode,region,LOANTYPE,PENSIONNO)values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getEmpNumber()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ Float.parseFloat(empShare)
							+ "','"
							+ Float.parseFloat(aaiShare)
							+ "','"
							+ advPurpose
							+ "','"
							+ advTransDate
							+ "','"
							+ bean.getStation()
							+ "','"
							+ bean.getRegion()
							+ "','NRF','"
							+ bean.getPfid() + "')";
					log.info(insertPfwTabledata);
					st.execute(insertPfwTabledata);
				}

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :IgiCargoPFwTable leaving method");

	}

	public void arrearTable(String xlsData) throws InvalidDataException {

		log.info("ImportDao :arrearTable() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo;
				if (!tempInfo[0].equals("XXX")) {
					cpfaccno = tempInfo[0].trim();
				} else {
					cpfaccno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					employeeNo = tempInfo[1].trim();
				} else {
					employeeNo = "";
				}
				if (!tempInfo[2].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[2].trim().toCharArray(), delimiters, "")
							.toString();
					employeeName = xlsEmpName.trim();
				} else {
					employeeName = "";
				}
				String arrearAmount = "";
				if (!tempInfo[3].equals("XXX")) {
					arrearAmount = tempInfo[3].trim();
				} else {
					arrearAmount = "0.00";
				}
				String aaiContAmount = "";
				if (!tempInfo[4].equals("XXX")) {
					aaiContAmount = tempInfo[4].trim();
				} else {
					aaiContAmount = "0.00";
				}

				String arrearDate = "";
				if (!tempInfo[5].equals("XXX")) {
					arrearDate = tempInfo[5].trim();
				} else {
					arrearDate = "";
				}

				String remarks = "";
				if (!tempInfo[6].equals("XXX")) {
					remarks = tempInfo[6].trim();
				} else {
					remarks = "";
				}

				String insertArrearTabledata = "";
				String transMonthYear = commonUtil.converDBToAppFormat(
						arrearDate, "dd-MMM-yyyy", "-MMM-yyyy");

				insertArrearTabledata = "insert into  employee_pension_arrear(cpfaccno,employeeno,employeename,arreardate,arrearAmt,aaiContrAmt,airportcode,region,remarks)values('"
						+ cpfaccno
						+ "','"
						+ employeeNo
						+ "','"
						+ employeeName
						+ "','"
						+ arrearDate
						+ "','"
						+ Float.parseFloat(arrearAmount)
						+ "','"
						+ Float.parseFloat(aaiContAmount)
						+ "','CHQNAD','CHQNAD','" + remarks + "')";

				remarks = "updating emoluments with AAIContrAmt";
				String updateTransaction = "UPDATE EMPLOYEE_PENSION_VALIDATE set EMOLUMENTS=to_char(((TO_NUMBER(nvl(CPFARREAR,0))+TO_NUMBER(nvl(cpf,0))+"
						+ aaiContAmount
						+ ")*100/12),'9999999.99'),EMPPFSTATUARY=to_char(TO_NUMBER(nvl(CPFARREAR,0))+TO_NUMBER(nvl(cpf,0))+"
						+ aaiContAmount
						+ ",'999999.99') WHERE to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='CHQNAD'";
				// String updateTransaction = "UPDATE EMPLOYEE_PENSION_VALIDATE
				// set
				//EMOLUMENTS=(TO_NUMBER(nvl(CPFARREAR,0))+nvl(TO_NUMBER(nvl(cpf,
				// 0
				// )))+'"+aaiContAmount+"')*100/12),EMPPFSTATUARY=TO_NUMBER(nvl(
				// CPFADVANCE
				// ,0))+nvl(TO_NUMBER(nvl(advance,0)))+'"+aaiContAmount+"'),
				// REMARKS=REMARKS||'"
				// + remarks+ "' WHERE to_char(monthyear,'dd-Mon-yyyy') like
				// '%"+arrearDate+ "' and cpfaccno='"+cpfaccno+"' and
				// region='CHQNAD' ";

				String empVpfCalculation = "UPDATE EMPLOYEE_PENSION_VALIDATE  set empvpf=to_char((TO_NUMBER(nvl(empvpf,0))+TO_NUMBER((nvl("
						+ arrearAmount
						+ ",0))-("
						+ aaiContAmount
						+ "))),'999999.99') WHERE to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='CHQNAD'";

				log.info(insertArrearTabledata);
				log.info(updateTransaction);
				log.info(empVpfCalculation);
				st.execute(insertArrearTabledata);
				// log.info(updateTransaction);
				st.execute(updateTransaction);
				st.execute(empVpfCalculation);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :arrearTable leaving method");

	}

	public void loansTable(String xlsData) throws InvalidDataException {

		log.info("ImportDao :loanTable() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeno = "";
				if (!tempInfo[0].equals("XXX")) {
					employeeno = tempInfo[0].trim();
				} else {
					employeeno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					cpfaccno = tempInfo[1].trim();
				} else {
					cpfaccno = "";
				}
				String loanPurpose = "";
				if (!tempInfo[1].equals("XXX")) {
					loanPurpose = tempInfo[1].trim();
				} else {
					loanPurpose = "";
				}
				String loanDate = "";
				if (!tempInfo[2].equals("XXX")) {
					loanDate = tempInfo[2].trim();
				} else {
					loanDate = "";
				}
				String subAmount = "";
				if (!tempInfo[3].equals("XXX")) {
					subAmount = tempInfo[3].trim();
				} else {
					subAmount = "0.00";
				}
				String cntAmount = "";
				if (!tempInfo[4].equals("XXX")) {
					cntAmount = tempInfo[4].trim();
				} else {
					cntAmount = "0.00";
				}
				String loanType = "";
				if (!tempInfo[5].equals("XXX")) {
					loanType = tempInfo[5].trim();
				} else {
					loanType = "";
				}
				String insertLoanTabledata = "";
				insertLoanTabledata = "insert into  employee_pension_loans(cpfaccno,loandate,loanpurpose,loantype,sub_amt,CONT_AMT,airportcode,region)values('"
						+ cpfaccno
						+ "','"
						+ loanDate
						+ "','"
						+ loanPurpose
						+ "','"
						+ loanType
						+ "','"
						+ Float.parseFloat(subAmount)
						+ "','"
						+ cntAmount
						+ "','OFFICE COMPLEX','CHQIAD')";

				log.info(insertLoanTabledata);
				st.execute(insertLoanTabledata);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :loanTable leaving method");

	}

	public void loansPrincipleUpdate(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :loansPrincipleUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "";
				if (!tempInfo[0].equals("XXX")) {
					cpfaccno = tempInfo[0].trim();
				} else {
					cpfaccno = "";
				}

				String loanType = "";
				if (!tempInfo[5].equals("XXX")) {
					loanType = tempInfo[5].trim();
				} else {
					loanType = "";
				}
				String loanDate = "";
				if (!tempInfo[2].equals("XXX")) {
					loanDate = tempInfo[2].trim();
				} else {
					loanDate = "";
				}

				String transMonthYear = commonUtil.converDBToAppFormat(
						loanDate, "dd-MMM-yyyy", "-MMM-yyyy");
				String selectrefadv = " select  nvl(refadv,0) as refadv  from employee_pension_validate where region='CHQIAD' and airportcode='OFFICE COMPLEX' and cpfaccno='"
						+ cpfaccno
						+ "'  and to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "'";
				log.info("selectrefadv query " + selectrefadv);
				ResultSet rs1 = st.executeQuery(selectrefadv);
				String refAdv = "";
				if (rs1.next()) {
					if (rs1.getString("refAdv") != null) {
						refAdv = rs1.getString(1).toString();
					} else
						refAdv = "0.00";
					log.info("refAdv is " + refAdv);
				} else {
					refAdv = "0.00";
				}
				String empPrinciple = "";
				String loanamt = "select nvl(SUB_AMT,0)as SUB_AMT ,nvl(CONT_AMT,0) as CONT_AMT,LOANTYPE,loandate from employee_pension_loans where region='CHQIAD' and airportcode='OFFICE COMPLEX' and cpfaccno='"
						+ cpfaccno
						+ "' and  to_char(LOANDATE,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "'";
				log.info("loanamt query " + loanamt);
				ResultSet rs = st.executeQuery(loanamt);
				if (rs.next()) {
					String loantype = rs.getString("loantype");
					if (loantype.equals("RF")) {
						String subAmount = rs.getString("SUB_AMT").toString();
						empPrinciple = String.valueOf(Float
								.parseFloat(subAmount)
								- Float.parseFloat(refAdv));
						log.info("empPrinciple in if " + empPrinciple);
					} else if (loantype.equals("NRF")) {
						String subAmount = rs.getString("SUB_AMT").toString();
						String contAmount = rs.getString("CONT_AMT").toString();
						log.info("subAmount " + subAmount + "contAmount "
								+ contAmount + "refadv" + refAdv);
						empPrinciple = String.valueOf(Float
								.parseFloat(subAmount)
								+ Float.parseFloat(contAmount)
								- Float.parseFloat(refAdv));
						log.info("empPrinciple in else " + empPrinciple);
					}

				}
				String updatePrinciple = "update employee_pension_validate set EMPADVRECPRINCIPAL='"
						+ empPrinciple
						+ "' where region='CHQIAD' and airportcode='OFFICE COMPLEX' and cpfaccno='"
						+ cpfaccno
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "'";

				log.info("updatePrinciple " + updatePrinciple);
				st.execute(updatePrinciple);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :loanTable leaving method");

	}

	public void eastRegionEmployeeNamesUpdate(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :eastRegionEmployeeNamesUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setRegion(tempInfo[3].trim());
				} else {
					bean.setRegion("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				String updateTransaction = "";
				String updatePersonalinfo = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfacno='"
							+ bean.getCpfAcNo()
							+ "' and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and master_empname is null ";

				} else if (bean.getCpfAcNo() != "") {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfacno='"
							+ bean.getCpfAcNo().trim()
							+ "' and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and master_empname is null  ";
				} else {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "'and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "' and master_empname is null";
				}
				log.info(updatePersonalinfo);
				log.info(updateTransaction);
				st.execute(updatePersonalinfo);
				st.execute(updateTransaction);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :eastRegionEmployeeNamesUpdate leaving method");

	}

	public void northEastRegionEmployeeNamesUpdate(String xlsData)
			throws InvalidDataException {

		log
				.info("ImportDao :northEastRegionEmployeeNamesUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setRegion(tempInfo[3].trim());
				} else {
					bean.setRegion("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				String updateTransaction = "";
				String updatePersonalinfo = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfacno='"
							+ bean.getCpfAcNo()
							+ "' and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and master_empname is null ";

				} else if (bean.getCpfAcNo() != "") {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfacno='"
							+ bean.getCpfAcNo().trim()
							+ "' and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and master_empname is null  ";
				} else {
					updatePersonalinfo = "update employee_info set employeename='"
							+ bean.getEmpName().toUpperCase()
							+ "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='"
							+ bean.getRegion()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "'and employeename is null";
					updateTransaction = "update employee_pension_validate set master_empname='"
							+ bean.getEmpName().toUpperCase().trim()
							+ "' where region='"
							+ bean.getRegion()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "' and master_empname is null";
				}
				log.info(updatePersonalinfo);
				log.info(updateTransaction);
				st.execute(updatePersonalinfo);
				st.execute(updateTransaction);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log
				.info("ImportDao :northEastRegionEmployeeNamesUpdate leaving method");

	}

	public void SouthGenderUpdates(String xlsData) throws InvalidDataException {

		log.info("ImportDao :SouthGenderUpdates() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[1].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setSex(tempInfo[2].trim());
				} else {
					bean.setSex("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setRegion(tempInfo[3].trim());
				} else {
					bean.setRegion("");
				}
				String tempName = "";
				for (int j = 0; j < quats.length; j++) {
					if (bean.getEmpName().toLowerCase().indexOf(
							quats[j].toLowerCase()) != -1) {
						tempName = bean.getEmpName().toLowerCase().replaceAll(
								quats[j].toLowerCase(), "").trim();
						bean.setEmpName(tempName);
					}
				}
				log.info("Name===" + bean.getEmpName());
				String updateTransaction = "";
				String updatePersonalinfo = "";
				if (bean.getCpfAcNo() != "" && bean.getEmpNumber() != "") {
					updatePersonalinfo = "update employee_info set sex='"
							+ bean.getSex() + "' LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='" + bean.getRegion()
							+ "' and cpfacno='" + bean.getCpfAcNo()
							+ "' and empl and sex is null";

				} else if (bean.getCpfAcNo() != "") {
					updatePersonalinfo = "update employee_info set  sex='"
							+ bean.getSex() + "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='" + bean.getRegion()
							+ "' and cpfacno='" + bean.getCpfAcNo().trim()
							+ "' and  sex is null";

				} else {
					updatePersonalinfo = "update employee_info set  sex='"
							+ bean.getSex() + "',LASTACTIVE='"
							+ commonUtil.getCurrentDate("dd-MMM-yyyy")
							+ "' where region='" + bean.getRegion()
							+ "' and employeeno='" + bean.getEmpNumber()
							+ "'and  sex is null";

				}
				log.info(updatePersonalinfo);
				st.execute(updatePersonalinfo);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :eastRegionEmployeeNamesUpdate leaving method");

	}

	public void chqnadVPFUpdate(String xlsData) throws Exception {

		log.info("ImportDao :chqnadVPFUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[9].trim());
				} else {
					bean.setEmployeeVPF("");
				}
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}

				String remarks = "CHQNAD empvpf UPDATED";
				String transMonthYear = commonUtil.converDBToAppFormat(
						monthYear, "dd-MMM-yyyy", "-MMM-yyyy");
				log.info("transMonthYear " + transMonthYear);
				String updateEmpVpf = "update employee_pension_validate set empvpf='"
						+ bean.getEmployeeVPF()
						+ "',REMARKS=REMARKS||'"
						+ remarks
						+ "' where region='CHQNAD' AND CPFACCNO='"
						+ bean.getCpfAcNo() + "'";

				log.info(updateEmpVpf);
				st.execute(updateEmpVpf);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :chqnadVPFUpdate leaving method");

	}

	public void eastRegionEmoluemntUpdates(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :eastRegionEmoluemntUpdates() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", empPfstatuary = "", DAILYALLOWANCE = "";

				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					cpfaccno = tempInfo[1].trim();
				} else {
					cpfaccno = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					DAILYALLOWANCE = tempInfo[5].trim();
				} else {
					DAILYALLOWANCE = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					empPfstatuary = tempInfo[6].trim();
				} else {
					empPfstatuary = "0.00";
				}
				String airportCode = "";
				if (!tempInfo[8].equals("XXX")) {
					airportCode = tempInfo[8].trim();
				} else {
					airportCode = "";
				}

				String insertArrearCount = "";
				String checkBasic = "select count(*) as count from employee_pension_validate where (basic!='0' and basic!='0.00') and region='East Region' and cpfaccno='"
						+ cpfaccno + "' and monthyear='" + monthYear + "'";
				ResultSet rs = st.executeQuery(checkBasic);
				int count = 0, recordCount = 0;
				if (rs.next()) {
					recordCount = Integer.parseInt(rs.getString(1));
				}
				log.info("recordCount " + recordCount);
				if (recordCount >= 1) {
					insertArrearCount = "update employee_pension_validate set DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
							+ DAILYALLOWANCE
							+ "')) , emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ DAILYALLOWANCE
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ empPfstatuary
							+ "')) where region='East Region' and cpfaccno='"
							+ cpfaccno + "' and monthyear='" + monthYear + "'";
					count = st.executeUpdate(insertArrearCount);
				}
				String deleteRecord = "delete from employee_pension_validate where  region='East Region' and cpfaccno='"
						+ cpfaccno
						+ "' and monthyear='"
						+ monthYear
						+ "' and airportcode='" + airportCode + "'";
				log.info("count is" + count);
				if (count >= 2) {
					log.info("inside delete");
					st.executeUpdate(deleteRecord);
				}
				log.info("Update emoluemnts query " + insertArrearCount);
				log.info("deleteRecord  " + deleteRecord);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :eastRegionEmoluemntUpdates leaving method");

	}

	public void igiCargoArrearEmoluemntUpdates(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :igiCargoArrearEmoluemntUpdates() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					cpfarrear = tempInfo[5].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					emoluments = tempInfo[6].trim();
				} else {
					emoluments = "0.00";
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"CHQIAD");
				String updateArrears = "";
				int count = 0;
				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,AIRPORTCODE,REGION) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ bean.getEmpNumber()
						+ "','"
						+ bean.getEmpName()
						+ "','"
						+ monthYear
						+ "','"
						+ cpfarrear + "','IGICargo IAD','CHQIAD')";
				st.executeUpdate(insertArrear);
				if (!foundSalaryDate.equals("")) {
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear
							+ "'))  where   region='CHQIAD' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					count = st.executeUpdate(updateArrears);
				}
				log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :igiCargoArrearEmoluemntUpdates leaving method");

	}

	public void westRegionEmoluemntUpdates(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :westRegionEmoluemntUpdates() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", empPfstatuary = "", DAILYALLOWANCE = "";
				if (!tempInfo[1].equals("XXX")) {
					cpfaccno = tempInfo[1].trim();
				} else {
					cpfaccno = "";
				}
				String monthYear = "";
				if (!tempInfo[8].equals("XXX")) {
					monthYear = tempInfo[8].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[10].equals("XXX")) {
					DAILYALLOWANCE = tempInfo[10].trim();
				} else {
					DAILYALLOWANCE = "0.00";
				}
				if (!tempInfo[11].equals("XXX")) {
					empPfstatuary = tempInfo[11].trim();
				} else {
					empPfstatuary = "0.00";
				}
				String fpf = "";
				if (!tempInfo[12].equals("XXX")) {
					fpf = tempInfo[12].trim();
				} else {
					fpf = "0.00";
				}
				String vpf = "";
				if (!tempInfo[13].equals("XXX")) {
					vpf = tempInfo[13].trim();
				} else {
					vpf = "0.00";
				}
				String airportCode = "";
				if (!tempInfo[6].equals("XXX")) {
					airportCode = tempInfo[6].trim();
				} else {
					airportCode = "";
				}

				String insertArrearCount = "";
				// upto 2002(becoz transaction is escalated by one month
				// earlier.
				String checkBasic = "select count(*) as count from employee_pension_validate where (basic!='0' and basic!='0.00' and basic is not null) and region='West Region' and cpfaccno='"
						+ cpfaccno
						+ "' and  monthyear=to_char(add_months('"
						+ monthYear + "',1),'dd-Mon-yyyy')";
				// String checkBasic="select count(*) as count from
				// employee_pension_validate where (basic!='0' and
				// basic!='0.00') and region='West Region' and
				// cpfaccno='"+cpfaccno+"' and monthyear='"+monthYear+"'";
				log.info("checkBasic " + checkBasic);
				ResultSet rs = st.executeQuery(checkBasic);
				int count = 0, recordCount = 0;
				if (rs.next()) {
					recordCount = Integer.parseInt(rs.getString(1));
				}
				log.info("recordCount " + recordCount);
				if (recordCount >= 1) {
					insertArrearCount = "update employee_pension_validate set DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+'"
							+ DAILYALLOWANCE
							+ "')) , emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ DAILYALLOWANCE
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ empPfstatuary
							+ "'+'"
							+ fpf
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ vpf
							+ "'))  where region='West Region' and cpfaccno='"
							+ cpfaccno
							+ "' and  monthyear=to_char(add_months('"
							+ monthYear + "',1),'dd-Mon-yyyy')";
					// insertArrearCount ="update employee_pension_validate set
					// DAILYALLOWANCE=to_char(TO_NUMBER(nvl(DAILYALLOWANCE,0)+
					// '"+DAILYALLOWANCE+"'))
					// ,
					// emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+
					// '"+DAILYALLOWANCE+"'))
					// ,
					// EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+
					// '"+empPfstatuary+"'+'"+fpf+"')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"+vpf+"'))
					// where region='West Region' and cpfaccno='"+cpfaccno+"'
					// and monthyear='"+monthYear+"'";
					count = st.executeUpdate(insertArrearCount);
				}

				log.info("count is" + count);
				if (count >= 2) {
					log.info("inside delete");
					// st.executeUpdate(deleteRecord);
				}
				log.info("Update emoluments query " + insertArrearCount);
				// log.info("deleteRecord "+deleteRecord);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :westRegionEmoluemntUpdates leaving method");

	}

	public void importArrCountCHQNAD(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importArrCountCHQNAD() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo;
				if (!tempInfo[1].equals("XXX")) {
					cpfaccno = tempInfo[1].trim();
				} else {
					cpfaccno = "";
				}
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				String arrCount = "";
				if (!tempInfo[16].equals("XXX")) {
					arrCount = tempInfo[16].trim();
				} else {
					arrCount = "0.00";
				}

				String insertArrearCount = "";
				insertArrearCount = "update employee_pension_validate set ARRCOUNT='"
						+ arrCount
						+ "' where region='CHQNAD' and cpfaccno='"
						+ cpfaccno + "' and monthyear='" + monthYear + "'";
				st.executeUpdate(insertArrearCount);
				log.info("Update ArrearCount " + insertArrearCount);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importArrCountCHQNAD leaving method");

	}

	public void importEastArr9697(String xlsData) throws Exception {
		log.info("ImportDao :importEastArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					cpfarrear = tempInfo[5].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					emoluments = tempInfo[6].trim();
				} else {
					emoluments = "0.00";
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"CHQIAD");
				String updateArrears = "";
				int count = 0;
				String noofMonthsQuery = "select round(months_between('01-Mar-1996',NVL(DATEOFJOINING,'01-Apr-1995'))) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo() + "' AND REGION='CHQIAD'";
				ResultSet rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				Date dateofjoing = null;
				if (rs.next()) {
					months = Integer.parseInt(rs.getString("months"));
					dateofjoing = rs.getDate("doj");

				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and region='CHQIAD' AND airportcode='KOLKATA'";
				ResultSet rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					// emolumentsCountno += 12;
					emolumentsCountno += 4;
				}
				String emoluments1 = "", cpfarrear1 = "";
				log.info("dateofjoining " + dateofjoing);
				if (!dateofjoing.equals(null)
						&& dateofjoing.before(new Date("01-Apr-95"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,REGION,AIRPORTCODE) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ bean.getEmpNumber()
						+ "','"
						+ bean.getEmpName()
						+ "','"
						+ monthYear
						+ "','"
						+ cpfarrear + "','CHQIAD','KOLKATA')";
				st.addBatch(insertArrear);
				if (!foundSalaryDate.equals("")) {
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "'))  where   region='CHQIAD' AND AIRPORTCODE='KOLKATA' and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					st.addBatch(updateArrears);

				}
				int count1[] = st.executeBatch();
				log.info("count is" + count1.length);
				log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importEastArr9697 leaving method");

	}
   //latest code for arrear North9697
	public void importNorthArr9697(String xlsData) throws InvalidDataException {
		log.info("ImportDao :importNorthArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "", pensionNo = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					emoluments = tempInfo[2].trim();
				} else {
					emoluments = "0.00";
				}
				if (!tempInfo[3].equals("XXX")) {
					pensionNo = tempInfo[3].trim();
				} else {
					pensionNo = "0.00";
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setStation(tempInfo[4].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setRegion(tempInfo[5].trim());
				} else {
					bean.setRegion("");
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, pensionNo, bean.getEmpNumber(), bean
								.getRegion());
				String updateArrears = "";
				int count = 0;
				String dateofjoing = "";
				String dojquery = "select (CASE WHEN (DATEOFJOINING between '01-Apr-1945' and '01-Jan-1989') THEN '01-Jan-1989'  ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy')  END) as doj,pensionno as empserialnumber  from employee_personal_info WHERE pensionno='"
						+pensionNo
						+ "'";
				rs = st.executeQuery(dojquery);
				if (rs.next()) {
					if (rs.getString("doj") != null) {
						dateofjoing = rs.getString("doj").toString();
					} else {
						dateofjoing = "";
					}
					if (rs.getString("empserialnumber") != null) {
						pensionNo = rs.getString("empserialnumber");
					}
				}
				int months = 0;
				if (dateofjoing != "") {
					String noofMonthsQuery = "select round(months_between(last_day('01-Aug-1996'),'"
							+ dateofjoing
							+ "')) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_personal_info WHERE pensionno='"
							+ pensionNo
							+ "'";
					log.info("noofMonthsQuery " + noofMonthsQuery);
					rs = st.executeQuery(noofMonthsQuery);

					if (rs.next()) {
						months = Integer.parseInt(rs.getString("months"));
					}
				}
				String countMonthsfromMaytoArreardate = "select round(months_between(last_day('01-Aug-1996'),'01-Dec-1995')) as months from dual";
				rs2 = st.executeQuery(countMonthsfromMaytoArreardate);
				int countMonthsfromMaytoArrearsdate = 0;
				if (rs2.next()) {
					countMonthsfromMaytoArrearsdate = Integer.parseInt(rs
							.getString("months"));
				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and pensionno='"
						+pensionNo
						+ "'";
				rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					// for CHQIAD KOLKATA 12
					emolumentsCountno += 9;
				}
				String emoluments1 = "0.00", cpfarrear1 = "0.00";
				log.info("dateofjoining " + dateofjoing);
				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
				Date transdate = null;
				if (dateofjoing != "") {
					transdate = df.parse(dateofjoing);
					if (transdate.before(new Date("01-Apr-1995"))) {
						df.parse(dateofjoing);
						emoluments1 = String.valueOf(Math.round(Double
								.parseDouble(emoluments)
								* emolumentsCountno / (months)));
						cpfarrear1 = String.valueOf(Math.round(Double
								.parseDouble(emoluments1) * (0.1)));
					} else {
						emoluments1 = emoluments;
						cpfarrear1 = cpfarrear;
					}
				}
				log.info("dateofjoing" + dateofjoing);
				log.info("foundSalaryDate" + foundSalaryDate);
				if (!dateofjoing.equals(null) && dateofjoing != ""
						&& !foundSalaryDate.trim().equals("")) {
					String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION,pensionno) values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ monthYear
							+ "','"
							+ emoluments1
							+ "','"
							+ bean.getRegion()
							+ "','"
							+ pensionNo + "')";
					st.addBatch(insertArrear);
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "')),pensionNo='"
							+ pensionNo
							+ "',remarks='Updated as on 30-Jun-2011'  where REGION='"
							+ bean.getRegion()
							+ "' and empflag='Y'  and pensionno='"
							+pensionNo
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";

					st.addBatch(updateArrears);
					int count1[] = st.executeBatch();
					log.info("count is" + count1.length);
					conn.commit();
					String updateemoluments_log = "update emoluments_log set (newemoluments,newemppfstatuary)=(select emoluments, emppfstatuary from employee_pension_validate   where region = '"
							+ bean.getRegion()
							+ "' and   to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear
							+ "' and  pensionno='"
							+ pensionNo
							+ "' and empflag='Y') where region = '"
							+ bean.getRegion()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear
							+ "' and  pensionno='"
							+ pensionNo + "' ";
					log.info(updateemoluments_log);
					st.executeUpdate(updateemoluments_log);

				} else {
					String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION,arrearflag,pensionno) values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ monthYear
							+ "','"
							+ emoluments1
							+ "','"
							+ bean.getRegion()
							+ "','N','"
							+ pensionNo + "')";
					st.executeUpdate(insertArrear);
				}

				// log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importNorthArr9697 leaving method");

	}

	//new codre for IAD Arrears
	public void importIADArr9697(String xlsData) throws InvalidDataException {
		log.info("ImportDao :importIAD9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "", pensionNo = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					emoluments = tempInfo[2].trim();
				} else {
					emoluments = "0.00";
				}
				if (!tempInfo[3].equals("XXX")) {
					pensionNo = tempInfo[3].trim();
				} else {
					pensionNo = "0.00";
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setRegion(tempInfo[4].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setStation(tempInfo[5].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setRemarks(tempInfo[6].trim());
				} else {
					bean.setRemarks("");
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, pensionNo, bean.getEmpNumber(), bean
								.getRegion());
				String updateArrears = "";
				int count = 0;
				String dateofjoing = "";
				String dojquery = "select (CASE WHEN (DATEOFJOINING between '01-Apr-1945' and '01-Jan-1992') THEN '01-Jan-1992'  ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy')  END) as doj,pensionno as empserialnumber   from employee_personal_info WHERE pensionno='"
						+ pensionNo
						+ "'";
				rs = st.executeQuery(dojquery);
				if (rs.next()) {
					if (rs.getString("doj") != null) {
						dateofjoing = rs.getString("doj").toString();
					} else {
						dateofjoing = "";
					}
					if (rs.getString("empserialnumber") != null) {
						pensionNo = rs.getString("empserialnumber");
					}
				}
				int months = 0;
				if (dateofjoing != "") {
					String noofMonthsQuery = "select round(months_between('"
							+ monthYear
							+ "','"
							+ dateofjoing
							+ "')) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_personal_info WHERE pensionno='"
							+pensionNo+ "'";
					log.info("noofMonthsQuery " + noofMonthsQuery);
					rs = st.executeQuery(noofMonthsQuery);

					if (rs.next()) {
						months = Integer.parseInt(rs.getString("months"));
					}
				}
				String countMonthsfromMaytoArreardate = "select round(months_between('"
						+ monthYear + "','01-Dec-1995')) as months from dual";
				rs2 = st.executeQuery(countMonthsfromMaytoArreardate);
				int countMonthsfromMaytoArrearsdate = 0;
				if (rs2.next()) {
					countMonthsfromMaytoArrearsdate = Integer.parseInt(rs
							.getString("months"));
				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and pensionno='"
						+ pensionNo
						+ "' ";
				rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					// for CHQIAD KOLKATA 12
					emolumentsCountno += countMonthsfromMaytoArrearsdate;
				}
				String emoluments1 = "0.00", cpfarrear1 = "0.00";
				log.info("dateofjoining " + dateofjoing);
				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
				Date transdate = null;
				if (dateofjoing != "") {
					transdate = df.parse(dateofjoing);
					if (transdate.before(new Date("01-Apr-1995"))) {
						df.parse(dateofjoing);
						emoluments1 = String.valueOf(Math.round(Double
								.parseDouble(emoluments)
								* emolumentsCountno / (months)));
						cpfarrear1 = String.valueOf(Math.round(Double
								.parseDouble(emoluments1) * (0.1)));
					} else {
						emoluments1 = emoluments;
						cpfarrear1 = cpfarrear;
					}
				}
				String Insertemoluments_log = "insert into emoluments_log(oldemoluments,oldemppfstatuary,cpfacno,pensionno,region,monthyear,updateddate)(select emoluments,emppfstatuary,cpfaccno,pensionno,region,'"
						+ monthYear
						+ "','06-Oct-2010' from employee_pension_validate where region='"
						+ bean.getRegion()
						+ "' and airportcode='"
						+ bean.getStation()
						+ "' and to_char(monthyear,'dd-Mon-yyyy')='"
						+ monthYear
						+ "' and cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and empflag='N')";
				log.info("Insertemoluments_log" + Insertemoluments_log);
				// st1.executeUpdate(Insertemoluments_log);
				log.info("dateofjoing" + dateofjoing);
				log.info("foundSalaryDate" + foundSalaryDate);
				if (!dateofjoing.equals(null) && dateofjoing != ""
						&& !foundSalaryDate.trim().equals("")) {
					String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION,pensionno,airportcode) values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ monthYear
							+ "','"
							+ emoluments1
							+ "','"
							+ bean.getRegion()
							+ "','"
							+ pensionNo + "','" + bean.getStation() + "')";
					st.addBatch(insertArrear);
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "')),pensionNo='"
							+ pensionNo
							+ "',remarks=remarks||'"
							+ bean.getRemarks()
							+ "'  where REGION='"
							+ bean.getRegion()
							+ "' and empflag='Y'  and pensionno='"
							+ pensionNo
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear
							+ "' ";

					st.addBatch(updateArrears);
					int count1[] = st.executeBatch();
					log.info("count is" + count1.length);
					conn.commit();
					String updateemoluments_log = "update emoluments_log set (newemoluments,newemppfstatuary)=(select emoluments, emppfstatuary from employee_pension_validate   where region = '"
							+ bean.getRegion()
							+ "' and  monthyear = '"
							+ monthYear
							+ "' and  pensionno='"
							+ pensionNo
							+ "' and empflag='Y') where region = '"
							+ bean.getRegion()
							+ "' and  monthyear = '"
							+ monthYear
							+ "' and  pensionno='"
							+ pensionNo+ "' ";
					log.info(updateemoluments_log);
					st.executeUpdate(updateemoluments_log);

				} else {
					String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION,arrearflag,pensionno,AIRPORTCODE) values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ monthYear
							+ "','"
							+ cpfarrear
							+ "','"
							+ bean.getRegion()
							+ "','N','"
							+ pensionNo + "','" + bean.getStation() + "')";
					st.executeUpdate(insertArrear);
				}

				// log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null || st1 != null) {
				try {
					st.close();
					st1.close();
					st = null;
					conn.close();
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}

		log.info("ImportDao :importIADArr9697 leaving method");
	}

	// commented below code
	/*
	 * public void importNorthArr9697(String xlsData) throws
	 * InvalidDataException {
	 * log.info("ImportDao :importNorthArr9697 entering method"); ArrayList
	 * xlsDataList = new ArrayList(); xlsDataList =
	 * commonUtil.getTheList(xlsData, "***"); Connection conn = null; Statement
	 * st = null; EmpMasterBean bean = null; String tempInfo[] = null; String
	 * tempData = ""; FileWriter fw = null; char[] delimiters = { '"', ',',
	 * '\'', '*', ',' }; String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.",
	 * "smt." }; String uploadFilePath = ""; String xlsEmpName = ""; ResultSet
	 * rs=null; ResultSet rs1=null; ResultSet rs2=null; log.debug("xlsData " +
	 * xlsData + "Size" + xlsDataList.size());
	 * 
	 * try { ResourceBundle bundle = ResourceBundle
	 * .getBundle("aims.resource.DbProperties"); uploadFilePath =
	 * bundle.getString("upload.folder.path"); File filePath = new
	 * File(uploadFilePath); if (!filePath.exists()) { filePath.mkdirs(); } fw =
	 * new FileWriter(new File(filePath + "//recordMissing.txt")); conn =
	 * commonDB.getConnection(); st = conn.createStatement(); for (int i = 1; i
	 * < xlsDataList.size(); i++) { bean = new EmpMasterBean(); tempData =
	 * xlsDataList.get(i).toString(); tempInfo = tempData.split("@"); String
	 * cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "",
	 * emoluments = "", empPfstatuary = "", DAILYALLOWANCE = ""; String
	 * monthYear = ""; if (!tempInfo[0].equals("XXX")) { monthYear =
	 * tempInfo[0].trim(); } else { monthYear = ""; } if
	 * (!tempInfo[1].equals("XXX")) { bean.setCpfAcNo(tempInfo[1].trim()); }
	 * else { bean.setCpfAcNo(""); }
	 * 
	 * if (!tempInfo[2].equals("XXX")) { emoluments = tempInfo[2].trim(); } else
	 * { emoluments = "0.00"; } if (!tempInfo[3].equals("XXX")) { cpfarrear =
	 * tempInfo[3].trim(); } else { cpfarrear = "0.00"; } String foundSalaryDate
	 * = this.checkFinanceDuplicate(conn, monthYear, bean.getCpfAcNo(),
	 * bean.getEmpNumber(), "RAUSAP"); String updateArrears = ""; int count = 0;
	 * String dateofjoing = null; Stringdojquery=
	 * "select (CASE WHEN (NVL(DATEOFJOINING,'01-Apr-1995') between '01-Apr-1945' and '01-Jan-1989') THEN '01-Jan-1989'  ELSE  to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')  END) as doj   from employee_info WHERE CPFACNO='"
	 * + bean.getCpfAcNo() + "' and REGION='RAUSAP'"; rs =
	 * st.executeQuery(dojquery); if(rs.next()){ dateofjoing=
	 * rs.getString("doj");
	 * 
	 * } String noofMonthsQuery =
	 * "select round(months_between(last_day('01-Aug-1996'),'"+dateofjoing+
	 * "')) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_info WHERE CPFACNO='"
	 * + bean.getCpfAcNo() + "' AND REGION='RAUSAP'"; rs =
	 * st.executeQuery(noofMonthsQuery); int months = 0; if (rs.next()) { months
	 * = Integer.parseInt(rs.getString("months")); } String
	 * countMonthsfromMaytoArreardate=
	 * "select round(months_between(last_day('01-Aug-1996'),'01-Dec-1995')) as months from dual"
	 * ; rs2 = st.executeQuery(countMonthsfromMaytoArreardate); int
	 * countMonthsfromMaytoArrearsdate=0; if (rs2.next()) {
	 * countMonthsfromMaytoArrearsdate =
	 * Integer.parseInt(rs.getString("months")); } String emolumentsCount =
	 * "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and cpfaccno='"
	 * + bean.getCpfAcNo() + "' and region='RAUSAP'"; rs1 =
	 * st.executeQuery(emolumentsCount); int emolumentsCountno = 0;
	 * 
	 * if (rs1.next()) { emolumentsCountno =
	 * Integer.parseInt(rs.getString("count")); // for East Region 9 // for
	 * CHQIAD KOLKATA 12 emolumentsCountno += 9; } String emoluments1 = "",
	 * cpfarrear1 = ""; log.info("dateofjoining " + dateofjoing); DateFormat df
	 * = new SimpleDateFormat("dd-MMM-yyyy"); Date transdate =
	 * df.parse(dateofjoing); if (!dateofjoing.equals(null) &&
	 * transdate.before(new Date("01-Apr-1995"))) { emoluments1 =
	 * String.valueOf(Math.round(Double .parseDouble(emoluments)
	 * emolumentsCountno / (months))); cpfarrear1 =
	 * String.valueOf(Math.round(Double .parseDouble(emoluments1) (0.1))); }
	 * else { emoluments1 = emoluments; cpfarrear1 = cpfarrear; }
	 * 
	 * 
	 * 
	 * if (!foundSalaryDate.equals("")) { String insertArrear =
	 * "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION) values('"
	 * + bean.getCpfAcNo() + "','" + monthYear + "','" + cpfarrear +
	 * "','RAUSAP')"; st.addBatch(insertArrear); String transMonthYear =
	 * commonUtil.converDBToAppFormat( monthYear.trim(), "dd-MMM-yy",
	 * "-MMM-yy"); updateArrears =
	 * "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
	 * + emoluments1 +
	 * "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'" +
	 * cpfarrear1 + "'))  where   region='RAUSAP'  and cpfaccno='" +
	 * bean.getCpfAcNo() + "' and  to_char(monthyear,'dd-Mon-yy') like '%" +
	 * transMonthYear + "'"; st.addBatch(updateArrears);
	 * 
	 * } int count1[] = st.executeBatch(); log.info("count is" + count1.length);
	 * //log.info("insertArrear " + insertArrear); log.info("updateArrears " +
	 * updateArrears);
	 * 
	 * } } catch (Exception e) { log.printStackTrace(e); }
	 * 
	 * log.info("ImportDao :importNorthArr9697 leaving method");
	 * 
	 * }
	 */
	public void importChqnadArr9697(String xlsData) throws InvalidDataException {
		log
				.info("ImportDao :importChqnadArr9697 bifurcalculaiton entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[3].equals("XXX")) {
					cpfarrear = tempInfo[3].trim();
				} else {
					cpfarrear = "0";
				}

				emoluments = String.valueOf((Integer.parseInt(cpfarrear) * 10));
				/*
				 * if (!tempInfo[2].equals("XXX")) { emoluments =
				 * tempInfo[2].trim(); } else { emoluments = "0.00"; }
				 */

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"CHQNAD");
				String updateArrears = "";
				int count = 0;
				String noofMonthsQuery = "select round(months_between('01-Nov-1996',NVL(DATEOFJOINING,'01-Apr-1995'))) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo() + "' AND REGION='CHQNAD'";
				ResultSet rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				Date dateofjoing = null;
				if (rs.next()) {
					months = Integer.parseInt(rs.getString("months"));
					dateofjoing = rs.getDate("doj");

				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and cpfaccno='"
						+ bean.getCpfAcNo() + "' and region='CHQNAD'";
				ResultSet rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					// for CHQIAD KOLKATA 12
					emolumentsCountno += 9;
				}
				String emoluments1 = "", cpfarrear1 = "";
				log.info("dateofjoining " + dateofjoing);
				if (!dateofjoing.equals(null)
						&& dateofjoing.before(new Date("01-Apr-95"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ monthYear
						+ "','"
						+ cpfarrear + "','CHQNAD')";
				st.addBatch(insertArrear);
				if (!foundSalaryDate.equals("")) {
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "'))  where   region='CHQNAD'  and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					st.addBatch(updateArrears);

				}
				int count1[] = st.executeBatch();
				log.info("count is" + count1.length);
				log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log
				.info("ImportDao :importChqnadArr9697  bifulcalculation leaving method");

	}

	public void importOfficeComplexArr9697(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :importOfficeComplexArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[7].equals("XXX")) {
					cpfarrear = tempInfo[7].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[7].equals("XXX")) {
					emoluments = String.valueOf(Math.round(Double
							.parseDouble(cpfarrear) * 10));
				} else {
					emoluments = "0.00";
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"CHQIAD");

				String updateArrears = "";
				int count = 0;
				String noofmonthsFrmmay95toTransactionDate = "select round(months_between('"
						+ monthYear
						+ "',NVL('01-May-1995','01-May-1995'))) as count from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo() + "' AND REGION='CHQIAD'";
				String noofMonthsQuery = "select round(months_between('"
						+ monthYear
						+ "', NVL( (CASE WHEN DATEOFJOINING <= to_date('01-Jan-1992', 'dd-Mon-yyyy') then  '01-Jan-1992'   ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy') END), '01-Apr-1995'))) as months, to_date(to_char(NVL(DATEOFJOINING, '01-Apr-1995'), 'dd-Mon-yyyy')) as doj from employee_info info WHERE CPFACNO = '"
						+ bean.getCpfAcNo() + "' AND REGION = 'CHQIAD'";
				ResultSet rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				Date dateofjoing = null;
				if (rs.next()) {
					months = Integer.parseInt(rs.getString("months"));
					dateofjoing = rs.getDate("doj");

				}

				ResultSet rs1 = st
						.executeQuery(noofmonthsFrmmay95toTransactionDate);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));

				}
				String emoluments1 = "", cpfarrear1 = "";
				log.info("dateofjoining " + dateofjoing);
				if (!dateofjoing.equals(null)
						&& dateofjoing.before(new Date("01-Apr-95"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}
				String transMonthYear = commonUtil.converDBToAppFormat(
						monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
				String updateTransaction = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
						+ emoluments1
						+ "')),EMPPFSTATUARY =to_char(TO_NUMBER(nvl(EMPPFSTATUARY ,0)+'"
						+ cpfarrear1
						+ "')) where cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and region='CHQIAD' and to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "'";
				log.info("update transaction " + updateTransaction);
				st.executeUpdate(updateTransaction);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}
		log.info("ImportDao : OfficeCOmplex leaving method");

	}

	public void importIGIArr9697(String xlsData, String username,
			String computername) throws InvalidDataException {
		log.info("ImportDao :importIGIArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		String emoluments_log = "", emoluments_log_history = "";
		String emppfstatuary = "0.00", oldemoluments = "0.00", oldemppfstatuary = "";
		String emoluments1 = "", cpfarrear1 = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					bean.setEmpNumber(tempInfo[0].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					cpfarrear = tempInfo[6].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					emoluments = String.valueOf(Math.round(Double
							.parseDouble(cpfarrear) * 10));
				} else {
					emoluments = "0.00";
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"CHQIAD");
				String updateArrears = "";
				int count = 0;
				String noofmonthsFrmmay95toTransactionDate = "select round(months_between('"
						+ monthYear
						+ "',NVL('01-May-1995','01-May-1995'))) as count from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo() + "' AND REGION='CHQIAD'";
				String noofMonthsQuery = "select round(months_between('"
						+ monthYear
						+ "', NVL( (CASE WHEN DATEOFJOINING <= to_date('01-Jan-1992', 'dd-Mon-yyyy') then  '01-Jan-1992'   ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy') END), '01-Apr-1995'))) as months, to_date(to_char(NVL(DATEOFJOINING, '01-Apr-1995'), 'dd-Mon-yyyy')) as doj from employee_info info WHERE CPFACNO = '"
						+ bean.getCpfAcNo() + "' AND REGION = 'CHQIAD'";
				rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				Date dateofjoing = null;
				if (rs.next()) {
					months = Integer.parseInt(rs.getString("months"));
					dateofjoing = rs.getDate("doj");

				}
				ResultSet rs1 = st
						.executeQuery(noofmonthsFrmmay95toTransactionDate);
				int emolumentsCountno = 0;
				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
				}
				if (!dateofjoing.equals(null)
						&& dateofjoing.before(new Date("01-Apr-95"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}
				String transMonthYear = commonUtil.converDBToAppFormat(
						monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
				Date transdate = df.parse(monthYear);
				String updateTransaction = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
						+ emoluments1
						+ "')),EMPPFSTATUARY =to_char(TO_NUMBER(nvl(EMPPFSTATUARY ,0)+'"
						+ cpfarrear1
						+ "')) where cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and region='CHQIAD' and to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "'";
				log.info("update transaction " + updateTransaction);

				// new code for tracking
				ImportDao IDAO = new ImportDao();
				oldemoluments = IDAO.getEmoluments(conn, monthYear, bean
						.getCpfAcNo(), "", "CHQIAD", "");
				if ((transdate.after(new Date("31-Mar-1998"))
						&& oldemoluments != "" && Float
						.parseFloat(oldemoluments) != 0.00)) {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 12 / 100);
				} else if (oldemoluments != ""
						&& Float.parseFloat(oldemoluments) != 0.00) {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 10 / 100);
				}

				String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");

				log.info(" update transaction" + updateTransaction);
				st.executeUpdate(updateTransaction);
				String newemolumentsQuery = "select emoluments,EMPPFSTATUARY from employee_pension_validate where cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "' and region='CHQIAD'";
				String newemoluments = "", newcpf = "";
				rs = st.executeQuery(newemolumentsQuery);
				while (rs.next()) {
					newemoluments = rs.getString("emoluments");
					newcpf = rs.getString("EMPPFSTATUARY");
				}

				emoluments_log = "update emoluments_log set newemoluments='"
						+ newemoluments + "',NEWEMPPFSTATUARY='" + newcpf
						+ "', monthyear='" + monthYear + "',UPDATEDDATE='"
						+ updatedDate
						+ "',pensionno='',region='CHQIAD',username='"
						+ username + "',computername='" + computername
						+ "' where cpfacno='" + bean.getCpfAcNo()
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "' and region='CHQIAD'";
				emoluments_log_history = "update emoluments_log_history set oldemoluments='"
						+ oldemoluments
						+ "',OLDEMPPFSTATUARY='"
						+ oldemppfstatuary
						+ "', newemoluments='"
						+ newemoluments
						+ "',NEWEMPPFSTATUARY='"
						+ newcpf
						+ "', monthyear='"
						+ monthYear
						+ "',UPDATEDDATE='"
						+ updatedDate
						+ "',pensionno='',region='CHQIAD',username='"
						+ username
						+ "',computername='"
						+ computername
						+ "' where cpfacno='"
						+ bean.getCpfAcNo()
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear + "' and region='CHQIAD'";
				log.info("emoluments_log .." + emoluments_log);
				log.info("emoluments_log_history " + emoluments_log_history);

				st.executeUpdate(emoluments_log);
				st.executeUpdate(emoluments_log_history);

			}

		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(conn, st, rs);
		}

		log.info("ImportDao : importIGIArr9697 leaving method");

	}

	public void importNERArr9697(String xlsData) throws InvalidDataException {
		log.info("ImportDao :importNERArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpNumber(tempInfo[2].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setDesegnation(tempInfo[4].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[5].equals("XXX")) {
					cpfarrear = tempInfo[5].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					emoluments = String.valueOf(Math.round(Double
							.parseDouble(cpfarrear) * 10));
				} else {
					emoluments = "0.00";
				}
				emoluments = String.valueOf(Math.round(Double
						.parseDouble(cpfarrear) * 10));
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"North-East Region");
				String foundArrearDate = this.checkFinanceArrear(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"North-East Region");
				String updateArrears = "";
				int count = 0;
				String noofMonthsQuery = "select round(months_between('01-Aug-1996',NVL(DATEOFJOINING,'01-Apr-1995'))) as months,to_date(to_char(NVL(DATEOFJOINING,'01-Apr-1995'),'dd-Mon-yyyy')) as doj from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo()
						+ "' AND REGION='North-East Region'";
				ResultSet rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				Date dateofjoing = null;
				if (rs.next()) {
					months = Integer.parseInt(rs.getString("months"));
					dateofjoing = rs.getDate("doj");

				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and region='North-East Region'";
				ResultSet rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;

				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					emolumentsCountno += 9;
				}
				String emoluments1 = "", cpfarrear1 = "";
				log.info("dateofjoining " + dateofjoing);
				if (!dateofjoing.equals(null)
						&& dateofjoing.before(new Date("01-Apr-95"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR(CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,REGION) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ bean.getEmpNumber()
						+ "','"
						+ bean.getEmpName()
						+ "','"
						+ monthYear
						+ "','"
						+ cpfarrear + "','North-East Region')";
				String transMonthYear = commonUtil.converDBToAppFormat(
						monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
				if (foundArrearDate.equals("")) {
					st.addBatch(insertArrear);
				} else {
					insertArrear = "update EMPLOYEE_PENSION_ARREAR  set ARREARAMT=to_char(TO_NUMBER(nvl(ARREARAMT,0)+'"
							+ cpfarrear
							+ "'))  where   region='North-East Region'  and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(ARREARDATE,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";

					st.addBatch(insertArrear);
				}
				if (!foundSalaryDate.equals("")) {

					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "'))  where   region='North-East Region'  and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					st.addBatch(updateArrears);

				}
				int count1[] = st.executeBatch();
				log.info("count is" + count1.length);
				log.info("insertArrear " + insertArrear);
				log.info("updateArrears " + updateArrears);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao : importEastArr9697 leaving method");

	}

	public void importArrCountCHQNAD9697(String xlsData)
			throws InvalidDataException {
		int total = 0;
		log.info("ImportDao :importArrCountCHQNAD() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", empName = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo;
				if (!tempInfo[0].equals("XXX")) {
					cpfaccno = tempInfo[0].trim();
				} else {
					cpfaccno = "";
				}
				String monthYear = "";
				if (!tempInfo[1].equals("XXX")) {
					monthYear = tempInfo[1].trim();
				} else {
					monthYear = "";
				}

				if (!tempInfo[2].equals("XXX")) {
					empName = tempInfo[2].trim();
				} else {
					empName = "";
				}
				int arrCount = 0, arreCal = 0;
				if (!tempInfo[4].equals("XXX")) {
					arrCount = Integer.parseInt(tempInfo[4].trim());
				}

				if (!tempInfo[5].equals("XXX")) {
					arreCal = Integer.parseInt(tempInfo[5].trim());
				}
				String empNumber = "";
				if (!tempInfo[6].equals("XXX")) {
					empNumber = tempInfo[6].trim();
				}
				log.info("empnm " + empNumber);
				// for chqnad arreCal
				// arreCal = (arrCount) * 100 / 10;

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,REGION,AIRPORTCODE) values('"
						+ cpfaccno
						+ "','"
						+ empNumber
						+ "','"
						+ empName
						+ "','"
						+ monthYear
						+ "','"
						+ arrCount
						+ "','CHQNAD','CHQNAD')";
				String insertArrearCount = "";
				monthYear = commonUtil.converDBToAppFormat(monthYear,
						"dd-MMM-yyyy", "MMM-yyyy");
				insertArrearCount = "update employee_pension_validate set EMOLUMENTS=EMOLUMENTS+"
						+ arreCal
						+ ", EMPPFSTATUARY=EMPPFSTATUARY+"
						+ arrCount
						+ " where region='CHQNAD' and cpfaccno='"
						+ cpfaccno
						+ "' and to_char(monthyear,'Mon-yyyy')='"
						+ monthYear
						+ "'";
				log.info("Update ArrearCount " + insertArrearCount);
				log.info("insertArrear " + insertArrear);
				// int cout = st.executeUpdate(insertArrearCount);
				// total = total + cout;
				st.addBatch(insertArrear);
				st.addBatch(insertArrearCount);
				int count[] = st.executeBatch();
				log.info("count is" + count.length);

			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importArrCountCHQNAD leaving method");

	}

	public void generateNewPFIDs(String xlsData, String userName,
			String ipAddress) {

		log.info("ImportDao :generateNewPFIDs() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setRegion(tempInfo[5].trim());
				} else {
					bean.setRegion("");
				}

				String sequenceNO = PersonalDAO.getSequenceNo(conn);

				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				PersonalDAO.addPersonalInfo(sequenceNO, bean.getCpfAcNo(),
						lastactive, bean.getRegion(), userName, ipAddress,
						lastactive);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :updateMasterNmtoTrans leaving method");

	}

	public void updateEmployeenametoMasterFromTrans(String xlsData,
			String userName, String ipAddress) {

		log
				.info("ImportDao :updateEmployeenametoMasterFromTrans() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setRegion(tempInfo[4].trim());
				} else {
					bean.setRegion("");
				}
				log.info("cpfaccno " + bean.getCpfAcNo() + " region "
						+ bean.getRegion());
				String empName = "";
				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				String selectEmpName = "select distinct(employeename) from employee_pension_validate where region='"
						+ bean.getRegion()
						+ "' and cpfaccno='"
						+ bean.getCpfAcNo() + "'";
				ResultSet rs = st.executeQuery(selectEmpName);

				if (rs.next()) {
					if (rs.getString("employeename") != null) {
						empName = rs.getString("employeename");
						st
								.executeQuery("update employee_info set employeename='"
										+ empName
										+ "',LASTACTIVE='"
										+ lastactive
										+ "',username='"
										+ userName
										+ "' where region='"
										+ bean.getRegion()
										+ "' and cpfacno='"
										+ bean.getCpfAcNo() + "'");
					}
				}

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :updateMasterNmtoTrans leaving method");

	}

	public void updateFinaceDatahavingCpfaccnoBlank(String xlsData,
			String userName, String ipAddress) {

		log
				.info("ImportDao :updateFinaceDatahavingCpfaccnoBlank() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[3].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setRegion(tempInfo[8].trim());
				} else {
					bean.setRegion("");
				}
				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				String cpfaccno = commonDAO.checkEmployeeInfo1(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				String insertCpfaccno = "";
				if (!cpfaccno.equals("")) {
					bean.setCpfAcNo(cpfaccno);
				} else {
					cpfaccno = bean.getRegion().substring(0, 2) + "-"
							+ bean.getEmpNumber();
					bean.setCpfAcNo(cpfaccno);
					insertCpfaccno = "insert into employee_info (cpfacno,employeeno,employeename,region,userName,LASTACTIVE) values('"
							+ cpfaccno
							+ "','"
							+ bean.getEmpNumber()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ bean.getRegion()
							+ "','" + userName + "','" + lastactive + "')";
					st.executeUpdate(insertCpfaccno);
				}
				String foundSalaryDate = commonDAO.checkFinanceDuplicate(conn,
						monthYear, "", bean.getEmpNumber(), bean.getRegion()
								.trim());
				String updateCpfaccno = "";
				if (!foundSalaryDate.equals("")) {
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateCpfaccno = "update employee_pension_validate set  cpfaccno='"
							+ bean.getCpfAcNo()
							+ "',activeflag='N'  where   region='"
							+ bean.getRegion()
							+ "' and employeeno='"
							+ bean.getEmpNumber()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					st.executeUpdate(updateCpfaccno);
				}
				log.info("updateCpfaccno " + updateCpfaccno);
				log.info("insertCpfaccno " + insertCpfaccno);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log
				.info("ImportDao :updateFinaceDatahavingCpfaccnoBlank leaving method");

	}

	public void updateFinaceDatahavingCpfaccnoBlank1(String xlsData,
			String userName, String ipAddress) {
		log
				.info("ImportDao :updateFinaceDatahavingCpfaccnoBlank1() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String monthYear = "";
				if (!tempInfo[0].equals("XXX")) {
					monthYear = tempInfo[0].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[3].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmpName(xlsEmpName.trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setBasic(tempInfo[5].trim());
				} else {
					bean.setBasic("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setEmoluments(tempInfo[6].trim());
				} else {
					bean.setEmoluments("");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setRegion(tempInfo[8].trim());
				} else {
					bean.setRegion("");
				}
				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				String cpfaccno = commonDAO.checkEmployeeInfo1(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				bean.setCpfAcNo(cpfaccno);

				int count = commonDAO.checkRecordCount(conn, monthYear,
						cpfaccno, bean.getEmpNumber(), bean.getRegion().trim());
				String updateCpfaccno = "";
				if (count == 2) {
				}
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log
				.info("ImportDao :updateFinaceDatahavingCpfaccnoBlank1 leaving method");

	}

	public void importIgiCargo0809Data(String xlsData) {

		log.info("ImportDao :importIgiCargo0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				log.info("emoluments " + tempInfo[9].trim());
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.0");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.0");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.0");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.0");
				}
				/* for east Region */
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF()
						+ "emoluments " + bean.getEmoluments());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "East Region");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation().trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "East Region".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "'))   where region='East Region' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importIgiCargo0809Data leaving method");

	}

	public void importOfficeComplex0809Data(String xlsData) {

		log.info("ImportDao :importOfficeComplex0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.0");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.0");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.0");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.0");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.0");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "OFFICE COMPLEX".trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "CHQIAD".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "'))  where region='CHQIAD' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and airportcode='OFFICE COMPLEX'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importOfficeComplex0809Data leaving method");

	}

	public void importTrivendrum0809Data(String xlsData) {
		log.info("ImportDao :importTrivendrum0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[12].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].trim());
				} else {
					bean.setInterest("0.00");
				}
				double pf = 0.0, pensionContri = 0.0;
				if (!tempInfo[19].equals("XXX")) {
					pf = Double.parseDouble(tempInfo[19].trim());
				} else {
					pf = 0.00;
				}
				if (!tempInfo[20].equals("XXX")) {
					pensionContri = Double.parseDouble(tempInfo[20].trim());
				} else {
					pensionContri = 0.00;
				}

				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,empvpf,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "TRIVANDRUM IAD".trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "CHQIAD".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, pf);
					pst.setDouble(15, pensionContri);
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "'))  where region='CHQIAD' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importTrivendrum0809Data leaving method");

	}

	public void importAmritserIAD0809Data(String xlsData) {
		log.info("ImportDao :importAmritserIAD0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("");
				}

				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "AmritsarIAD".trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "CHQIAD".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')) where region='CHQIAD' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";
					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importAmritserIAD0809Data leaving method");

	}

	public void importCHQNAD0809Data(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importCHQNAD0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					String empnumber = tempInfo[3].trim();
					// empnumber = empnumber.substring(2, empnumber.length());
					// empnumber =
					// commonUtil.trailingZeros(empnumber.toCharArray());
					/*
					 * if(empnumber.startsWith("0")){
					 * empnumber=empnumber.substring(1,empnumber.length()); }
					 */
					bean.setEmpNumber(tempInfo[3].trim());

					// bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.00");
				}
				int count = 0, countEmployeeInfo = 0;
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						"CHQNAD");

				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(cpfacno,airportCode, employeeno,employeeName,desegnation,region,empserialnumber) VALUES "
							+ "(?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(sql);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, "CHQNAD".trim());
					pst.setString(3, bean.getEmpNumber());
					pst.setString(4, bean.getEmpName());
					pst.setString(5, bean.getDesegnation());
					// for southern region Data
					pst.setString(6, "CHQNAD".trim());
					pst.setString(7, bean.getPfid().trim());
					pst.executeUpdate();
					pst.close();
				}

				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,pensionno,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "CHQNAD");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "CHQNAD".trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "CHQNAD".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')) where region='CHQNAD' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";

					log.info("update emolumentss " + insertArrearCount);
					st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		}

		log.info("ImportDao :importCHQNAD0809Data leaving method");

	}

	public void importKolkataIad0809Data(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :importCAPIAD0809Data() entering method");
		// log.info("ImportDao :importKolkataIad0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {

					bean.setEmpNumber(tempInfo[3].trim());

				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[8].equals("XXX")) {
					monthYear = tempInfo[8].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[18].equals("XXX")) {
					bean.setStation(tempInfo[18].trim());
				} else {
					bean.setStation("");
				}

				if (!tempInfo[20].equals("XXX")) {
					bean.setRegion(tempInfo[20].trim());
				} else {
					bean.setRegion("");
				}
				double pensioncontri = 0.00, pf = 0.00;
				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for Cpfaccno " + bean.getCpfAcNo()
								+ " . PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}

					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());

					pensioncontri = commonDAO.pensionCalculation(monthYear, bean
							.getEmoluments(), bean.getWetherOption(), bean
							.getRegion(), "");
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- pensioncontri;

				}
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), bean.getRegion().trim());

				if (foundSalaryDate.equals("") && bean.getPfid() != "") {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation().trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					float emoluments = 0.0f;
					if (bean.getEmployeePF().trim() != ""
							|| (!bean.getEmployeePF().trim().equals(""))) {
						emoluments = Float.parseFloat(bean.getEmployeePF()
								.trim()) * 100 / 12;
					}

					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					if (!bean.getEmoluments().equals("0.00")
							&& !bean.getEmoluments().equals("0.0")
							&& !bean.getEmoluments().equals("0")
							&& !bean.getEmoluments().equals("")) {
						insertArrearCount = "update employee_pension_validate set EMOLUMENTS=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='"
								+ bean.getRegion()
								+ "' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					} else {
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='"
								+ bean.getRegion()
								+ "' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					}
					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);

				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			if (st != null) {
				try {
					rs.close();
					st.close();
					st = null;

				} catch (SQLException se) {
					log.printStackTrace(se);
				}
			}
			log.info("ImportDao :importEastRegion0809Data leaving method");
			// log.info("ImportDao :importKolkataIad0809Data leaving method");

		}
	}

	public void deductSouth9697ArrearData(String xlsData) {
		log.info("ImportDao :deductSouth9697ArrearData() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				String cpf = "";
				if (!tempInfo[7].equals("XXX")) {
					cpf = tempInfo[7].trim();
				} else {
					cpf = "";
				}
				int emoluments = 0;
				emoluments = Integer.parseInt(cpf) * 10;
				// for South and westDeduction need below column
				/*
				 * if (!tempInfo[6].equals("XXX")) { emoluments =
				 * Integer.parseInt(tempInfo[6].trim()); }
				 */

				monthYear = commonUtil.converDBToAppFormat(monthYear,
						"dd-MMM-yyyy", "MMM-yyyy");
				String deductArrear = "update employee_pension_validate set EMOLUMENTS=EMOLUMENTS-("
						+ emoluments
						+ "), EMPPFSTATUARY=EMPPFSTATUARY-("
						+ cpf
						+ ") where region='CHQNAD' and cpfaccno='"
						+ bean.getCpfAcNo()
						+ "' and to_char(monthyear,'Mon-yyyy')='"
						+ monthYear
						+ "'";
				log.info(deductArrear);
				st.executeUpdate(deductArrear);

			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :deductSouth9697ArrearData leaving method");

	}

	public void importSouthArr9697(String xlsData) throws Exception {
		log.info("ImportDao :importSouthArr9697 entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			Statement st1 = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", cpfarrear = "", emoluments = "", empPfstatuary = "", DAILYALLOWANCE = "";
				String monthYear = "";
				if (!tempInfo[2].equals("XXX")) {
					monthYear = tempInfo[2].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[7].equals("XXX")) {
					cpfarrear = tempInfo[7].trim();
				} else {
					cpfarrear = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					emoluments = tempInfo[6].trim();
				} else {
					emoluments = "0.00";
				}

				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear, bean.getCpfAcNo(), bean.getEmpNumber(),
						"South Region");
				String updateArrears = "";
				int count = 0;
				// String noofmonthsFrmmay95toTransactionDate=
				// "select round(months_between('"+monthYear+
				// "',NVL('01-May-1995','01-May-1995'))) as count from employee_info WHERE CPFACNO='"
				// +bean.getCpfAcNo()+"' AND REGION='CHQIAD'";
				// String noofMonthsQuery =
				// "select round(months_between('"+monthYear+
				// "', NVL( (CASE WHEN DATEOFJOINING <= to_date('01-Jan-1992', 'dd-Mon-yyyy') then  '01-Jan-1992'   ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy') END), '01-Apr-1995'))) as months, to_date(to_char(NVL(DATEOFJOINING, '01-Apr-1995'), 'dd-Mon-yyyy')) as doj from employee_info info WHERE CPFACNO = '"
				// +bean.getCpfAcNo()+"' AND REGION = 'CHQIAD'";

				String noofMonthsQuery = "select round(months_between('01-Aug-1996',CASE WHEN DATEOFJOINING <= to_date('01-Jan-1992', 'dd-Mon-yyyy') then  '01-Jan-1992'   ELSE  to_char(DATEOFJOINING,'dd-Mon-yyyy') END)) as months,to_char(DATEOFJOINING,'dd-Mon-yyyy') as doj from employee_info WHERE CPFACNO='"
						+ bean.getCpfAcNo() + "' AND REGION='South Region'";
				ResultSet rs = st.executeQuery(noofMonthsQuery);
				int months = 0;
				String dateofjoing = "";
				if (rs.next()) {
					if (rs.getString("doj") != null) {
						months = Integer.parseInt(rs.getString("months"));
						dateofjoing = rs.getString("doj");
					}
					// dateofjoing = rs.getDate("doj");
				}
				String emolumentsCount = "SELECT count(*) as count FROM EMPLOYEE_PENSION_VALIDATE WHERE EMOLUMENTS<5000 AND  monthyear>=to_date('1-May-1995','dd-Mon-yyyy') and monthyear<=to_date('30-Nov-1995','dd-Mon-yyyy')  and cpfaccno='"
						+ bean.getCpfAcNo() + "' and region='South Region'";
				ResultSet rs1 = st.executeQuery(emolumentsCount);
				int emolumentsCountno = 0;
				if (rs1.next()) {
					emolumentsCountno = Integer.parseInt(rs.getString("count"));
					// for East Region 9
					// for CHQIAD KOLKATA 12
					// for west region emolumentsCountno += 10;
					emolumentsCountno += 9;
				}
				String emoluments1 = "", cpfarrear1 = "";
				log.info("dateofjoining " + dateofjoing);
				if (dateofjoing != null
						&& dateofjoing != ""
						&& new Date(dateofjoing)
								.before(new Date("01-Apr-1995"))) {
					emoluments1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments)
							* emolumentsCountno / (months)));
					cpfarrear1 = String.valueOf(Math.round(Double
							.parseDouble(emoluments1) * (0.1)));
				} else {
					emoluments1 = emoluments;
					cpfarrear1 = cpfarrear;
				}

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,ARREARDATE,ARREARAMT,REGION) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ monthYear
						+ "','"
						+ cpfarrear + "','South Region')";

				if (!foundSalaryDate.equals("") && !dateofjoing.equals(null)
						&& dateofjoing != "") {
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yy", "-MMM-yy");
					updateArrears = "update employee_pension_validate set  emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ emoluments1
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ cpfarrear1
							+ "'))  where   region='South Region'  and cpfaccno='"
							+ bean.getCpfAcNo()
							+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";

				}
				log.info("dateofjoing" + dateofjoing);
				if (!dateofjoing.equals(null)
						&& dateofjoing != ""
						&& new Date(dateofjoing)
								.before(new Date("31-Mar-1997"))
						&& !foundSalaryDate.equals("")) {
					log.info("insertArrear " + insertArrear);
					log.info("updateArrears " + updateArrears);

					st1.addBatch(insertArrear);
					st1.addBatch(updateArrears);
					log.info("cpfaccno updated is" + bean.getCpfAcNo());
					int count1[] = st1.executeBatch();
					log.info("count is" + count1.length);
				} else {
					log.info("Missing cpfaccno doj is" + bean.getCpfAcNo());
				}

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importSouthArr9697 leaving method");

	}

	public void pensionCalculation(String xlsData) throws InvalidDataException {

		log.info("ImportDao :pensionCalculation() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement upDst = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", emoluments = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		FinancialReportDAO FDAO = new FinancialReportDAO();
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();

			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					bean.setPfid(tempInfo[0].trim());
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setRegion(tempInfo[10].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setWetherOption(tempInfo[6].trim());
				} else {
					bean.setWetherOption("");
				}

				String sql3 = "";

				sql3 = "select  emoluments, to_char(monthyear,'dd-Mon-yyyy')as monthyear from  employee_pension_validate 	 where region='"
						+ bean.getRegion()
						+ "' and cpfaccno='"
						+ bean.getCpfAcNo() + "' ";
				log.info(sql3);
				try {
					rs = st.executeQuery(sql3);
					int j = 0, k = 0;
					while (rs.next()) {
						String monthyear = rs.getString("monthyear");
						emoluments = rs.getString("emoluments");
						emoluments = FDAO.calWages(emoluments, monthyear, bean
								.getWetherOption(), false, false, "1");
						double pensioncont = commonDAO.pensionCalculation(rs
								.getString("monthyear"), emoluments, bean
								.getWetherOption(), bean.getRegion(), "");
						j++;
						log.info(j + "=" + bean.getCpfAcNo() + "="
								+ pensioncont);
						upDst = conn.createStatement();
						String updateQuery = "update employee_pension_validate set pensioncont='"
								+ pensioncont
								+ "',pensionno='"
								+ bean.getPfid()
								+ "'  where region='"
								+ bean.getRegion()
								+ "' and cpfaccno='"
								+ bean.getCpfAcNo()
								+ "' and monthyear='"
								+ monthyear + "'";
						log.info(updateQuery);
						k = upDst.executeUpdate(updateQuery);
						upDst.close();
						upDst = null;

					}

				} catch (Exception e) {
					log.printStackTrace(e);
				}
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}
		log.info("ImportDao :pensionCalculation leaving method");

	}

	public void writeIgiCargo0809DataPFID(String xlsData) {

		log.info("ImportDao :writeIgiCargo0809DataPFID() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		ArrayList fnlDataList = new ArrayList();
		FileWriter fw = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", empDbName = "", dateofbirth = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[2].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[2].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				/*if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[1].equals("XXX")) {
					// for CHQNAD getting cpfaccno passing empnumber
					/*
					 * String empnumber= tempInfo[3].trim();
					 * log.info("empno "+empnumber);
					 * empnumber=empnumber.substring(2,empnumber.length());
					 * empnumber=
					 * commonUtil.trailingZeros(empnumber.toCharArray());
					 * log.info("empno "+empnumber); String cpfaccnoQuery=
					 * "select cpfacno from employee_info where employeeno='"
					 * +empnumber+"' and region='CHQNAD' and rownum=1";
					 * rs1=st.executeQuery(cpfaccnoQuery); while(rs1.next()){
					 * if(rs1.getString("cpfacno")!=null){
					 * bean.setCpfAcNo(rs1.getString("cpfacno")); }else{
					 * bean.setCpfAcNo(""); }
					 */

					/*bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}
				log.info("cpfaccno " + bean.getCpfAcNo());
				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				bean.setDateofBirth(monthYear);
				log.info("monthyear " + monthYear);
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("");
				}*/
				String sequenceNoQuery = "";
				if (bean.getPfid() != "") {
					// sequenceNoQuery=
					// "select pensionno,to_char(dateofbirth,'dd-Mon-yyyy')as dob,employeename from employee_personal_info where cpfacno='"
					// +bean.getCpfAcNo()+"'  and rownum=1";
					sequenceNoQuery = "select WETHEROPTION,pensionno,to_char(dateofbirth,'dd-Mon-yyyy')as dob,employeename from employee_personal_info where pensionno='"
							+ bean.getPfid()
							+ "'";
				}
				log.info(sequenceNoQuery);
				if (sequenceNoQuery != "") {
					rs = st.executeQuery(sequenceNoQuery);
					while (rs.next()) {
						if (rs.getString("pensionno") != null) {
							bean.setEmpSerialNo(rs.getString("pensionno"));
						} else {
							bean.setEmpSerialNo("");
						}
						empDbName = rs.getString("employeename");
						if (rs.getString("dob") != null) {
							bean.setDateofBirth(rs.getString("dob"));
						} else {
							bean.setDateofBirth("");
						}

						if (rs.getString("WETHEROPTION") != null) {
							bean.setWetherOption(rs.getString("WETHEROPTION"));
						} else {
							bean.setWetherOption("");
						}
					}
				}
				log.info("serial no" + bean.getEmpSerialNo());
				
					bean.setPensionNumber(commonDAO.getPFID(empDbName, bean
							.getDateofBirth(), commonUtil.leadingZeros(5, bean
							.getEmpSerialNo())));	
					
             log.info("bean.getPensionNumber"+bean.getPensionNumber());
				fnlDataList.add(bean);
			}

			File outputFile = null;
			outputFile = new File("c://pensionoptionanddob.xls");
			WorkbookSettings ws = new WorkbookSettings();
			ws.setLocale(new Locale("en", "EN"));
			WritableWorkbook workbook = Workbook.createWorkbook(outputFile, ws);
			CommonUtil cUtil = new CommonUtil();
			ArrayList hdrsList = new ArrayList();
			cUtil.createSheet(fnlDataList, "test", workbook, hdrsList);
			workbook.write();
			workbook.close();
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :writeIgiCargo0809DataPFID leaving method");

	}

	public void north0809AutoMapping(String xlsData) {

		log.info("ImportDao :North0809AutoMapping() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		ArrayList fnlDataList = new ArrayList();
		FileWriter fw = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", empDbName = "", dateofbirth = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		String sqlSelQuery = "", insertQry = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("tempinfo  " + tempInfo[1].trim());
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));

				} else {
					bean.setPfid("");
				}

				if (!tempInfo[14].equals("XXX")) {
					bean.setRegion(tempInfo[14].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				log.info("pfid is " + bean.getPfid() + "region is "
						+ bean.getRegion());
				if (bean.getPfid() != "") {
					sqlSelQuery = "select to_char(PENSIONNO),AIRPORTSERIALNUMBER,EMPLOYEENO, EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,"
							+ "WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,GENDER,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,EMPFLAG,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,'CHQNAD','NAGA','"
							+ bean.getCpfAcNo()
							+ "','"
							+ lastactive
							+ "'"
							+ " FROM employee_personal_info WHERE  ROWID=(SELECT Max(ROWID) FROM EMPLOYEE_personal_INFO WHERE EMPFLAG='Y' AND PENSIONNO='"
							+ bean.getPfid()
							+ "' AND REGION='"
							+ bean.getRegion() + "')";
					insertQry = "insert into employee_info(EMPSERIALNUMBER,AIRPORTSERIALNUMBER,EMPLOYEENO, EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,"
							+ "sex,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,EMPFLAG,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,REGION,USERNAME,cpfacno,lastactive)  "
							+ sqlSelQuery;

					log.info("insert query " + insertQry);
				}
				st.executeUpdate(insertQry);
				bean.setPfid("");
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					log.printStackTrace(se);
				}
			}
		}

		log.info("ImportDao :North0809AutoMapping leaving method");

	}

	public void importWR0809Data(String xlsData) {

		log.info("ImportDao :importWR0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setBasic(tempInfo[7].trim());
				} else {
					bean.setBasic("0.00");
				}
				if (!tempInfo[8].equals("XXX")) {
					bean.setDailyAllowance(tempInfo[8].trim());
				} else {
					bean.setDailyAllowance("0.00");
				}
				String emoluments = String.valueOf(Float.parseFloat(bean
						.getBasic())
						+ Float.parseFloat(bean.getDailyAllowance()));

				bean.setEmoluments(emoluments.trim());

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmployeePF(tempInfo[9].trim());
				} else {
					bean.setEmployeePF("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("");
				}
				if (!tempInfo[0].equals("XXX")) {
					bean.setStation(tempInfo[0].trim());
				} else {
					bean.setStation("");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,basic,DAILYALLOWANCE)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "West Region");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation().trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "West Region".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getBasic().trim());
					pst.setString(14, bean.getDailyAllowance().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					float emoluments1 = 0.0f;
					if (bean.getEmployeePF().trim() != ""
							|| (!bean.getEmployeePF().trim().equals(""))) {
						emoluments1 = Float.parseFloat(bean.getEmployeePF()
								.trim()) * 100 / 12;
					}
					bean.setEmoluments(String.valueOf(emoluments1));
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "'))  where region='West Region' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importWR0809Data leaving method");

	}

	public void importNorth0809Data(String xlsData) {

		log.info("ImportDao :importNorth0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "North Region");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "North Region".trim());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "North Region".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "'))  where region='North Region' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importNorth0809Data leaving method");

	}

	public void importSouth0809Data(String xlsData) {

		log.info("ImportDao :importSouth0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		FinancialReportDAO fDao = new FinancialReportDAO();
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		String foundSalaryDate = "";
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setFromDate(tempInfo[4].trim());
				} else {
					bean.setFromDate("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setStation(tempInfo[7].trim());
				} else {
					bean.setStation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setRegion(tempInfo[14].trim());
				} else {
					bean.setRegion("");
				}
				int countEmployeeInfo = 0;
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(empserialnumber,cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks,MAPPINGFLAG) VALUES "
							+ "(?,?,?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(sql);
					pst.setString(1, bean.getPfid().trim());
					pst.setString(2, bean.getCpfAcNo().trim());
					pst.setString(3, bean.getStation().trim());
					pst.setString(4, bean.getEmpNumber().trim());
					pst.setString(5, bean.getEmpName().trim());
					pst.setString(6, bean.getDesegnation().trim());
					// for southern region Data
					pst.setString(7, bean.getRegion().trim());
					pst.setString(8, "new records from South Region".trim());
					pst.setString(9, "Y".trim());
					pst.executeUpdate();
					pst.close();
				}
				double pensioncontri = 0.00, pf = 0.00;
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					String checkPFID = "select wetheroption from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);
					if (rs.next()) {
						if (rs.getString("wetheroption") != null) {
							bean.setWetherOption(rs.getString("wetheroption"));
						} else {
							bean.setWetherOption("");
						}
					}
					log.info("wetheroption" + bean.getWetherOption());
					foundSalaryDate = this.checkFinanceDuplicate(conn, bean
							.getFromDate().trim(), bean.getCpfAcNo(), bean
							.getEmpNumber(), bean.getRegion());

					pensioncontri = commonDAO.pensionCalculation(bean.getFromDate(),
							bean.getEmoluments(), bean.getWetherOption(), bean
									.getRegion(), "");
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- pensioncontri;
				}
				log.info("finaceInsert-----" + finaceInsert);
				/*
				 * String foundSalaryDate = this.checkFinanceDuplicate(conn,
				 * monthYear.trim(), bean.getCpfAcNo(), bean .getEmpNumber(),
				 * bean.getRegion());
				 */

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation().trim());
					pst.setString(5, bean.getFromDate().trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, pensioncontri);
					pst.setDouble(15, pf);
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')), PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'pensioncontri')), PF=to_char(TO_NUMBER(nvl(PF,0)+'pf')) where region='"
							+ bean.getRegion().trim()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importSouth0809Data leaving method");

	}

	public void importRAUSAP0809Data(String xlsData) {

		log.info("ImportDao :importRausap0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				/*
				 * if (!tempInfo[7].equals("XXX")) {
				 * bean.setBasic(tempInfo[7].trim()); } else {
				 * bean.setBasic("0.00"); } if (!tempInfo[8].equals("XXX")) {
				 * bean.setDailyAllowance(tempInfo[8].trim()); } else {
				 * bean.setDailyAllowance("0.00"); }
				 */

				if (!tempInfo[8].equals("XXX")) {
					bean.setEmoluments(tempInfo[8].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmployeePF(tempInfo[9].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[10].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setPrincipal(tempInfo[11].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setInterest(tempInfo[12].trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[0].equals("XXX")) {
					bean.setStation(tempInfo[0].trim());
				} else {
					bean.setStation("");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,ACTIVEFLAG)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "RAUSAP");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "RAUSAP");
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "RAUSAP");
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setString(14, "N");

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.executeUpdate();
					pst.close();
				} else {
					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "'))  where region='RAUSAP' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "' AND ACTIVEFLAG='N'";

					log.info("update emolumentss " + insertArrearCount);
					int count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importRausap0809Data leaving method");

	}

	/*
	 * public void importNER0809Data(String xlsData, String userName, String
	 * ipAddress)throws InvalidDataException {
	 * log.info("ImportDao :importNER0809Data() entering method"); ArrayList
	 * xlsDataList = new ArrayList(); FinancialReportDAO fDao = new
	 * FinancialReportDAO(); xlsDataList = commonUtil.getTheList(xlsData,
	 * "***"); Connection conn = null; Statement st = null; ResultSet rs = null;
	 * EmpMasterBean bean = null; String tempInfo[] = null; String tempData =
	 * ""; String foundSalaryDate = ""; FileWriter fw = null; char[] delimiters
	 * = { '"', ',', '\'', '*', ',' }; String quats[] = { "Mrs.", "DR.", "Mr.",
	 * "Ms.", "SH.", "smt." }; String uploadFilePath = ""; String xlsEmpName =
	 * ""; // cpfAccNum = this.getMaxValue(); // bean.setCpfAcNo(cpfAccNum);
	 * String retirementDate = "", dateofbirth = ""; log.debug("xlsData " +
	 * xlsData + "Size" + xlsDataList.size()); PreparedStatement pst = null; try
	 * { ResourceBundle bundle = ResourceBundle
	 * .getBundle("aims.resource.DbProperties"); uploadFilePath =
	 * bundle.getString("upload.folder.path"); File filePath = new
	 * File(uploadFilePath); if (!filePath.exists()) { filePath.mkdirs(); } fw =
	 * new FileWriter(new File(filePath + "//recordMissing.txt")); conn =
	 * commonDB.getConnection(); st = conn.createStatement(); String
	 * transMonthYear = ""; for (int i = 1; i < xlsDataList.size(); i++) { bean
	 * = new EmpMasterBean(); tempData = xlsDataList.get(i).toString(); tempInfo
	 * = tempData.split("@"); if (!tempInfo[1].equals("XXX")) {
	 * bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim())); } else {
	 * bean.setPfid(""); } log.info(bean.getPfid());
	 * 
	 * if (!tempInfo[2].equals("XXX")) { bean.setCpfAcNo(tempInfo[2].trim()); }
	 * else { bean.setCpfAcNo(""); } if (!tempInfo[3].equals("XXX")) {
	 * bean.setEmpNumber(tempInfo[3].trim()); } else { bean.setEmpNumber(""); }
	 * 
	 * if (!tempInfo[4].equals("XXX")) { bean.setFromDate(tempInfo[4].trim()); }
	 * else { bean.setFromDate(""); } if (!tempInfo[5].equals("XXX")) {
	 * bean.setEmpName(tempInfo[5].replaceAll(",", "").trim()); } else {
	 * bean.setEmpName(""); } if (!tempInfo[6].equals("XXX")) {
	 * bean.setDesegnation(tempInfo[6].trim()); } else {
	 * bean.setDesegnation(""); }
	 * 
	 * if (!tempInfo[9].equals("XXX")) { bean.setEmoluments(tempInfo[9].trim());
	 * } else { bean.setEmoluments("0.0"); } if (!tempInfo[10].equals("XXX")) {
	 * bean.setEmployeePF(tempInfo[10].trim()); } else {
	 * bean.setEmployeePF("0.0"); }
	 * 
	 * DateFormat df = new SimpleDateFormat("dd-MMM-yy");
	 * 
	 * if (bean.getFromDate() != "") { Date transdate =
	 * df.parse(bean.getFromDate()); float cpfarrear = 0; if
	 * (transdate.after(new Date("31-Aug-97"))) {
	 * bean.setEmoluments(String.valueOf
	 * (Math.round(Float.parseFloat(bean.getEmployeePF()) 100 / 12))); } else {
	 * bean.setEmoluments(String.valueOf(Math.round(Float.parseFloat(bean
	 * .getEmployeePF()) 100 / 10))); } }
	 * 
	 * if (!tempInfo[11].equals("XXX")) {
	 * bean.setEmployeeVPF(tempInfo[11].trim()); } else {
	 * bean.setEmployeeVPF("0.0"); } if (!tempInfo[12].equals("XXX")) {
	 * bean.setPrincipal(tempInfo[12].trim()); } else {
	 * bean.setPrincipal("0.0"); } if (!tempInfo[13].equals("XXX")) {
	 * bean.setInterest(tempInfo[13].trim()); } else { bean.setInterest("0.0");
	 * } if (!tempInfo[14].equals("XXX")) {
	 * bean.setStation(tempInfo[14].trim()); } else { bean.setStation(""); } if
	 * (!tempInfo[15].equals("XXX")) { bean.setRegion(tempInfo[15].trim()); }
	 * else { bean.setRegion(""); } if (!tempInfo[16].equals("XXX")) {
	 * bean.setRemarks(tempInfo[16].trim()); } else { bean.setRemarks(""); } int
	 * countEmployeeInfo = 0; countEmployeeInfo =
	 * commonDAO.checkEmployeeInfo(conn, bean .getEmpNumber(),
	 * bean.getCpfAcNo(), bean.getEmpName(), bean.getRegion()); if
	 * (countEmployeeInfo == 0) { String sql =
	 * "insert into employee_info(empserialnumber,cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks,MAPPINGFLAG) VALUES "
	 * + "(?,?,?,?,?,?,?,?,?)"; pst = conn.prepareStatement(sql);
	 * pst.setString(1, bean.getPfid()); pst.setString(2, bean.getCpfAcNo());
	 * pst.setString(3, bean.getStation()); pst.setString(4,
	 * bean.getEmpNumber()); pst.setString(5, bean.getEmpName());
	 * pst.setString(6, bean.getDesegnation()); // for southern region Data
	 * pst.setString(7, bean.getRegion().trim()); pst.setString(8,
	 * "new records from" + bean.getRegion().trim()); pst.setString(9,
	 * "Y".trim()); //pst.executeUpdate(); //pst.close(); } else { String sql =
	 * "update employee_info set empserialnumber='" + bean.getPfid() +
	 * "',MAPPINGFLAG='Y' where cpfacno='" + bean.getCpfAcNo() +
	 * "' and region='" + bean.getRegion() + "'"; //st.executeUpdate(sql); }
	 * double pensioncontri = 0.00, pf = 0.00, calculatedPension = 0.00;
	 * log.info(" Principle " + bean.getPrincipal() + "interest  " +
	 * bean.getInterest() + " vpf " + bean.getEmployeeVPF()); String
	 * finaceInsert =
	 * "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
	 * +
	 * "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,remarks)"
	 * + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"; if
	 * (!bean.getCpfAcNo().trim().equals("") ||
	 * !bean.getPfid().trim().equals("")) { // if(!tempInfo[1].equals("XXX")){
	 * String checkPFID =
	 * "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
	 * + bean.getFromDate() +
	 * "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
	 * + bean.getPfid() + "'"; log.info(checkPFID); rs =
	 * st.executeQuery(checkPFID);
	 * 
	 * if (!rs.next()) { throw new InvalidDataException("PFID " +
	 * bean.getPfid().trim() + " doesn't Exist" + " for  Employee " +
	 * bean.getEmpName() + ". PFID is Mandatory for All The Employees"); } if
	 * (rs.getString("wetheroption") != null) {
	 * bean.setWetherOption(rs.getString("wetheroption")); } else {
	 * bean.setWetherOption(""); } if (rs.getString("REIREMENTDATE") != null) {
	 * retirementDate = rs.getString("REIREMENTDATE"); } else { retirementDate =
	 * ""; } if (rs.getString("dateofbirth") != null) { dateofbirth =
	 * rs.getString("dateofbirth"); } else { dateofbirth = ""; } String days =
	 * "0"; if (rs.getString("days") != null) { days = rs.getString("days"); }
	 * else { days = "0"; }
	 * 
	 * if (tempInfo[1].equals("XXX")) { throw new
	 * InvalidDataException("PFID is Blank for " + bean.getCpfAcNo()); }
	 * 
	 * log.info(" Principle " + bean.getPrincipal() + "interest  " +
	 * bean.getInterest() + " vpf " + bean.getEmployeeVPF());
	 * 
	 * foundSalaryDate = this.checkFinanceDuplicate2(conn, bean .getFromDate(),
	 * bean.getCpfAcNo(), bean .getEmpNumber(),
	 * bean.getRegion(),bean.getStation(),bean.getPfid()); FinancialReportDAO
	 * fdao = new FinancialReportDAO(); calculatedPension = Math
	 * .round(fdao.calclatedPF(bean.getFromDate(), retirementDate, dateofbirth,
	 * bean .getEmoluments(), bean .getWetherOption(), "", days,"1")); pf =
	 * Math.round(Double.parseDouble(bean.getEmployeePF() .toString()) -
	 * calculatedPension);
	 * 
	 * }
	 * 
	 * 
	 * // inserting log transMonthYear = commonUtil.converDBToAppFormat(bean
	 * .getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy"); FinancialReportDAO
	 * FDAO = new FinancialReportDAO(); String updatedDate =
	 * commonUtil.getCurrentDate("dd-MMM-yyyy");
	 * 
	 * String emoluments_log = "", emoluments_log_history = ""; String
	 * oldemppfstatuary = "", oldemoluments = ""; Date transdate1 =
	 * df.parse(bean.getFromDate()); oldemoluments = this.getEmoluments(conn,
	 * bean.getFromDate(), bean.getCpfAcNo(), "", bean.getRegion()); if
	 * ((transdate1.after(new Date("31-Mar-98")) && oldemoluments != "" && Float
	 * .parseFloat(oldemoluments) != 0.00)) { oldemppfstatuary =
	 * String.valueOf(Float .parseFloat(oldemoluments) 12 / 100); } else if
	 * (oldemoluments != "" && Float.parseFloat(oldemoluments) != 0.00) {
	 * oldemppfstatuary = String.valueOf(Float .parseFloat(oldemoluments) 10 /
	 * 100); } String selectEmolumentsLog =
	 * "select count(*) as count from emoluments_log where cpfacno='" +
	 * bean.getCpfAcNo().trim() +
	 * "' and  to_char(monthyear,'dd-Mon-yyyy') like '%" + transMonthYear +
	 * "' and region='" + bean.getRegion() + "' "; rs =
	 * st.executeQuery(selectEmolumentsLog); while (rs.next()) { int count =
	 * rs.getInt(1); if (count == 0) { emoluments_log =
	 * "insert into emoluments_log(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
	 * + oldemoluments + "','" + bean.getEmoluments() + "','" + oldemppfstatuary
	 * + "','" + bean.getEmployeePF() + "','" + bean.getFromDate() + "','" +
	 * updatedDate + "','" + bean.getPfid() + "','" + bean.getCpfAcNo() + "','"
	 * + bean.getRegion() + "','" + userName + "','" + ipAddress + "')"; } else
	 * { emoluments_log = "update emoluments_log set oldemoluments='" +
	 * oldemoluments + "',newemoluments='" + bean.getEmoluments() +
	 * "',oldemppfstatuary='" + oldemppfstatuary + "',newemppfstatuary='" +
	 * bean.getEmployeePF() + "',monthyear='" + bean.getFromDate() +
	 * "',UPDATEDDATE='" + updatedDate + "',pensionno='" + bean.getPfid() +
	 * "',region='" + bean.getRegion() + "',username='" + userName +
	 * "',computername='" + ipAddress + "' where cpfacno='" + bean.getCpfAcNo()
	 * + "' and  to_char(monthyear,'dd-Mon-yy') like '%" + transMonthYear +
	 * "' and region='" + bean.getRegion() + "'";
	 * 
	 * } emoluments_log_history =
	 * "insert into emoluments_log_history(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
	 * + oldemoluments + "','" + bean.getEmoluments() + "','" + oldemppfstatuary
	 * + "','" + bean.getEmployeePF() + "','" + bean.getFromDate() + "','" +
	 * updatedDate + "','" + bean.getPfid() + "','" + bean.getCpfAcNo() + "','"
	 * + bean.getRegion() + "','" + userName + "','" + ipAddress + "')";
	 * st.executeUpdate(emoluments_log);
	 * st.executeUpdate(emoluments_log_history); } String updateemoluments = "";
	 * // code commented on 20-04-2010 , foundSalaryDate.equals("") && if
	 * (foundSalaryDate.equals("") && bean.getFromDate() != "") { pst =
	 * conn.prepareStatement(finaceInsert); pst.setString(1, bean.getCpfAcNo());
	 * pst.setString(2, bean.getEmoluments()); pst.setString(3,
	 * bean.getEmployeePF()); pst.setString(4, bean.getStation());
	 * pst.setString(5, bean.getFromDate()); pst.setString(6,
	 * bean.getEmpName()); pst.setString(7, bean.getEmpNumber());
	 * pst.setString(8, bean.getDesegnation()); pst.setString(9,
	 * bean.getRegion()); pst.setString(10, bean.getPfid()); pst.setString(11,
	 * bean.getEmployeeVPF()); pst.setString(12, bean.getPrincipal());
	 * pst.setString(13, bean.getInterest()); pst.setDouble(14,
	 * calculatedPension); pst.setDouble(15, pf); pst.setString(16,
	 * bean.getRemarks()); pst.executeUpdate(); pst.close();
	 * 
	 * } else if (bean.getFromDate() != "" && bean.getRegion().equals("CHQIAD"))
	 * { log.info(bean.getFromDate().trim()); float basicDaSum = 0;
	 * transMonthYear = commonUtil.converDBToAppFormat(bean
	 * .getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
	 * 
	 * updateemoluments ="update employee_pension_validate set emoluments='" +
	 * bean.getEmoluments() + "' , EMPPFSTATUARY='" +
	 * bean.getEmployeePF().trim() +
	 * "' ,empvpf='"+bean.getEmployeeVPF()+"',EMPADVRECPRINCIPAL='"
	 * +bean.getPrincipal
	 * ()+"',EMPADVRECINTEREST='"+bean.getInterest()+"',remarks=remarks ||'"
	 * +bean.getRemarks()+"',EMPFLAG='Y',pensionno='"
	 * +bean.getPfid()+"' where region='" + bean.getRegion().trim() +
	 * "' and cpfaccno='" + bean.getCpfAcNo().trim() +
	 * "' and airportcode='"+bean
	 * .getStation()+"' and to_char(monthyear,'dd-Mon-yyyy') like '%" +
	 * transMonthYear + "' AND empflag='Y'";
	 * 
	 * updateemoluments =
	 * "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
	 * + bean.getEmoluments() +
	 * "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'" +
	 * bean.getEmployeePF().trim() +
	 * "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'" +
	 * bean.getPrincipal().trim() +
	 * "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'" +
	 * bean.getInterest().trim() +
	 * "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'" +
	 * bean.getEmployeeVPF().trim() + "')),EMPFLAG='Y',pensionno='" +
	 * bean.getPfid() + "',pf= to_char(TO_NUMBER(nvl(pf,0)+'" + pf +
	 * "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'" +
	 * calculatedPension +
	 * "')),remarks=remarks ||'"+bean.getRemarks()+"'  where region='" +
	 * bean.getRegion().trim() + "' and cpfaccno='" + bean.getCpfAcNo().trim() +
	 * "' and to_char(monthyear,'dd-Mon-yyyy') like '%" + transMonthYear +
	 * "' and empflag='Y' and airportcode='"+bean.getStation()+"'";
	 * log.info("update query " + updateemoluments); int count =
	 * st.executeUpdate(updateemoluments);
	 * 
	 * }else if (bean.getFromDate() != ""&&!bean.getRegion().equals("CHQIAD")){
	 * log.info(bean.getFromDate().trim()); float basicDaSum = 0; transMonthYear
	 * = commonUtil.converDBToAppFormat(bean .getFromDate().trim(),
	 * "dd-MMM-yyyy", "-MMM-yyyy"); updateemoluments =
	 * "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
	 * + bean.getEmoluments() +
	 * "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'" +
	 * bean.getEmployeePF().trim() +
	 * "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'" +
	 * bean.getPrincipal().trim() +
	 * "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'" +
	 * bean.getInterest().trim() +
	 * "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'" +
	 * bean.getEmployeeVPF().trim() + "')),EMPFLAG='Y',pensionno='" +
	 * bean.getPfid() + "',pf= to_char(TO_NUMBER(nvl(pf,0)+'" + pf +
	 * "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'" +
	 * calculatedPension +
	 * "')),remarks=remarks ||'"+bean.getRemarks()+"'  where region='" +
	 * bean.getRegion().trim() + "' and pensionno='" + bean.getPfid().trim() +
	 * "' and to_char(monthyear,'dd-Mon-yyyy') like '%" + transMonthYear +
	 * "' and empflag='Y' "; updateemoluments
	 * ="update employee_pension_validate set emoluments='" +
	 * bean.getEmoluments() + "' , EMPPFSTATUARY='" +
	 * bean.getEmployeePF().trim() +
	 * "' ,empvpf='"+bean.getEmployeeVPF()+"',EMPADVRECPRINCIPAL='"
	 * +bean.getPrincipal
	 * ()+"',EMPADVRECINTEREST='"+bean.getInterest()+"',remarks=remarks ||'"
	 * +bean.getRemarks()+"',EMPFLAG='Y',pensionno='"
	 * +bean.getPfid()+"' where region='" + bean.getRegion().trim() +
	 * "' and cpfaccno='" + bean.getCpfAcNo().trim() +
	 * "' and to_char(monthyear,'dd-Mon-yyyy') like '%" + transMonthYear +
	 * "' and empflag='Y'"; log.info("update query " + updateemoluments); int
	 * count = st.executeUpdate(updateemoluments); }
	 * 
	 * } } catch (Exception e) { throw new InvalidDataException(e.getMessage());
	 * } finally{ commonDB.closeConnection(conn, st, rs); }
	 * 
	 * log.info("ImportDao :importNER0809Data leaving method");
	 * 
	 * }
	 */

	public void importNER0809Data(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		log.info("ImportDao :importNER0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "", datavail = "";
		String foundSalaryDate = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "", arrearFlag = "";
		;
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		String retirementDate = "", dateofbirth = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			String transMonthYear = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				// log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setFromDate(tempInfo[4].trim());
				} else {
					bean.setFromDate("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].replaceAll(",", "").trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				log.info("emoluments" + tempInfo[9].trim());
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.0");
				}
				log.info("emoluments" + bean.getEmoluments());
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.0");
				}

				DateFormat df = new SimpleDateFormat("dd-MMM-yy");
				/*
				 * if (bean.getFromDate() != "") { Date transdate =
				 * df.parse(bean.getFromDate());
				 * 
				 * float cpfarrear = 0; if (transdate.after(new
				 * Date("31-Mar-98"))) {
				 * bean.setEmoluments(String.valueOf(Math.round
				 * (Float.parseFloat(bean.getEmployeePF()) 100 / 12))); } else {
				 * bean
				 * .setEmoluments(String.valueOf(Math.round(Float.parseFloat(
				 * bean .getEmployeePF()) 100 / 10))); } }
				 */

				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.0");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.0");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.0");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setRegion(tempInfo[15].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[16].equals("XXX")) {
					bean.setRemarks(tempInfo[16].trim());
				} else {
					bean.setRemarks("");
				}
				/*
				 * if (!tempInfo[17].equals("XXX")) {
				 * bean.setEmployeeTotal(tempInfo[17].trim()); } else {
				 * bean.setEmployeeTotal(""); }
				 */

				if (!tempInfo[17].equals("XXX")) {
					arrearFlag = tempInfo[17].trim();
				} else {
					arrearFlag = "";
				}

				int countEmployeeInfo = 0;
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(empserialnumber,cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks,MAPPINGFLAG) VALUES "
							+ "(?,?,?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(sql);
					pst.setString(1, bean.getPfid());
					pst.setString(2, bean.getCpfAcNo());
					pst.setString(3, bean.getStation());
					pst.setString(4, bean.getEmpNumber());
					pst.setString(5, bean.getEmpName());
					pst.setString(6, bean.getDesegnation());
					// for southern region Data
					pst.setString(7, bean.getRegion().trim());
					pst.setString(8, "new records from"
							+ bean.getRegion().trim());
					pst.setString(9, "Y".trim());
					// pst.executeUpdate();
					pst.close();
				} else {
					String sql = "update employee_info set empserialnumber='"
							+ bean.getPfid()
							+ "',MAPPINGFLAG='Y' where cpfacno='"
							+ bean.getCpfAcNo() + "' and region='"
							+ bean.getRegion() + "'";
					// st.executeUpdate(sql);
				}
				double pensioncontri = 0.00, pf = 0.00, calculatedPension = 0.00;
				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,REMARKS,arrearflag)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ bean.getFromDate()
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}

					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}

					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());

					foundSalaryDate = this.checkFinanceDuplicate2(conn, bean
							.getFromDate(), bean.getCpfAcNo(), bean
							.getEmpNumber(), bean.getRegion(), bean
							.getStation(), bean.getPfid());
					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = Math.round(commonDAO.calclatedPF(bean
							.getFromDate(), retirementDate, dateofbirth, bean
							.getEmoluments(), bean.getWetherOption(), "", days,
							"1"));
					pf = Math.round(Double.parseDouble(bean.getEmployeePF()
							.toString())
							- calculatedPension);

				}
				// foundSalaryDate = this.checkFinanceDuplicate2(conn, bean
				// .getFromDate(), bean.getCpfAcNo(), bean
				// .getEmpNumber(),
				// bean.getRegion(),bean.getStation(),bean.getPfid());

				// inserting log
				transMonthYear = commonUtil.converDBToAppFormat(bean
						.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
				FinancialReportDAO FDAO = new FinancialReportDAO();
				String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");

				String emoluments_log = "", emoluments_log_history = "";
				String oldemppfstatuary = "0.00", oldemoluments = "0.00";
				Date transdate1 = df.parse(bean.getFromDate());
				oldemoluments = this
						.getEmoluments(conn, bean.getFromDate(), bean
								.getCpfAcNo(), "", bean.getRegion(), bean
								.getPfid());
				if (oldemoluments == "") {
					oldemoluments = "0.00";
				}
				if (oldemppfstatuary == "") {
					oldemppfstatuary = "0.00";
				}
				if ((transdate1.after(new Date("31-Mar-98"))
						&& oldemoluments != "" && Float
						.parseFloat(oldemoluments) != 0.00)) {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 12 / 100);
				} else if (oldemoluments != ""
						&& Float.parseFloat(oldemoluments) != 0.00) {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 10 / 100);
				}
				String selectEmolumentsLog = "select count(*) as count from emoluments_log where pensionno='"
						+ bean.getPensionNumber().trim()
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear
						+ "' and region='"
						+ bean.getRegion()
						+ "' ";
				rs = st.executeQuery(selectEmolumentsLog);
				float newemppfstatuary = Float.parseFloat(bean.getEmployeePF())
						+ Float.parseFloat(oldemppfstatuary);
				float newemoluments = Float.parseFloat(bean.getEmoluments())
						+ Float.parseFloat(oldemoluments);
				while (rs.next()) {
					int count = rs.getInt(1);
					System.out.println("count is " + count + " query "
							+ selectEmolumentsLog);
					if (count == 0) {
						emoluments_log = "insert into emoluments_log(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
								+ oldemoluments
								+ "','"
								+ newemoluments
								+ "','"
								+ oldemppfstatuary
								+ "','"
								+ newemppfstatuary
								+ "','"
								+ bean.getFromDate()
								+ "','"
								+ updatedDate
								+ "','"
								+ bean.getPfid()
								+ "','"
								+ bean.getCpfAcNo()
								+ "','"
								+ bean.getRegion()
								+ "','" + userName + "','" + ipAddress + "')";
					} else {
						emoluments_log = "update emoluments_log set oldemoluments='"
								+ oldemoluments
								+ "',newemoluments='"
								+ newemoluments
								+ "',oldemppfstatuary='"
								+ oldemppfstatuary
								+ "',newemppfstatuary='"
								+ newemppfstatuary
								+ "',monthyear='"
								+ bean.getFromDate()
								+ "',UPDATEDDATE='"
								+ updatedDate
								+ "',pensionno='"
								+ bean.getPfid()
								+ "',region='"
								+ bean.getRegion()
								+ "',username='"
								+ userName
								+ "',computername='"
								+ ipAddress
								+ "' where cpfacno='"
								+ bean.getPensionNumber()
								+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear
								+ "' and region='"
								+ bean.getRegion() + "'";

					}
					emoluments_log_history = "insert into emoluments_log_history(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
							+ oldemoluments
							+ "','"
							+ bean.getEmoluments()
							+ "','"
							+ oldemppfstatuary
							+ "','"
							+ bean.getEmployeePF()
							+ "','"
							+ bean.getFromDate()
							+ "','"
							+ updatedDate
							+ "','"
							+ bean.getPfid()
							+ "','"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getRegion()
							+ "','"
							+ userName
							+ "','"
							+ ipAddress + "')";
					st.executeUpdate(emoluments_log);
					st.executeUpdate(emoluments_log_history);
				}
				String insertarrear = "";
				insertarrear = "insert into employee_pension_arrear(CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,AIRPORTCODE,REGION,REMARKS,PENSIONNO)values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ bean.getEmpNumber()
						+ "','"
						+ bean.getEmpName()
						+ "','"
						+ bean.getFromDate()
						+ "','"
						+ bean.getEmoluments()
						+ "','"
						+ bean.getStation()
						+ "','"
						+ bean.getRegion()
						+ "','"
						+ bean.getRemarks()
						+ "','"
						+ bean.getPfid()
						+ "')";
				// log.info("insertarrear"+insertarrear);
				// st.executeUpdate(insertarrear);
				String updateemoluments = "";
				// code commented on 20-04-2010 , foundSalaryDate.equals("") &&
				if (foundSalaryDate.equals("") && bean.getFromDate() != "") {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmployeePF());
					pst.setString(4, bean.getStation());
					pst.setString(5, bean.getFromDate());
					pst.setString(6, bean.getEmpName());
					pst.setString(7, bean.getEmpNumber());
					pst.setString(8, bean.getDesegnation());
					pst.setString(9, bean.getRegion());
					pst.setString(10, bean.getPfid());
					pst.setString(11, bean.getEmployeeVPF());
					pst.setString(12, bean.getPrincipal());
					pst.setString(13, bean.getInterest());
					pst.setDouble(14, calculatedPension);
					// pst.setString(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, bean.getRemarks());
					// pst.setString(17, bean.getFhFlag().trim());
					pst.setString(17, arrearFlag.trim());
					pst.executeUpdate();
					pst.close();
					log.info("inside insert");

				} else if (bean.getFromDate() != ""
						&& bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					/*
					 * updateemoluments
					 * ="update employee_pension_validate set emoluments='" +
					 * bean.getEmoluments() + "' , EMPPFSTATUARY='" +
					 * bean.getEmployeePF().trim() +
					 * "' ,empvpf='"+bean.getEmployeeVPF
					 * ()+"',EMPADVRECPRINCIPAL='"+bean.getPrincipal()
					 * +"',EMPADVRECINTEREST='"+bean.getInterest()
					 * +"',EMPFLAG='Y',pensionno='"
					 * +bean.getPfid()+"',remarks=REMARKS||'"
					 * +bean.getRemarks()+"' where region='" +
					 * bean.getRegion().trim() + "' and pensionno='" +
					 * bean.getPfid().trim() +
					 * "' and airportcode='"+bean.getStation
					 * ()+"' and to_char(monthyear,'dd-Mon-yyyy') like '%" +
					 * transMonthYear + "' and EMPFLAG='Y'";
					 */

					updateemoluments = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),remarks=remarks||'"
							+ bean.getRemarks()
							+ "',EMPFLAG='Y',arrearflag ='"
							+ arrearFlag
							+ "',pensionno='"
							+ bean.getPfid()
							+ "',pf= to_char(TO_NUMBER(nvl(pf,0)+'"
							+ pf
							+ "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'"
							+ calculatedPension
							+ "')) where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and empflag='Y' and airportcode='"
							+ bean.getStation() + "'";

					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);
				} else if (bean.getFromDate() != ""
						&& !bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					updateemoluments = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),remarks=remarks||'"
							+ bean.getRemarks()
							+ "',EMPFLAG='Y',arrearflag ='"
							+ arrearFlag
							+ "',pensionno='"
							+ bean.getPfid()
							+ "',pf= to_char(TO_NUMBER(nvl(pf,0)+'"
							+ pf
							+ "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'"
							+ calculatedPension
							+ "')) where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "' and empflag='Y' ";
					/*
					 * updateemoluments
					 * ="update employee_pension_validate set emoluments='" +
					 * bean.getEmoluments() + "' , EMPPFSTATUARY='" +
					 * bean.getEmployeePF().trim()
					 * +"',empvpf='"+bean.getEmployeeVPF()
					 * +"',EMPADVRECPRINCIPAL='"+bean.getPrincipal()
					 * +"',EMPADVRECINTEREST='"+bean.getInterest()
					 * +"',EMPFLAG='Y',pensionno='"
					 * +bean.getPfid()+"',remarks=REMARKS||'"
					 * +bean.getRemarks()+"' where region='" +
					 * bean.getRegion().trim() + "' and pensionno='" +
					 * bean.getPfid().trim() +
					 * "' and to_char(monthyear,'dd-Mon-yyyy') like '%" +
					 * transMonthYear + "' and EMPFLAG='Y'";
					 */
					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			try {
				// st1.close();
				rs.close();
				st.close();
				pst.close();
				conn.close();
			} catch (Exception e) {

			}
		}
		log.info("ImportDao :importNER0809Data leaving method");

	}

	public void importOfficeComplexDparrears(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		int total = 0;
		log.info("ImportDao :importOfficeComplexDparrears() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", empName = "";

		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setFromDate(tempInfo[4].trim());
				} else {
					bean.setFromDate("");
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setEmployeePF(tempInfo[7].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				bean.setEmoluments(String.valueOf(Float.parseFloat(bean
						.getEmployeePF()) * 100 / 12));

				if (!tempInfo[9].equals("XXX")) {
					bean.setPrincipal(tempInfo[9].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setInterest(tempInfo[10].trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setStation(tempInfo[11].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setRegion(tempInfo[12].trim());
				} else {
					bean.setRegion("");
				}
				String transMonthYear = commonUtil.converDBToAppFormat(bean
						.getFromDate(), "dd-MMM-yyyy", "MMM-yyyy");
				String emoluments_log = "", emoluments_log_history = "";
				String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
				String selectEmolumentsLog = "select count(*) as count from emoluments_log where cpfacno='"
						+ bean.getCpfAcNo().trim()
						+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
						+ transMonthYear
						+ "' and region='"
						+ bean.getRegion()
						+ "' ";
				rs = st.executeQuery(selectEmolumentsLog);
				String oldemppfstatuary = "0.00", oldemoluments = "0.00";
				oldemoluments = this.getEmolumentsBesedonPFID(conn, bean
						.getFromDate(), bean.getCpfAcNo(), "",
						bean.getRegion(), bean.getPfid());
				DateFormat df = new SimpleDateFormat("dd-MMM-yy");
				Date transdate = df.parse(bean.getFromDate());
				if ((transdate.after(new Date("31-Mar-98"))
						&& oldemoluments != "" && Float
						.parseFloat(oldemoluments) != 0.00)) {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 12 / 100);
				} else if (oldemoluments != "") {
					oldemppfstatuary = String.valueOf(Float
							.parseFloat(oldemoluments) * 10 / 100);
				}
				while (rs.next()) {
					int count = rs.getInt(1);
					if (oldemppfstatuary == "" || oldemppfstatuary == "0.00") {
						oldemppfstatuary = "0.00";
						oldemoluments = "0.00";
					}
					float newemppfstatuary = Float.parseFloat(bean
							.getEmployeePF())
							+ Float.parseFloat(oldemppfstatuary);
					float newemoluments = Float
							.parseFloat(bean.getEmoluments())
							+ Float.parseFloat(oldemoluments);
					if (count == 0) {
						emoluments_log = "insert into emoluments_log(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
								+ oldemoluments
								+ "','"
								+ newemoluments
								+ "','"
								+ oldemppfstatuary
								+ "','"
								+ newemppfstatuary
								+ "','"
								+ bean.getFromDate()
								+ "','"
								+ updatedDate
								+ "','"
								+ bean.getPfid()
								+ "','"
								+ bean.getCpfAcNo()
								+ "','"
								+ bean.getRegion()
								+ "','" + userName + "','" + ipAddress + "')";
					} else {
						emoluments_log = "update emoluments_log set oldemoluments='"
								+ oldemoluments
								+ "',newemoluments='"
								+ newemoluments
								+ "',oldemppfstatuary='"
								+ oldemppfstatuary
								+ "',newemppfstatuary='"
								+ newemppfstatuary
								+ "',monthyear='"
								+ bean.getFromDate()
								+ "',UPDATEDDATE='"
								+ updatedDate
								+ "',pensionno='"
								+ bean.getPfid()
								+ "',region='"
								+ bean.getRegion()
								+ "',username='"
								+ userName
								+ "',computername='"
								+ ipAddress
								+ "' where cpfacno='"
								+ bean.getCpfAcNo()
								+ "' and  to_char(monthyear,'dd-Mon-yy') like '%"
								+ transMonthYear
								+ "' and region='"
								+ bean.getRegion() + "'";

					}

					emoluments_log_history = "insert into emoluments_log_history(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
							+ oldemoluments
							+ "','"
							+ newemoluments
							+ "','"
							+ oldemppfstatuary
							+ "','"
							+ newemppfstatuary
							+ "','"
							+ bean.getFromDate()
							+ "','"
							+ updatedDate
							+ "','"
							+ bean.getPfid()
							+ "','"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getRegion()
							+ "','" + userName + "','" + ipAddress + "')";
					st.executeUpdate(emoluments_log);
					st.executeUpdate(emoluments_log_history);
				}

				String insertArrear = "insert into EMPLOYEE_PENSION_ARREAR (CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,REGION,AIRPORTCODE,remarks) values('"
						+ bean.getCpfAcNo()
						+ "','"
						+ bean.getEmpNumber()
						+ "','"
						+ bean.getEmpName()
						+ "','"
						+ bean.getFromDate()
						+ "','"
						+ bean.getEmoluments()
						+ "','"
						+ bean.getStation()
						+ "','"
						+ bean.getRegion()
						+ "','Supplimentory_AAI_GL')";
				String updateEmoluments = "";
				transMonthYear = commonUtil.converDBToAppFormat(bean
						.getFromDate(), "dd-MMM-yyyy", "MMM-yyyy");
				String foundSalaryDate = this.getEmolumentsBesedonPFID(conn,
						bean.getFromDate(), bean.getCpfAcNo(), bean
								.getEmpNumber(), bean.getRegion(), bean
								.getPfid());

				if (foundSalaryDate != "" && foundSalaryDate != "0.00") {
					updateEmoluments = "update employee_pension_validate set EMOLUMENTS=EMOLUMENTS+"
							+ bean.getEmoluments()
							+ ", EMPPFSTATUARY=EMPPFSTATUARY+"
							+ bean.getEmployeePF()
							+ ",EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "'))  where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'Mon-yyyy')='"
							+ transMonthYear + "'";
				} else {
					updateEmoluments = "insert into employee_pension_validate(cpfaccno,pensionno,employeename,emoluments,EMPPFSTATUARY,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,region,monthyear,empvpf)"
							+ "values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getPfid()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ bean.getEmoluments()
							+ "','"
							+ bean.getEmployeePF()
							+ "','"
							+ bean.getPrincipal()
							+ "','"
							+ bean.getInterest()
							+ "','"
							+ bean.getRegion()
							+ "','"
							+ bean.getFromDate()
							+ "','"
							+ bean.getEmployeeVPF() + "')";
				}
				log.info("Update arrears " + updateEmoluments);

				st.addBatch(insertArrear);
				st.addBatch(updateEmoluments);
				int count[] = st.executeBatch();
				log.info("count is" + count.length);

			}

		} catch (Exception e) {
			log.printStackTrace(e);
		}
		log.info("ImportDao :importOfficeComplexDparrears leaving method");

	}

	public String importMonthlyTrData(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
				log.info("ImportDao :importMonthlyTrData() entering method");
				String message = "";
				ArrayList xlsDataList = new ArrayList();
				FinancialReportDAO fDao = new FinancialReportDAO();
				xlsDataList = commonUtil.getTheList(xlsData, "***");
				// log.info("xlsDataList======"+xlsDataList);
				Set duplicateSet = new HashSet();
				ArrayList TransferList = new ArrayList();
				ArrayList duplicateList = new ArrayList();
				ArrayList exceptionList = new ArrayList();		
				Connection conn = null;
				Statement st = null;
				Statement st1 = null;
				Statement st2=null;
				Statement st3=null;
				EmpMasterBean bean = null;
				String tempInfo[] = null;
				String tempData = "",srno = "";
				FileWriter fw = null;
				char[] delimiters = { '"', ',', '\'', '*', ',' };
				String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
				String uploadFilePath = "";
				String xlsEmpName = "", monthYear = "", dateofbirth = "";
				PreparedStatement pst = null;
				PreparedStatement pst1 = null;		
				ResultSet rs = null;
				ResultSet rs1 = null;	
				ResultSet rs2 = null;
				boolean addflag = false;
				boolean updateflag = false;	
				String returnMessage="";
				int addBatchcount[] = { 0 };
				int addBatchcount1[] = { 0 };
				try {
					ResourceBundle bundle = ResourceBundle.getBundle("aims.resource.DbProperties");
					uploadFilePath = bundle.getString("upload.folder.path");
					File filePath = new File(uploadFilePath);
					if (!filePath.exists()) {
						filePath.mkdirs();
					}
					fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
					conn = commonDB.getConnection();			
					st = conn.createStatement();
					st1 = conn.createStatement();
					st2=conn.createStatement();
					st3=conn.createStatement();		
					conn.setAutoCommit(false);
					String convertedMonthYear = commonUtil.getMonthYear(month, year);
					String lastactiveMonth = "01" + "-" + convertedMonthYear;
					String monthyear = convertedMonthYear;			
					String importMonthStatus = "select lower(FILENAME) as FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
							+ lastactiveMonth + "')";
					rs = st1.executeQuery(importMonthStatus);
					while (rs.next()) {
						if (rs.getString("IMPORTSTATUS").equals("Y")
								&& rs.getString("FILENAME").equals(fileName.toLowerCase())
								&& rs.getString("monthyear").equals(lastactiveMonth)) {
							exceptionList.add(fileName.trim()
									+ " Sheet Already Imported for Salary Month "
									+ month + "-" + year);
						} 
					}
					if(userName.trim().equals("navayuga")){
					String checkimportstatustemp="select lower(airportcode) as airportcode from employee_form3_temporary where rowid in(select min(rowid) from employee_form3_temporary where lower(airportcode)='"+airportcode.toLowerCase()+"')  and lower(region)='"+region.toLowerCase()+"'";
					rs = st.executeQuery(checkimportstatustemp);
					if(rs!=null){
						while (rs.next()) {
						if (rs.getString("airportcode").equals(airportcode.toLowerCase()))
							{
							exceptionList.add("AAIEPF-3 sheet for the airportcode "+airportcode+" is Alreeady Imported by the User partially...Please Delete the Sheet from Deviation Data Screen to import it once again");
						} 
						}
					}
					}					
					String  srnoCheck = "";	
					String monthyear2="";
					int deviationCount=0;
					String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR,IMPORTSTATUS) values(?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(payment_recov_mnth_upload_log);
					pst.setString(1, fileName.trim());
					pst.setString(2, userName.trim());
					pst.setString(3, ipAddress.trim());
					pst.setString(4, airportcode);
					pst.setString(5, region);
					pst.setString(6, lastactiveMonth.trim());
					pst.setString(7, "N");
					pst.executeUpdate();			
					String finacetempararyInsert = "insert into employee_form3_temporary(gross,emoluments,emppfstatuary,AIRPORTCODE,"
							+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,form3remarks,dateofbirth,wetheroption,DEVIATIONFLAG,accounttype,prevEmol,leaveflag,additionalcontri )"
							+ " values(?,?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
					pst1 = conn.prepareStatement(finacetempararyInsert);
					String finaceInsert = "insert into employee_pension_validate(gross,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,form3remarks,leaveflag,additionalcontri)"
						+ " values(?,?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				pst = conn.prepareStatement(finaceInsert);
					log.info("xlsDataList.size" + xlsDataList.size());
					for (int i = 1; i < xlsDataList.size(); i++) {				
						srnoCheck = xlsDataList.get(1).toString();
						String tempSrNoCheck[] = srnoCheck.split("@");
						log.info("i"+i+"tempSrNoCheck[0].trim()"+tempSrNoCheck[0].trim());
						if (i == 1 &&!tempSrNoCheck[0].trim().equals("1")) {
							exceptionList.add("Please Put The Data from 12th Row Onwards and SRNO Should be Start With 1");
							}
						String PfidFlag="N";
						double pensioncontri = 0.00, pf = 0.00,diff=0.00;						
						double calculatedPension = 0.00;
						double calculatedAdditionalContri = 0.0;
						double calculatedEmoluments = 0.00;
						String foundSalaryDate = "", retirementDate = "",freezedPenData="",prevEmol="",leavequery="";
						String deviationflag="";
						bean = new EmpMasterBean();
						String leaveflag="N";
						tempData = xlsDataList.get(i).toString();
						tempInfo = tempData.split("@");
						bean.setRegion(region);
						if (!tempInfo[0].equals("XXX")) {
							srno = tempInfo[0];
						} else {
							srno = "";
						}
						if (!tempInfo[1].equals("XXX")) {
							bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
						} else {
							bean.setPfid("");
						}
						
						log.info(bean.getPfid());
						if (!tempInfo[2].equals("XXX")) {
							bean.setCpfAcNo(tempInfo[2].trim());
						} else {
							bean.setCpfAcNo("");
						}
						if (!tempInfo[3].equals("XXX")) {
							bean.setEmpNumber(tempInfo[3].trim());
						} else {
							bean.setEmpNumber("");
						}
						if (!tempInfo[4].equals("XXX")) {
							bean.setEmpName(tempInfo[4].trim());
						} else {
							bean.setEmpName("");
						}
						if(!bean.getPfid().equals("")){
							try{					
								Integer.parseInt(bean.getPfid());
								PfidFlag="Y";
							}catch (NumberFormatException e){					
								exceptionList.add("PFID "
										+ bean.getPfid().trim() + " doesn't Exist"
										+ " for  Employee " + bean.getEmpName()
										+ ". PFID is Mandatory for All The Employees");
							}
							}
						if (!tempInfo[5].equals("XXX")) {
							bean.setDesegnation(tempInfo[5].trim());
						} else {
							bean.setDesegnation("");
						}
						if (!tempInfo[6].equals("XXX")) {
							bean.setFhName(tempInfo[6].trim());
						} else {
							bean.setFhName("");
						}				
						log.info("PFID" + tempInfo[1] + "Length" + tempInfo.length);
						if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
							String convertedDate = commonUtil
									.convertDateFormat(tempInfo[8].trim());
							log.info("converted date is " + convertedDate);
							int index = tempInfo[8].trim().indexOf("-");
							String count[] = tempInfo[8].split("-");
							log.info(" countlength " + count.length);
							if (index == -1 || count.length != 3) {
								exceptionList.add(
										"PFID "
												+ bean.getPfid().trim()
												+ " Doesn't Have Valid Date Format(i.e dd-Mon-yyyy) In Column I of The Uploaded Sheet ");
							}
							String sheetDateMonthYear = tempInfo[8];
							String sheetDateMonthyear[] = tempInfo[8].split("-");
							// String sheetDateMonthyear[] = tempInfo[8].split("-");
							String sheetMonthYear = sheetDateMonthyear[1] + "-"
									+ sheetDateMonthyear[2];
							log.info("sheetMonthYear======="+sheetMonthYear);
							if (!monthyear.equals(sheetMonthYear)) {
								String monthyear1[] = tempInfo[8].split("-");
								String month1 = monthyear1[1];
								String year1 = monthyear1[2];
								exceptionList.add("Please Make Sure That The Salary Month Selected above (i.e "
												+ convertedMonthYear
												+ " is Matching With Month Given in The Excel Sheet at Column I Against PFID "
												+ tempInfo[1].trim() + " ( i.e "
												+ sheetMonthYear + ")");
							}					 		
								DateFormat df = new SimpleDateFormat("MMM-yyyy"); 						
								log.info(df.format(new Date())); 
								String currentdate=df.format(new Date());
								log.info("currentdate"+currentdate);
								log.info("sheetMonthYear"+sheetMonthYear);
								if (currentdate.equals(sheetMonthYear)) {							
									Date currdate=new Date();							
									int curdate=currdate.getDate();
									log.info("currentdatteis -----"+curdate);
									if(curdate<25){
										log.info("inside"+currdate.getDate());
										exceptionList.add("Your uploading current month data.You don't have previlages to upload before 25th of current month");
								}
								}
								long transMntYear = 0, empRetriedDt = 0, dateofseperation=0;
								if(PfidFlag.equals("Y")){
								String annuationdate="select EMPLOYEENAME,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,to_char((dateofbirth + INTERVAL '60' year ),'dd-Mon-yyyy') as DOR from employee_personal_info where to_char(pensionno)='"+ bean.getPfid() + "'";
							log.info("annuationdate"+annuationdate);
								rs = st1.executeQuery(annuationdate);					
								if (!rs.next()) {
									exceptionList.add("PFID "
											+ bean.getPfid().trim() + " doesn't Exist"
											+ " for  Employee " + bean.getEmpName()
											+ ". PFID is Mandatory for All The Employees");
								}else{					
								if (rs.getString("DOR") != null) {
									bean.setDateOfAnnuation(rs.getString("DOR"));
								} else {
									bean.setDateOfAnnuation("");
								}
								if (rs.getString("EMPLOYEENAME") != null) {
									bean.setNomineeName(rs.getString("EMPLOYEENAME"));
								} else {
									bean.setNomineeName("");
								}
								if (rs.getString("DATEOFSEPERATION_DATE") != null) {
									bean.setDateofSeperationDate(commonUtil.converDBToAppFormat(rs
											.getDate("DATEOFSEPERATION_DATE")));
								}else {
									bean.setDateofSeperationDate("");
								}
								if (rs.getString("DATEOFSEPERATION_REASON") != null) {
									bean.setSeperationReason(rs.getString("DATEOFSEPERATION_REASON").trim());
								} else {
									bean.setSeperationReason("");
								}
								log.info(bean.getDateOfAnnuation().trim());			
								String sheetTransYear = 01+"-"+sheetDateMonthyear[1] +"-"+ sheetDateMonthyear[2];					
								transMntYear = Date.parse(sheetTransYear);							
								empRetriedDt = Date.parse(bean.getDateOfAnnuation());						
								freezedPenData = this.FreezedpennoData(conn,sheetTransYear.trim(), bean.getPfid());						
								if(!freezedPenData.equals(""))	{
								        String count1[] = freezedPenData.split("_");
										String pensionno = count1[0];
										String username = count1[1];							
										//throw new InvalidDataException("Monthly Recoverie Data Alredy Imported for PFID "+pensionno+" , in the month of "+monthyear2+" for the Airportcode "+stationname+" and Region "+region1+" ");
										exceptionList.add("PFID "+pensionno+" Frozen in the month of "+sheetTransYear+" as Per Request on '"+username+"'");
								
							}
								if (transMntYear > empRetriedDt) {
									exceptionList.add("Retirement Date completed.You don't have previlages to upload after Retirement for the PFID "
											+ bean.getPfid().trim() 
											+ "	for   Employee " 
											+ bean.getEmpName()
											+ ".");	
								}	
								log.info("DOS=="+bean.getDateofSeperationDate().trim());
								if(!bean.getDateofSeperationDate().trim().equals("")){
								dateofseperation=Date.parse(bean.getDateofSeperationDate());						
								if (transMntYear > dateofseperation) {
									exceptionList.add("Employee attained "+bean.getSeperationReason()+" on "+bean.getDateofSeperationDate()+" and EmployeeName is "+bean.getNomineeName()+" in Epis DB.You don't have previlages to upload after Date of Seperation for the PFID "
											+ bean.getPfid().trim() 
											+ "	for   Employee " 
											+ bean.getEmpName()
											+ ".");	
								}
							}
								}}	
						}

						if (!tempInfo[8].equals("XXX")
								&& !bean.getPfid().trim().equals("")) {
							String sheetDateMonth[] = tempInfo[8].split("-");			
							String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
							String monthyearQuery = "SELECT  to_char(add_months('"
									+ monthyearsheet.trim()
									+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
							
							log.info(monthyearQuery);
							rs = st1.executeQuery(monthyearQuery);
							if (rs.next()) {
								monthyear2 = rs.getString(1);
							}
							
							    
						}
						log.info("monthyear 2 " + monthyear2);

						if (!tempInfo[7].equals("XXX")) {
							bean.setDateofBirth(tempInfo[7].trim());
						} else {
							bean.setDateofBirth("");
						}

						if (!tempInfo[8].equals("XXX")) {
							monthYear = tempInfo[8].trim();
						} else {
							monthYear = "";
						}

						String finyear = "";
						Date transdate = null;
						log.info("monthyear" + monthyear);
						if (!tempInfo[8].equals("XXX")
								&& !bean.getPfid().trim().equals("")) {
							DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
							transdate = df.parse(monthYear);

						}
						log.info("monthyear25" + monthyear+tempInfo[9]);
						if (!tempInfo[9].equals("XXX")) {
							bean.setGross(tempInfo[9].replaceAll(",", "").trim());
						} else {
							bean.setGross("0.00");
						}
						
						
						if (!tempInfo[10].equals("XXX")) {
							bean.setEmoluments(tempInfo[10].replaceAll(",", "").trim());
						} else {
							bean.setEmoluments("0.00");
						}
						if(Math.round(Double.parseDouble(bean.getEmoluments()))>0 && Math.round(Double.parseDouble(bean.getGross()))<=0){
						log.info("monthyear28" + monthyear);
						exceptionList.add("Gross for the PFID "+bean.getPfid().trim()+" cannot be Zero or Empty");					
				}
						if (!tempInfo[11].equals("XXX")) {
							bean.setEmployeePF(tempInfo[11].replaceAll(",", "").trim());
						} else {
							bean.setEmployeePF("0.00");
						}
						if (!bean.getPfid().trim().equals("")) {
						if(Math.round(Double.parseDouble(bean.getEmoluments()))<0){
							exceptionList.add("Emoluments for the PFID "+bean.getPfid().trim()+" cannot be Negative");					
					}
						
						diff=Double.parseDouble(bean.getEmoluments())*12/100-Double.parseDouble(bean.getEmployeePF());
						if(diff>=1 || diff<=-1){
							exceptionList.add("EPF Is Not Equal to (Emoluments/12%)   , for the PFID "+bean.getPfid().trim()+" and EmployeeName "+bean.getEmpName());
						}
						  /*if(Double.parseDouble(bean.getEmoluments())!=Math.round(Double.parseDouble(bean.getEmployeePF())*100/12))
						  { 
							  exceptionList.add("Emoluments Is Not Equal to (EPF/12%)   , for the PFID "+bean.getPfid().trim()+" and EmployeeName "+bean.getEmpName());
							}*/
						 
						if(Math.round(Double.parseDouble(bean.getEmoluments().toString()))>0 && Math.round(Double.parseDouble(bean.getEmployeePF().toString()))<0){
							exceptionList.add(
									"PFID "
											+ bean.getPfid().trim()
											+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
						
						}
		            if(Math.round(Double.parseDouble(bean.getEmployeePF().toString()))>0 && Math.round(Double.parseDouble(bean.getEmoluments().toString()))<0 ){
		            	exceptionList.add(
								"PFID"
										+ bean.getPfid().trim()
										+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
					
						}
						
						} 
						if (!tempInfo[12].equals("XXX")) {
							bean
									.setEmployeeVPF(tempInfo[12].replaceAll(",", "")
											.trim());
						} else {
							bean.setEmployeeVPF("0.00");
						}
						log.info("monthyear26" + monthyear);
						if (!tempInfo[13].equals("XXX")) {
							bean.setPrincipal(tempInfo[13].replaceAll(",", "").trim());
						} else {
							bean.setPrincipal("0.00");
						}
						if (!tempInfo[14].equals("XXX")) {
							bean.setInterest(tempInfo[14].replaceAll(",", "").trim());
						} else {
							bean.setInterest("0.00");
						}
						log.info("monthyear" + monthyear);
						if (!tempInfo[19].equals("XXX")) {
							bean.setStation(tempInfo[19].trim());
						} else {
							bean.setStation("");
						}
						log.info("tempInfo[19]"+tempInfo[19]);
						if(userName.trim().equals("navayuga")){
						if (!tempInfo[20].equals("XXX")) {
							bean.setRemarks(tempInfo[20].trim());
						} else {
							bean.setRemarks("");
						}}else{
							bean.setRemarks("");
							}
						log.info("tempInfo[20]"+tempInfo[20]);
						if (!tempInfo[21].equals("XXX")) {
							bean.setNotes(tempInfo[21].trim());
						} else {
							bean.setNotes("");
						}
						log.info("bean.getNotes()1"+bean.getNotes());
						if(!bean.getNotes().trim().equals("")){
							log.info("bean.getNotes()2"+bean.getNotes());
							if( !bean.getNotes().trim().equals("0")){
							try {
								log.info("bean.getNotes()3"+bean.getNotes());
							bean.setNotes(String.valueOf(Double.parseDouble(bean.getNotes().trim())));
							log.info("bean.getNotes()4"+bean.getNotes());
							if(Double.parseDouble(bean.getNotes().trim())<=0){
								exceptionList.add("Please Enter valid Positive Numeric Data in the EOL :"+bean.getNotes().trim()+" for the PFID "
										+ bean.getPfid().trim()
									+ "  in Column U of the Uploaded sheet ");
							}
							if(Double.parseDouble(bean.getNotes().trim())>31){
								exceptionList.add("EOL's cannot be  more than 31 days. for the PFID "+ bean.getPfid().trim()+ "  in Column U of the Uploaded sheet ");
							}
							if(Double.parseDouble(bean.getNotes().trim())>0){
								leavequery = "insert into employee_monthly_leaves (PENSIONNO,MONTHYEAR,LEAVETYPE,NOOFLEAVES,USERNAME,AIRPORTCODE,REGION) values('"+bean.getPfid()+"','"+monthyear2+"','EOL','"+bean.getNotes().trim()+"','"+userName.trim()+"','"+bean.getStation().trim()+"','"+bean.getRegion().trim()+"')";
								log.info(leavequery);
								st3.addBatch(leavequery);
								leaveflag="Y";
							}
							}catch(NumberFormatException e){
								exceptionList.add("Please Enter only Numeric Data in the EOL :"+bean.getNotes().trim()+" for the PFID "
											+ bean.getPfid().trim()
										+ "  in Column U of the Uploaded sheet ");
							}
						}
						}
						
						if (airportcode != null	&& !bean.getPfid().trim().equals("")/*&& (region.equals("CHQIAD") || region.equals("South Region"))*/) {
							log.info("sheet airportcode "
									+ bean.getStation().trim()
									+ " selected airportcode "
									+ airportcode.trim() + "srno " + srno);
							if (!bean.getStation().trim().equals(airportcode.trim())&& !srno.equals("")) {
								exceptionList.add(
										"Make Sure That The Selected Airport Code above  (i.e "
												+ airportcode
												+ ") and is Matching with Airport Code given in the excel sheet at Column 18. i.e"
												+ bean.getStation()+ ".for the PFID "
											+ bean.getPfid().trim());
							}
						}
						
						log.info("cpfaccno " + bean.getCpfAcNo() + " " + bean.getPfid()
								+ "bean.getPfid().trim().equals()"
								+ bean.getPfid().trim().equals("")
								+ "bean.getCpfAcNo().trim().equals()"
								+ bean.getCpfAcNo().trim().equals(""));
						if (srno.equals("") && !bean.getPfid().trim().equals("")) {
							exceptionList.add(
									"PFID "
											+ bean.getPfid().trim()
											+ " doesn't have SRNO in Column A of the Uploaded sheet ");
						}
						if (!srno.equals("") && bean.getPfid().trim().equals("")) {
							exceptionList.add("PFID "
									+ bean.getPfid().trim() + " doesn't Exist"
									+ " for   Employee " + bean.getEmpName()
									+ ". PFID is Mandatory for All The Employees");
						}

						if (!bean.getPfid().trim().equals("") && monthYear.equals("")) {
							exceptionList.add("monthyear " + monthyear
									+ " doesn't Exist" + " for PFID "
									+ bean.getPfid().trim() + ", " + bean.getEmpName()
									+ ". monthyear is Mandatory for All The Employees");
						}
						if(PfidFlag.equals("Y")){
		                  // For updation of latest Airportcode and Region and basic to EmployeePersonal info table 
						String updateLatestAirport="update employee_personal_info set AIRPORTCODE='"+bean.getStation()+"',region='"+region+"',basic='"+bean.getEmoluments()+"' where pensionno='"+bean.getPfid()+"'";	
						log.info(updateLatestAirport);
						st2.addBatch(updateLatestAirport);
						if (!bean.getPfid().trim().equals("")) {
							String sheetDateMonth[] = tempInfo[8].split("-");			
						String	 monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
								//changed the caliculation upto as 696
							/*String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
									+ monthyearsheet
									+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
									+ bean.getPfid() + "'";*/
							
							//if(commonUtil.compareTwoDates("01-Mar-2015", monthyearsheet)) {
							String checkPFID = " select a.wetheroption, a.pensionno, a.REIREMENTDATE, a.days, a.calPensionupto, a.dateofbirth, nvl(b.freshpensionoption, 'B') as freshpensionoption  from (select i.wetheroption, i.pensionno," +
												" to_char(add_months(i.dateofbirth, 696), 'dd-Mon-yyyy') AS REIREMENTDATE, to_char(i.dateofbirth, 'dd-Mon-yyyy') as dateofbirth, to_date('"+monthyearsheet+"', 'DD-Mon-RRRR') - to_date(add_months(TO_DATE(i.dateofbirth), (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)), "+
												" 'dd-Mon-RRRR') + 1 as days, to_char(add_months(i.dateofbirth, (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)), 'dd-Mon-yyyy') AS calPensionupto  from employee_personal_info i) a, (select nvl(j.freshpensionoption, 'B') as freshpensionoption, "+
												" j.pensionno, to_char(add_months(j.dateofbirth, 696), 'dd-Mon-yyyy') AS REIREMENTDATE, to_char(j.dateofbirth, 'dd-Mon-yyyy') as dateofbirth, to_date('"+monthyearsheet+"', 'DD-Mon-RRRR') - to_date(add_months(TO_DATE(j.dateofbirth), 696), " +
												" 'dd-Mon-RRRR') + 1 as days, to_char(add_months(j.dateofbirth, 696), 'dd-Mon-yyyy') AS calPensionupto from employee_pension_freshoption j where j.deleteflag='N') b  where to_char(a.pensionno) = '"+bean.getPfid()+ "' and  a.pensionno = b.pensionno(+) ";
						//	}
							
							log.info("Qury (New Code) venkatesh==== "+checkPFID);
							rs = st1.executeQuery(checkPFID);
							if (!rs.next()) {
								exceptionList.add("PFID "
										+ bean.getPfid().trim() + " doesn't Exist"
										+ " for  Employee " + bean.getEmpName()
										+ ". PFID is Mandatory for All The Employees");
							}else{
							if (rs.getString("wetheroption") != null) {
								bean.setWetherOption(rs.getString("wetheroption"));
							} else {
								bean.setWetherOption("");
							}
							/**
							 * test code start
							 * 
							 */
							if(bean.getWetherOption().trim().equals("A")) {
								if(rs.getString("freshpensionoption")!=null) {
									bean.setWetherOption(rs.getString("freshpensionoption"));									
								}
								else {
									bean.setWetherOption("B");
								}
							}
							
							/**
							 * test code end
							 * 
							 */
							log.info("wetheroption(New code)========="+bean.getWetherOption());
							
							
							if (rs.getString("REIREMENTDATE") != null) {
								retirementDate = rs.getString("REIREMENTDATE");
							} else {
								retirementDate = "";
							}
							if (rs.getString("dateofbirth") != null) {
								dateofbirth = rs.getString("dateofbirth");
							} else {
								dateofbirth = "";
							}
							String days = "0";
							if (rs.getString("days") != null) {
								days = rs.getString("days");
							} else {
								days = "0";
							}
							String calPensionupto = "";
							if (rs.getString("calPensionupto") != null) {
								calPensionupto = rs.getString("calPensionupto");
							} else {
								calPensionupto = "0";
							}

							if (tempInfo[1].equals("XXX")) {
								exceptionList.add("PFID is Blank for "
										+ bean.getCpfAcNo());
							}
							
							foundSalaryDate = this.trasactionDuplicate(conn,
									monthyear2.trim(), bean.getCpfAcNo(), bean
											.getEmpNumber(), bean.getRegion(), bean
											.getPfid(), airportcode, "");
							if(!foundSalaryDate.equals(""))	{
							        String count1[] = foundSalaryDate.split("_");
									String pensionno = count1[0];
									String stationname = count1[1];
									String region1 = count1[2];
									exceptionList.add("Monthly Recoverie Data Alredy Imported for PFID "+pensionno+" , in the month of "+monthyear2+" for the Airportcode "+stationname+" and Region "+region1+" ");
								}
							prevEmol = this.prevEmoluments(conn,
									monthyearsheet.trim(), bean.getCpfAcNo(), bean
											.getEmpNumber(), bean.getRegion(), bean
											.getPfid(), airportcode, "");
							int transCount=0;
							String transCnt="";
							String checkTransaction = "select count(*) as COUNT from employee_pension_validate where pensionno='"+ bean.getPfid() + "'";
							log.info(checkTransaction);
							rs1 = st.executeQuery(checkTransaction);
							if (rs1.next()) {
								transCnt = rs1.getString("COUNT");
							}
							log.info("transCnt"+transCnt);
							transCount=Integer.parseInt(transCnt);	
							log.info("transCount"+transCount);
							if(transCount>0){
							if(!userName.trim().equals("navayuga")){
								boolean deviation = false;
								deviationflag="";
								if((Math.round(Double.parseDouble(bean.getEmoluments())))==0){
									deviation=true;
			                    	deviationflag="Y";
								}
								log.info("prevEmol"+prevEmol);
							if(prevEmol.equals("")){
								//exceptionList.add("Previous Month Salary drawn Amount Does not Exist for PFID "+bean.getPfid()+" , in the month of "+monthyearsheet+"");
								log.info("insidebalnk");
								deviation=true;
		                    	deviationflag="Y";
							}					
							if(!prevEmol.equals("")){						
		                    if((Math.round(Double.parseDouble(bean.getEmoluments()))<Math.round(Double.parseDouble(prevEmol)-1000))){
		                    log.info("inside1000");
		                    	double diff1=Math.round(Double.parseDouble(prevEmol))-Math.round(Double.parseDouble(bean.getEmoluments()));
		                     	//exceptionList.add("For PFID : "+bean.getPfid()+" Previous Month Emoluments "+Math.round(Double.parseDouble(prevEmol))+" is Lesser than the Current Month Emoluments "+Math.round(Double.parseDouble(bean.getEmoluments()))+". Difference is "+Math.round(diff1)+"");
		                    	deviation=true;
		                    	deviationflag="Y";
		                    }if((Math.round(Double.parseDouble(bean.getEmoluments()))>Math.round(Double.parseDouble(prevEmol)+5000))){
		                    	log.info("inside5000");
		                    	double diff2=Math.round(Double.parseDouble(bean.getEmoluments()))-Math.round(Double.parseDouble(prevEmol));
		                    	//exceptionList.add("For PFID : "+bean.getPfid()+" Current Month Emoluments "+Math.round(Double.parseDouble(bean.getEmoluments()))+" is greater than the Previous Month Emoluments "+Math.round(Double.parseDouble(prevEmol))+" . Difference is "+Math.round(diff2)+"");
		                    	deviation=true;
		                    	deviationflag="Y";
		                    }
		                    }
							if(deviation==true){
								log.info("insidecount");
							deviationCount++;
							log.info("deviationCount"+deviationCount);
							}
							}else if(bean.getRemarks().trim().equals("")){
		                    	if(Math.round(Double.parseDouble(bean.getEmoluments()))==0 ){
		                    		exceptionList.add("Emoluments should not be Zero or Empty. for PFID "+bean.getPfid()+" , in the month of "+monthyearsheet+"");
		                    	}
		                    	if(Math.round(Double.parseDouble(bean.getEmployeePF()))==0){
		                    		exceptionList.add("EPF should not be Zero or Empty. for PFID "+bean.getPfid()+" , in the month of "+monthyearsheet+"");
		                    	}
		                    	if(prevEmol.equals("")){
		    						exceptionList.add("Previous Month Salary drawn Amount Does not Exist for PFID "+bean.getPfid()+" , in the month of "+monthyearsheet+"");
		    					}
		                    	if(!prevEmol.equals("")){
		                            if((Math.round(Double.parseDouble(bean.getEmoluments()))<Math.round(Double.parseDouble(prevEmol)-1000))){
		                            	double diff1=Math.round(Double.parseDouble(prevEmol))-Math.round(Double.parseDouble(bean.getEmoluments()));
		                            	//exceptionList.add("Salary drawn Amount is not matching with the Previous Month Salary drawn Amount for the PFID "+bean.getPfid()+" , in the month of "+monthyearsheet+"");
		                            	exceptionList.add("For PFID : "+bean.getPfid()+" Previous Month Emoluments "+Math.round(Double.parseDouble(prevEmol))+" is Lesser than the Current Month Emoluments "+Math.round(Double.parseDouble(bean.getEmoluments()))+". Difference is "+Math.round(diff1)+"");
		                            }if((Math.round(Double.parseDouble(bean.getEmoluments()))>Math.round(Double.parseDouble(prevEmol)+5000))){
		                            	double diff2=Math.round(Double.parseDouble(bean.getEmoluments()))-Math.round(Double.parseDouble(prevEmol));
		                            	exceptionList.add("For PFID : "+bean.getPfid()+" Current Month Emoluments "+Math.round(Double.parseDouble(bean.getEmoluments()))+" is greater than the Previous Month Emoluments "+Math.round(Double.parseDouble(prevEmol))+" . Difference is "+Math.round(diff2)+"");
		                            }
		                            }}
							  log.info("deviationCount == (MYCODE)"+deviationCount);
							}
							FinancialReportDAO fdao = new FinancialReportDAO();	
							
							calculatedPension = this.calclatedPF1(monthyearsheet,
									calPensionupto, dateofbirth, bean.getEmoluments(), bean
											.getWetherOption(), "", days, "1", bean
											.getEmployeePF());
							
							calculatedAdditionalContri=this.calclatedAdditionalContri(monthyearsheet,
									calPensionupto, dateofbirth, bean.getEmoluments(), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF(),"");

							calculatedPension = Math.round(calculatedPension);
							calculatedAdditionalContri=Math.round(calculatedAdditionalContri);
							pf = Double.parseDouble(bean.getEmployeePF().toString())
									- calculatedPension;
							/*calculatedEmoluments = fdao.calclatedEmoluments(monthyearsheet,
									calPensionupto, dateofbirth, bean.getEmoluments(), bean
											.getWetherOption(), "", days, "1", bean
											.getEmployeePF());*/
							if(bean.getWetherOption().trim().equals("A")){
								calculatedEmoluments = Math.round((calculatedPension*100)/8.33);
								
						} else{
							String transMonthYear = "" , conditionDate = "Aug-2014";
							try {
								transMonthYear = commonUtil.converDBToAppFormat(monthyearsheet,"dd-MMM-yyyy", "MMM-yyyy");
								//commonUtil.c
							} catch (Exception e) {
								log.printStackTrace(e);
							}									
							//log.info("Compare two dates ::::"+conditionDate + "=======" +transMonthYear);
							if( commonUtil.compareTwoDates(conditionDate, transMonthYear) ) {
								if(calculatedPension!=0 && calculatedPension==1250){
									calculatedEmoluments=15000;
								}else if(calculatedPension==0){
									calculatedEmoluments=0;
								}else{
									calculatedEmoluments = Math.round((calculatedPension*100)/8.33);
								}			
							} else {
							if(calculatedPension!=0 && calculatedPension==541){
								calculatedEmoluments=6500;
							}else if(calculatedPension==0){
								calculatedEmoluments=0;
							}else{
								calculatedEmoluments = Math.round((calculatedPension*100)/8.33);
							}
							}
						}
							log.info("calculatedEmoluments=="+calculatedEmoluments);
						}}
						String accounttype="";
						String getaccounttype = "select ACCOUNTTYPE  from employee_unit_master where UNITNAME='"+ bean.getStation().trim() + "' and region='"+bean.getRegion().trim()+"'";
						log.info(getaccounttype);
						rs2 = st.executeQuery(getaccounttype);
						if (rs2.next()) {
							accounttype = rs2.getString("ACCOUNTTYPE");
						}
						if (!duplicateSet.contains(bean.getPfid())) {
							duplicateSet.add(bean.getPfid());
						} else if (bean.getPfid() != null && bean.getPfid() != "") {
							duplicateList.add(bean.getPfid());
							duplicateSet.remove(bean.getPfid());
							// continue;
						}
						if (!bean.getPfid().equals("") && !srno.equals("")) {
							String sheetDateMonth[] = tempInfo[8].split("-");			
							String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
							pst.setString(1, bean.getGross().trim());
							pst.setString(2, bean.getEmoluments().trim());
							pst.setString(3, bean.getEmployeePF().trim());
							pst.setString(4, bean.getStation());
							pst.setString(5, monthyearsheet.trim());
							pst.setString(6, bean.getEmpName().trim());
							pst.setString(7, bean.getEmpNumber().trim());
							pst.setString(8, bean.getDesegnation().trim());
							pst.setString(9, bean.getRegion().trim());
							pst.setString(10, bean.getPfid().trim());
							pst.setString(11, bean.getEmployeeVPF().trim());
							pst.setString(12, bean.getPrincipal().trim());
							pst.setString(13, bean.getInterest().trim());
							pst.setDouble(14, calculatedPension);
							pst.setDouble(15, pf);
							pst.setString(16, finyear);
							pst.setDouble(17, calculatedEmoluments);
							pst.setString(18, bean.getRemarks());
							pst.setString(19,leaveflag.trim());
							pst.setDouble(20,calculatedAdditionalContri);
							pst.addBatch();
							log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
									+ bean.getEmoluments() + "," + bean.getEmployeePF()
									+ "PFID " + bean.getPfid() + ","
									+ bean.getEmpName() + "," + bean.getEmpNumber()
									+ "," + bean.getDesegnation());
								pst1.setString(1, bean.getGross().trim());
								pst1.setString(2, bean.getEmoluments().trim());
								pst1.setString(3, bean.getEmployeePF().trim());
								pst1.setString(4, bean.getStation());
								pst1.setString(5, monthyearsheet.trim());
								pst1.setString(6, bean.getEmpName().trim());
								pst1.setString(7, bean.getEmpNumber().trim());
								pst1.setString(8, bean.getDesegnation().trim());
								pst1.setString(9, bean.getRegion().trim());
								pst1.setString(10, bean.getPfid().trim());
								pst1.setString(11, bean.getEmployeeVPF().trim());
								pst1.setString(12, bean.getPrincipal().trim());
								pst1.setString(13, bean.getInterest().trim());
								pst1.setDouble(14, calculatedPension);
								pst1.setDouble(15, pf);
								pst1.setString(16, finyear);
								pst1.setDouble(17, calculatedEmoluments);
								pst1.setString(18, bean.getRemarks());
								pst1.setString(19, dateofbirth.trim());
								pst1.setString(20,bean.getWetherOption().trim());
								pst1.setString(21,deviationflag.trim());
								pst1.setString(22,accounttype.trim());
								pst1.setString(23,prevEmol.trim());
								pst1.setString(24,leaveflag.trim());
								pst1.setDouble(25,calculatedAdditionalContri);
								pst1.addBatch();								
								addflag = true;					
								rs.close();
								rs1.close();
								rs2.close();
						} else if (!bean.getPfid().equals("") && !srno.equals("")) {
							String insertArrearCount = "";
							float basicDaSum = 0;
							String transMonthYear = commonUtil.converDBToAppFormat(monthyear2.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
							insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
									+ bean.getEmoluments()
									+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
									+ bean.getEmployeePF().trim()
									+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
									+ bean.getPrincipal().trim()
									+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
									+ bean.getInterest().trim()
									+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
									+ bean.getEmployeeVPF().trim()
									+ "')),calcEmoluments=to_char(to_number(nvl(calcEmoluments,0)+'"
									+ calculatedEmoluments
									+ "'  where region='"
									+ bean.getRegion().trim()
									+ "' and airportcode='"
									+ bean.getStation()
									+ "' and cpfaccno='"
									+ bean.getCpfAcNo().trim()
									+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
									+ transMonthYear + "'";
							//st.addBatch(insertArrearCount);
							updateflag = true;
						}
						// }
					}
					}
					if (addflag) {
						if (duplicateList.size() > 0) {
							StringBuffer dupliateRecords = new StringBuffer();
							for (Iterator it = duplicateList.iterator(); it.hasNext();) {
								dupliateRecords.append(it.next() + "\n" + ",");
							}
							exceptionList.add(
									" The Imported Sheet Having the Dupliate Records For The PFID's "
											+ dupliateRecords);
						}
						 if (exceptionList.size() > 0) {					
								StringBuffer exceptionRecords = new StringBuffer();
								Set set = new HashSet();
								StringBuffer newRecords = new StringBuffer();
								String mesg="";
								for (Iterator it = exceptionList.iterator(); it.hasNext();) {
									Object element = it.next();
									if (set.add(element))
										newRecords.append(element + "\r\n" + "-->");
									}
								exceptionList.clear();
								exceptionRecords.append(newRecords);
								log.info("exceptionRecords"+exceptionRecords);
								if(exceptionRecords.indexOf("java.lang.ArrayIndexOutOfBoundsException")==-1){
									mesg=""+ exceptionRecords;
							}						 
								throw new InvalidDataException(mesg);
							}
						 if(deviationCount>0){					 
							 addBatchcount = pst1.executeBatch();	
							 log.info("addBatchcount==="+Integer.parseInt(String.valueOf(addBatchcount.length))+"deviationCount--"+deviationCount);
							 int deviation=Integer.parseInt(String.valueOf(addBatchcount.length));
							 returnMessage="Total Inserted Records - "+deviation+"  in that Deviation Records - "+deviationCount+"";
							 st3.executeBatch();
						 }else{
							 
							// log.info("Inside else condition=================");
							 conn.setAutoCommit(false);
							 addBatchcount1=pst1.executeBatch();
							 conn.commit();					 
							  TransferList=this.getStationInOutRecords(region,year,month,airportcode) ;
							 log.info("TransferList.size"+TransferList.size());					
							 if(TransferList.size()>0){							
								 addBatchcount=pst1.executeBatch(); 
								 log.info("addBatchcount1="+addBatchcount.length);
								 int deviation=Integer.parseInt(String.valueOf(addBatchcount1.length));
								 log.info("deviation="+deviation);
								 returnMessage="Total Inserted Records- "+deviation+".Please submit the Remarks for below Deviation Records.";
							 }else{							
								addBatchcount = pst.executeBatch();
								int deviation=Integer.parseInt(String.valueOf(addBatchcount.length));
								 returnMessage=fileName.trim()+" Sheet Imported SuccessFully. Total Inserted Records - "+deviation+"";
								 String deletetrans="delete from employee_form3_temporary where monthyear='"+monthyear2+"' and airportcode='"+airportcode+"' and region='"+region+"'";
								
								 st.execute(deletetrans);
								 st3.executeBatch();
							 }
						}
						st2.executeBatch();
					}			
					if (updateflag) {
						int updatedBatchCount[] = st.executeBatch();
						log.info("Updated Records count is "+ updatedBatchCount.length);
					}
					String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y',AIRPORT='"+bean.getStation()+"' where filename='"
							+ fileName + "'";
					st.executeUpdate(importStausupdate);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					log.printStackTrace(e);
					throw new InvalidDataException(e.getMessage());		
				} catch (Exception e) {
					// TODO Auto-generated catch block
					 log.info(e.toString());
					 log.info("exceptionList.size()"+exceptionList.size());
					 if (exceptionList.size() > 0) {				
							StringBuffer exceptionRecords = new StringBuffer();
							Set set = new HashSet();
							StringBuffer newRecords = new StringBuffer();
							String mesg="";
							for (Iterator it = exceptionList.iterator(); it.hasNext();) {
								Object element = it.next();
								if (set.add(element))
									newRecords.append(element + "\r\n" + "-->");
								}
							exceptionList.clear();
							exceptionRecords.append(newRecords);
							log.info("exceptionRecords"+exceptionRecords);
							if(exceptionRecords.indexOf("java.lang.ArrayIndexOutOfBoundsException")==-1){
								mesg=""+ exceptionRecords;					
						}
							
							throw new InvalidDataException(mesg);
						}
						String msg="";
						String txt=e.toString();
						if(txt.indexOf("java.lang.ArrayIndexOutOfBoundsException")!=-1){
						 msg="Please Enter Valid Data ( Excepting only Numeric Values) for the PFID "+bean.getPfid()+" in SRN0 "+srno+" , Containing Invalid Characters in the Column No";	
						}				
						throw new InvalidDataException(msg +""+e.getMessage());
				} finally {
					try {
						rs.close();
						rs1.close();
						rs2.close();
						st1.close();
						st2.close();
						st.close();
						pst.close();
						conn.close();
						commonDB.closeConnection(conn, st, rs);
						
					} catch (Exception e) {
					}
				}

				log.info("ImportDao :importMonthlyTrData leaving method");
				message = String.valueOf(addBatchcount.length);
					return returnMessage;
			}
	
	
	/*this.calclatedAdditionalContri(monthyearsheet,
			calPensionupto, dateofbirth, bean.getEmoluments(), bean
			.getWetherOption(), "", days, "1", bean
			.getEmployeePF());
	*/
	public double calclatedAdditionalContri(String monthYear, String dateOfRetriment,
			String dateOfBirth, String calEmoluments, String wetherOption,
			String region, String days1, String emolumentMonths,
			String emppfstatuary,String dataType){
		log.info("calclatedAdditionalContri:start");
		double additionalContri=0.0;
		
		long transMntYear = 0, empRetriedDt = 0;
		boolean flag = true, contrFlag = false, chkDOBFlag = false;
		
		String days = "", getMonth = "";
		int getDaysBymonth = 0;
		DecimalFormat df = new DecimalFormat("#########0.00");
		DecimalFormat df1 = new DecimalFormat("#########0.0000000000000");
		double pensionAsPerOption = 0.0, retriredEmoluments = 0.0;
		if (flag == true) {
			if (!monthYear.equals("-NA-") && !dateOfRetriment.equals("")) {
				transMntYear = Date.parse(monthYear);
				empRetriedDt = Date.parse(dateOfRetriment);
				log.info("days " + days1 + "empRetriedDt " + empRetriedDt+ "transMntYear " + transMntYear);
				if (transMntYear >= empRetriedDt) {
					contrFlag = true;
				} else if (transMntYear == 0 || empRetriedDt == 0) {
					contrFlag = false;
				}
				log.info("contrFlag " + contrFlag);
				if (transMntYear != 0
						&& empRetriedDt != 0
						&& (Integer.parseInt(days1) >= 0 && Integer
								.parseInt(days1) <= 1)
						|| (Integer.parseInt(days1) < 0 && Integer
								.parseInt(days1) > -29)) {
					chkDOBFlag = true;
				}
			}
			if (contrFlag != true) {
				additionalContri = this.pensionAdditionalFormsCalculation(monthYear,calEmoluments, wetherOption.trim(), region, emolumentMonths,dataType);
			}
			if (chkDOBFlag == true && wetherOption.trim().equals("A")) {
				String[] dobList = dateOfBirth.split("-");
				days = dobList[0];
				getDaysBymonth = commonDAO.getNoOfDays(dateOfBirth);
				//additionalContri = additionalContri * (Double.parseDouble(days) - 1)/ getDaysBymonth;
				additionalContri=Math.round((((Double.parseDouble(calEmoluments)*(Double.parseDouble(days) - 1))/getDaysBymonth)-15000)*1.16/100);
				System.out.println("additionalContri:::::"+additionalContri+days);
				if(additionalContri<0){
					additionalContri=0;
				}
			}

		} else {
			additionalContri = 0;
		}
	
		log.info("calclatedAdditionalContri:end");
		return additionalContri;
	}
	public double calclatedPF1(String monthYear, String dateOfRetriment,
			String dateOfBirth, String calEmoluments, String wetherOption,
			String region, String days1, String emolumentMonths,
			String emppfstatuary){
		long transMntYear = 0, empRetriedDt = 0;
		boolean flag = true, contrFlag = false, chkDOBFlag = false;
		double pensionVal = 0.00;
		String days = "", getMonth = "";
		int getDaysBymonth = 0;
		DecimalFormat df = new DecimalFormat("#########0.00");
		DecimalFormat df1 = new DecimalFormat("#########0.0000000000000");
		double pensionAsPerOption = 0.0, retriredEmoluments = 0.0;
		if (flag == true) {
			if (!monthYear.equals("-NA-") && !dateOfRetriment.equals("")) {
				transMntYear = Date.parse(monthYear);
				empRetriedDt = Date.parse(dateOfRetriment);
				log.info("days " + days1 + "empRetriedDt " + empRetriedDt+ "transMntYear " + transMntYear);
				if (transMntYear >= empRetriedDt) {
					contrFlag = true;
				} else if (transMntYear == 0 || empRetriedDt == 0) {
					contrFlag = false;
				}
				log.info("contrFlag " + contrFlag);
				if (transMntYear != 0
						&& empRetriedDt != 0
						&& (Integer.parseInt(days1) >= 0 && Integer
								.parseInt(days1) <= 1)
						|| (Integer.parseInt(days1) < 0 && Integer
								.parseInt(days1) > -29)) {
					chkDOBFlag = true;
				}
			}
			if (contrFlag != true) {
				pensionVal = this.pensionFormsCalculation(monthYear,calEmoluments, wetherOption.trim(), region, emolumentMonths);
			}
			if (chkDOBFlag == true) {
				String[] dobList = dateOfBirth.split("-");
				days = dobList[0];
				getDaysBymonth = commonDAO.getNoOfDays(dateOfBirth);
				pensionVal = pensionVal * (Double.parseDouble(days) - 1)/ getDaysBymonth;
			}

		} else {
			pensionVal = 0;
		}
		return pensionVal;
	}
	public double pensionAdditionalFormsCalculation(String monthYear, String emoluments,
			String penionOption, String region,String emolumentMonths,String dataType) {
		log.info("pensionAdditionalFormsCalculation:start");
		double additionalContriVal=0.0;
		DecimalFormat df = new DecimalFormat("#########0.00");
			
		String transMonthYear = "",conditionDate = "Nov-2014";
		
		//String transMonthYear = "",conditionDate = "Jul-2014";
		
		
		try {
			transMonthYear = commonUtil.converDBToAppFormat(monthYear,"dd-MMM-yyyy", "MMM-yyyy");
		} catch (Exception e) {
			log.printStackTrace(e);
		}
		System.out.println("penoption"+penionOption);
		
		if(penionOption.equals("A")) { 			
			if( commonUtil.compareTwoDates(conditionDate, transMonthYear) ) {
				if(!dataType.equals("Arrear")){
				if (Double.parseDouble(emoluments) >= 15000) {
					additionalContriVal=Math.round(((Double.parseDouble(emoluments)-15000)*1.16)/100);
				}else {
					additionalContriVal=0.0;
				}
				}else{
					additionalContriVal=Math.round(((Double.parseDouble(emoluments))*1.16)/100);
				}
			}else {
				additionalContriVal=0.0;
			}		
			
		}else {
			additionalContriVal=0.0;
		}
		log.info("additionalContriValue==========="+additionalContriVal);
		log.info("pensionAdditionalFormsCalculation:end");
		return additionalContriVal;
	}
	
	
	
	
	public double pensionFormsCalculation(String monthYear, String emoluments,
			String penionOption, String region,String emolumentMonths) {
		
		double penContrVal = 0.0;		
		DecimalFormat df = new DecimalFormat("#########0.00");
		String transMonthYear = "",conditionDate = "Aug-2014";
		try {
			transMonthYear = commonUtil.converDBToAppFormat(monthYear,"dd-MMM-yyyy", "MMM-yyyy");
		} catch (Exception e) {
			log.printStackTrace(e);
		}		
		log.info("penionOption::::"+penionOption);
			if (!penionOption.equals("---")) {
				if (penionOption.trim().equals("A")) {					
					penContrVal = new Double(df.format((Double
							.parseDouble(emoluments) * 8.33) / 100f))
							.doubleValue();
				} else if (penionOption.trim().equals("B")) {
					log.info("Compare two dates ::::"+conditionDate + "=======" +transMonthYear);
					if( commonUtil.compareTwoDates(conditionDate, transMonthYear) ) {
						log.info("Inside new Condition for PC Calculation-------------");
						if (Double.parseDouble(emoluments) >= 15000) {
							penContrVal = Math.round((15000 * 8.33 * Double.parseDouble(emolumentMonths)) / 100f);
						}else if(Double.parseDouble(emoluments)<=-15000){
							penContrVal = Math.round((-15000 * 8.33 * Double.parseDouble(emolumentMonths)) / 100f);
						} else if (Double.parseDouble(emoluments) < 15000 && Double.parseDouble(emoluments) >=-15000) {
							penContrVal = Math.round(new Double(df.format((Double
									.parseDouble(emoluments) * 8.33 * Double
									.parseDouble(emolumentMonths)) / 100f))
									.doubleValue());
						}
						
					}
					else {
						if (Double.parseDouble(emoluments) >= 6500) {
							penContrVal = Math.round((6500 * 8.33 * Double.parseDouble(emolumentMonths)) / 100f);
						}else if(Double.parseDouble(emoluments)<=-6500){
							penContrVal = Math.round((-6500 * 8.33 * Double.parseDouble(emolumentMonths)) / 100f);
						} else if (Double.parseDouble(emoluments) < 6500 && Double.parseDouble(emoluments) >=-6500) {
							penContrVal = Math.round(new Double(df.format((Double
									.parseDouble(emoluments) * 8.33 * Double
									.parseDouble(emolumentMonths)) / 100f))
									.doubleValue());
						}
					}
				}else{
					penContrVal=0;
				}
			}
		return penContrVal;
	}
	public String importMonthwiseSupplData(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		log.info("ImportDao :importMonthwise SupplData  Entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Set duplicateSet = new HashSet();
		Set duplicateMonthyearSet = new HashSet();
		ArrayList duplicateList = new ArrayList();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement suppli = null;
		Statement insert= null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "",pcCalcMonthYear="",dateofjoining="";
		PreparedStatement pst = null;
		PreparedStatement pst1 = null;
		Statement st2=null;
		ResultSet rs = null;
		String srno = "";
		String foundSalaryDate = "", retirementDate = "",foundPensioncontri="",freezedPenData="",pcpfcardmonth="";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			st2=conn.createStatement();
			suppli = conn.createStatement();
			insert = conn.createStatement();
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			String monthyear = convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth+"monthyear:"+monthyear);
			/* checking the file import status */
			String importMonthStatus = "select lower(FILENAME) as FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);
			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName.toLowerCase())
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported for Salary Month "
							+ month + "-" + year);
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String srnoCheck = "";
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, "");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_supplimentory_data(gross,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,PAIDDATE,PFCARDNARRATION,"
					+"FILENAME,CLIENTNAME,SYSADDRESS,FORMTYPE,SALMONTH,RECMONTH,additionalcontri)"
					+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			String validateInsert = "insert into employee_pension_validate(gross,emoluments,emppfstatuary,AIRPORTCODE,"
				+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,PFCARDNARRATION,additionalcontri )"
				+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
	
			pst = conn.prepareStatement(finaceInsert);
		    pst1=conn.prepareStatement(validateInsert);
		    log.info("validateInsert"+validateInsert);
			for (int i = 1; i < xlsDataList.size(); i++) {
				srnoCheck = xlsDataList.get(1).toString();
				String tempSrNoCheck[] = srnoCheck.split("@");
				if (i == 1 && !tempSrNoCheck[0].trim().equals("1")) {
					throw new InvalidDataException(
							"Please Put the Data from 12th row onwards");
				}
				double calculatedPension = 0.00,diff=0.00;
				double calculatedEmoluments = 0.00;
				double pcdiff=0.00;
				double calculatedAdditionalContri=0.00;
				String update1Flag="";
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("tempInfo"+tempInfo);
				bean.setRegion(region);
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if(tempInfo[4].equals("XXX")){					
					throw new InvalidDataException(
							" EmployeeName Column E Cannot be Blank, Please Enter the EmployeeName for the PFID : "+bean.getPfid().trim()+"");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}
				String monthyear2 = "";
				log.info("tempInfo[8]"+tempInfo[8].trim());
			if(tempInfo[8].equals("XXX")){
				throw new InvalidDataException(
						" Salary Month Column I Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
			}
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
				}
				log.info("tempInfo[22]"+tempInfo[22].trim());
				if (!tempInfo[22].equals("XXX") && !srno.equals("")) {
					String sheetDateMonthYear = tempInfo[22];
					String sheetDateMonthyear[] = tempInfo[22].split("-");
					String sheetMonthYear = sheetDateMonthyear[1] + "-"
							+ sheetDateMonthyear[2];
					if (!monthyear.equals(sheetMonthYear)) {
												throw new InvalidDataException(
								"Please make sure that the Salary Month Selected above (i.e "
										+ convertedMonthYear
										+ " is matching with month given in the excel sheet at Column V of the Paid Date against PFID  "+bean.getPfid()+"  "+ tempInfo[22].trim() + " ( i.e "
										+ sheetMonthYear + ")");
					}	
				}
				
				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}
				log.info("tempInfo[8]"+tempInfo[8].trim());
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					log.info("convertedDate"+convertedDate.trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
					String convertedDatecpf = commonUtil
					.convertDateFormat(tempInfo[21].trim());
			log.info("convertedDate"+convertedDate.trim());
			int cpfrecindex = tempInfo[21].trim().indexOf("-");
			String cpfreccount[] = tempInfo[21].split("-");
			
			if (cpfrecindex == -1 || cpfreccount.length != 3) {
				throw new InvalidDataException(
						"PFID "
								+ bean.getPfid().trim()
								+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column U of the Uploaded sheet ");
			}
			String convertedDatepaid = commonUtil
			.convertDateFormat(tempInfo[22].trim());
	log.info("convertedDate"+convertedDate.trim());
	int paidindex = tempInfo[22].trim().indexOf("-");
	String paidcount[] = tempInfo[22].split("-");
	
	if (paidindex == -1 || paidcount.length != 3) {
		throw new InvalidDataException(
				"PFID "
						+ bean.getPfid().trim()
						+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column V of the Uploaded sheet ");
	}
					log.info("hello");
				if (!tempInfo[21].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					String sheetDateMonth[] = tempInfo[21].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ monthyearsheet.trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						monthyear2 = rs.getString(1);
					}
				}
				
				String cpfrecmonth="";
				if(!monthyear2.equals("")){
				String cpfmonth[]=monthyear2.split("-");
				 cpfrecmonth = 01+"-"+cpfmonth[1] + "-"+ cpfmonth[2];
				}
				if (!tempInfo[21].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[21].split("-");			
					monthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];					
				} else {
					monthYear = "";
				}if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					String sheetDateMonth[] = tempInfo[8].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ monthyearsheet.trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						pcpfcardmonth = rs.getString(1);
					}
				}
				log.info("pcpfcardmonth"+pcpfcardmonth);
				if (!tempInfo[8].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[8].split("-");						
					pcCalcMonthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];					
				} else {
					pcCalcMonthYear = "";
				}	
				
				String finyear = "";				
				log.info("after hello");
				if (!tempInfo[9].equals("XXX")) {
					bean.setGross(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setGross("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmoluments(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeePF(tempInfo[11].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				diff=Double.parseDouble(bean.getEmoluments())*12/100-Double.parseDouble(bean.getEmployeePF());
				if(diff>=1 || diff<=-1){
					throw new InvalidDataException("EPF Is Not Equal to (Emoluments/12%)   , for the PFID "+bean.getPfid().trim()+" and EmployeeName "+bean.getEmpName());
				}
				if(Math.round(Double.parseDouble(bean.getEmoluments().toString()))>0 && Math.round(Double.parseDouble(bean.getEmployeePF().toString()))<0){
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
				
				}
            if(Math.round(Double.parseDouble(bean.getEmployeePF().toString()))>0 && Math.round(Double.parseDouble(bean.getEmoluments().toString()))<0){
            	throw new InvalidDataException(
						"PFID"
								+ bean.getPfid().trim()
								+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
			
				}
				if (!tempInfo[12].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[12].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}

				if (!tempInfo[19].equals("XXX")) {
					bean.setStation(tempInfo[19].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[20].equals("XXX")) {
					bean.setPfcardNarration(tempInfo[20].trim());
				} else {
					bean.setPfcardNarration("");
				}			
				if (!tempInfo[21].trim().equals("XXX")) {
					String sheetCpfRecoveryDate[] = tempInfo[21].split("-");			
					bean.setCpfRecoveryDate(01+"-"+sheetCpfRecoveryDate[1] + "-"+ sheetCpfRecoveryDate[2]);
				} else {
					bean.setCpfRecoveryDate("");
				}	
				log.info("bean.getCpfRecoveryDate"+bean.getCpfRecoveryDate());
				if (!tempInfo[22].trim().equals("XXX")) {
					String sheetPaidMonth[] = tempInfo[22].split("-");			
					bean.setPaidDate(01+"-"+sheetPaidMonth[1] + "-"+ sheetPaidMonth[2]);					
				} else {
					bean.setPaidDate("");
				}
				log.info("bean.getCpfRecoveryDate"+bean.getPaidDate());
				log.info("tempInfo[22].trim()"+tempInfo[22]);
				if (tempInfo[23].trim().equals("XXX")) {
					throw new InvalidDataException("Please put username in format column X");
				}
				
				if (!tempInfo[23].trim().equals("XXX")) {
					bean.setUserName(tempInfo[23].trim());
				} else {
					bean.setUserName("");
				}
				log.info("tempInfo[23].trim()"+tempInfo[23]);
				if (tempInfo[24].trim().equals("XXX")) {
					throw new InvalidDataException("Please put flag is N in format column X ");
				}
				if (!tempInfo[24].trim().equals("XXX")) {
					bean.setAllRecordsFlag(tempInfo[24].trim());
				} else {
					bean.setAllRecordsFlag("");
				}
				 	//checking paiddate is null or not..
				if (bean.getPaidDate() == ""
						&& !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("Paid Date Column V Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
				}
				if (bean.getCpfRecoveryDate() == ""
					&& !bean.getPfid().trim().equals("")) {
				throw new InvalidDataException("Cpf Recovery Month Column U Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
			}
				if (bean.getPfcardNarration() == ""
					&& !bean.getPfid().trim().equals("")) {
				throw new InvalidDataException("Remarks Column T Cannot be Blank, Please Enter the valid Remarks for the PFID : "+bean.getPfid().trim()+""); 
				}
				log.info(bean.getCpfRecoveryDate().trim());
				//checking pensionno Freezed or not..
				log.info("FreezedpennoData"+bean.getCpfRecoveryDate().trim()+"pensionno"+bean.getPfid());
				freezedPenData = this.FreezedpennoData(conn,bean.getCpfRecoveryDate().trim(), bean.getPfid());
				log.info("freezedPenData==="+freezedPenData);
				if(!freezedPenData.equals("")){
				        String count1[] = freezedPenData.split("_");
						String pensionno = count1[0];
						String username = count1[1];							
							throw new InvalidDataException("PFID "+pensionno+" Frozen  as Per Request on '"+username+"'");
			}
				
				log.info("tempInfo[20]"+tempInfo[20].trim());
				 //checking paiddate is in correct format..
				if (bean.getPaidDate() != ""
						&& !bean.getPfid().trim().equals("")) {
					 convertedDate = commonUtil.convertDateFormat(bean
							.getPaidDate());
				 index = bean.getPaidDate().indexOf("-");
					String  count1[] = bean.getPaidDate().split("-");
				//log.info(" countlength " + count.length);
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column V of the PaidDate of the Uploaded sheet ");
					}
				}
           //checking CpfRecoveryDate is in correct format..
				if (bean.getCpfRecoveryDate() != ""
					&& !bean.getPfid().trim().equals("")) {
				 convertedDate = commonUtil.convertDateFormat(bean
						.getCpfRecoveryDate());				
				int cpfindex=bean.getCpfRecoveryDate().trim().indexOf("-");
				String cpfcount[] = bean.getCpfRecoveryDate().split("-");
				if (cpfindex == -1 || cpfcount.length != 3) {
					throw new InvalidDataException(
							"PFID "+ bean.getPfid().trim()
									+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column U of the Uploaded sheet ");
				}
				}
				//checking paid date should greater than salary recoverie date..
				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
				Date paiddate = df.parse(bean.getPaidDate());
				log.info("monthyear2=="+cpfrecmonth+"   paidate=="+bean.getPaidDate());
				if (!bean.getPfid().trim().equals("") && !new Date(bean.getPaidDate()).equals(new Date(cpfrecmonth))) {
								throw new InvalidDataException("Paid Date "+bean.getPaidDate()+"  Should Greater than CPF Recoverie date "+bean.getCpfRecoveryDate()+" only one month ");
				}
              //checking paid date should greater than CPf recoverie date..
				if (!bean.getPfid().trim().equals("") && new Date(cpfrecmonth).before(new Date("01-Mar-2011"))) {
					throw new InvalidDataException("" +"Salary month  Should be Greater than  01-Mar-2011");
	           }
              //checking paid date should greater than CPf recoverie date..
				if (!bean.getPfid().trim().equals("") && new Date(pcCalcMonthYear).before(new Date("01-Apr-2008"))) {
					throw new InvalidDataException("" +"Salary month  Should be Greater than  01-Apr-2008 ");
	}
				if(bean.getStation().trim().equals("")){
					throw new InvalidDataException("Airport Code Cannot be Blank ...! Please Enter the Airport Code Same as the Selected Airport for the PFID: "+bean.getEmpName()+"."); 
				}
				//checking selected airpotcode  and sheet airportcode is mandatory in the sheet 
				if (airportcode != null	&& !bean.getPfid().trim().equals("")/*&& (region.equals("CHQIAD") || region.equals("South Region"))*/) {
					log.info("sheet airportcode "
							+ bean.getStation().trim()
							+ " selected airportcode "
							+ airportcode.trim() + "srno " + srno);
					if (!bean.getStation().trim().equals(airportcode.trim())&& !srno.equals("")) {
						throw new InvalidDataException(
								"Please Make Sure That The Selected Airportcode above  (i.e "
										+ airportcode
										+ ") and is Matching with AirportCode given in the excel sheet at Column 18. i.e"
										+ bean.getStation());
					}
				}
				
				if (srno.equals("") && !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have SRNO in Column A of the Uploaded sheet ");
				}
				if (!srno.equals("") && bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for   Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}

				if (!bean.getPfid().trim().equals("") && monthYear.equals("")) {
					throw new InvalidDataException("monthyear " + monthyear
							+ " doesn't Exist" + " for PFID "
							+ bean.getPfid().trim() + ", " + bean.getEmpName()
							+ ". monthyear is Mandatory for All The Employees");
				}
				bean.setPfcardNarration(bean.getPfcardNarration().trim()+tempInfo[8].trim());
				log.info("bean.getPfid().concat(pcCalcMonthYear)"+bean.getPfid().concat(pcCalcMonthYear));
				if (!duplicateMonthyearSet.contains(bean.getPfid().concat(pcCalcMonthYear).trim())) {
					duplicateMonthyearSet.add(bean.getPfid().concat(pcCalcMonthYear).trim());					
				} else if (bean.getPfid() != null && bean.getPfid() != "") {				
					throw new InvalidDataException(" for PFID "
							+ bean.getPfid().trim() + ", " + bean.getEmpName()
							+ ". have the Duplicate MonthYear");
					} 
				log.info("updateflag========="+update1Flag.trim());	
				if (!duplicateSet.contains(bean.getPfid())) {
					duplicateSet.add(bean.getPfid());
					log.info("duplicateSet first-------"+duplicateSet.size()+"monthyear"+tempInfo[8].trim());
				} else if (bean.getPfid() != null && bean.getPfid() != "") {				
					log.info("duplicateSet2======="+duplicateSet.size()+"monthyear"+tempInfo[8].trim());
					update1Flag="Y";
					} 					
				log.info("updateflag========="+update1Flag.trim());			
				//log.info("pfcardnarration"+bean.getPfcardNarration());
				if (!bean.getPfid().trim().equals("")) {
					String prevEmoluments="",prevEpf="";
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select a.wetheroption, a.pensionno, a.REIREMENTDATE, a.dateofbirth,a.dateofjoining, a.calPensionupto,(case when to_date(to_char(add_months(a.dateofbirth, 696), 'dd-Mon-yyyy')) >'02-Sep-2014' then b.freshpensionoption else a.wetheroption end) as freshpensionoption,days from (select i.wetheroption,i.pensionno, to_char(add_months(i.dateofbirth, (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(i.dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_char(dateofjoining,'Mon-yyyy') as dateofjoining ,to_date('"
						+ tempInfo[8]
						+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(i.dateofbirth), (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-RRRR')+1 as days,to_char(add_months(i.dateofbirth, (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info i) a,(select j.freshpensionoption,j.pensionno from employee_pension_freshoption j where j.deleteflag='N' )b where a.pensionno=b.pensionno(+)  and    to_char(a.pensionno)='"
						+ bean.getPfid() + "'";
					log.info("=======checkPFID Supplementary=================="+checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if(bean.getWetherOption().trim().equals("A")) {
						if(rs.getString("freshpensionoption")!=null) {
							bean.setWetherOption(rs.getString("freshpensionoption"));									
						}
						else {
							bean.setWetherOption("B");
						}
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}										
					
					if (rs.getString("dateofjoining") != null) {
						dateofjoining =01+"-"+rs.getString("dateofjoining");
					} else {
						dateofjoining = "";
					}
					
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs.getString("calPensionupto") != null) {
						calPensionupto = rs.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "+ bean.getCpfAcNo());
					}					
					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());
					
					/* Duplicate Record Checking */
					foundSalaryDate = this.trasactionDuplicateSuppli(conn, bean.getPaidDate()
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");					
					FinancialReportDAO fdao = new FinancialReportDAO();
					if (!bean.getPfid().trim().equals("") && (new Date(pcCalcMonthYear).after(new Date("01-Apr-2008")) && new Date(pcCalcMonthYear).before(new Date("31-Mar-2010")))) {
						log.info("inside between 01-Apr-2008 and 31-Mar-2010");
						calculatedPension = this.calclatedPF1(pcCalcMonthYear,
							calPensionupto, dateofbirth, String
									.valueOf(Double.parseDouble(bean.getEmoluments())), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					}else if (!bean.getPfid().trim().equals("") && (new Date(pcCalcMonthYear).after(new Date("01-Apr-2010")) && new Date(pcCalcMonthYear).before(new Date("30-May-2012")))) {
						log.info("inside between 01-Apr-2008 and 31-Mar-2010");
						calculatedPension = this.calclatedPF1(pcCalcMonthYear,
							calPensionupto, dateofbirth, String
									.valueOf(Math.round(Double.parseDouble(bean.getEmployeePF())*100/12)), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					}else if (!bean.getPfid().trim().equals("") && new Date(pcCalcMonthYear).after(new Date("30-May-2012"))) {
						log.info("inside after 01-Apr-2010");
						calculatedPension = this.calclatedPF1(pcCalcMonthYear,
								calPensionupto, dateofbirth, bean.getEmoluments(), bean
										.getWetherOption(), "", days, "1", bean
										.getEmployeePF());
						}
					calculatedPension = Math.round(calculatedPension);	
					calculatedAdditionalContri=this.calclatedAdditionalContri(monthYear,
							calPensionupto, dateofbirth, bean.getEmoluments(), bean
							.getWetherOption(), "", days, "1", bean
							.getEmployeePF(),"");
					
					calculatedAdditionalContri=Math.round(calculatedAdditionalContri);
					
					pf = Double.parseDouble(bean.getEmployeePF().toString()) - calculatedPension;				
					calculatedEmoluments = fdao.calclatedEmoluments(pcCalcMonthYear,
							calPensionupto, dateofbirth,bean.getEmoluments(), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					foundPensioncontri = this.getPensionContri(conn, bean.getPaidDate()
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					if(!foundPensioncontri.equals("")){
					pcdiff=Double.parseDouble(foundPensioncontri.trim())+calculatedPension;
					}else if(foundPensioncontri.equals("") && calculatedPension<0)
					{
						throw new InvalidDataException("Sorry! You dont have privileges to import the Negitive Data for PFID: "+bean.getPfid().trim()+"");
					}
					if(pcdiff<0){
						throw new InvalidDataException("Sorry! You dont have privileges to import the Negitive Data for PFID: "+bean.getPfid().trim()+"");
					}
					if (bean.getWetherOption().trim().equals("B") && Double.parseDouble(bean.getEmoluments())<0) {
						foundPensioncontri = this.getPensionContri(conn, pcpfcardmonth
								.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
								bean.getRegion(), bean.getPfid(), airportcode, "");
						log.info("foundPensioncontri=="+foundPensioncontri+"option=="+bean.getWetherOption());
						if (foundPensioncontri.trim().equals("1250") && bean.getWetherOption().trim().equals("B")){
							//log.info("insidepensioncontri");
							calculatedPension=0;
							pf = Double.parseDouble(bean.getEmployeePF().toString());
						}
						String emolumentsQuery = "select emoluments,EMPPFSTATUARY from employee_pension_validate where pensionno='"+bean.getPfid()+"' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ pcpfcardmonth + "'";
						log.info("emolumentsQuery"+emolumentsQuery);
						rs = st1.executeQuery(emolumentsQuery);
						if (rs.next()) {
							if (rs.getString("emoluments") != null) {
							prevEmoluments = rs.getString("emoluments");
							}else{
								prevEmoluments="";	
							}
							if (rs.getString("emoluments") != null) {
								prevEpf= rs.getString("EMPPFSTATUARY");
								}else{
								prevEpf="";	
								}
						}	
						 if((!prevEmoluments.equals("") || !prevEpf.equals("")) && !bean.getAllRecordsFlag().equals("Y")){
					double diffEmol= Double.parseDouble(bean.getEmoluments())+ Double.parseDouble(prevEmoluments);
					double diffEpf= Double.parseDouble(bean.getEmployeePF())+ Double.parseDouble(prevEpf);
			         log.info("diffEmol==="+diffEmol);
			           if((diffEmol>=0 && diffEmol<=6500 || diffEmol<=0) && !bean.getAllRecordsFlag().equals("Y")){
			        	   if((diffEpf>=0 && diffEpf<=780 || diffEpf<=0) && !bean.getAllRecordsFlag().equals("Y")){  
			        	   throw new InvalidDataException("PFID "
									+ bean.getPfid().trim() + " doesn't Caliculating the pensioncontri Please Caliculate pensioncontri manually and Put a Flag as Y after USERNAME");
			        	   }
			        	   }else if(bean.getAllRecordsFlag().equals("Y")){
							   calculatedPension=Double.parseDouble(tempInfo[17].replaceAll(",", "").trim());
				        	   pf=Double.parseDouble(tempInfo[16].replaceAll(",", "").trim());
						}
					}	
					}
					String preveemol="",prevaptcd="";
					String prevemolQuery = "select emoluments from employee_pension_validate where pensionno='"+bean.getPfid()+"' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ pcpfcardmonth + "' and airportcode='"+bean.getStation()+"'";
					log.info("emolumentsQuery"+prevemolQuery);
					rs = st1.executeQuery(prevemolQuery);
					if (rs.next()) {
						if (rs.getString("emoluments") != null) {
							preveemol = rs.getString("emoluments");
						}else{
							preveemol="";	
						}						
					}
					log.info("prevEmoluments"+preveemol+"emoluments"+bean.getEmoluments());
					if(preveemol.equals(bean.getEmoluments())){
						throw new InvalidDataException(" For the PFID : "+ bean.getPfid().trim() + " Data has been already imported with the Same Amount of Emoluments and from the same Airport For the Salary Month "+ pcpfcardmonth+".");
		        	   }
				}
				log.info("foundSalaryDate======"+foundSalaryDate+"updateFlag"+update1Flag.trim());
				if(!bean.getAllRecordsFlag().equals("S")){
				if (foundSalaryDate.trim() == "") {
					String dateofretirement=this.getRetriedDate(dateofbirth);	
					log.info("dateofretirement"+dateofretirement);
					if (!bean.getPfid().trim().equals("") && new Date(bean.getPaidDate()).before(new Date(dateofretirement))) {
						throw new InvalidDataException("For the PFID:"
									+ bean.getPfid().trim() + " data cannot be imported, as their is no Data in the Form 3 Report for the Particular PFID and for the Paid month "+bean.getPaidDate().trim()+"");
			           }}}		
				if (foundSalaryDate.trim() != "" || update1Flag.trim().equals("Y")) {
					bean.setGross("0.00");
						String transMonthYear = commonUtil.converDBToAppFormat(
								bean.getPaidDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
						if(!update1Flag.trim().equals("Y")){	
					String suppliquery = " insert into employee_supplimentory_data(pensionno,gross,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,remarks,USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,additionalcontri) (select pensionno,gross,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,'data fulled from Validate table to suppli table',USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,additionalcontri from employee_pension_validate where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'  and suppliflag='N' and EMPFLAG='Y')";
					log.info("suppliquery===="+suppliquery);
					insert.addBatch(suppliquery);
						}
					foundPensioncontri = this.getPensionContri(conn, pcpfcardmonth
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					log.info("foundPensioncontri=="+foundPensioncontri+"option=="+bean.getWetherOption());
					if (foundPensioncontri.trim().equals("1250") && bean.getWetherOption().trim().equals("B") && !bean.getAllRecordsFlag().equals("Y")){
						log.info("insidepensioncontri");
						calculatedPension=0;
						pf = Double.parseDouble(bean.getEmployeePF().toString());
					}
                     String	updateValidatetable = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),calcEmoluments=to_char(to_number(nvl(calcEmoluments,0)+'"
							+ calculatedEmoluments
							+ "')),remarks=remarks||'"+bean.getStation()+"',SUPPLIFLAG='Y',PFCARDNARRATION=PFCARDNARRATION||'"+bean.getPfcardNarration()+"',pf= to_char(TO_NUMBER(nvl(pf,0)+TO_NUMBER('"
							+ pf
							+ "'))),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+TO_NUMBER('"
							+ calculatedPension
							+ "'))),additionalcontri=TO_NUMBER(nvl(additionalcontri,0)+TO_NUMBER('"
							+ calculatedAdditionalContri
							+ "'))   where pensionno='"+bean.getPfid()+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'";
				  // suppli.addBatch(suppliquery);
				  log.info(updateValidatetable);
				   suppli.addBatch(updateValidatetable);
				}else{
					if (!bean.getPfid().equals("") && !srno.equals("")) {
						foundPensioncontri = this.getPensionContri(conn, pcpfcardmonth
								.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
								bean.getRegion(), bean.getPfid(), airportcode, "");
						log.info("foundPensioncontri=="+foundPensioncontri+"option=="+bean.getWetherOption());
						if (foundPensioncontri.trim().equals("1250") && bean.getWetherOption().trim().equals("B") && !bean.getAllRecordsFlag().equals("Y")){
							log.info("insidepensioncontri");
							calculatedPension=0;
							pf = Double.parseDouble(bean.getEmployeePF().toString());
						}						
						if(pcCalcMonthYear.equals(bean.getCpfRecoveryDate())){
	                       //For updation of latest Airportcode and Region and basic to EmployeePersonal info table 
							String updateLatestAirport="update employee_personal_info set AIRPORTCODE='"+bean.getStation()+"',region='"+region+"',basic='"+bean.getEmoluments()+"' where pensionno='"+bean.getPfid()+"'";	
							log.info(updateLatestAirport);
							st2.addBatch(updateLatestAirport);
						}
					
						pst1.setString(1, bean.getGross().trim());
						pst1.setString(2, bean.getEmoluments().trim());
						pst1.setString(3, bean.getEmployeePF().trim());
						pst1.setString(4, bean.getStation());
						pst1.setString(5, bean.getPaidDate().trim());
						pst1.setString(6, bean.getEmpName().trim());
						pst1.setString(7, bean.getEmpNumber().trim());
						pst1.setString(8, bean.getDesegnation().trim());
						pst1.setString(9, bean.getRegion().trim());
						pst1.setString(10, bean.getPfid().trim());
						pst1.setString(11, bean.getEmployeeVPF().trim());
						pst1.setString(12, bean.getPrincipal().trim());
						pst1.setString(13, bean.getInterest().trim());
						pst1.setDouble(14, calculatedPension);
						pst1.setDouble(15, pf);
						pst1.setString(16, finyear);
						pst1.setDouble(17, calculatedEmoluments);
						pst1.setString(18, "Y");
						pst1.setString(19, bean.getPfcardNarration());
						pst1.setDouble(20, calculatedAdditionalContri);
						log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
								+ bean.getEmoluments() + "," + bean.getEmployeePF()
								+ "PFID " + bean.getPfid() + ","
								+ bean.getEmpName() + "," + bean.getEmpNumber()
								+ "," + bean.getDesegnation());
						pst1.addBatch();
						log.info("validateInsert"+validateInsert);
						addflag = true;
					}
				}				
				if (!bean.getPfid().equals("") && !srno.equals("")) {
					//String supplilog="insert into employee_suppli_log(pensionno,FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR,PAIDDATE,FORMTYPE) values('"+bean.getPfid().trim()+"','"+fileName.trim()+"','"+bean.getUserName().trim()+"','"+ipAddress.trim()+"','"+bean.getStation().trim()+"','"+bean.getRegion().trim()+"','"+monthYear.trim()+"','"+bean.getPaidDate()+"','AAIEPF-3-SUPPL')";
					//st.execute(supplilog);
					foundPensioncontri = this.getPensionContri(conn, pcpfcardmonth
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					log.info("foundPensioncontri=="+foundPensioncontri+"option=="+bean.getWetherOption());
					if (foundPensioncontri.trim().equals("1250") && bean.getWetherOption().trim().equals("B") && !bean.getAllRecordsFlag().equals("Y")){
						log.info("insidepensioncontri++++++++++++++");
						calculatedPension=0;
						pf = Double.parseDouble(bean.getEmployeePF().toString());
					}
					pst.setString(1, bean.getGross().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, bean.getPaidDate().trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, finyear);
					pst.setDouble(17, calculatedEmoluments);
					pst.setString(18, "S");
					pst.setString(19, bean.getPaidDate());
					pst.setString(20, bean.getPfcardNarration());
					pst.setString(21, fileName.trim());
					pst.setString(22, bean.getUserName().trim());
					pst.setString(23, ipAddress.trim());
					pst.setString(24, "AAIEPF-3-SUPPL");
					pst.setString(25, pcCalcMonthYear);
					pst.setString(26, bean.getCpfRecoveryDate());
					pst.setDouble(27, calculatedAdditionalContri);
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.addBatch();
					addflag = true;
				}
				
			}				
				}

			if (addflag) {	
				if (duplicateList.size() > 0) {
					StringBuffer dupliateRecords = new StringBuffer();
					for (Iterator it = duplicateList.iterator(); it.hasNext();) {
						dupliateRecords.append(it.next() + "\n" + ",");
					}					
				}
				conn.setAutoCommit(false);
				insert.executeBatch();
				pst1.executeBatch();
				st2.executeBatch();
				suppli.executeBatch();
				addBatchcount = pst.executeBatch();				
				 log.info("Inserted Records Count is " + addBatchcount.length);
				
			}
			if (updateflag) {
				conn.setAutoCommit(false);
			int updatedBatchCount[] = st.executeBatch();
				log.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y',AIRPORT='"+bean.getStation()+"' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
			conn.commit();
		} catch (SQLException e) {
			try{
			conn.rollback();			
			}catch(SQLException ex){				
			}
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			 log.info("e.tostring"+e.toString());			 
				String msg="";
				String txt=e.toString();
				if(e.toString().trim().equals("java.lang.ArrayIndexOutOfBoundsException: 22")){
					 msg="Please put username in format column W";	
					} else if(e.toString().trim().equals("java.lang.ArrayIndexOutOfBoundsException: 23")){
					 msg="Please put flag is N in format column X ";	
					}else if(txt.indexOf("java.lang.ArrayIndexOutOfBoundsException")!=-1){
				 msg="Please Enter Valid Data ( Excepting only Numeric Values) for the PFID "+bean.getPfid()+" in SRN0 "+srno+" , Containing Invalid Characters in the Column No";	
				}
				try{
					conn.rollback();
					}catch(SQLException  ex){
					}
		throw new InvalidDataException(msg +""+e.getMessage());
		} finally {
			try {				
				rs.close();
				st1.close();
				st.close();
				suppli.close();
				pst.close();
				pst1.close();
				conn.close();
			} catch (Exception e) {
			}
		}

		log.info("ImportDao :importMonthwiseSupplData leaving method");
		message = String.valueOf(addBatchcount.length);
		return message;
	}
	public String getRetriedDate(String dateOfBirth) throws InvalidDataException {
		dateOfBirth = commonUtil.converDBToAppFormat(dateOfBirth,"dd-MMM-yyyy", "dd-MM-yyyy");
           String[] dobElements = dateOfBirth.split("-");
            int day = 0, month = 0, year = 0;
           String retriedDt = "", formatedRtDt = "";
        day = Integer.parseInt(dobElements[0]);
         month = Integer.parseInt(dobElements[1]);
            year = Integer.parseInt(dobElements[2]);
          if (day >= 1) {
	           month = month + 1;
	        day = 1;
             }
       year = year + 60;
        formatedRtDt = day + "-" + month + "-" + year;
        retriedDt = commonUtil.converDBToAppFormat(formatedRtDt, "dd-MM-yyyy","dd-MMM-yyyy");
   return retriedDt;
}
	public String importMonthwiseArrData(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {

		log.info("ImportDao :importMonthwiseArrData  Entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Set duplicateSet = new HashSet();
		ArrayList duplicateList = new ArrayList();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement suppli = null;
		Statement insert = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "";
		PreparedStatement pst = null;
		PreparedStatement pst1 = null;
		PreparedStatement pst2 = null;
		ResultSet rs = null;
		String srno = "";
		String foundSalaryDate = "", retirementDate = "",foundPensioncontri="",freezedPenData="";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			suppli = conn.createStatement();
			insert = conn.createStatement();
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			String monthyear = convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth);
			/* checking the file import status */
			String importMonthStatus = "select lower(FILENAME) as FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName.toLowerCase())
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported for Salary Month "
							+ month + "-" + year);
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String srnoCheck = "";
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, "");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_supplimentory_data(gross,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG ,paiddate,"
					+"FILENAME,CLIENTNAME,SYSADDRESS,FORMTYPE,additionalcontri)"
					+ " values(?,?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?)";
			log.info("finaceInsert============Venki=============>>>>>>>>>>>>>"+finaceInsert);
			
			
			String validateInsert = "insert into employee_pension_validate(gross,emoluments,emppfstatuary,AIRPORTCODE,"
				+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,ARREARFLAG,additionalcontri )"
				+ " values(?,?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
	
			log.info("validateInsert============Venki=============>>>>>>>>>>>>>"+validateInsert);
			
			
			String arrerinsert="insert into employee_pension_arrear(gross,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,AAICONTRAMT,AIRPORTCODE,REGION,REMARKS,PENSIONNO,additionalcontri)"
		+"values(?,?,?,to_char(add_months(?,1),'dd-Mon-yyyy'),?,?,?,?,?,?,?)";
			log.info("arrerinsert============Venki=============>>>>>>>>>>>>>"+arrerinsert);
			
			
			
			log.info("arrerinsert"+arrerinsert);
	
	
	
			pst = conn.prepareStatement(finaceInsert);
		    pst1=conn.prepareStatement(validateInsert);
		    pst2=conn.prepareStatement(arrerinsert);
			for (int i = 1; i < xlsDataList.size(); i++) {
				srnoCheck = xlsDataList.get(1).toString();
				String tempSrNoCheck[] = srnoCheck.split("@");
				if (i == 1 && !tempSrNoCheck[0].trim().equals("1")) {
					throw new InvalidDataException(
							"Please Put the Data from 12th row onwards");

				}

				double calculatedPension = 0.00,diff=0.00;
				double calculatedEmoluments = 0.00;
				double pcdiff=0.00;
				double calculatedAdditionalContri=0.00;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				bean.setRegion(region);
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}
				String monthyear2 = "";
			
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
					String sheetDateMonthYear = tempInfo[8];
					String sheetDateMonthyear[] = tempInfo[8].split("-");
					String sheetMonthYear = sheetDateMonthyear[1] + "-"
							+ sheetDateMonthyear[2];
					if (!monthyear.equals(sheetMonthYear)) {
												throw new InvalidDataException(
								"Please make sure that the Salary Month Selected above (i.e "
										+ convertedMonthYear
										+ " is matching with month given in the excel sheet at Column I of the Paid Date against PFID  "+bean.getPfid()+"  "+ tempInfo[8].trim() + " ( i.e "
										+ sheetMonthYear + ")");
					}
             
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
				if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					String sheetDateMonth[] = tempInfo[8].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ monthyearsheet.trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						monthyear2 = rs.getString(1);
					}
				}
				log.info("monthyear 2 " + monthyear2);

				if (!tempInfo[8].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[8].split("-");			
					monthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];	

				} else {
					monthYear = "";
				}

				String finyear = "";
				Date transdate = null;
				
				if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
					transdate = df.parse(monthYear);

				}
				
				if (!tempInfo[9].equals("XXX")) {
					bean.setGross(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setGross("0.00");
				}
				
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmoluments(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}
          
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeePF(tempInfo[11].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[12].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				diff=Double.parseDouble(bean.getEmoluments())*12/100-Double.parseDouble(bean.getEmployeePF());
				if(diff>=1 || diff<=-1){
					throw new InvalidDataException("EPF Is Not Equal to (Emoluments/12%)   , for the PFID "+bean.getPfid().trim()+" and EmployeeName "+bean.getEmpName());
				}
				if(Integer.parseInt(bean.getEmoluments())>0 && Integer.parseInt(bean.getEmployeePF())<0){
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
				
				}
            if(Integer.parseInt(bean.getEmployeePF())<0 && Integer.parseInt(bean.getEmoluments())>0 ){
            	throw new InvalidDataException(
						"PFID"
								+ bean.getPfid().trim()
								+ " doesn't have valide Caliculation for Emoluments Vs EPF in the Uploaded sheet ");
			
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}

				if (!tempInfo[19].equals("XXX")) {
					bean.setStation(tempInfo[19].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[20].equals("XXX")) {
					bean.setRemarks(tempInfo[20].trim());
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[21].trim().equals("XXX")) {
					bean.setUserName(tempInfo[21].trim());
				} else {
					bean.setUserName("");
				}
				if (!tempInfo[22].trim().equals("XXX")) {
					bean.setAllRecordsFlag(tempInfo[22].trim());
				} else {
					bean.setAllRecordsFlag("");
				}
               freezedPenData = this.FreezedpennoData(conn,monthyear2.trim(), bean.getPfid());
				
				if(!freezedPenData.equals(""))	{
				        String count1[] = freezedPenData.split("_");
						String pensionno = count1[0];
						String username = count1[1];							
						//throw new InvalidDataException("Monthly Recoverie Data Alredy Imported for PFID "+pensionno+" , in the month of "+monthyear2+" for the Airportcode "+stationname+" and Region "+region1+" ");
						throw new InvalidDataException("PFID "+pensionno+" Frozen  as Per Request on '"+username+"'");
				
			}
				if (monthYear == ""
						&& !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"monthyear Can't be null (i.e in the excel sheet at Column 8. i.e"
									+ bean.getPaidDate());
				}
				if (monthYear != ""
						&& !bean.getPfid().trim().equals("")) {
					 convertedDate = commonUtil.convertDateFormat(monthYear);
					log.info("converted date is " + convertedDate);
					 index = monthYear.indexOf("-");
					String  count1[] = monthYear.split("-");
					log.info(" countlength " + count.length);
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ monthYear
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the PaidDate of the Uploaded sheet ");
					}
				}
			//checking selected airpotcode  and sheet airportcode is mandatory in the sheet 
				if (airportcode != null	&& !bean.getPfid().trim().equals("")/*&& (region.equals("CHQIAD") || region.equals("South Region"))*/) {
					log.info("sheet airportcode "
							+ bean.getStation().trim()
							+ " selected airportcode "
							+ airportcode.trim() + "srno " + srno);
					if (!bean.getStation().trim().equals(airportcode.trim())&& !srno.equals("")) {
						throw new InvalidDataException(
								"Please Make Sure That The Seleted Airportcode above  (i.e "
										+ airportcode
										+ ") and is Matching with AirportCode given in the excel sheet at Column 18. i.e"
										+ bean.getStation());
					}
				}
				
				if (srno.equals("") && !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have SRNO in Column A of the Uploaded sheet ");
				}
				if (!srno.equals("") && bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for   Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}
				if (!bean.getPfid().trim().equals("") && monthYear.equals("")) {
					throw new InvalidDataException("monthyear " + monthyear
							+ " doesn't Exist" + " for PFID "
							+ bean.getPfid().trim() + ", " + bean.getEmpName()
							+ ". monthyear is Mandatory for All The Employees");
				}
				if (!bean.getPfid().trim().equals("")) {
					String checkPFID = "select a.wetheroption, a.pensionno, a.REIREMENTDATE, a.dateofbirth, a.calPensionupto,(case when to_date(to_char(add_months(a.dateofbirth, 696), 'dd-Mon-yyyy')) >'02-Sep-2014' then b.freshpensionoption else a.wetheroption end) as freshpensionoption,days from (select i.wetheroption,i.pensionno, to_char(add_months(i.dateofbirth, (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(i.dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ tempInfo[8]
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(i.dateofbirth), (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-RRRR')+1 as days,to_char(add_months(i.dateofbirth, (case  when i.deferement = 'Y' and i.deferementpension = 'S' then  i.deferementage * 12  else  696 end)),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info i) a,(select j.freshpensionoption,j.pensionno from employee_pension_freshoption j where j.deleteflag='N' )b where a.pensionno=b.pensionno(+)  and    to_char(a.pensionno)='"
							+ bean.getPfid() + "'";
					log.info("checkPFID============Venki=============>>>>>>>>>>>>>"+checkPFID);
					rs = st1.executeQuery(checkPFID);
					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if(bean.getWetherOption().trim().equals("A")) {
						if(rs.getString("freshpensionoption")!=null) {
							bean.setWetherOption(rs.getString("freshpensionoption"));									
						}
						else {
							bean.setWetherOption("B");
						}
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs.getString("calPensionupto") != null) {
						calPensionupto = rs.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}
					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}
					
					/* Duplicate Record Checking */
					foundSalaryDate = this.trasactionDuplicateSuppli(conn, monthyear2
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					
					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = this.calclatedPF1(monthYear,
							calPensionupto, dateofbirth, bean.getEmoluments(), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());

					calculatedPension = Math.round(calculatedPension);
					/* Additional Contribution */
					calculatedAdditionalContri=this.calclatedAdditionalContri(monthYear,
							calPensionupto, dateofbirth, bean.getEmoluments(), bean
							.getWetherOption(), "", days, "1", bean
							.getEmployeePF(),"Arrear");
					
					calculatedAdditionalContri=Math.round(calculatedAdditionalContri);
					
					
					if(calculatedPension==0 || calculatedPension==0.00) {
						log.info("bean.getAllRecordsFlag()"+bean.getAllRecordsFlag());						
						if (!tempInfo[17].equals("XXX")) {
							if (bean.getWetherOption().trim().equals("A") && !bean.getAllRecordsFlag().trim().equals("Y")){
							if(tempInfo[17].replaceAll(",", "").trim().equals("0") || tempInfo[17].replaceAll(",", "").trim().equals("0.00")){
								throw new InvalidDataException("PFID "+bean.getPfid()+" not have Pension Contribution. System is not Calculated  arrear pension contribution  for option 'A' Cases.");
							}
							}
						calculatedPension=Double.parseDouble(tempInfo[17].replaceAll(",", "").trim());
						}else{
							if (bean.getWetherOption().trim().equals("A")){
								throw new InvalidDataException("PFID "+bean.getPfid()+" not have Pension Contribution. System is not Calculated  arrear pension contribution  for option 'A' Cases.");					
							}
							calculatedPension=calculatedPension;
						}
					}					
					if (bean.getWetherOption().trim().equals("B")){
						log.info("insidepensioncontri");
						calculatedPension=0;						
					}
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;
					
					calculatedEmoluments = fdao.calclatedEmoluments(monthYear,
							calPensionupto, dateofbirth, bean.getEmoluments(), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					foundPensioncontri = this.getPensionContri(conn, monthyear2
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					if(!foundPensioncontri.equals("")){
					 pcdiff=Double.parseDouble(foundPensioncontri.trim())+calculatedPension;
					}
					if(pcdiff<0){
						throw new InvalidDataException("Sorry! You dont have privileges to import the Negitive Data for PFID: "+bean.getPfid().trim()+")");
					}

				}
				if (!bean.getPfid().equals("") && !srno.equals("")) {
					pst2.setString(1, bean.getGross().trim());
					pst2.setString(2, bean.getEmpNumber().trim());
					pst2.setString(3, bean.getEmpName().trim());
					pst2.setString(4, monthYear.trim());
                    pst2.setString(5, bean.getEmoluments().trim());
					pst2.setDouble(6, calculatedPension);
					pst2.setString(7, bean.getStation());
					pst2.setString(8, bean.getRegion().trim());
					pst2.setString(9, bean.getRemarks().trim());
					pst2.setString(10, bean.getPfid().trim());
					pst2.setDouble(11, calculatedAdditionalContri);
					pst2.addBatch();
					addflag = true;
				}
				if (foundSalaryDate != "") {
					bean.setGross("0.00");
					 String count1[] = foundSalaryDate.split("_");
						String pensionno = count1[0];
						String stationname = count1[1];
						String region1 = count1[2];
						String transMonthYear = commonUtil.converDBToAppFormat(
								monthyear2.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					String suppliquery = " insert into employee_supplimentory_data(pensionno,gross,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,remarks,USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,additionalcontri) (select pensionno,gross,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,'data fulled from Validate table to suppli table',USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,additionalcontri from employee_pension_validate where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "' and suppliflag='N' and EMPFLAG='Y')";
					log.info(suppliquery);	
					insert.addBatch(suppliquery);
				String	updateValidatetable = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "'))  ,EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),calcEmoluments=to_char(to_number(nvl(calcEmoluments,0)+'"
							+ calculatedEmoluments
							+ "')),remarks=remarks||'"+bean.getStation()+"',SUPPLIFLAG='Y',arrearflag='Y',pf= to_char(TO_NUMBER(nvl(pf,0)+TO_NUMBER('"
							+ pf
							+ "'))),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+TO_NUMBER('"
							+ calculatedPension
							+ "'))),additionalcontri=to_char(TO_NUMBER(nvl(additionalcontri,0)+TO_NUMBER('"
							+ calculatedAdditionalContri
							+ "')))   where pensionno='"+bean.getPfid()+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'";
				   log.info(updateValidatetable);
				   suppli.addBatch(updateValidatetable);					
				}else{
					if (!bean.getPfid().equals("") && !srno.equals("")) {
						pst1.setString(1, bean.getGross().trim());
						pst1.setString(2, bean.getEmoluments().trim());
						pst1.setString(3, bean.getEmployeePF().trim());
						pst1.setString(4, bean.getStation());
						pst1.setString(5, monthYear.trim());
						pst1.setString(6, bean.getEmpName().trim());
						pst1.setString(7, bean.getEmpNumber().trim());
						pst1.setString(8, bean.getDesegnation().trim());
						pst1.setString(9, bean.getRegion().trim());
						pst1.setString(10, bean.getPfid().trim());
						pst1.setString(11, bean.getEmployeeVPF().trim());
						pst1.setString(12, bean.getPrincipal().trim());
						pst1.setString(13, bean.getInterest().trim());
						pst1.setDouble(14, calculatedPension);
						pst1.setDouble(15, pf);
						pst1.setString(16, finyear);
						pst1.setDouble(17, calculatedEmoluments);
						pst1.setString(18, "Y");
						pst1.setString(19, "Y");
						pst1.setDouble(20, calculatedAdditionalContri);
						log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
								+ bean.getEmoluments() + "," + bean.getEmployeePF()
								+ "PFID " + bean.getPfid() + ","
								+ bean.getEmpName() + "," + bean.getEmpNumber()
								+ "," + bean.getDesegnation());
						pst1.addBatch();
						addflag = true;
					}					
				}
				if (!duplicateSet.contains(bean.getPfid())) {
					duplicateSet.add(bean.getPfid());
				} else if (bean.getPfid() != null && bean.getPfid() != "") {
					duplicateList.add(bean.getPfid());
					duplicateSet.remove(bean.getPfid());
					// continue;
				}
				if (!bean.getPfid().equals("") && !srno.equals("")) {	
					//String supplilog="insert into employee_suppli_log(pensionno,FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR,PAIDDATE,FORMTYPE) values('"+bean.getPfid().trim()+"','"+fileName.trim()+"','"+bean.getUserName().trim()+"','"+ipAddress.trim()+"','"+bean.getStation().trim()+"','"+bean.getRegion().trim()+"','"+monthYear.trim()+"','"+bean.getPaidDate()+"','AAIEPF-3A')";
					//st.execute(supplilog);
     				pst.setString(1, bean.getGross().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, finyear);
					pst.setDouble(17, calculatedEmoluments);
					pst.setString(18, "A");
					pst.setString(19, monthYear.trim());
					pst.setString(20, fileName.trim());
					pst.setString(21, bean.getUserName().trim());
					pst.setString(22, ipAddress.trim());
					pst.setString(23, "AAIEPF-3A");
					pst.setDouble(24, calculatedAdditionalContri);
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.addBatch();
					addflag = true;
				}
				
			}}

			if (addflag) {
				if (duplicateList.size() > 0) {
					StringBuffer dupliateRecords = new StringBuffer();
					for (Iterator it = duplicateList.iterator(); it.hasNext();) {
						dupliateRecords.append(it.next() + "\n" + ",");
					}
					/*throw new InvalidDataException(
							" The Imported sheet having the dupliate Records for the PFID's "
									+ dupliateRecords);*/
				}
				insert.executeBatch();
				suppli.executeBatch();
				pst1.executeBatch();
				pst2.executeBatch();
				addBatchcount = pst.executeBatch();
				log.info("Inserted Records Count is " + addBatchcount.length);

			}
			if (updateflag) {
			int updatedBatchCount[] = st.executeBatch();
				log
						.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y',AIRPORT='"+bean.getStation()+"' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		}  catch (Exception e) {
			// TODO Auto-generated catch block
			 log.info(e.toString());
				String msg="";
				String txt=e.toString();
				if(txt.indexOf("java.lang.ArrayIndexOutOfBoundsException")!=-1){
				 msg="Please Enter Valid Data ( Excepting only Numeric Values) for the PFID "+bean.getPfid()+" in SRN0 "+srno+" , Containing Invalid Characters in the Column No";	
				}
		throw new InvalidDataException(msg +""+e.getMessage());
			
		} finally {
			try {
				rs.close();
				st1.close();
				st.close();
				pst.close();
				pst1.close();
				pst2.close();
				suppli.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :importMonthwiseArrData leaving method");
		message = String.valueOf(addBatchcount.length);
		return message;
	}
	public String importMonthwiseaaiepf4Data(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		log.info("ImportDao :importMonthwiseaaiepf4Data  Entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Set duplicateSet = new HashSet();
		ArrayList duplicateList = new ArrayList();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement suppli = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "";
		PreparedStatement pst = null;
		PreparedStatement pst1 = null;
		PreparedStatement pst2 = null;
		ResultSet rs = null;
		String srno = "";
		String foundSalaryDate = "", retirementDate = "",supplisalrydate="",freezedPenData="",foundPensioncontri="";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			suppli = conn.createStatement();
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			String monthyear = convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth);
			/* checking the file import status */
			String importMonthStatus = "select lower(FILENAME) as FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName.toLowerCase())
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported for Salary Month "
							+ month + "-" + year);
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String  srnoCheck = "";
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, "");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_supplimentory_data(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG ,paiddate,remarks,"
					+"FILENAME,CLIENTNAME,SYSADDRESS,FORMTYPE)"
					+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			String validateInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
				+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,PFCARDNARRATION,edittrans,EMPRECOVERYSTS )"
				+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			pst = conn.prepareStatement(finaceInsert);
		    pst1=conn.prepareStatement(validateInsert);		  
			for (int i = 1; i < xlsDataList.size(); i++) {
				srnoCheck = xlsDataList.get(1).toString();
				String tempSrNoCheck[] = srnoCheck.split("@");
				if (i == 1 && !tempSrNoCheck[0].trim().equals("1")) {
					throw new InvalidDataException(
							"Please Put the Data from 12th row onwards");

				}

				double calculatedPension = 0.00;
				double calculatedEmoluments = 0.00;
				double pcdiff=0.00;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				bean.setRegion(region);
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}
				String monthyear2 = "";
			
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
					String sheetDateMonthYear = tempInfo[8];
					String sheetDateMonthyear[] = tempInfo[8].split("-");
					String sheetMonthYear = sheetDateMonthyear[1] + "-"
							+ sheetDateMonthyear[2];
			/*	if (!monthyear.equals(sheetMonthYear)) {
												throw new InvalidDataException(
								"Please make sure that the Salary Month Selected above (i.e "
										+ convertedMonthYear
										+ " is matching with month given in the excel sheet at Column I of the Paid Date against PFID  "+bean.getPfid()+"  "+ tempInfo[8].trim() + " ( i.e "
										+ sheetMonthYear + ")");
					}*/
				}
				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
				if (!tempInfo[8].equals("XXX") && !bean.getPfid().trim().equals("")) {
					/*String monthyearQuery = "SELECT  to_char(add_months('"
							+ tempInfo[8].trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						monthyear2 = rs.getString(1);
					}*/
					String sheetDateMonth[] = tempInfo[8].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					monthyear2  = monthyearsheet.trim();
				}
				log.info("monthyear 2 " + monthyear2);

				if (!tempInfo[8].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[8].split("-");			
					monthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];	

				} else {
					monthYear = "";
				}
				String finyear = "";
				Date transdate = null;
				if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
					transdate = df.parse(monthYear);

				}				
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[11].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}			
				if (!tempInfo[15].equals("XXX")) {
					pf=Double.parseDouble(tempInfo[15].replaceAll(",", "").trim());
				} else {
					pf=0.00;
				}
				if (!tempInfo[16].equals("XXX")) {
					calculatedPension=Double.parseDouble(tempInfo[16].replaceAll(",", "").trim());
				} else {
					calculatedPension=0.00;
				}			
				if (!tempInfo[18].equals("XXX")) {
					bean.setStation(tempInfo[18].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[19].equals("XXX")) {
					bean.setPfcardNarration(tempInfo[19].trim());
				} else {
					bean.setPfcardNarration("");
				}
				if (!tempInfo[20].trim().equals("XXX")) {
					if(tempInfo[20].trim().equals("DEPUTATIONIST")){
					bean.setUplodeType("DEP");
					}else if(tempInfo[20].trim().equals("RETIRED")){
						bean.setUplodeType("RET");
					}else if(tempInfo[20].trim().equals("REGULAR")){
						bean.setUplodeType("REG");
					}
				} else {
					bean.setUplodeType("");
				}
				log.info("uplodedType"+bean.getUplodeType());
				
				if (!tempInfo[21].trim().equals("XXX")) {
					bean.setUserName(tempInfo[21].trim());
				} else {
					bean.setUserName("");
				}
       freezedPenData = this.FreezedpennoData(conn,monthyear2.trim(), bean.getPfid());
				
				if(!freezedPenData.equals(""))	{
				        String count1[] = freezedPenData.split("_");
						String pensionno = count1[0];
						String username = count1[1];							
						//throw new InvalidDataException("Monthly Recoverie Data Alredy Imported for PFID "+pensionno+" , in the month of "+monthyear2+" for the Airportcode "+stationname+" and Region "+region1+" ");
						throw new InvalidDataException("PFID "+pensionno+" Frozen  as Per Request on '"+username+"'");
				
			}
				if(bean.getUplodeType().trim().equals("")){
					throw new InvalidDataException(
							"Please fill the Correct Status of the Employee as DEPUTATIONIST,RETIRED,REGULAR (i.e in the excel sheet in Column U for the PfID"
									+ bean.getPfid().trim());
				}
				if(!bean.getUplodeType().trim().equals("DEP") && !bean.getUplodeType().trim().equals("RET") && !bean.getUplodeType().trim().equals("REG")){
					throw new InvalidDataException(
							"Please fill the Status  as DEPUTATIONIST,RETIRED,REGULAR (i.e in the excel sheet in Column U for the PfID"
									+ bean.getPfid().trim());
				}
				if (monthYear == ""
						&& !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"monthyear Can't be null (i.e in the excel sheet at Column 8. i.e"
									+ bean.getPaidDate());
				}
				if (monthYear != ""
						&& !bean.getPfid().trim().equals("")) {
					 convertedDate = commonUtil.convertDateFormat(monthYear);
					log.info("converted date is " + convertedDate);
					 index = monthYear.indexOf("-");
					String  count1[] = monthYear.split("-");
					log.info(" countlength " + count.length);
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ monthYear
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the PaidDate of the Uploaded sheet ");
					}
				}
			//checking selected airpotcode  and sheet airportcode is mandatory in the sheet 
				if (airportcode != null	&& !bean.getPfid().trim().equals("")/*&& (region.equals("CHQIAD") || region.equals("South Region"))*/) {
					log.info("sheet airportcode "
							+ bean.getStation().trim()
							+ " selected airportcode "
							+ airportcode.trim() + "srno " + srno);
					if (!bean.getStation().trim().equals(airportcode.trim())&& !srno.equals("")) {
						throw new InvalidDataException(
								"Make Sure That The Selected Airport Code above  (i.e "
										+ airportcode
										+ ") and is Matching with Airport Code given in the excel sheet at Column 18. i.e"
										+ bean.getStation());
					}
				}				
				if (srno.equals("") && !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have SRNO in Column A of the Uploaded sheet ");
				}
				if (!srno.equals("") && bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for   Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}
				if (!bean.getPfid().trim().equals("") && monthYear.equals("")) {
					throw new InvalidDataException("monthyear " + monthyear
							+ " doesn't Exist" + " for PFID "
							+ bean.getPfid().trim() + ", " + bean.getEmpName()
							+ ". monthyear is Mandatory for All The Employees");
				}
				if (!bean.getPfid().trim().equals("")) {
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ tempInfo[8]
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 697),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);
					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs.getString("calPensionupto") != null) {
						calPensionupto = rs.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}
					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}
					
					/* Duplicate Record Checking */
					foundSalaryDate = this.trasactionDuplicateSuppli(conn, monthyear2
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					log.info("foundSalaryDate"+foundSalaryDate);
					FinancialReportDAO fdao = new FinancialReportDAO();					
					calculatedEmoluments = fdao.calclatedEmoluments(monthYear,
							calPensionupto, dateofbirth, String
									.valueOf(Double.parseDouble(bean
											.getEmployeePF()) * 100 / 12), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					foundPensioncontri = this.getPensionContri(conn, monthyear2
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					if(!foundPensioncontri.equals("")){
					 pcdiff=Double.parseDouble(foundPensioncontri.trim())+calculatedPension;
					}
					if(pcdiff<0){
						throw new InvalidDataException("Sorry! You dont have privileges to import the Negitive Data for PFID: "+bean.getPfid().trim()+")");
					}
				}			
				if (foundSalaryDate != "") {
					 String count1[] = foundSalaryDate.split("_");
						String pensionno = count1[0];
						String stationname = count1[1];
						String region1 = count1[2];
						String transMonthYear = commonUtil.converDBToAppFormat(
								monthyear2.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
							String suppliquery = " insert into employee_supplimentory_data(pensionno,CPFACCNO,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,remarks,USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE) (select pensionno,CPFACCNO,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,'data Pulled from Validate table to suppli table',USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE from employee_pension_validate where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "' and suppliflag='N')";
					log.info(suppliquery);
				String	updateValidatetable = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),calcEmoluments=to_char(to_number(nvl(calcEmoluments,0)+'"
							+ calculatedEmoluments
							+ "')),remarks=remarks||'"+bean.getStation()+"',PFCARDNARRATION=PFCARDNARRATION||'"+bean.getPfcardNarration()+"',SUPPLIFLAG='Y',pf= to_char(TO_NUMBER(nvl(pf,0)+TO_NUMBER('"
							+ pf
							+ "'))),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+TO_NUMBER('"
							+ calculatedPension
							+ "'))),edittrans='Y',EMPRECOVERYSTS='"+bean.getUplodeType()+"' where pensionno='"+bean.getPfid()+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'";
				   log.info(updateValidatetable);
				   st.executeQuery(suppliquery);
				   st.executeUpdate(updateValidatetable);
					//suppli.addBatch(suppliquery);
				   //suppli.addBatch(updateValidatetable);
					
				}else{
					if (!bean.getPfid().equals("") && !srno.equals("")) {
						pst1.setString(1, bean.getCpfAcNo().trim());
						pst1.setString(2, bean.getEmoluments().trim());
						pst1.setString(3, bean.getEmployeePF().trim());
						pst1.setString(4, bean.getStation());
						pst1.setString(5, monthYear.trim());
						pst1.setString(6, bean.getEmpName().trim());
						pst1.setString(7, bean.getEmpNumber().trim());
						pst1.setString(8, bean.getDesegnation().trim());
						pst1.setString(9, bean.getRegion().trim());
						pst1.setString(10, bean.getPfid().trim());
						pst1.setString(11, bean.getEmployeeVPF().trim());
						pst1.setString(12, bean.getPrincipal().trim());
						pst1.setString(13, bean.getInterest().trim());
						pst1.setDouble(14, calculatedPension);
						pst1.setDouble(15, pf);
						pst1.setString(16, finyear);
						pst1.setDouble(17, calculatedEmoluments);
						pst1.setString(18, "Y");
						pst1.setString(19, bean.getPfcardNarration());
						pst1.setString(20, "Y");
						pst1.setString(21, bean.getUplodeType());
						log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
								+ bean.getEmoluments() + "," + bean.getEmployeePF()
								+ "PFID " + bean.getPfid() + ","
								+ bean.getEmpName() + "," + bean.getEmpNumber()
								+ "," + bean.getDesegnation());
					   pst1.addBatch();	
						pst1.executeBatch();
						addflag = true;
					}					
				}
				
				if (!duplicateSet.contains(bean.getPfid())) {
					duplicateSet.add(bean.getPfid());
				} else if (bean.getPfid() != null && bean.getPfid() != "") {
					duplicateList.add(bean.getPfid());
					duplicateSet.remove(bean.getPfid());
					// continue;
				}		
				if (!bean.getPfid().equals("") && !srno.equals("")) {
					//String supplilog="insert into employee_suppli_log(pensionno,FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR,PAIDDATE,FORMTYPE) values('"+bean.getPfid().trim()+"','"+fileName.trim()+"','"+bean.getUserName().trim()+"','"+ipAddress.trim()+"','"+bean.getStation().trim()+"','"+bean.getRegion().trim()+"','"+monthYear.trim()+"','"+bean.getPaidDate()+"','AAIEPF-4')";
					//st.execute(supplilog);					
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, finyear);
					pst.setDouble(17, calculatedEmoluments);
					pst.setString(18, "F");
					pst.setString(19, monthYear.trim());
					pst.setString(20, bean.getPfcardNarration());
					pst.setString(21, fileName.trim());
					pst.setString(22, bean.getUserName().trim());
					pst.setString(23, ipAddress.trim());
					pst.setString(24, "AAIEPF-4");
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.addBatch();
					addBatchcount=	pst.executeBatch();
					addflag = true;
				}
				
			}}

			if (addflag) {
				if (duplicateList.size() > 0) {
					StringBuffer dupliateRecords = new StringBuffer();
					for (Iterator it = duplicateList.iterator(); it.hasNext();) {
						dupliateRecords.append(it.next() + "\n" + ",");
					}
					/*throw new InvalidDataException(
							" The Imported sheet having the dupliate Records for the PFID's "
									+ dupliateRecords);*/
				}			
				//pst1.executeBatch();
			   //addBatchcount = pst.executeBatch();
				log.info("Inserted Records Count is " + addBatchcount.length);

			}
			if (updateflag) {
			int updatedBatchCount[] = st.executeBatch();
				log
						.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y',AIRPORT='"+bean.getStation()+"' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		}  catch (Exception e) {
			// TODO Auto-generated catch block
			 log.info(e.toString());
				String msg="";
				String txt=e.toString();
				if(txt.indexOf("java.lang.ArrayIndexOutOfBoundsException")!=-1){
				 msg="Please Enter Valid Data ( Excepting only Numeric Values) for the PFID "+bean.getPfid()+" in SRN0 "+srno+" , Containing Invalid Characters in the Column No";	
				}
		throw new InvalidDataException(msg +""+e.getMessage());
			
		} finally {
			try {
				rs.close();
				st1.close();
				st.close();
				suppli.close();
				pst.close();
				pst1.close();
				conn.close();
			} catch (Exception e) {

			}
		}
		log.info("ImportDao :importMonthwiseArrData leaving method");
		message = String.valueOf(addBatchcount.length);
		return message;
	}
	public String importMonthwisesinglesuppliData(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		log.info("ImportDao :importMonthwise single suppli  Entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Set duplicateSet = new HashSet();
		ArrayList duplicateList = new ArrayList();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement suppli = null;
		Statement insert= null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "",pcCalcMonthYear="";
		PreparedStatement pst = null;
		PreparedStatement pst1 = null;
		ResultSet rs = null;
		String srno = "";
		String foundSalaryDate = "", retirementDate = "",foundPensioncontri="",freezedPenData="",pcpfcardmonth="";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			suppli = conn.createStatement();
			insert = conn.createStatement();
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			String monthyear = convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth);
			/* checking the file import status */
			String importMonthStatus = "select lower(FILENAME) as FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info("Mohan MMMMMMMM===="+importMonthStatus);

			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName.toLowerCase())
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported for Salary Month "
							+ month + "-" + year);
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String srnoCheck = "";
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, "");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_supplimentory_data(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,PAIDDATE,PFCARDNARRATION,"
					+"FILENAME,CLIENTNAME,SYSADDRESS,FORMTYPE,SALMONTH,RECMONTH,FORM4FLAG)"
					+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			String validateInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
				+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,calcEmoluments,SUPPLIFLAG,PFCARDNARRATION,FORM4FLAG )"
				+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
	
			pst = conn.prepareStatement(finaceInsert);
		    pst1=conn.prepareStatement(validateInsert);
			for (int i = 1; i < xlsDataList.size(); i++) {
				srnoCheck = xlsDataList.get(1).toString();
				String tempSrNoCheck[] = srnoCheck.split("@");
				if (i == 1 && !tempSrNoCheck[0].trim().equals("1")) {
					throw new InvalidDataException(
							"Please Put the Data from 12th row onwards");
				}
				double calculatedPension = 0.00;
				double calculatedEmoluments = 0.00;
				String updateFlag="";
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				System.out.println("tempInfo==="+tempData.toString());
				bean.setRegion(region);
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if(tempInfo[4].equals("XXX")){					
					throw new InvalidDataException(
							" EmployeeName Column E Cannot be Blank, Please Enter the EmployeeName for the PFID : "+bean.getPfid().trim()+"");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}
				String monthyear2 = "";
			if(tempInfo[8].equals("XXX")){
				throw new InvalidDataException(
						" Salary Month Column I Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
			}
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
				}
				if (!tempInfo[21].equals("XXX") && !srno.equals("")) {
					String sheetDateMonthYear = tempInfo[21];
					String sheetDateMonthyear[] = tempInfo[21].split("-");
					String sheetMonthYear = sheetDateMonthyear[1] + "-"
							+ sheetDateMonthyear[2];
					if (!monthyear.equals(sheetMonthYear)) {
												throw new InvalidDataException(
								"Please make sure that the Salary Month Selected above (i.e "
										+ convertedMonthYear
										+ " is matching with month given in the excel sheet at Column V of the Paid Date against PFID  "+bean.getPfid()+"  "+ tempInfo[20].trim() + " ( i.e "
										+ sheetMonthYear + ")");
					}	
				}
				
				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}
				log.info("tempInfo[8]"+tempInfo[8].trim());
				if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
					
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					log.info("convertedDate"+convertedDate.trim());
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet ");
					}
					log.info("hello");
				if (!tempInfo[20].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					String sheetDateMonth[] = tempInfo[20].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ monthyearsheet.trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						monthyear2 = rs.getString(1);
					}
				}
				String cpfrecmonth="";
				if(!monthyear2.equals("")){
				String cpfmonth[]=monthyear2.split("-");
				 cpfrecmonth = 01+"-"+cpfmonth[1] + "-"+ cpfmonth[2];
				}
				if (!tempInfo[20].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[20].split("-");			
					monthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];					
				} else {
					monthYear = "";
				}if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					String sheetDateMonth[] = tempInfo[8].split("-");			
					String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ monthyearsheet.trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st1.executeQuery(monthyearQuery);
					if (rs.next()) {
						pcpfcardmonth = rs.getString(1);
					}
				}
				
				if (!tempInfo[8].equals("XXX")) {
					String sheetDateMonth[] = tempInfo[8].split("-");						
					pcCalcMonthYear =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];					
				} else {
					pcCalcMonthYear = "";
				}	
				String finyear = "";		
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}				
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].replaceAll(",", "").trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[15].equals("XXX")) {
					pf=Double.parseDouble(tempInfo[15].replaceAll(",", "").trim());
				} else {
					pf=0.00;
				}
				if (!tempInfo[16].equals("XXX")) {
					calculatedPension=Double.parseDouble(tempInfo[16].replaceAll(",", "").trim());
				} else {
					calculatedPension=0.00;
				}	
				if (!tempInfo[18].equals("XXX")) {
					bean.setStation(tempInfo[18].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[19].equals("XXX")) {
					bean.setPfcardNarration(tempInfo[19].trim());
				} else {
					bean.setPfcardNarration("");
				}
				
				
				if (!tempInfo[20].trim().equals("XXX")) {
					String sheetCpfRecoveryDate[] = tempInfo[20].split("-");			
					bean.setCpfRecoveryDate(01+"-"+sheetCpfRecoveryDate[1] + "-"+ sheetCpfRecoveryDate[2]);
					//bean.setCpfRecoveryDate(tempInfo[21].trim());
				} else {
					bean.setCpfRecoveryDate("");
				}	
				log.info("bean.getCpfRecoveryDate"+bean.getCpfRecoveryDate());
				if (!tempInfo[21].trim().equals("XXX")) {
					String sheetPaidMonth[] = tempInfo[21].split("-");			
					bean.setPaidDate(01+"-"+sheetPaidMonth[1] + "-"+ sheetPaidMonth[2]);					
					//bean.setPaidDate(tempInfo[20].trim());
				} else {
					bean.setPaidDate("");
				}				
				if (!tempInfo[22].trim().equals("XXX")) {
					bean.setUserName(tempInfo[22].trim());
				} else {
					bean.setUserName("");
				}
				if (!tempInfo[23].trim().equals("XXX")) {
					bean.setForm4flag(tempInfo[23].trim());
				} else {
					bean.setForm4flag("N");
				}
				 //	checking paiddate is null or not..
				if (bean.getPaidDate() == ""
						&& !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("Paid Date Column V Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
				}
				if (bean.getCpfRecoveryDate() == ""
					&& !bean.getPfid().trim().equals("")) {
					
				throw new InvalidDataException("Cpf Recovery Month Column U Cannot be Blank, Please Enter the Date ( in DD-Mon-YYYY Format) for the PFID : "+bean.getPfid().trim()+"");
			}
				if (bean.getPfcardNarration() == ""
					&& !bean.getPfid().trim().equals("")) {
				throw new InvalidDataException("Remarks Column T Cannot be Blank, Please Enter the valid Remarks for the PFID : "+bean.getPfid().trim()+""); 
				}
				log.info(bean.getCpfRecoveryDate().trim());
              //checking pensionno Freezed or not..
				log.info("FreezedpennoData"+bean.getCpfRecoveryDate().trim()+"pensionno"+bean.getPfid());
				freezedPenData = this.FreezedpennoData(conn,bean.getCpfRecoveryDate().trim(), bean.getPfid());
				log.info("freezedPenData==="+freezedPenData);
				if(!freezedPenData.equals("")){
				        String count1[] = freezedPenData.split("_");
						String pensionno = count1[0];
						String username = count1[1];							
							throw new InvalidDataException("PFID "+pensionno+" Frozen  as Per Request on '"+username+"'");
			}
              
				 //checking paiddate is in correct format..
				if (bean.getPaidDate() != ""
						&& !bean.getPfid().trim().equals("")) {
					 convertedDate = commonUtil.convertDateFormat(bean
							.getPaidDate());
				 index = bean.getPaidDate().indexOf("-");
					String  count1[] = bean.getPaidDate().split("-");
					log.info(" countlength " + count.length);
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column V of the PaidDate of the Uploaded sheet ");
					}
				}
               //checking CpfRecoveryDate is in correct format..
				if (bean.getCpfRecoveryDate() != ""
					&& !bean.getPfid().trim().equals("")) {
				 convertedDate = commonUtil.convertDateFormat(bean
						.getCpfRecoveryDate());				
				int cpfindex=bean.getCpfRecoveryDate().trim().indexOf("-");
				String cpfcount[] = bean.getCpfRecoveryDate().split("-");
				if (cpfindex == -1 || cpfcount.length != 3) {
					throw new InvalidDataException(
							"PFID "+ bean.getPfid().trim()
									+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column U of the Uploaded sheet ");
				}
				}
				//checking paid date should greater than salary recoverie date..
				DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
				Date paiddate = df.parse(bean.getPaidDate());
				log.info("monthyear2=="+cpfrecmonth+"   paidate=="+bean.getPaidDate());
				if (!bean.getPfid().trim().equals("") && !new Date(bean.getPaidDate()).equals(new Date(cpfrecmonth))) {
								throw new InvalidDataException("Paid Date "+bean.getPaidDate()+"  Should Greater than CPF Recoverie date "+bean.getCpfRecoveryDate()+" only one month ");
				}
                //checking paid date should greater than CPf recoverie date..
				if (!bean.getPfid().trim().equals("") && new Date(cpfrecmonth).before(new Date("01-Mar-2011"))) {
					throw new InvalidDataException("" +
							"Salary month  Should be Greater than  01-Mar-2011 ");
	}
               // checking paid date should greater than CPf recoverie date..
				if (!bean.getPfid().trim().equals("") && new Date(pcCalcMonthYear).before(new Date("01-Apr-2008"))) {
					throw new InvalidDataException("" +
							"Salary month  Should be Greater than  01-Apr-2008 ");
	}
				if(bean.getStation().trim().equals("")){
					throw new InvalidDataException("Airport Code Cannot be Blank ...! Please Enter the Airport Code Same as the Selected Airport for the PFID: "+bean.getEmpName()+"."); 
				}
				//checking selected airpotcode  and sheet airportcode is mandatory in the sheet 
				if (airportcode != null	&& !bean.getPfid().trim().equals("")/*&& (region.equals("CHQIAD") || region.equals("South Region"))*/) {
					log.info("sheet airportcode "
							+ bean.getStation().trim()
							+ " selected airportcode "
							+ airportcode.trim() + "srno " + srno);
					if (!bean.getStation().trim().equals(airportcode.trim())&& !srno.equals("")) {
						throw new InvalidDataException(
								"Please Make Sure That The Selected Airportcode above  (i.e "
										+ airportcode
										+ ") and is Matching with AirportCode given in the excel sheet at Column 18. i.e"
										+ bean.getStation());
					}
				}
				
				if (srno.equals("") && !bean.getPfid().trim().equals("")) {
					throw new InvalidDataException(
							"PFID "
									+ bean.getPfid().trim()
									+ " doesn't have SRNO in Column A of the Uploaded sheet ");
				}
				if (!srno.equals("") && bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for   Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}

				if (!bean.getPfid().trim().equals("") && monthYear.equals("")) {
					throw new InvalidDataException("monthyear " + monthyear
							+ " doesn't Exist" + " for PFID "
							+ bean.getPfid().trim() + ", " + bean.getEmpName()
							+ ". monthyear is Mandatory for All The Employees");
				}
				bean.setPfcardNarration(bean.getPfcardNarration().trim()+tempInfo[8].trim());				
				log.info("pfcardnarration"+bean.getPfcardNarration());
				//checking duplicate pfid
				if (!duplicateSet.contains(bean.getPfid())) {
					duplicateSet.add(bean.getPfid());
					log.info("duplicateSet first-------"+duplicateSet.size()+"monthyear"+tempInfo[8].trim());
				} else if (bean.getPfid() != null && bean.getPfid() != "") {
					log.info("duplicateSet2======="+duplicateSet.size()+"monthyear"+tempInfo[8].trim());
					updateFlag="Y";
				}
				if (!bean.getPfid().trim().equals("")) {			
					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
						+ tempInfo[8]
						+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 697),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
						+ bean.getPfid() + "'";
				log.info(checkPFID);
				rs = st1.executeQuery(checkPFID);
				if (!rs.next()) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for  Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}
				if (rs.getString("wetheroption") != null) {
					bean.setWetherOption(rs.getString("wetheroption"));
				} else {
					bean.setWetherOption("");
				}
				if (rs.getString("REIREMENTDATE") != null) {
					retirementDate = rs.getString("REIREMENTDATE");
				} else {
					retirementDate = "";
				}
				if (rs.getString("dateofbirth") != null) {
					dateofbirth = rs.getString("dateofbirth");
				} else {
					dateofbirth = "";
				}
				String days = "0";
				if (rs.getString("days") != null) {
					days = rs.getString("days");
				} else {
					days = "0";
				}
				String calPensionupto = "";
				if (rs.getString("calPensionupto") != null) {
					calPensionupto = rs.getString("calPensionupto");
				} else {
					calPensionupto = "0";
				}
				if (tempInfo[1].equals("XXX")) {
					throw new InvalidDataException("PFID is Blank for "
							+ bean.getCpfAcNo());
				}
				
					/* Duplicate Record Checking */
					foundSalaryDate = this.trasactionDuplicateSuppli(conn, bean.getPaidDate()
							.trim(), bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");					
					FinancialReportDAO fdao = new FinancialReportDAO();
					}
				if (foundSalaryDate.trim() != "" || updateFlag.equals("Y")) {
					 String count1[] = foundSalaryDate.split("_");
						String pensionno = count1[0];
						String stationname = count1[1];
						String region1 = count1[2];
						String transMonthYear = commonUtil.converDBToAppFormat(
								bean.getPaidDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
						if(!updateFlag.trim().equals("Y")){
					String suppliquery = " insert into employee_supplimentory_data(pensionno,CPFACCNO,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,remarks,USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,FORM4FLAG) (select pensionno,CPFACCNO,monthyear,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,'data fulled from Validate table to suppli table',USERNAME,IPADDRESS,CALCEMOLUMENTS,SUPPLIFLAG,UPLOADDATE,FORM4FLAG from employee_pension_validate where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'  and suppliflag='N' and EMPFLAG='Y')";
					log.info(suppliquery);
					insert.addBatch(suppliquery);
						}
                     String	updateValidatetable = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),calcEmoluments=to_char(to_number(nvl(calcEmoluments,0)+'"
							+ calculatedEmoluments
							+ "')),remarks=remarks||'"+bean.getStation()+"',SUPPLIFLAG='Y',PFCARDNARRATION=PFCARDNARRATION||'"+bean.getPfcardNarration()+"',FORM4FLAG='"+bean.getForm4flag()+"',pf= to_char(TO_NUMBER(nvl(pf,0)+TO_NUMBER('"
							+ pf
							+ "'))),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+TO_NUMBER('"
							+ calculatedPension
							+ "')))  where pensionno='"+bean.getPfid()+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"+ transMonthYear + "'";
				  // suppli.addBatch(suppliquery);
				   log.info(updateValidatetable);
				   suppli.addBatch(updateValidatetable);
					
				}else{
					if (!bean.getPfid().equals("") && !srno.equals("")) {						
						pst1.setString(1, bean.getCpfAcNo().trim());
						pst1.setString(2, bean.getEmoluments().trim());
						pst1.setString(3, bean.getEmployeePF().trim());
						pst1.setString(4, bean.getStation());
						pst1.setString(5, bean.getPaidDate().trim());
						pst1.setString(6, bean.getEmpName().trim());
						pst1.setString(7, bean.getEmpNumber().trim());
						pst1.setString(8, bean.getDesegnation().trim());
						pst1.setString(9, bean.getRegion().trim());
						pst1.setString(10, bean.getPfid().trim());
						pst1.setString(11, bean.getEmployeeVPF().trim());
						pst1.setString(12, bean.getPrincipal().trim());
						pst1.setString(13, bean.getInterest().trim());
						pst1.setDouble(14, calculatedPension);
						pst1.setDouble(15, pf);
						pst1.setString(16, finyear);
						pst1.setDouble(17, calculatedEmoluments);
						pst1.setString(18, "Y");
						pst1.setString(19, bean.getPfcardNarration());
						pst1.setString(20, bean.getForm4flag());		
						pst1.addBatch();
						addflag = true;
					}
				}
				if (!duplicateSet.contains(bean.getPfid())) {
					duplicateSet.add(bean.getPfid());
				} else if (bean.getPfid() != null && bean.getPfid() != "") {
					duplicateList.add(bean.getPfid());
					duplicateSet.remove(bean.getPfid());
					// continue;
				}
				if (!bean.getPfid().equals("") && !srno.equals("")) {
					
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, bean.getPaidDate().trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, finyear);
					pst.setDouble(17, calculatedEmoluments);
					pst.setString(18, "S");
					pst.setString(19, bean.getPaidDate());
					pst.setString(20, bean.getPfcardNarration());
					pst.setString(21, fileName.trim());
					pst.setString(22, bean.getUserName().trim());
					pst.setString(23, ipAddress.trim());
					pst.setString(24, "AAIEPF-SINGLEVALUE");
					pst.setString(25, pcCalcMonthYear);
					pst.setString(26, bean.getCpfRecoveryDate());
					pst.setString(27, bean.getForm4flag());
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					pst.addBatch();
					addflag = true;
				}
				
			}}

			if (addflag) {
				if (duplicateList.size() > 0) {
					StringBuffer dupliateRecords = new StringBuffer();
					for (Iterator it = duplicateList.iterator(); it.hasNext();) {
						dupliateRecords.append(it.next() + "\n" + ",");
					}
					/*throw new InvalidDataException(
							" The Imported sheet having the dupliate Records for the PFID's "
									+ dupliateRecords);*/
				}
				insert.executeBatch();
				suppli.executeBatch();
				pst1.executeBatch();
				addBatchcount = pst.executeBatch();				
				 log.info("Inserted Records Count is " + addBatchcount.length);
               
			}
			if (updateflag) {
			int updatedBatchCount[] = st.executeBatch();
				log.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y',AIRPORT='"+bean.getStation()+"' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			 log.info(e.toString());
				String msg="";
				String txt=e.toString();
				if(txt.indexOf("java.lang.ArrayIndexOutOfBoundsException")!=-1){
				 msg="Please Enter Valid Data ( Excepting only Numeric Values) for the PFID "+bean.getPfid()+" in SRN0 "+srno+" , Containing Invalid Characters in the Column No";	
				}
		throw new InvalidDataException(msg +""+e.getMessage());
			
		} finally {
			try {
				rs.close();
				st1.close();
				st.close();
				suppli.close();
				pst.close();
				pst1.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :importMonthwiseSuppl Single Value Data leaving method");
		message = String.valueOf(addBatchcount.length);
		return message;
	}
	public String cpfRecievedFromOtherOrg(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {

		log.info("ImportDao :cpfRecievedFromOtherOrg() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		String foundSalaryDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			String lastactiveMonth = 1 + "-" + month + "-" + year;
			String monthyear = month + "-" + year;
			log.info(lastactiveMonth + "lastactiveMonth");
			String importMonthStatus = "select FILENAME,IMPORTSTATUS FROM payment_recov_mnth_upload_log where  to_char(monthyear,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName)
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported");
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, " ");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,recfromotherorg)"
					+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			pst = conn.prepareStatement(finaceInsert);

			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				bean.setRegion(region);

				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}

				if (!tempInfo[8].equals("XXX")
						&& !bean.getPfid().trim().equals("")) {
					log.info(tempInfo[8]);
					String convertedDate = commonUtil
							.convertDateFormat(tempInfo[8].trim());
					log.info("converted date is " + convertedDate);
					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 && count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ bean.getPfid().trim()
										+ " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet");
					}
					String sheetDateMonthYear = tempInfo[8];
					String sheetDateMonthyear[] = tempInfo[8].split("-");
					String sheetMonthYear = sheetDateMonthyear[1] + "-"
							+ sheetDateMonthyear[2];
					log.info("sheetMonthYear " + sheetMonthYear);
					if (!monthyear.equals(sheetMonthYear)) {
						String monthyear1[] = lastactiveMonth.split("-");
						String month1 = monthyear1[1];
						String year1 = monthyear1[2];
						throw new InvalidDataException("PFID "
								+ tempInfo[1].trim() + " doesn't have Month "
								+ month1 + "-" + year1);
					}
				}

				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}

				if (!tempInfo[8].equals("XXX")) {
					monthYear = tempInfo[8].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmoluments(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}

				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeePF(tempInfo[11].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[12].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setPrincipal(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setInterest(tempInfo[14].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}

				if (!tempInfo[18].equals("XXX")) {
					bean.setStation(tempInfo[18].trim());
				} else {
					bean.setStation("");
				}
				if (airportcode != null && !bean.getPfid().trim().equals("")) {
					// log.info("sheet airportcode "+
					// bean.getStation().replaceAll(" ", "")+
					// " selected airportcode "+ airportcode.replaceAll(" ",
					// ""));
					if (!bean.getStation().replaceAll(" ", "").equals(
							airportcode.replaceAll(" ", ""))) {
						throw new InvalidDataException(
								"Seleted Airportcode and upload sheet Airportcode are not Equal");
					}
				}
				log.info("cpfaccno " + bean.getCpfAcNo() + " " + bean.getPfid()
						+ "bean.getPfid().trim().equals()"
						+ bean.getPfid().trim().equals("")
						+ "bean.getCpfAcNo().trim().equals()"
						+ bean.getCpfAcNo().trim().equals(""));
				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for Cpfaccno " + bean.getCpfAcNo());
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}
					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());

					foundSalaryDate = this.checkFinanceDuplicate(conn,
							monthYear.trim(), bean.getCpfAcNo(), bean
									.getEmpNumber(), bean.getRegion());
					if (!tempInfo[17].equals("XXX")) {
						pensioncontri = Double.parseDouble(tempInfo[17].trim());
					}

				}

				if (foundSalaryDate.equals("") && !bean.getCpfAcNo().equals("")) {
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, pensioncontri);
					pst.setString(15, "Y");
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					// pst.executeUpdate();
					pst.addBatch();
					// pst.close();
					addflag = true;
				} else if (!bean.getCpfAcNo().equals("")) {
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "'))  where region='"
							+ bean.getRegion().trim()
							+ "' and airportcode='"
							+ bean.getStation()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";
					st.addBatch(insertArrearCount);

					updateflag = true;
				}
				// }
			}

			if (addflag) {
				addBatchcount = pst.executeBatch();
				log.info("Inserted Records Count is " + addBatchcount.length);
			}
			if (updateflag) {
				int updatedBatchCount[] = st.executeBatch();
				log
						.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				st1.close();
				st.close();
				pst.close();
				rs.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :cpfRecievedFromOtherOrg leaving method");
		message = String.valueOf(addBatchcount.length);
		return message;
	}

	public void importOpeningBalance(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		int total = 0;
		log.info("ImportDao :importOpeningBalance() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		PreparedStatement pst = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", empName = "", designation = "", station = "", insertOB = "";

		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");

			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			// String lastactiveMonth = 1 + "-" + month + "-" + year;

			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth);
			String monthyear = convertedMonthYear;
			String importMonthStatus = "select FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(monthyear,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st.executeQuery(importMonthStatus);
			// log.info("file name is "+ rs.getString("FILENAME"));

			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName)
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported");
				}
			}
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, " ");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", pensionNo = "";
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[2].equals("XXX")) {
					cpfaccno = tempInfo[2].trim();
				} else {
					cpfaccno = "";
				}
				if (!tempInfo[3].equals("XXX")) {
					employeeNo = tempInfo[3].trim();
				}
				if (!tempInfo[4].equals("XXX")) {
					empName = tempInfo[4].trim();
				} else {
					empName = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					designation = tempInfo[5].trim();
				} else {
					designation = "";
				}
				String monthYear = "01-Apr-2007";

				double empOB = 0.00, aaiOB = 0.00, outStandingOB = 0.00;

				if (!tempInfo[11].equals("XXX")) {
					station = tempInfo[11].trim();
				} else {
					station = "";
				}
				if (airportcode != null && !bean.getPfid().trim().equals("")) {
					log.info("pfid" + bean.getPfid() + "sheet airportcode "
							+ station.replaceAll(" ", "")
							+ " selected airportcode "
							+ airportcode.replaceAll(" ", ""));

					if (region.equals("CHQIAD")) {
						if (!station.replaceAll(" ", "").equals(
								airportcode.replaceAll(" ", ""))) {
							throw new InvalidDataException(
									"Please make sure that the Seleted Airportcode above  (i.e "
											+ airportcode
											+ ") and is matching with AirportCode given in the excel sheet at Column 11. i.e"
											+ station);
						}
					}
				}
				if (!tempInfo[8].equals("XXX")
						&& !tempInfo[8].trim().equals("")) {
					log.info("ob " + tempInfo[8]);
					empOB = Double.parseDouble(tempInfo[8].trim().replaceAll(
							",", "").trim());
				}

				if (!tempInfo[9].equals("XXX")
						&& !tempInfo[9].trim().equals("")) {
					aaiOB = Double.parseDouble(tempInfo[9].replaceAll(",", "")
							.trim());
				}

				if (!tempInfo[10].equals("XXX")
						&& !tempInfo[10].trim().equals("")) {
					outStandingOB = Double.parseDouble(tempInfo[10].replaceAll(
							",", "").trim());
				} else {
					outStandingOB = 0.00;
				}
				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for Cpfaccno " + cpfaccno);
					}

				}
				// if (!bean.getPfid().trim().equals("")) {

				insertOB = "insert into employee_pension_ob (pensionno,cpfaccno,OBYEAR,EMPNETOB ,AAINETOB,outstandadv,region,airportcode,employeename,DESEGNATION) values('"
						+ bean.getPfid()
						+ "','"
						+ cpfaccno
						+ "','"
						+ monthYear
						+ "','"
						+ empOB
						+ "','"
						+ aaiOB
						+ "','"
						+ outStandingOB
						+ "','"
						+ region
						+ "','"
						+ station
						+ "','"
						+ empName
						+ "','" + designation + "')";
				String insertArrearCount = "";
				log.info(insertOB);
				st.addBatch(insertOB);
				// }

			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y' where filename='"
					+ fileName + "'";
			st.addBatch(importStausupdate);
			int count[] = st.executeBatch();

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				st1.close();
				st.close();
				pst.close();
				rs.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :importOpeningBalance leaving method");

	}

	public void importAdjOpeningBalance(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		int total = 0;
		log.info("ImportDao :importAdjOpeningBalance() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		PreparedStatement pst = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", empName = "", designation = "", station = "", insertAdjOB = "";

		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");

			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			String lastactiveMonth = 1 + "-" + month + "-" + year;
			log.info(lastactiveMonth + "lastactiveMonth");
			String importMonthStatus = "select FILENAME,IMPORTSTATUS FROM payment_recov_mnth_upload_log where  to_char(monthyear,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st.executeQuery(importMonthStatus);
			// log.info("file name is "+ rs.getString("FILENAME"));

			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName)
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported");
				}
			}
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, " ");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String cpfaccno = "", employeeName = "", employeeNo = "", pensionNo = "";
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				if (!tempInfo[2].equals("XXX")) {
					cpfaccno = tempInfo[2].trim();
				} else {
					cpfaccno = "";
				}
				if (!tempInfo[3].equals("XXX")) {
					employeeNo = tempInfo[3].trim();
				}
				if (!tempInfo[4].equals("XXX")) {
					empName = tempInfo[4].trim();
				} else {
					empName = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					designation = tempInfo[5].trim();
				} else {
					designation = "";
				}
				String monthYear = "01-Apr-2008";
				double empsub = 0.00, empsubInterest = 0.00, aaiAmount = 0.00, aaiInterest = 0.00, outstandadv = 0.00;
				if (!tempInfo[17].equals("XXX")) {
					station = tempInfo[17].trim();
				} else {
					station = "";
				}
				if (airportcode != null && !bean.getPfid().trim().equals("")) {
					log.info("pfid" + bean.getPfid() + "sheet airportcode "
							+ station.replaceAll(" ", "")
							+ " selected airportcode "
							+ airportcode.replaceAll(" ", ""));

					if (region.equals("CHQIAD")) {
						if (!station.replaceAll(" ", "").equals(
								airportcode.replaceAll(" ", ""))) {
							throw new InvalidDataException(
									"Please make sure that the Seleted Airportcode above  (i.e "
											+ airportcode
											+ ") and is matching with AirportCode given in the excel sheet at Column 17. i.e"
											+ station);
						}
					}
				}
				if (!tempInfo[10].equals("XXX")
						&& !tempInfo[10].trim().equals("")) {
					log.info("ob " + tempInfo[10]);
					empsub = Double.parseDouble(tempInfo[10].trim().replaceAll(
							",", "").trim());
				}

				if (!tempInfo[11].equals("XXX")
						&& !tempInfo[11].trim().equals("")) {
					empsubInterest = Double.parseDouble(tempInfo[11]
							.replaceAll(",", "").trim());
				}

				if (!tempInfo[13].equals("XXX")
						&& !tempInfo[13].trim().equals("")) {
					aaiAmount = Double.parseDouble(tempInfo[13].replaceAll(",",
							"").trim());
				} else {
					aaiAmount = 0.00;
				}
				if (!tempInfo[14].equals("XXX")
						&& !tempInfo[14].trim().equals("")) {
					aaiInterest = Double.parseDouble(tempInfo[14].replaceAll(
							",", "").trim());
				} else {
					aaiInterest = 0.00;
				}
				if (!tempInfo[16].equals("XXX")
						&& !tempInfo[16].trim().equals("")) {
					outstandadv = Double.parseDouble(tempInfo[16].replaceAll(
							",", "").trim());
				} else {
					outstandadv = 0.00;
				}
				if (!bean.getCpfAcNo().trim().equals("")
						|| !bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for Cpfaccno " + cpfaccno);
					}

				}
				if (!bean.getPfid().trim().equals("")) {

					insertAdjOB = "update employee_adj_ob  set PENSIONTOTAL=to_char(TO_NUMBER(nvl(PENSIONTOTAL,0)-'"
							+ aaiAmount
							+ "')), PENSIONINTEREST=to_char(TO_NUMBER(nvl(PENSIONINTEREST,0)-'"
							+ aaiInterest
							+ "')),EMPSUB=to_char(TO_NUMBER(nvl(EMPSUB,0)+'"
							+ empsub
							+ "')),EMPSUBINTEREST=to_char(TO_NUMBER(nvl(EMPSUBINTEREST,0)+'"
							+ empsubInterest
							+ "')),OUTSTANDADV=to_char(TO_NUMBER(nvl(OUTSTANDADV,0)+'"
							+ outstandadv
							+ "')),REMARKS=REMARKS ||'aaiAmount:'||'"
							+ aaiAmount
							+ "'||'interest:'||'"
							+ aaiInterest
							+ "' where pensionno='"
							+ bean.getPfid()
							+ "' and region='" + region + "'";
					String insertArrearCount = "";
					log.info(insertAdjOB);
					st.addBatch(insertAdjOB);
				}
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y' where filename='"
					+ fileName + "'";
			st.addBatch(importStausupdate);
			int count[] = st.executeBatch();

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				st1.close();
				st.close();
				pst.close();
				rs.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :importAdjOpeningBalance leaving method");

	}

	public void advancePfwFinalsettlement(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		int total = 0;
		log.info("ImportDao :advancePfwFinalsettlement() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		PreparedStatement pst = null;
		ResultSet rs = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "", srnoCheck = "", srno = "";
		String xlsEmpName = "", empName = "", designation = "", station = "";
		String cpfaccno = "", employeeName = "", employeeNo = "", pensionNo = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "", advAmount = "";
		String pfwPurpose = "", settlementdate = "";
		String reasonofSettlement = "";
		double finemp = 0.00, finaai = 0.00, pencon = 0.00, netamount = 0.00;
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");

			conn = commonDB.getConnection();
			st = conn.createStatement();
			conn.setAutoCommit(false);
			// String lastactiveMonth = 1 + "-" + month + "-" + year;
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			// log.info("lastactiveMonth" + lastactiveMonth);
			String monthyear = convertedMonthYear;
			String importMonthStatus = "select FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(monthyear,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st.executeQuery(importMonthStatus);
			// log.info("file name is "+ rs.getString("FILENAME"));

			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName)
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported");
				}
			}
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, " ");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			for (int i = 1; i < xlsDataList.size(); i++) {
				srnoCheck = xlsDataList.get(1).toString();
				String tempSrNoCheck[] = srnoCheck.split("@");
				// log.info("srnoCheck]"+tempSrNoCheck[0]);
				if (i == 1 && !tempSrNoCheck[0].trim().equals("1")) {
					throw new InvalidDataException(
							"Please Put the Recovery data from 11th  row onwards");
				}
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0].trim();
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					pensionNo = commonUtil.getSearchPFID1(tempInfo[1].trim());
				} else {
					pensionNo = "";
				}
				System.out.println(pensionNo);
				if (!tempInfo[2].equals("XXX")) {
					cpfaccno = tempInfo[2].trim();
				} else {
					cpfaccno = "";
				}
				if (!tempInfo[3].equals("XXX")) {
					employeeNo = tempInfo[3].trim();
				}
				if (!tempInfo[4].equals("XXX")) {
					empName = tempInfo[4].trim().replaceAll("'", "");
				} else {
					empName = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					designation = tempInfo[5].trim();
				} else {
					designation = "";
				}

				if (!tempInfo[8].equals("XXX") && !pensionNo.trim().equals("")) {

					int index = tempInfo[8].trim().indexOf("-");
					String count[] = tempInfo[8].split("-");
					if (index == -1 || count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ pensionNo.trim()
										+ " doesn't have valid date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet");
					}
					advTransDate = tempInfo[8].trim();
				} else {
					advTransDate = "";
				}

				// Advance Attributes
				if (!tempInfo[9].equals("XXX")) {
					advPurpose = tempInfo[9].trim().replaceAll("'", "");
					;
				} else {
					advPurpose = "";
				}

				if (!tempInfo[10].equals("XXX") && !tempInfo[10].equals(".")) {
					advAmount = tempInfo[10].replaceAll(",", "").trim();
				} else {
					advAmount = "0.00";
				}
				// Pfw Attributes
				if (!tempInfo[11].equals("XXX")) {
					pfwPurpose = tempInfo[11].trim().replaceAll("'", "");
				} else {
					pfwPurpose = "";
				}
				if (!tempInfo[12].equals("XXX")) {
					empShare = tempInfo[12].replaceAll(",", "").trim();
				} else {
					empShare = "0.00";
				}
				if (!tempInfo[13].equals("XXX")) {
					aaiShare = tempInfo[13].replaceAll(",", "").trim();
				} else {
					aaiShare = "0.00";
				}

				// final settlement Attributes

				if (!tempInfo[15].equals("XXX")) {
					reasonofSettlement = tempInfo[15].trim();
				} else {
					reasonofSettlement = "";
				}
				if (!tempInfo[16].trim().equals("XXX")) {
					finemp = Double.parseDouble(tempInfo[16]
							.replaceAll(",", "").trim());
				} else {
					finemp = 0.00;
				}
				if (!tempInfo[17].equals("XXX")) {
					finaai = Double.parseDouble(tempInfo[17]
							.replaceAll(",", "").trim());
				} else {
					finaai = 0.00;
				}
				if (!tempInfo[18].equals("XXX")) {
					pencon = Double.parseDouble(tempInfo[18]
							.replaceAll(",", "").trim());
				} else {
					pencon = 0.00;
				}
				if (!tempInfo[19].equals("XXX")) {
					netamount = Double.parseDouble(tempInfo[19].replaceAll(",",
							"").trim());
				} else {
					netamount = 0.00;
				}

				if (!tempInfo[21].trim().equals("XXX")
						&& !pensionNo.trim().equals("")
						&& !tempInfo[21].trim().equals("0")) {

					int index = tempInfo[21].trim().indexOf("-");
					String count[] = tempInfo[21].split("-");
					if (index == -1 && count.length != 3) {
						throw new InvalidDataException(
								"PFID "
										+ pensionNo.trim()
										+ " doesn't have valid date format(i.e dd-Mon-yyyy) in column V of the Uploaded sheet");
					}
					settlementdate = tempInfo[21].trim();
				} else {
					settlementdate = "";
				}

				if (!tempInfo[22].equals("XXX")) {
					station = tempInfo[22].trim();
				} else {
					station = "";
				}
				if (srno.equals("") && !pensionNo.trim().equals("")) {
					throw new InvalidDataException(
							"PFID "
									+ pensionNo.trim()
									+ " doesn't have SRNO in Column A of the Uploaded sheet ");
				} else if (!srno.equals("") && Integer.parseInt(pensionNo) < 0) {
					throw new InvalidDataException(
							"PFID "
									+ pensionNo.trim()
									+ " is not valid in the  Column B of the Uploaded sheet ");
				}
				if (!srno.equals("") && pensionNo.trim().equals("")) {
					throw new InvalidDataException("PFID " + pensionNo.trim()
							+ " doesn't Exist" + " for   Employee " + empName
							+ ". PFID is Mandatory for All The Employees");
				}
				if (advTransDate.equals("") && !srno.equals("")) {
					throw new InvalidDataException("monthyear " + advTransDate
							+ " doesn't Exist" + " for PFID " + pensionNo
							+ ", " + empName
							+ ". monthyear is Mandatory for All The Employees");
				}
				if (settlementdate.equals("") && !srno.equals("")) {
					throw new InvalidDataException(
							"settlementdate "
									+ settlementdate
									+ " doesn't Exist"
									+ " for PFID "
									+ pensionNo
									+ ", "
									+ empName
									+ ". settlementdate is Mandatory for All The Employees");
				}
				if (station.trim().equals("") && !srno.equals("")) {
					throw new InvalidDataException(
							"airportcode "
									+ airportcode
									+ " doesn't Exist"
									+ " for PFID "
									+ pensionNo
									+ ", "
									+ empName
									+ ". airportcode is Mandatory for All The Employees");
				}
				if (airportcode != null && !pensionNo.trim().equals("")) {
					// log.info("sheet airportcode " + station.replaceAll(" ",
					// "")+ " selected airportcode " +
					// airportcode.replaceAll(" ", ""));

					if (region.equals("CHQIAD") && !pensionNo.equals("")) {
						if (!station.replaceAll(" ", "").equals(
								airportcode.replaceAll(" ", ""))) {
							throw new InvalidDataException(
									"Please make sure that the Seleted Airportcode above  (i.e "
											+ airportcode
											+ ") and is matching with AirportCode given in the excel sheet at Column W. i.e"
											+ station);
						}
					}
				}
				String insertAdvanceTabledata = "", insertPfwTabledata = "", insertFinalSettlementTabledata = "";
				if (pensionNo != "") {
					insertAdvanceTabledata = "insert into  employee_pension_advances (cpfaccno,employeeno,employeename,amount,advPurpose,AdvTransDate,airportcode,region,PARTAMT,PENSIONNO)values('"
							+ cpfaccno
							+ "','"
							+ employeeNo
							+ "','"
							+ empName
							+ "','"
							+ Float.parseFloat(advAmount)
							+ "','"
							+ advPurpose
							+ "','"
							+ advTransDate
							+ "','"
							+ station.trim()
							+ "','"
							+ region
							+ "','0.00','"
							+ pensionNo + "')";
					st.addBatch(insertAdvanceTabledata);
					log.info(insertAdvanceTabledata);
				}

				if (pensionNo != "") {
					insertPfwTabledata = "insert into  employee_pension_loans(cpfaccno,employeeno,employeename,SUB_AMT,CONT_AMT,LOANPURPOSE,LOANDATE,airportcode,region,LOANTYPE,PENSIONNO)values('"
							+ cpfaccno
							+ "','"
							+ employeeNo
							+ "','"
							+ empName
							+ "','"
							+ Float.parseFloat(empShare)
							+ "','"
							+ Float.parseFloat(aaiShare)
							+ "','"
							+ pfwPurpose
							+ "','"
							+ advTransDate
							+ "','"
							+ station
							+ "','"
							+ region + "','NRF','" + pensionNo + "')";
					log.info(insertPfwTabledata);
					st.addBatch(insertPfwTabledata);

				}
				if (pensionNo != "") {
					insertFinalSettlementTabledata = "insert into employee_pension_finsettlement(cpfaccno,employeeno,employeename,pensionno,purpose,finemp,finaai,pencon,netamount,settlementdate,airportcode,region)values('"
							+ cpfaccno
							+ "','"
							+ employeeNo
							+ "','"
							+ empName
							+ "','"
							+ pensionNo
							+ "','"
							+ reasonofSettlement
							+ "',"
							+ finemp
							+ ","
							+ finaai
							+ ","
							+ pencon
							+ ","
							+ netamount
							+ ",'"
							+ settlementdate
							+ "','"
							+ station.trim() + "','" + region + "')";
					log.info(insertFinalSettlementTabledata);
					st.addBatch(insertFinalSettlementTabledata);
				}

			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y' where filename='"
					+ fileName + "'";
			log.info(importStausupdate);
			st.addBatch(importStausupdate);
			int count[] = st.executeBatch();

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				st.close();
				pst.close();
				rs.close();
				conn.close();
			} catch (Exception e) {

			}
		}
		log.info("ImportDao :advancePfwFinalsettlement leaving method");

	}
	//	 By Radha On 20-Sep-2011 for insering  New Entry in Pension OB Table
	public String createNewPFIDS(String xlsData, String region, String userName,
			String ipAddress) throws InvalidDataException {		log.info("ImportDao :createNewPFIDS() entering method");
			NomineeBean nomineeBean = new NomineeBean();
			ArrayList xlsDataList = new ArrayList();
			xlsDataList = commonUtil.getTheList(xlsData, "***");
			Connection conn = null;
			Statement st = null;
			PreparedStatement pst = null;
			PreparedStatement pst1= null;
			EmployeePersonalInfo bean = null;
			String tempInfo[] = null;
			String tempData = "";
			FileWriter fw = null;
			char[] delimiters = { '"', ',', '\'', '*', ',' };
			String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
			String uploadFilePath = "";
			String xlsEmpName = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "";
			String FinYear="",obYear="",pensionObQuery="",dojYear="",doj="";
			String year[]=null;	
			String message = "";
			int length=0;
			int addBatchcount[] = { 0 };
			int addOBBatchCount[]={ 0 };
			int updateEmpinfoCount = 0, updateTransactionCount = 0, totalEmpInfoCount = 0, totalTransCount = 0,dojMnth = 0;
			// cpfAccNum = this.getMaxValue();
			// bean.setCpfAcNo(cpfAccNum);
			log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

			try {
				ResourceBundle bundle = ResourceBundle
						.getBundle("aims.resource.DbProperties");
				uploadFilePath = bundle.getString("upload.folder.path");
				File filePath = new File(uploadFilePath);
				if (!filePath.exists()) {
					filePath.mkdirs();
				}
				fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
				conn = commonDB.getConnection();
				st = conn.createStatement();
				for (int i = 1; i < xlsDataList.size(); i++) {
					bean = new EmployeePersonalInfo();
					tempData = xlsDataList.get(i).toString();
					tempInfo = tempData.split("@");

					if (!tempInfo[2].equals("XXX")) {
						bean.setCpfAccno(tempInfo[2].trim());
					} else {
						bean.setCpfAccno("");
					}
					if (!tempInfo[3].equals("XXX")) {
						bean.setEmployeeNumber(tempInfo[3].trim());
					} else {
						bean.setEmployeeNumber("");
					}
					if (!tempInfo[4].equals("XXX")) {
						xlsEmpName = StringUtility.replaces(
								tempInfo[4].trim().toCharArray(), delimiters, "")
								.toString();
						bean.setEmployeeName(xlsEmpName.trim());
					} else {
						bean.setEmployeeName("");
					}
					if (!tempInfo[5].equals("XXX")) {
						bean.setDesignation(tempInfo[5].trim());
					} else {
						bean.setDesignation("");
					}
					if (!tempInfo[6].equals("XXX")) {
						if (tempInfo[6].indexOf(".") != -1) {
							bean.setDateOfBirth(commonUtil
									.converDBToAppFormat(tempInfo[6].trim(),
											"dd.MM.yyyy", "dd-MMM-yyyy"));
						} else if (tempInfo[6].indexOf("/") != -1) {
							bean.setDateOfBirth(commonUtil
									.converDBToAppFormat(tempInfo[6].trim(),
											"dd/MM/yyyy", "dd-MMM-yyyy"));
						} else if (tempInfo[6].indexOf("-") != -1) {
							bean.setDateOfBirth(commonUtil.converDBToAppFormat(
									tempInfo[6].trim(), "dd-MMM-yyyy",
									"dd-MMM-yyyy"));
						} else {
							bean.setDateOfBirth("");
						}
					} else {
						bean.setDateOfBirth("");
					}
					if (!tempInfo[7].equals("XXX")) {
						if (tempInfo[7].indexOf(".") != -1) {
							bean.setDateOfJoining(commonUtil
									.converDBToAppFormat(tempInfo[7].trim(),
											"dd.MM.yyyy", "dd-MMM-yyyy"));
						} else if (tempInfo[7].indexOf("/") != -1) {
							bean.setDateOfJoining(commonUtil
									.converDBToAppFormat(tempInfo[7].trim(),
											"dd/MM/yyyy", "dd-MMM-yyyy"));
						} else if (tempInfo[7].indexOf("-") != -1) {
							bean.setDateOfJoining(commonUtil.converDBToAppFormat(
									tempInfo[7].trim(), "dd-MMM-yyyy",
									"dd-MMM-yyyy"));
						} else {
							bean.setDateOfJoining("");
						}
					} else {
						bean.setDateOfJoining("");
					}

					if (!tempInfo[8].equals("XXX")) {
						bean.setGender(tempInfo[8].trim());
					} else {
						bean.setGender("");
					}
					// FOR UTILIZING OLF PFIDS
					if (!tempInfo[1].equals("XXX")) {
						bean.setPensionNo(tempInfo[1].trim());
					} else {
						bean.setPensionNo("");
					}

					if (!tempInfo[9].equals("XXX")) {
						bean.setAirportCode(tempInfo[9].trim());
					} else {
						bean.setAirportCode("");
					}
					if (!tempInfo[10].equals("XXX")) {
						bean.setRegion(tempInfo[10].trim());
					} else {
						bean.setRegion("");
					}
					if (!tempInfo[11].equals("XXX")) {
						bean.setWetherOption(tempInfo[11].trim());
					} else {
						bean.setWetherOption("");
					}

					if (!tempInfo[12].equals("XXX")) {
						bean.setRemarks(tempInfo[12].trim());
					} else {
						bean.setRemarks("");
					}
					if (!tempInfo[13].equals("XXX")) {
						bean.setDivision(tempInfo[13].trim());
					} else {
						bean.setDivision("");
					}
					if (!tempInfo[14].equals("XXX")) {
						bean.setFhName(tempInfo[14].trim());
					} else {
						bean.setFhName("");
					}
					if (!tempInfo[15].equals("XXX")) {
						bean.setSeperationReason(tempInfo[15].trim());
					} else {
						bean.setSeperationReason("");
					}
					if (!tempInfo[16].equals("XXX")) {
						bean.setSeperationDate(tempInfo[16].trim());
					} else {
						bean.setSeperationDate("");
					}
					if (!tempInfo[17].equals("XXX")) {
						bean.setMaritalStatus(tempInfo[17].trim());
					} else {
						bean.setMaritalStatus("");
					}
					if(bean.getSeperationDate().equals("") && !bean.getSeperationReason().equals("")){
						throw new InvalidDataException("Seperation date is not null while seperation reason is submitted for the pfid "+bean.getPensionNo()+"");
					}
					if(!bean.getSeperationDate().equals("") && bean.getSeperationReason().equals("")){
						throw new InvalidDataException("Seperation reason is not null while seperation date is submitted for the pfid "+bean.getPensionNo()+"");
					}
					if(bean.getWetherOption().trim().equals("")){
						throw new InvalidDataException("For the PfID "+bean.getPensionNo()+" WetherOption L Column can't be blank Please Submit the valid WetherOption");
					}
					if(!bean.getWetherOption().trim().equals("A") && !bean.getWetherOption().trim().equals("B")){
						throw new InvalidDataException("For the PfID "+bean.getPensionNo()+" WetherOption L Column can't have valid WetherOption");
					}
					PersonalService personalService = new PersonalService();
					String uniqueID = "", pensionNo = "";
					// below mentioned method only for creation of new PFIDs
					// uniqueID = personalService.addPersonalInfo(bean,
					// nomineeBean,userName, ipAddress);
					/*
					 * try { pensionNo = PersonalDAO.getSequenceNo(conn);
					 * bean.setPensionNo(pensionNo); } catch (Exception e1) { //
					 * TODO Auto-generated catch block log.printStackTrace(e1);
					 * throw e1; }
					 */
					// for utilizing old pfid's
					String updateEmpSerialNumber = "", updateTransaction = "";
					log.info("Pension No" + bean.getPensionNo() + "Employee Name"
							+ bean.getEmployeeName());
					log.info(" dob " + bean.getDateOfBirth() + "doj "
							+ bean.getDateOfJoining());
					log.info(" CPFACCNO " + bean.getCpfAccno() + "Employeeno"
							+ bean.getEmployeeNumber() + "Desigantion"
							+ bean.getDesignation());
					if (!bean.getCpfAccno().equals("")) {
						updateEmpSerialNumber = "update employee_info set EMPSERIALNUMBER='"
								+ bean.getPensionNo()
								+ "' ,DATEOFBIRTH='"
								+ bean.getDateOfBirth()
								+ "',dateofjoining='"
								+ bean.getDateOfJoining()
								+ "',FHNAME='"
								+ bean.getFhName()
								+ "',DESEGNATION ='"
								+ bean.getDesignation()
								+ "',wetheroption='"
								+ bean.getWetherOption()
								+ "',sex='"
								+ bean.getGender()
								+ "' where cpfacno='"
								+ bean.getCpfAccno()
								+ "' and region='"
								+ bean.getRegion() + "'";
						updateTransaction = "update employee_pension_validate set pensionno='"
								+ bean.getPensionNo()
								+ "' where cpfaccno='"
								+ bean.getCpfAccno()
								+ "' and region='"
								+ bean.getRegion() + "'";
					}
					String insertNewRecordInPersonalInfo = "insert into employee_personal_info (cpfacno,employeename,dateofbirth,dateofjoining,GENDER,airportcode,region,USERNAME,ipaddress,lastactive,pensionno,WETHEROPTION,EMPLOYEENO,DESEGNATION,FHNAME,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,DIVISION,MARITALSTATUS) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
					length=length+1;
					pst = conn.prepareStatement(insertNewRecordInPersonalInfo);
					pst.setString(1, bean.getCpfAccno());
					pst.setString(2, bean.getEmployeeName());
					pst.setString(3, bean.getDateOfBirth());
					pst.setString(4, bean.getDateOfJoining());
					pst.setString(5, bean.getGender());
					pst.setString(6, bean.getAirportCode());
					pst.setString(7, bean.getRegion());
					pst.setString(8, userName);
					pst.setString(9, ipAddress.trim());
					pst.setString(10, commonUtil.getCurrentDate("dd-MMM-yyyy"));
					pst.setString(11, bean.getPensionNo().trim());
					pst.setString(12, bean.getWetherOption());
					pst.setString(13, bean.getEmployeeNumber());
					pst.setString(14, bean.getDesignation());
					pst.setString(15, bean.getFhName());
					pst.setString(16, bean.getSeperationReason());
					pst.setString(17, bean.getSeperationDate());
					pst.setString(18, bean.getDivision());
					pst.setString(19, bean.getMaritalStatus().trim());
					pst.addBatch();				
					log.info(insertNewRecordInPersonalInfo);
					doj= commonUtil.converDBToAppFormat(bean.getDateOfJoining(), "dd-MMM-yyyy", "dd-MM-yyyy");
					year =doj.split("-");
					dojMnth = Integer.parseInt(year[1]);
					dojYear = year[2];
				   log.info("-----dojMnth-----"+dojMnth);
					if (dojMnth >= 4 && dojMnth <= 12) {
						FinYear =  dojYear+"-"+((Integer.parseInt(dojYear))+1);
						obYear ="01-Apr-"+ dojYear ;
					} else if (dojMnth >= 1 && dojMnth <= 3) {
						FinYear = ((Integer.parseInt(dojYear))-1)+"-"+dojYear;
						obYear ="01-Apr-"+ ((Integer.parseInt(dojYear))-1) ;
					}

					 log.info("-----obYear-----"+obYear);
					 pensionObQuery = "insert into employee_pension_ob (PENSIONNO, OBYEAR ,EMPNETOB , AAINETOB ,PENSIONOB , OBFLAG  ,REMARKS , CPFACCNO, REGION , AIRPORTCODE  ,  PRINCIPALOB, OUTSTANDADV,  FINYEAR ,  DESEGNATION  , EMPLOYEENO, EMPLOYEENAME ) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
						 pst1 = conn.prepareStatement(pensionObQuery);
					 pst1.setString(1, bean.getPensionNo().trim());
					 pst1.setString(2, obYear.trim());
					 pst1.setString(3, "0.00");
					 pst1.setString(4, "0.00");
					 pst1.setString(5,"0.00");
					 pst1.setString(6, "Y");
					 pst1.setString(7, "AAI New Entry");
					 pst1.setString(8, bean.getCpfAccno().trim());
					 pst1.setString(9, bean.getRegion());
					 pst1.setString(10, bean.getAirportCode());
					 pst1.setString(11, "0.00");
					 pst1.setString(12, "0.00");
					 pst1.setString(13, FinYear);
					 pst1.setString(14, bean.getDesignation());
					 pst1.setString(15, bean.getEmployeeNumber());
					 pst1.setString(16, bean.getEmployeeName());
					 log.info("dateOfJoining----"+bean.getDateOfJoining());	  		 
					 	//st.executeUpdate(pensionObQuery);
						log.info("pensionObQuery----"+pensionObQuery);
						pst1.addBatch();	
					
					//if (!bean.getCpfAccno().equals("") && personalInsertCount != 0) {
						//updateEmpinfoCount = st.executeUpdate(updateEmpSerialNumber);
						//updateTransactionCount = st.executeUpdate(updateTransaction);
					//}
					//totalEmpInfoCount = totalEmpInfoCount + updateEmpinfoCount;
					//totalTransCount = totalTransCount + updateTransactionCount;
						addBatchcount = pst.executeBatch();
						 addOBBatchCount = pst1.executeBatch();
				}
				
				log.info(" updateTransactionCount" + addBatchcount+ "totalEmpInfoCount" + addOBBatchCount);
			} catch (Exception e) {
				throw new InvalidDataException(e.getMessage());
			}
			log.info("length"+length);
			log.info("ImportDao :createNewPFIDS leaving method");
			message = String.valueOf(length);
			return message;
		}

	public void createNewPFIDSFrom19100(String xlsData, String region,
			String userName, String ipAddress) throws InvalidDataException {

		log.info("ImportDao :createNewPFIDS() entering method");
		NomineeBean nomineeBean = new NomineeBean();
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement insst = null;
		PreparedStatement pst = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", sql = "", remarksinfo = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "", refPensionNo = "";
		int updateEmpinfoCount = 0, updateTransactionCount = 0, totalEmpInfoCount = 0, totalTransCount = 0, personalInsertCount = 0;
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			String srlno = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				st = conn.createStatement();
				insst = conn.createStatement();
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					srlno = tempInfo[0].trim();
				} else {
					srlno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setOldPensionNo(tempInfo[1].trim());
				} else {
					bean.setOldPensionNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}
				log.info(" dob " + bean.getDateOfBirth() + "doj "
						+ bean.getDateOfJoining());
				if (!tempInfo[8].equals("XXX")) {
					bean.setGender(tempInfo[8].trim());
				} else {
					bean.setGender("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setAirportCode(tempInfo[9].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setRegion(tempInfo[10].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setWetherOption(tempInfo[11].trim());
				} else {
					bean.setWetherOption("");
				}

				if (!tempInfo[12].equals("XXX")) {
					bean.setSeperationReason(tempInfo[12].trim());
				} else {
					bean.setSeperationReason("");
				}
				if (!tempInfo[13].equals("XXX")) {
					if (tempInfo[13].indexOf(".") != -1) {
						bean
								.setSeperationDate(commonUtil
										.converDBToAppFormat(tempInfo[13]
												.trim(), "dd.MM.yy",
												"dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setSeperationDate(commonUtil.converDBToAppFormat(
								tempInfo[13].trim(), "dd/MM/yyyy",
								"dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setSeperationDate(commonUtil.converDBToAppFormat(
								tempInfo[13].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setSeperationDate("");
					}

				} else {
					bean.setSeperationDate("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setForm2Nominee(tempInfo[14].trim());
				} else {
					bean.setForm2Nominee("");
				}

				if (!tempInfo[15].equals("XXX")) {
					bean.setEmpDesLevel(tempInfo[15].trim());
				} else {
					bean.setEmpDesLevel("");
				}

				if (!tempInfo[16].equals("XXX")) {
					bean.setFhName(tempInfo[16].trim());
				} else {
					bean.setFhName("");
				}
				if (!tempInfo[17].equals("XXX")) {
					bean.setMaritalStatus(tempInfo[17].trim());
				} else {
					bean.setMaritalStatus("");
				}

				if (!tempInfo[18].equals("XXX")) {
					bean.setPerAddress(tempInfo[18].trim());
				} else {
					bean.setPerAddress("");
				}

				if (!tempInfo[19].equals("XXX")) {
					bean.setTempAddress(tempInfo[19].trim());
				} else {
					bean.setTempAddress("");
				}
				if (!tempInfo[20].equals("XXX")) {
					bean.setDateOfAnnuation(tempInfo[20].trim());
				} else {
					bean.setDateOfAnnuation("");
				}

				if (!tempInfo[21].equals("XXX")) {
					bean.setDivision(tempInfo[21].trim());
				} else {
					bean.setDivision("");
				}

				if (!tempInfo[22].equals("XXX")) {
					bean.setDepartment(tempInfo[22].trim());
				} else {
					bean.setDepartment("");
				}

				if (!tempInfo[23].equals("XXX")) {
					bean.setEmailID(tempInfo[23].trim());
				} else {
					bean.setEmailID("");
				}
				if (!tempInfo[24].equals("XXX")) {
					bean.setEmpNomineeSharable(tempInfo[24].trim());
				} else {
					bean.setEmpNomineeSharable("");
				}
				if (!tempInfo[25].equals("XXX")) {
					bean.setRemarks(tempInfo[25].trim());
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[26].equals("XXX")) {
					bean.setFhFlag(tempInfo[26].trim());
				} else {
					bean.setFhFlag("");
				}
				if (!tempInfo[27].equals("XXX")) {
					bean.setMappingFlag(tempInfo[27].trim());
				} else {
					bean.setMappingFlag("");
				}
				log.info("Old Pension No" + bean.getOldPensionNo()
						+ "CPF ACCNO" + bean.getCpfAccno());
				log.info("Employee Name" + bean.getEmployeeName()
						+ "Date Of Birth" + bean.getDateOfBirth());
				log.info("DateOfAnnuation" + bean.getDateOfAnnuation()
						+ "Date Of Joining" + bean.getDateOfJoining());
				log.info("Employee No" + bean.getEmployeeNumber()
						+ "Designaiton" + bean.getDesignation() + "Emp Level"
						+ bean.getEmpDesLevel());
				log.info("getSeperationReason" + bean.getSeperationReason()
						+ "SeperationReasonDate" + bean.getSeperationDate()
						+ "Form-2 Nominee" + bean.getForm2Nominee());
				log.info("Remarks" + bean.getRemarks() + "Airportcode"
						+ bean.getAirportCode() + "Gender" + bean.getGender());
				log.info("FatherName" + bean.getFhName() + "Department"
						+ bean.getDepartment() + "MaritalStatus"
						+ bean.getMaritalStatus());

				String uniqueID = "", pensionNo = "";
				String updateEmpSerialNumber = "", updateTransaction = "";
				// creating new pfids
				try {
					pensionNo = PersonalDAO.getSequenceNo(conn);
					log.info("New Sequence ID" + pensionNo);
				} catch (Exception e1) {
					// TODO Auto-generated catch block
					log.printStackTrace(e1);
					throw e1;
				}
				log.info("Old Pension No" + bean.getOldPensionNo()
						+ "New pensionNo" + pensionNo);
				sql = "insert into employee_personal_info(CPFACNO,EMPLOYEENO, EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,"
						+ "GENDER,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,REGION,PENSIONNO,username,LASTACTIVE,RefMonthYear,FHFLAG,MAPINGFLAG,IPAddress)"
						+ " VALUES " + "('"
						+ bean.getCpfAccno().trim()
						+ "','"
						+ bean.getEmployeeNumber().trim()
						+ "','"
						+ bean.getEmployeeName().toUpperCase().trim()
						+ "','"
						+ bean.getDesignation().trim()
						+ "','"
						+ bean.getEmpDesLevel().trim()
						+ "','"
						+ bean.getDateOfBirth().trim()
						+ "','"
						+ bean.getDateOfJoining().trim()
						+ "','"
						+ bean.getSeperationReason().trim()
						+ "','"
						+ bean.getSeperationDate().trim()
						+ "','"
						+ bean.getForm2Nominee().trim()
						+ "','"
						+ bean.getRemarks().trim()
						+ "','"
						+ bean.getAirportCode().trim()
						+ "','"
						+ bean.getGender().trim()
						+ "','"
						+ bean.getFhName().trim()
						+ "','"
						+ bean.getMaritalStatus().trim()
						+ "','"
						+ bean.getPerAddress().trim()
						+ "','"
						+ bean.getTempAddress().trim()
						+ "','"
						+ bean.getWetherOption().trim()
						+ "','"
						+ bean.getDateOfAnnuation().trim()
						+ "','"
						+ bean.getDivision().trim()
						+ "','"
						+ bean.getDepartment().trim()
						+ "','"
						+ bean.getEmailID().trim()
						+ "','"
						+ bean.getEmpNomineeSharable().trim()
						+ "','"
						+ bean.getRegion().trim()
						+ "','"
						+ pensionNo
						+ "','"
						+ userName
						+ "','"
						+ commonUtil.getCurrentDate("dd-MMM-yyyy")
						+ "','"
						+ commonUtil.getCurrentDate("dd-MMM-yyyy")
						+ "','"
						+ bean.getFhFlag()
						+ "','"
						+ bean.getMappingFlag()
						+ "','" + ipAddress + "')";
				log.info("sql" + sql);

				personalInsertCount = insst.executeUpdate(sql);

				/*
				 * remarksinfo=pensionNo+"="+bean.getEmployeeName();
				 * 
				 * updateEmpSerialNumber =
				 * "update employee_info set EMPSERIALNUMBER='" + pensionNo
				 * +"',REMARKS=REMARKS ||'" +remarksinfo +
				 * "' where EMPSERIALNUMBER='" + bean.getOldPensionNo() + "'";
				 * updateTransaction =
				 * "update employee_pension_validate set pensionno='" +
				 * pensionNo + "' where pensionno='" + bean.getOldPensionNo()+
				 * "'";
				 * 
				 * sql="update employee_personal_info set CPFACNO='"+
				 * bean.getCpfAccno
				 * ().trim()+"',EMPLOYEENO='"+bean.getEmployeeNumber
				 * ().trim()+"', EMPLOYEENAME='"
				 * +bean.getEmployeeName().toUpperCase
				 * ().trim()+"',DESEGNATION='"
				 * +bean.getDesignation().trim()+"',EMP_LEVEL='"
				 * +bean.getEmpDesLevel
				 * ().trim()+"',DATEOFBIRTH='"+bean.getDateOfBirth
				 * ().trim()+"',DATEOFJOINING='"
				 * +bean.getDateOfJoining().trim()+"',DATEOFSEPERATION_REASON='"
				 * +
				 * bean.getSeperationReason().trim()+"',DATEOFSEPERATION_DATE='"
				 * +
				 * bean.getSeperationDate().trim()+"',WHETHER_FORM1_NOM_RECEIVED='"
				 * +
				 * bean.getForm2Nominee().trim()+"',REMARKS='"+bean.getRemarks()
				 * .trim()+"',AIRPORTCODE='"+bean.getAirportCode().trim()+
				 * "',GENDER='"
				 * +bean.getGender().trim()+"',FHNAME='"+bean.getFhName
				 * ().trim()+"',MARITALSTATUS='"+bean.getMaritalStatus().trim()+
				 * "',PERMANENTADDRESS='"
				 * +bean.getPerAddress().trim()+"',TEMPORATYADDRESS='"
				 * +bean.getTempAddress
				 * ().trim()+"',WETHEROPTION='"+bean.getWetherOption
				 * ().trim()+"',SETDATEOFANNUATION='"
				 * +bean.getDateOfAnnuation().trim
				 * ()+"',DIVISION='"+bean.getDivision
				 * ().trim()+"',DEPARTMENT='"+bean
				 * .getDepartment().trim()+"',EMAILID='"
				 * +bean.getEmailID().trim()
				 * +"',EMPNOMINEESHARABLE='"+bean.getEmpNomineeSharable
				 * ().trim()+
				 * "',REGION='"+bean.getRegion().trim()+"',PENSIONNO='"
				 * +srlno+"',username='"
				 * +userName+"',LASTACTIVE='"+commonUtil.getCurrentDate
				 * ("dd-MMM-yyyy"
				 * )+"',RefMonthYear='"+commonUtil.getCurrentDate("dd-MMM-yyyy"
				 * )+"',FHFLAG='"+bean.getFhFlag()+"',MAPINGFLAG='"+bean.
				 * getMappingFlag
				 * ()+"',IPAddress='"+ipAddress+"' where pensionno='"+srlno+"'";
				 * log.info(sql); personalInsertCount=insst.executeUpdate(sql);
				 * 
				 * remarksinfo=srlno+"="+bean.getEmployeeName();
				 * 
				 * updateEmpSerialNumber =
				 * "update employee_info set EMPSERIALNUMBER='" + srlno
				 * +"',REMARKS=REMARKS ||'" +remarksinfo +
				 * "' where EMPSERIALNUMBER='" + bean.getOldPensionNo() + "'";
				 * updateTransaction =
				 * "update employee_pension_validate set pensionno='" + srlno +
				 * "' where pensionno='" + bean.getOldPensionNo()+ "'";
				 */
				commonDB.closeConnection(null, insst, null);
				/*
				 * if(personalInsertCount!=0 &&
				 * !bean.getOldPensionNo().equals("")){ updateEmpinfoCount =
				 * st.executeUpdate(updateEmpSerialNumber);
				 * updateTransactionCount = st
				 * .executeUpdate(updateTransaction); }
				 * commonDB.closeConnection(null,st, null);
				 */
				totalEmpInfoCount = totalEmpInfoCount + updateEmpinfoCount;
				totalTransCount = totalTransCount + updateTransactionCount;

			}
			log.info(" updateTransactionCount" + totalTransCount
					+ "totalEmpInfoCount" + totalEmpInfoCount);
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :createNewPFIDS leaving method");

	}

	public void updateCPFAccnoMIAL(String xlsData, String region,
			String userName, String ipAddress) throws InvalidDataException {

		log.info("ImportDao :createNewPFIDS() entering method");
		NomineeBean nomineeBean = new NomineeBean();
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement insst = null;
		PreparedStatement pst = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", sql = "", remarksinfo = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "", refPensionNo = "";
		int updateEmpinfoCount = 0, updateTransactionCount = 0, totalEmpInfoCount = 0, totalTransCount = 0, personalInsertCount = 0;
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			String srlno = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				st = conn.createStatement();
				insst = conn.createStatement();
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					srlno = tempInfo[0].trim();
				} else {
					srlno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setOldPensionNo(tempInfo[1].trim());
				} else {
					bean.setOldPensionNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}
				log.info(" dob " + bean.getDateOfBirth() + "doj "
						+ bean.getDateOfJoining());

				if (!tempInfo[8].equals("XXX")) {
					bean.setRegion(tempInfo[8].trim());
				} else {
					bean.setRegion("");
				}

				/*
				 * if (!tempInfo[9].equals("XXX")) {
				 * bean.setAirportCode(tempInfo[9].trim()); } else {
				 * bean.setAirportCode(""); } if (!tempInfo[10].equals("XXX")) {
				 * bean.setRegion(tempInfo[10].trim()); } else {
				 * bean.setRegion(""); } if (!tempInfo[11].equals("XXX")) {
				 * bean.setWetherOption(tempInfo[11].trim()); } else {
				 * bean.setWetherOption(""); }
				 * 
				 * if (!tempInfo[12].equals("XXX")) {
				 * bean.setSeperationReason(tempInfo[12].trim()); } else {
				 * bean.setSeperationReason(""); } if
				 * (!tempInfo[13].equals("XXX")) {
				 * if(tempInfo[13].indexOf(".")!= -1){
				 * bean.setSeperationDate(commonUtil
				 * .converDBToAppFormat(tempInfo[13].trim(),"dd.MM.yy",
				 * "dd-MMM-yyyy")); }else if(tempInfo[7].indexOf("/")!= -1){
				 * bean
				 * .setSeperationDate(commonUtil.converDBToAppFormat(tempInfo
				 * [13].trim(),"dd/MM/yyyy", "dd-MMM-yyyy")); }else
				 * if(tempInfo[7].indexOf("-")!= -1){
				 * bean.setSeperationDate(commonUtil
				 * .converDBToAppFormat(tempInfo[13].trim(),"dd-MMM-yyyy",
				 * "dd-MMM-yyyy")); }else { bean.setSeperationDate(""); }
				 * 
				 * } else { bean.setSeperationDate(""); } if
				 * (!tempInfo[14].equals("XXX")) {
				 * bean.setForm2Nominee(tempInfo[14].trim()); } else {
				 * bean.setForm2Nominee(""); }
				 * 
				 * if (!tempInfo[15].equals("XXX")) {
				 * bean.setEmpDesLevel(tempInfo[15].trim()); } else {
				 * bean.setEmpDesLevel(""); }
				 * 
				 * if (!tempInfo[16].equals("XXX")) {
				 * bean.setFhName(tempInfo[16].trim()); } else {
				 * bean.setFhName(""); } if (!tempInfo[17].equals("XXX")) {
				 * bean.setMaritalStatus(tempInfo[17].trim()); } else {
				 * bean.setMaritalStatus(""); }
				 * 
				 * if (!tempInfo[18].equals("XXX")) {
				 * bean.setPerAddress(tempInfo[18].trim()); } else {
				 * bean.setPerAddress(""); }
				 * 
				 * if (!tempInfo[19].equals("XXX")) {
				 * bean.setTempAddress(tempInfo[19].trim()); } else {
				 * bean.setTempAddress(""); } if (!tempInfo[20].equals("XXX")) {
				 * bean.setDateOfAnnuation(tempInfo[20].trim()); } else {
				 * bean.setDateOfAnnuation(""); }
				 * 
				 * if (!tempInfo[21].equals("XXX")) {
				 * bean.setDivision(tempInfo[21].trim()); } else {
				 * bean.setDivision(""); }
				 * 
				 * if (!tempInfo[22].equals("XXX")) {
				 * bean.setDepartment(tempInfo[22].trim()); } else {
				 * bean.setDepartment(""); }
				 * 
				 * if (!tempInfo[23].equals("XXX")) {
				 * bean.setEmailID(tempInfo[23].trim()); } else {
				 * bean.setEmailID(""); } if (!tempInfo[24].equals("XXX")) {
				 * bean.setEmpNomineeSharable(tempInfo[24].trim()); } else {
				 * bean.setEmpNomineeSharable(""); } if
				 * (!tempInfo[25].equals("XXX")) {
				 * bean.setRemarks(tempInfo[25].trim()); } else {
				 * bean.setRemarks(""); } if (!tempInfo[26].equals("XXX")) {
				 * bean.setFhFlag(tempInfo[26].trim()); } else {
				 * bean.setFhFlag(""); } if (!tempInfo[27].equals("XXX")) {
				 * bean.setMappingFlag(tempInfo[27].trim()); } else {
				 * bean.setMappingFlag(""); }
				 */
				log.info("Old Pension No" + bean.getOldPensionNo()
						+ "CPF ACCNO" + bean.getCpfAccno());
				log.info("Employee Name" + bean.getEmployeeName()
						+ "Date Of Birth" + bean.getDateOfBirth());
				log.info("DateOfAnnuation" + bean.getDateOfAnnuation()
						+ "Date Of Joining" + bean.getDateOfJoining());
				log.info("Employee No" + bean.getEmployeeNumber()
						+ "Designaiton" + bean.getDesignation() + "Emp Level"
						+ bean.getEmpDesLevel());
				log.info("getSeperationReason" + bean.getSeperationReason()
						+ "SeperationReasonDate" + bean.getSeperationDate()
						+ "Form-2 Nominee" + bean.getForm2Nominee());
				log.info("Remarks" + bean.getRemarks() + "Airportcode"
						+ bean.getAirportCode() + "Gender" + bean.getGender());
				log.info("FatherName" + bean.getFhName() + "Department"
						+ bean.getDepartment() + "MaritalStatus"
						+ bean.getMaritalStatus());

				String uniqueID = "", pensionNo = "";
				String updateEmpSerialNumber = "", updateTransaction = "";

				sql = "update employee_personal_info set CPFACNO='"
						+ bean.getCpfAccno().trim() + "' where pensionno='"
						+ bean.getOldPensionNo() + "'";
				log.info(sql);
				personalInsertCount = insst.executeUpdate(sql);

				updateEmpSerialNumber = "update employee_info set EMPSERIALNUMBER='"
						+ bean.getOldPensionNo()
						+ "' where cpfacno='"
						+ bean.getCpfAccno()
						+ "' and region='"
						+ bean.getRegion() + "'";
				updateTransaction = "update employee_pension_validate set pensionno='"
						+ bean.getOldPensionNo()
						+ "' where cpfaccno='"
						+ bean.getCpfAccno()
						+ "' and region='"
						+ bean.getRegion() + "'";

				commonDB.closeConnection(null, insst, null);
				if (personalInsertCount != 0
						&& !bean.getOldPensionNo().equals("")) {
					updateEmpinfoCount = st
							.executeUpdate(updateEmpSerialNumber);
					updateTransactionCount = st
							.executeUpdate(updateTransaction);
				}
				commonDB.closeConnection(null, st, null);
				totalEmpInfoCount = totalEmpInfoCount + updateEmpinfoCount;
				totalTransCount = totalTransCount + updateTransactionCount;

			}
			log.info(" updateTransactionCount" + totalTransCount
					+ "totalEmpInfoCount" + totalEmpInfoCount);
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :createNewPFIDS leaving method");

	}

	public void importIgiIad0809Data(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importIgiIad0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			int count = 0;
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.00");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), "CHQIAD");

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, "IGI IAD");
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, "CHQIAD".trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					log.info("vpf" + bean.getEmployeeVPF() + "Principal"
							+ bean.getPrincipal() + "Interest"
							+ bean.getInterest());
					pst.executeUpdate();
					pst.close();
				} else {
					float emoluments = 0.0f;
					if (bean.getEmployeePF().trim() != ""
							|| (!bean.getEmployeePF().trim().equals(""))) {
						emoluments = Float.parseFloat(bean.getEmployeePF()
								.trim()) * 100 / 12;
					}

					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					if (!bean.getEmoluments().equals("0.00")
							&& !bean.getEmoluments().equals("0.0")
							&& !bean.getEmoluments().equals("0")
							&& !bean.getEmoluments().equals("")) {
						insertArrearCount = "update employee_pension_validate set EMOLUMENTS=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					} else {
						insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		}
		log.info("ImportDao :IGI IAD leaving method");

	}

	public void importChennaiIad0809Data(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importIgiIad0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			int count = 0;
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					monthYear = tempInfo[4].trim();
				} else {
					monthYear = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.00");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.00");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.00");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setRegion(tempInfo[15].trim());
				} else {
					bean.setRegion("");
				}

				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?)";
				String foundSalaryDate = this.checkFinanceDuplicate(conn,
						monthYear.trim(), bean.getCpfAcNo(), bean
								.getEmpNumber(), bean.getRegion());

				if (foundSalaryDate.equals("")) {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, monthYear.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());

					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					log.info("vpf" + bean.getEmployeeVPF() + "Principal"
							+ bean.getPrincipal() + "Interest"
							+ bean.getInterest());
					pst.executeUpdate();
					pst.close();
				} else {
					float emoluments = 0.0f;
					if (bean.getEmployeePF().trim() != ""
							|| (!bean.getEmployeePF().trim().equals(""))) {
						emoluments = Float.parseFloat(bean.getEmployeePF()
								.trim()) * 100 / 12;
					}

					st = conn.createStatement();
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					if (!bean.getEmoluments().equals("0.00")
							&& !bean.getEmoluments().equals("0.0")
							&& !bean.getEmoluments().equals("0")
							&& !bean.getEmoluments().equals("")) {
						insertArrearCount = "update employee_pension_validate set EMOLUMENTS=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					} else {

						insertArrearCount = "update employee_pension_validate set EMOLUMENTS=to_char(TO_NUMBER(nvl(emoluments,0)+'"
								+ emoluments
								+ "')) ,  EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
								+ bean.getEmployeePF().trim()
								+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
								+ bean.getEmployeeVPF().trim()
								+ "')),EMPADVRECINTEREST =to_char(TO_NUMBER(nvl(EMPADVRECINTEREST ,0)+'"
								+ bean.getInterest().trim()
								+ "')),EMPADVRECPRINCIPAL =to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL ,0)+'"
								+ bean.getPrincipal().trim()
								+ "'))  where region='CHQIAD' and cpfaccno='"
								+ bean.getCpfAcNo().trim()
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear + "'";

					}
					log.info("update emolumentss " + insertArrearCount);
					count = st.executeUpdate(insertArrearCount);
					st.close();
				}
			}

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		}
		log.info("ImportDao :Chennai IAD leaving method");

	}

	public void deleteRetiredEmployees(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :deleteRetiredEmployees() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		int count = 0;
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				// log.info("hedername" + tempInfo[1].trim());
				/*
				 * if (!tempInfo[1].equals("XXX")) {
				 * bean.setCpfAcNo(tempInfo[1].trim()); } else {
				 * bean.setCpfAcNo(""); }
				 */
				if (!tempInfo[2].equals("XXX")) {
					bean.setPensionNumber(tempInfo[2].trim());
				} else {
					bean.setPensionNumber("");
				}
				String monthYear = "";
				if (!tempInfo[3].equals("XXX")) {
					monthYear = tempInfo[3].trim();
				} else {
					monthYear = "";
				}
				/*
				 * if (!tempInfo[4].equals("XXX")) {
				 * bean.setStation(tempInfo[4].trim()); } else {
				 * bean.setStation(""); }
				 */
				// String transMonthYear =
				// commonUtil.converDBToAppFormat(monthYear, "dd-MMM-yyyy",
				// "-MMM-yyyy");
				String deleteTransaction = "";
				if (bean.getPensionNumber() != "") {
					deleteTransaction = "delete from employee_personal_info where PENSIONNO='"
							+ bean.getPensionNumber()
							+ "' and to_char(DATEOFBIRTH,'dd-Mon-yyyy') like '%"
							+ monthYear + "'";
					log.info(deleteTransaction);

				}

				count = st.executeUpdate(deleteTransaction);
				count = count++;
				log.info("deleteedrecords" + count);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :deleteRetiredEmployees leaving method");

	}

	public void importPensionOptUpdate(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importPensionOptUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.info("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPensionNo(commonUtil.getSearchPFID1(tempInfo[1]
							.trim()));
				} else {
					bean.setPensionNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}

				if (!tempInfo[8].equals("XXX")) {
					bean.setFhName(tempInfo[8].trim());
				} else {
					bean.setFhName("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setWetherOption(tempInfo[9].trim());
				} else {
					bean.setWetherOption("");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setAirportCode(tempInfo[10].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setRegion(tempInfo[11].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setRemarks(tempInfo[12].trim());
				} else {
					bean.setRemarks("");
				}

				if (!(bean.getRemarks().equals("O") || bean.getRemarks()
						.equals("E"))) {
					bean.setWetherOption(bean.getRemarks());
				}
				log.info("CPFACCNO :" + bean.getCpfAccno() + " Pensionno :"
						+ bean.getPensionNo() + "wether option:"
						+ bean.getWetherOption());

				String sql3 = "";
				if (bean.getWetherOption() != "") {
					sql3 = "update employee_personal_info set WETHEROPTION='"
							+ bean.getWetherOption().trim()
							+ "' where pensionno='" + bean.getPensionNo() + "'";
					log.info("importPensionOptUpdate" + sql3);
					st.execute(sql3);
				}
				// st.execute(sql3);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importPensionOptUpdate leaving method");

	}

	public void importCPFACCNOUpdate(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :importCPFACCNOUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.info("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPensionNo(commonUtil.getSearchPFID1(tempInfo[1]
							.trim()));
				} else {
					bean.setPensionNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}

				if (!tempInfo[8].equals("XXX")) {
					bean.setFhName(tempInfo[8].trim());
				} else {
					bean.setFhName("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setWetherOption(tempInfo[9].trim());
				} else {
					bean.setWetherOption("");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setAirportCode(tempInfo[10].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setRegion(tempInfo[11].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setRemarks(tempInfo[12].trim());
				} else {
					bean.setRemarks("");
				}

				if (!(bean.getRemarks().equals("O") || bean.getRemarks()
						.equals("E"))) {
					bean.setWetherOption(bean.getRemarks());
				}
				log.info("CPFACCNO :" + bean.getCpfAccno() + " Pensionno :"
						+ bean.getPensionNo() + "wether option:"
						+ bean.getWetherOption());

				String sql3 = "";
				if (bean.getWetherOption() != "") {
					sql3 = "update employee_personal_info set cpfacno='"
							+ bean.getCpfAccno().trim() + "' where pensionno='"
							+ bean.getPensionNo() + "'";
					log.info("importPensionOptUpdate" + sql3);
					st.execute(sql3);
				}
				// st.execute(sql3);
			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :importCPFACCNOUpdate leaving method");

	}

	public void UpdateOtherCPFACCNOFields(String xlsData)
			throws InvalidDataException {

		log.info("ImportDao :UpdateOtherCPFACCNOFields() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.info("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPensionNo(commonUtil.getSearchPFID1(tempInfo[1]
							.trim()));
				} else {
					bean.setPensionNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}

				if (!tempInfo[8].equals("XXX")) {
					bean.setFhName(tempInfo[8].trim());
				} else {
					bean.setFhName("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setWetherOption(tempInfo[9].trim());
				} else {
					bean.setWetherOption("");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setAirportCode(tempInfo[10].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setRegion(tempInfo[11].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setRemarks(tempInfo[12].trim());
				} else {
					bean.setRemarks("");
				}

				if (!(bean.getRemarks().equals("O") || bean.getRemarks()
						.equals("E"))) {
					bean.setWetherOption(bean.getRemarks());
				}
				log.info("CPFACCNO :" + bean.getCpfAccno() + " Pensionno :"
						+ bean.getPensionNo() + "wether option:"
						+ bean.getWetherOption());

				String sql3 = "";
				sql3 = "update employee_personal_info set EMPLOYEENAME='"
						+ bean.getEmployeeName().trim() + "',FHNAME='"
						+ bean.getFhName().trim() + "',DATEOFBIRTH='"
						+ bean.getDateOfBirth().trim() + "',DATEOFJOINING='"
						+ bean.getDateOfJoining().trim() + "',DESEGNATION='"
						+ bean.getDesignation().trim() + "',EMPLOYEENO='"
						+ bean.getEmployeeNumber().trim()
						+ "' where pensionno='" + bean.getPensionNo() + "'";
				log.info("UpdateOtherCPFACCNOFields" + sql3);
				st.execute(sql3);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :UpdateOtherCPFACCNOFields leaving method");

	}

	public void autoMapping0809Data(String xlsData, String userName,
			String ipaddress) {

		log.info("ImportDao :autoMapping0809Data() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement transSt = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		ArrayList fnlDataList = new ArrayList();
		FileWriter fw = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", empDbName = "", dateofbirth = "", transQuery = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		String sqlSelQuery = "", insertQry = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			transSt = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("tempinfo  " + tempInfo[1].trim());
				if (!tempInfo[2].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[2].trim()));

				} else {
					bean.setPfid("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setRegion(tempInfo[4].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[0].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[0].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setEmpNumber(tempInfo[1].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpName(tempInfo[3].trim());
				} else {
					bean.setEmpName("");
				}
				String lastactive = commonUtil.getCurrentDate("dd-MMM-yyyy");
				log.info("PFID " + bean.getPfid() + "CPFACCNO"
						+ bean.getCpfAcNo() + "region ==" + bean.getRegion()
						+ "employeename" + bean.getEmpName());
				if (bean.getPfid() != "") {
					sqlSelQuery = "select to_char(PENSIONNO),AIRPORTSERIALNUMBER,'"
							+ bean.getEmpNumber()
							+ "', EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,"
							+ "WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,GENDER,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,EMPFLAG,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,'"
							+ bean.getRegion()
							+ "','"
							+ userName
							+ "','"
							+ bean.getCpfAcNo()
							+ "','"
							+ lastactive
							+ "'"
							+ " FROM employee_personal_info WHERE PENSIONNO="
							+ bean.getPfid();

					if (this.chkEmployeeInfoTbl(conn, bean.getEmpNumber(), bean
							.getCpfAcNo(), bean.getRegion()) == true) {
						insertQry = "UPDATE EMPLOYEE_INFO SET EMPSERIALNUMBER='"
								+ bean.getPfid()
								+ "',dateofbirth= (select dateofbirth from employee_personal_info where pensionno ="
								+ bean.getPfid()
								+ " ),dateofjoining= (select dateofjoining from employee_personal_info where pensionno ="
								+ bean.getPfid()
								+ " ),USERNAME='"
								+ userName
								+ "',lastactive='"
								+ lastactive
								+ "' WHERE cpfacno='"
								+ bean.getCpfAcNo()
								+ "' and region='" + bean.getRegion() + "'";
					} else {
						insertQry = "insert into employee_info(EMPSERIALNUMBER,AIRPORTSERIALNUMBER,EMPLOYEENO, EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,"
								+ "sex,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,EMPFLAG,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,REGION,USERNAME,cpfacno,lastactive)  "
								+ sqlSelQuery;
					}
					transQuery = "UPDATE EMPLOYEE_PENSION_VALIDATE SET PENSIONNO="
							+ bean.getPfid()
							+ " WHERE CPFACCNO='"
							+ bean.getCpfAcNo()
							+ "' AND REGION='"
							+ bean.getRegion() + "'";

					log.info("insert query " + insertQry);
					log.info("insert query " + transQuery);
				}
				st.executeUpdate(insertQry);
				transSt.executeUpdate(transQuery);
				bean.setPfid("");
			}

		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(null, transSt, null);
			commonDB.closeConnection(conn, st, rs);
		}

		log.info("ImportDao :North0809AutoMapping leaving method");

	}

	private boolean chkEmployeeInfoTbl(Connection con, String empCode,
			String cpfaccno, String region) {
		log.info("ImportDAO :chkEmployeeInfoTbl() entering method ");
		String foundEmpFlag = "", query = "";
		Statement st = null;
		ResultSet rs = null;
		boolean chkTblFlag = false;
		int count = 0;
		query = "SELECT COUNT(*) as COUNT FROM EMPLOYEE_INFO WHERE empflag='Y' and cpfacno='"
				+ cpfaccno + "' and region='" + region + "'";
		log.info("query is " + query);
		try {

			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				count = rs.getInt("COUNT");
				if (count == 0) {
					chkTblFlag = false;
				} else {
					chkTblFlag = true;
				}

			} else {
				chkTblFlag = false;
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(null, st, rs);
		}
		log.info("FinanceDAO :checkEmployeeInfo() leaving method"
				+ foundEmpFlag);
		return chkTblFlag;
	}

	public void insertNomineeDtls(String xlsData) throws InvalidDataException {

		log.info("ImportDao :insertNomineeDtls() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.info("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				String nomineeName = "", nomineedob = "", nomineeaddress = "", nomineerelation = "", nameofguardian = "";
				String gaurdianaddress = "", region = "", empflag = "", pensionno = "", srno = "", cpfaccno = "";
				if (!tempInfo[0].equals("XXX")) {
					cpfaccno = tempInfo[0].trim();
				}
				if (!tempInfo[1].equals("XXX")) {
					srno = tempInfo[1].trim();
				}

				if (!tempInfo[2].equals("XXX")) {
					nomineeName = tempInfo[2].trim();
				}
				if (!tempInfo[3].equals("XXX")) {
					nomineedob = tempInfo[3].trim();
				}
				if (!tempInfo[4].equals("XXX")) {
					nomineeaddress = tempInfo[4].trim();
				}
				if (!tempInfo[5].equals("XXX")) {
					nomineerelation = tempInfo[5].trim();
				}
				if (!tempInfo[6].equals("XXX")) {
					nameofguardian = tempInfo[6].trim();
				}
				if (!tempInfo[7].equals("XXX")) {
					gaurdianaddress = tempInfo[7].trim();
				}
				if (!tempInfo[9].equals("XXX")) {
					region = tempInfo[9].trim();
				}
				if (!tempInfo[10].equals("XXX")) {
					empflag = tempInfo[10].trim();
				}
				if (!tempInfo[11].equals("XXX")) {
					pensionno = tempInfo[11].trim();
				}

				String sql3 = "";
				sql3 = "insert into employee_nominee_dtls (cpfaccno,srno,NOMINEENAME,NOMINEEDOB,NOMINEEADDRESS,NOMINEERELATION,NAMEOFGUARDIAN,REGION,PENSIONNO )"
						+ "	 values('"
						+ cpfaccno
						+ "','"
						+ srno
						+ "','"
						+ nomineeName
						+ "','"
						+ nomineedob
						+ "','"
						+ nomineeaddress
						+ "','"
						+ nomineerelation
						+ "','"
						+ nameofguardian
						+ "','"
						+ region
						+ "','"
						+ pensionno
						+ "')";
				log.info("insert nominee dtls " + sql3);
				st.execute(sql3);

			}
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :UpdateOtherCPFACCNOFields leaving method");

	}

	public void createEmpUtilzeOldPfid(String xlsData, String region,
			String userName, String ipAddress) throws InvalidDataException {

		log.info("ImportDao :createEmpUtilzeOldPfid() entering method");
		NomineeBean nomineeBean = new NomineeBean();
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement insst = null;
		PreparedStatement pst = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", sql = "", remarksinfo = "", advTransDate = "", empShare = "", aaiShare = "", advPurpose = "", refPensionNo = "";
		int updateEmpinfoCount = 0, updateTransactionCount = 0, totalEmpInfoCount = 0, totalTransCount = 0, personalInsertCount = 0;
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			String srlno = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				st = conn.createStatement();
				insst = conn.createStatement();
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					srlno = tempInfo[0].trim();
				} else {
					srlno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setOldPensionNo(tempInfo[1].trim());
				} else {
					bean.setOldPensionNo("");
				}
				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAccno(tempInfo[2].trim());
				} else {
					bean.setCpfAccno("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmployeeNumber(tempInfo[3].trim());
				} else {
					bean.setEmployeeNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					xlsEmpName = StringUtility.replaces(
							tempInfo[4].trim().toCharArray(), delimiters, "")
							.toString();
					bean.setEmployeeName(xlsEmpName.trim());
				} else {
					bean.setEmployeeName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesignation(tempInfo[5].trim());
				} else {
					bean.setDesignation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					if (tempInfo[6].indexOf(".") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("/") != -1) {
						bean.setDateOfBirth(commonUtil
								.converDBToAppFormat(tempInfo[6].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[6].indexOf("-") != -1) {
						bean.setDateOfBirth(commonUtil.converDBToAppFormat(
								tempInfo[6].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfBirth("");
					}
				} else {
					bean.setDateOfBirth("");
				}
				if (!tempInfo[7].equals("XXX")) {
					if (tempInfo[7].indexOf(".") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd.MM.yy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setDateOfJoining(commonUtil
								.converDBToAppFormat(tempInfo[7].trim(),
										"dd/MM/yyyy", "dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setDateOfJoining(commonUtil.converDBToAppFormat(
								tempInfo[7].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setDateOfJoining("");
					}
				} else {
					bean.setDateOfJoining("");
				}
				log.info(" dob " + bean.getDateOfBirth() + "doj "
						+ bean.getDateOfJoining());
				if (!tempInfo[8].equals("XXX")) {
					bean.setGender(tempInfo[8].trim());
				} else {
					bean.setGender("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setAirportCode(tempInfo[9].trim());
				} else {
					bean.setAirportCode("");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setRegion(tempInfo[10].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[11].equals("XXX")) {
					bean.setWetherOption(tempInfo[11].trim());
				} else {
					bean.setWetherOption("");
				}

				if (!tempInfo[12].equals("XXX")) {
					bean.setSeperationReason(tempInfo[12].trim());
				} else {
					bean.setSeperationReason("");
				}
				if (!tempInfo[13].equals("XXX")) {
					if (tempInfo[13].indexOf(".") != -1) {
						bean
								.setSeperationDate(commonUtil
										.converDBToAppFormat(tempInfo[13]
												.trim(), "dd.MM.yy",
												"dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("/") != -1) {
						bean.setSeperationDate(commonUtil.converDBToAppFormat(
								tempInfo[13].trim(), "dd/MM/yyyy",
								"dd-MMM-yyyy"));
					} else if (tempInfo[7].indexOf("-") != -1) {
						bean.setSeperationDate(commonUtil.converDBToAppFormat(
								tempInfo[13].trim(), "dd-MMM-yyyy",
								"dd-MMM-yyyy"));
					} else {
						bean.setSeperationDate("");
					}

				} else {
					bean.setSeperationDate("");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setForm2Nominee(tempInfo[14].trim());
				} else {
					bean.setForm2Nominee("");
				}

				if (!tempInfo[15].equals("XXX")) {
					bean.setEmpDesLevel(tempInfo[15].trim());
				} else {
					bean.setEmpDesLevel("");
				}

				if (!tempInfo[16].equals("XXX")) {
					bean.setFhName(tempInfo[16].trim());
				} else {
					bean.setFhName("");
				}
				if (!tempInfo[17].equals("XXX")) {
					bean.setMaritalStatus(tempInfo[17].trim());
				} else {
					bean.setMaritalStatus("");
				}

				if (!tempInfo[18].equals("XXX")) {
					bean.setPerAddress(tempInfo[18].trim());
				} else {
					bean.setPerAddress("");
				}

				if (!tempInfo[19].equals("XXX")) {
					bean.setTempAddress(tempInfo[19].trim());
				} else {
					bean.setTempAddress("");
				}
				if (!tempInfo[20].equals("XXX")) {
					bean.setDateOfAnnuation(tempInfo[20].trim());
				} else {
					bean.setDateOfAnnuation("");
				}

				if (!tempInfo[21].equals("XXX")) {
					bean.setDivision(tempInfo[21].trim());
				} else {
					bean.setDivision("");
				}

				if (!tempInfo[22].equals("XXX")) {
					bean.setDepartment(tempInfo[22].trim());
				} else {
					bean.setDepartment("");
				}

				if (!tempInfo[23].equals("XXX")) {
					bean.setEmailID(tempInfo[23].trim());
				} else {
					bean.setEmailID("");
				}
				if (!tempInfo[24].equals("XXX")) {
					bean.setEmpNomineeSharable(tempInfo[24].trim());
				} else {
					bean.setEmpNomineeSharable("");
				}
				if (!tempInfo[25].equals("XXX")) {
					bean.setRemarks(tempInfo[25].trim());
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[26].equals("XXX")) {
					bean.setFhFlag(tempInfo[26].trim());
				} else {
					bean.setFhFlag("");
				}
				if (!tempInfo[27].equals("XXX")) {
					bean.setMappingFlag(tempInfo[27].trim());
				} else {
					bean.setMappingFlag("");
				}
				log.info("Old Pension No" + bean.getOldPensionNo()
						+ "CPF ACCNO" + bean.getCpfAccno());
				log.info("Employee Name" + bean.getEmployeeName()
						+ "Date Of Birth" + bean.getDateOfBirth());
				log.info("DateOfAnnuation" + bean.getDateOfAnnuation()
						+ "Date Of Joining" + bean.getDateOfJoining());
				log.info("Employee No" + bean.getEmployeeNumber()
						+ "Designaiton" + bean.getDesignation() + "Emp Level"
						+ bean.getEmpDesLevel());
				log.info("getSeperationReason" + bean.getSeperationReason()
						+ "SeperationReasonDate" + bean.getSeperationDate()
						+ "Form-2 Nominee" + bean.getForm2Nominee());
				log.info("Remarks" + bean.getRemarks() + "Airportcode"
						+ bean.getAirportCode() + "Gender" + bean.getGender());
				log.info("FatherName" + bean.getFhName() + "Department"
						+ bean.getDepartment() + "MaritalStatus"
						+ bean.getMaritalStatus());

				String uniqueID = "", pensionNo = "";
				String updateEmpSerialNumber = "", updateTransaction = "";

				log.info("Old Pension No" + bean.getOldPensionNo());
				sql = "insert into employee_personal_info(CPFACNO,EMPLOYEENO, EMPLOYEENAME,DESEGNATION,EMP_LEVEL,DATEOFBIRTH,DATEOFJOINING,DATEOFSEPERATION_REASON,DATEOFSEPERATION_DATE,WHETHER_FORM1_NOM_RECEIVED,REMARKS,AIRPORTCODE,"
						+ "GENDER,FHNAME,MARITALSTATUS,PERMANENTADDRESS,TEMPORATYADDRESS,WETHEROPTION,SETDATEOFANNUATION,DIVISION,DEPARTMENT,EMAILID,EMPNOMINEESHARABLE,REGION,PENSIONNO,username,LASTACTIVE,RefMonthYear,FHFLAG,MAPINGFLAG,IPAddress)"
						+ " VALUES " + "('"
						+ bean.getCpfAccno().trim()
						+ "','"
						+ bean.getEmployeeNumber().trim()
						+ "','"
						+ bean.getEmployeeName().toUpperCase().trim()
						+ "','"
						+ bean.getDesignation().trim()
						+ "','"
						+ bean.getEmpDesLevel().trim()
						+ "','"
						+ bean.getDateOfBirth().trim()
						+ "','"
						+ bean.getDateOfJoining().trim()
						+ "','"
						+ bean.getSeperationReason().trim()
						+ "','"
						+ bean.getSeperationDate().trim()
						+ "','"
						+ bean.getForm2Nominee().trim()
						+ "','"
						+ bean.getRemarks().trim()
						+ "','"
						+ bean.getAirportCode().trim()
						+ "','"
						+ bean.getGender().trim()
						+ "','"
						+ bean.getFhName().trim()
						+ "','"
						+ bean.getMaritalStatus().trim()
						+ "','"
						+ bean.getPerAddress().trim()
						+ "','"
						+ bean.getTempAddress().trim()
						+ "','"
						+ bean.getWetherOption().trim()
						+ "','"
						+ bean.getDateOfAnnuation().trim()
						+ "','"
						+ bean.getDivision().trim()
						+ "','"
						+ bean.getDepartment().trim()
						+ "','"
						+ bean.getEmailID().trim()
						+ "','"
						+ bean.getEmpNomineeSharable().trim()
						+ "','"
						+ bean.getRegion().trim()
						+ "','"
						+ bean.getOldPensionNo()
						+ "','"
						+ userName
						+ "','"
						+ commonUtil.getCurrentDate("dd-MMM-yyyy")
						+ "','"
						+ commonUtil.getCurrentDate("dd-MMM-yyyy")
						+ "','"
						+ bean.getFhFlag()
						+ "','"
						+ bean.getMappingFlag()
						+ "','" + ipAddress + "')";
				log.info("sql" + sql);

				personalInsertCount = insst.executeUpdate(sql);

				commonDB.closeConnection(null, insst, null);
				/*
				 * if(personalInsertCount!=0 &&
				 * !bean.getOldPensionNo().equals("")){ updateEmpinfoCount =
				 * st.executeUpdate(updateEmpSerialNumber);
				 * updateTransactionCount = st
				 * .executeUpdate(updateTransaction); }
				 * commonDB.closeConnection(null,st, null);
				 */
				totalEmpInfoCount = totalEmpInfoCount + updateEmpinfoCount;
				totalTransCount = totalTransCount + updateTransactionCount;

			}
			log.info(" updateTransactionCount" + totalTransCount
					+ "totalEmpInfoCount" + totalEmpInfoCount);
		} catch (Exception e) {
			log.printStackTrace(e);
		}

		log.info("ImportDao :createNewPFIDS leaving method");

	}

	public void readXLSFinalSettlement(String xlsData)
			throws InvalidDataException {
		log.info("ImportDao :readXLSFinalSettlement() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		EmployeePersonalInfo bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmployeePersonalInfo();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");

				String region = "", pensionno = "", cpfaccno = "", employeeno = "", employeename = "", purpose = "", settlementdate = "", remarks = "", airportcode = "";
				double finemp = 0.00, finaai = 0.00, pencon = 0.00, netamount = 0.00;
				if (!tempInfo[1].equals("XXX")) {
					pensionno = commonUtil.getSearchPFID1(tempInfo[1].trim());
				}
				if (!tempInfo[3].equals("XXX")) {
					cpfaccno = tempInfo[3].trim();
				}
				if (!tempInfo[4].equals("XXX")) {
					employeeno = tempInfo[4].trim();
				}
				if (!tempInfo[5].equals("XXX")) {
					employeename = tempInfo[5].trim();
				}
				if (!tempInfo[8].equals("XXX")) {
					purpose = tempInfo[8].trim();
				}
				if (!tempInfo[9].equals("XXX")) {
					finemp = Double.parseDouble(tempInfo[9].trim());
				}
				if (!tempInfo[10].equals("XXX")) {
					finaai = Double.parseDouble(tempInfo[10].trim());
				}
				if (!tempInfo[11].equals("XXX")) {
					pencon = Double.parseDouble(tempInfo[11].trim());
				}
				if (!tempInfo[12].equals("XXX")) {
					netamount = Double.parseDouble(tempInfo[12].trim());
				}

				if (!tempInfo[13].equals("XXX")) {
					settlementdate = tempInfo[13].trim();
				}

				if (!tempInfo[15].equals("XXX")) {
					airportcode = tempInfo[15].trim();
				}
				log.info(airportcode);
				if (!tempInfo[16].equals("XXX")) {
					region = tempInfo[16].trim();
				}
				String query = "";
				query = "insert into employee_pension_finsettlement(cpfaccno,employeeno,employeename,pensionno,purpose,finemp,finaai,pencon,netamount,settlementdate,airportcode,region)values('"
						+ cpfaccno
						+ "','"
						+ employeeno
						+ "','"
						+ employeename
						+ "','"
						+ pensionno
						+ "','"
						+ purpose
						+ "',"
						+ finemp
						+ ","
						+ finaai
						+ ","
						+ pencon
						+ ","
						+ netamount
						+ ",'"
						+ settlementdate
						+ "','"
						+ airportcode
						+ "','"
						+ region
						+ "')";

				log.info("query " + query);
				st.execute(query);

			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(conn, st, null);
		}

		log.info("ImportDao :readXLSFinalSettlement leaving method");

	}

	public String getEmoluments(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region, String Pfid) {

		String foundEmpFlag = "";
		Statement st = null;

		ResultSet rs = null;
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "select emoluments as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear
					+ "' and pensionno='"
					+ Pfid
					+ "'  and region='" + region + "' and empflag='Y' ";
			// and empflag='N' and UPDATEDDATE='3-Mar-2011';
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public void pentionContributionProcess(String xlsData, String region,
			String userName, String ipAddress, String fileName1, String year,
			String month) {

		log.info("ImportDao :pentionContributionProcess() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs2 = null;
		String foundSalaryDate = "", retirementDate = "", emppfstatuary = "0.00";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				double calculatedPension = 0.00, pf = 0.00;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				bean.setRegion(region);

				if (!tempInfo[0].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[0].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[1].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[1].trim());
				} else {
					bean.setCpfAcNo("");
				}

				if (!tempInfo[2].equals("XXX")) {
					bean.setEmpName(tempInfo[2].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[3].equals("XXX")) {
					monthYear = tempInfo[3].trim();
				} else {
					monthYear = "";
				}

				if (!tempInfo[5].equals("XXX")) {
					bean.setEmployeePF(tempInfo[5].trim());
				} else {
					bean.setEmployeePF("0.00");
				}

				String transMonthYear = "";

				if (!bean.getPfid().trim().equals("")) {

					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date(to_char(add_months(TO_DATE('"
							+ monthYear
							+ "'), -1),'dd-Mon-yyyy'),'DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs.getString("calPensionupto") != null) {
						calPensionupto = rs.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					transMonthYear = commonUtil.converDBToAppFormat(
							calPensionupto.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					/*
					 * String emolumentsQuery =
					 * "select emppfstatuary from employee_pension_validate where pensionno='"
					 * + bean.getPfid() +
					 * "' and to_char(monthyear,'dd-Mon-yyyy') like '%" +
					 * monthYear.trim() + "'"; log.info(emolumentsQuery); rs2 =
					 * st1.executeQuery(emolumentsQuery); if (rs2.next()) { if
					 * (rs2.getString("emppfstatuary") != null) {
					 * bean.setEmployeePF(rs2.getString("emppfstatuary")); } }
					 * else { bean.setEmployeePF("0.00"); }
					 */
					Date transdate = null;
					DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
					transdate = df.parse(monthYear);
					float cpfarrear = 0;
					if (transdate.after(new Date("31-Mar-1998"))) {
						bean.setEmoluments(String.valueOf(Float.parseFloat(bean
								.getEmployeePF()) * 100 / 12));
					} else {
						bean.setEmoluments(String.valueOf(Float.parseFloat(bean
								.getEmployeePF()) * 100 / 10));
					}

					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = commonDAO.calclatedPF(monthYear,
							retirementDate, dateofbirth, bean.getEmoluments(),
							bean.getWetherOption(), "", days, "1");
					calculatedPension = Math.round(calculatedPension);
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;
					pf = Math.round(pf);

				}
				// this code snippet is removed from if condition
				// foundSalaryDate.equals("") &&
				if (!bean.getPfid().equals("")) {
					String insertPensionCon = "", updatePensionCon = "";
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertPensionCon = "update employee_pension_validate set pf='"
							+ pf
							+ "',PENSIONCONTRI='"
							+ calculatedPension
							+ "'  where pensionno='"
							+ bean.getPfid()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "' AND EMPFLAG='Y' ";

					/*
					 * updatePensionCon =
					 * "update employee_pension_validate set PF=EMPPFSTATUARY,PENSIONCONTRI='0.00' where pensionno='"
					 * + bean.getPfid() +
					 * "' and monthyear>=add_months(to_date('" + monthYear +
					 * "','dd-Mon-yyyy'),1) ";
					 */
					log.info(insertPensionCon);
					// log.info(updatePensionCon);
					st.executeUpdate(insertPensionCon);
					// st.executeUpdate(updatePensionCon);
				}

			}

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} finally {
			try {
				pst.close();
				rs.close();
				rs2.close();
				st1.close();
				st.close();
				conn.close();
			} catch (Exception e) {

			}
		}

	} 
	 public void pentionContributionProcess2008to11(String range, String region,
			String airportcode, String Pfid, String fromYear, String toYear,
			FileWriter fw, String checkPendingFlag) {

		log
				.info("ImportDao :pentionContributionProcess2008to11(range,region) entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";

		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "", pensionno = "", updateQuery = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();

			if (checkPendingFlag.equals("false")) {
				updateQuery = buildQueryTransInfoPrinting("NO-SELECT",
						airportcode, region, Pfid, fromYear, toYear);
			} else {
				updateQuery = "select pensionno,to_char(monthyear,'dd-Mon-yyyy') as monthyear from employee_pension_ where pensionno in(select pensionno from employee_personal_info where to_char(LASTACTIVE,'dd-Mon-yyyy')=to_date(current_date)) "
						+ " and monthyear>=to_date('01-Apr-2008','dd-Mon-yyyy') and monthyear<=to_date('31-May-2010','dd-Mon-yyyy') and edittrans='N' AND empflag='Y' order by pensionno";
			}

			rs = st1.executeQuery(updateQuery);
			log.info("pentionContributionProcess2008to11" + updateQuery);
			while (rs.next()) {
				double calculatedPension = 0.00, pf = 0.00;
				bean = new EmpMasterBean();

				if (rs.getString("monthyear") != null) {
					monthYear = rs.getString("monthyear").toString();
				} else {
					monthYear = "";
				}
				if (rs.getString("pensionno") != null) {
					pensionno = rs.getString("pensionno").trim();
				} else {
					pensionno = "";
				}

				String transMonthYear = "";

				if (!pensionno.trim().equals("")) {

					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date(to_char(add_months(TO_DATE('"
							+ monthYear
							+ "'), -1),'dd-Mon-yyyy'),'DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 697),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ pensionno + "'";
					log.info(checkPFID);
					rs1 = st.executeQuery(checkPFID);

					if (!rs1.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs1.getString("wetheroption") != null) {
						bean.setWetherOption(rs1.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs1.getString("REIREMENTDATE") != null) {
						retirementDate = rs1.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs1.getString("dateofbirth") != null) {
						dateofbirth = rs1.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs1.getString("days") != null) {
						days = rs1.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs1.getString("calPensionupto") != null) {
						calPensionupto = rs1.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					String emolumentsQuery = "select nvl(emoluments,'0.0') as emoluments from employee_pension_validate where pensionno='"
							+ pensionno
							+ "' and to_char(monthyear,'dd-Mon-yyyy') = '"
							+ monthYear.trim()
							+ "' and edittrans='N' and empflag='Y'";
					log.info(emolumentsQuery);
					rs2 = st.executeQuery(emolumentsQuery);
					if (rs2.next()) {
						if (rs2.getString("emoluments") != null) {
							bean.setEmoluments(rs2.getString("emoluments"));
						}
					} else {
						bean.setEmoluments("0.00");
					}
					log.info("emoluments" + bean.getEmoluments() + "monthYear "
							+ monthYear);
					Date transdate = null;
					DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
					transdate = df.parse(monthYear);
					float cpfarrear = 0;
					if (transdate.after(new Date("31-Mar-1998"))) {
						bean.setEmployeePF(String.valueOf(Float.parseFloat(bean
								.getEmoluments()) * 12 / 100));
					} else {
						bean.setEmployeePF(String.valueOf(Float.parseFloat(bean
								.getEmoluments()) * 10 / 100));
					}

					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = fdao.calclatedPF1(monthYear,
							calPensionupto, dateofbirth, bean.getEmoluments(),
							bean.getWetherOption(), "", days, "1", bean
									.getEmployeePF());
					calculatedPension = Math.round(calculatedPension);
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;
					pf = Math.round(pf);

				}
				if (!pensionno.equals("")) {
					String insertPensionCon = "", updatePensionCon = "";
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					insertPensionCon = "update employee_pension_validate set pf='"
							+ pf
							+ "',PENSIONCONTRI='"
							+ calculatedPension
							+ "'  where pensionno='"
							+ pensionno
							+ "' and to_char(monthyear,'dd-Mon-yyyy') ='"
							+ monthYear.trim() + "' ";

					log.info(insertPensionCon);
					// log.info(updatePensionCon);
					st.executeUpdate(insertPensionCon);
					fw.write(commonUtil.leadingZeros(5, pensionno)
							+ "==============================="
							+ transMonthYear + "=========================="
							+ pf + "========================"
							+ calculatedPension + "\n");
				}
				fw.flush();
			}

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} finally {
			try {
				pst.close();
				rs.close();
				rs1.close();
				rs2.close();
				st1.close();
				st.close();
				conn.close();
			} catch (Exception e) {

			}
		}

	}

	public String buildQueryTransInfoPrinting(String range, String airportcode,
			String region, String pensionno, String fromYear, String toYear) {
		log.info("ImportDAO::buildQueryTransInfoPrinting-- Entering Method");
		StringBuffer whereClause = new StringBuffer();
		StringBuffer query = new StringBuffer();
		String dynamicQuery = "", sqlQuery = "";
		int startIndex = 0, endIndex = 0;

		sqlQuery = "select pensionno,to_char(monthyear,'dd-Mon-yyyy') as monthyear from employee_pension_validate where monthyear between to_date('"
				+ fromYear
				+ "','dd-Mon-yyyy') and to_date('"
				+ toYear
				+ "','dd-Mon-yyyy') and edittrans='N' AND empflag='Y'";
		if (!range.equals("NO-SELECT")) {
			String[] findRnge = range.split(" - ");
			startIndex = Integer.parseInt(findRnge[0]);
			endIndex = Integer.parseInt(findRnge[1]);

			whereClause.append("  (EPV.PFID BETWEEN " + startIndex + " AND "
					+ endIndex + ")");
			whereClause.append(" AND ");

		}

		if (!region.equals("") && (pensionno.equals(""))) {
			whereClause.append(" REGION ='" + region + "'");
			whereClause.append(" AND ");
		}
		if (!airportcode.equals("") && (pensionno.equals(""))) {
			whereClause.append(" AIRPORTCODE ='" + airportcode + "'");
			whereClause.append(" AND ");
		}

		if (!pensionno.equals("")) {
			whereClause.append("PENSIONNO='" + pensionno + "' ");
			whereClause.append(" AND ");
		}

		query.append(sqlQuery);
		if ((region.equals("")) && (airportcode.equals(""))
				&& (range.equals("NO-SELECT") && (pensionno.equals("")))) {

		} else {
			query.append(" AND ");
			query.append(commonDAO.sTokenFormat(whereClause));
		}
		String orderBy = " ORDER BY PENSIONNO";
		query.append(orderBy);
		dynamicQuery = query.toString();
		log.info("ImportDAO::buildQueryTransInfoPrinting Leaving Method");
		return dynamicQuery;
	}

	public String importArrearsTRData(String xlsData, String region,
			String userName, String ipAddress, String fileName, String year,
			String month, String airportcode) throws InvalidDataException {
		log.info("ImportDao :importArrearTrData() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "", monthYear1 = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		int updatedBatchCount[] = { 0 };
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String lastactiveMonth = "01" + "-" + convertedMonthYear;
			String monthyear = convertedMonthYear;
			log.info("lastactiveMonth" + lastactiveMonth);
			String importMonthStatus = "select FILENAME,IMPORTSTATUS,to_char(MONTHYEAR,'dd-Mon-yyyy')as monthyear FROM payment_recov_mnth_upload_log where  to_char(MONTHYEAR,'dd-Mon-yyyy') like  to_char('%"
					+ lastactiveMonth + "')";
			log.info(importMonthStatus);

			rs = st1.executeQuery(importMonthStatus);
			while (rs.next()) {
				if (rs.getString("IMPORTSTATUS").equals("Y")
						&& rs.getString("FILENAME").equals(fileName)
						&& rs.getString("monthyear").equals(lastactiveMonth)) {
					throw new InvalidDataException(fileName.trim()
							+ " Sheet Already Imported for Salary Month "
							+ month + "-" + year);
				}
			}
			double pensioncontri = 0.00, pf = 0.00;
			String srno = "";
			String payment_recov_mnth_upload_log = "insert into payment_recov_mnth_upload_log(FILENAME,USERNAME,IPADDRESS,AIRPORT,REGION,MONTHYEAR) values(?,?,?,?,?,?)";
			pst = conn.prepareStatement(payment_recov_mnth_upload_log);
			pst.setString(1, fileName.trim());
			pst.setString(2, userName.trim());
			pst.setString(3, ipAddress.trim());
			pst.setString(4, " ");
			pst.setString(5, region);
			pst.setString(6, lastactiveMonth.trim());
			pst.executeUpdate();
			String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
					+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,FINYEAR,remarks )"
					+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
			pst = conn.prepareStatement(finaceInsert);

			for (int i = 1; i < xlsDataList.size(); i++) {
				double calculatedPension = 0.00;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				bean.setRegion(region);
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}

				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}
				if (!tempInfo[4].equals("XXX")) {
					bean.setEmpName(tempInfo[4].trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setDesegnation(tempInfo[5].trim());
				} else {
					bean.setDesegnation("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setFhName(tempInfo[6].trim());
				} else {
					bean.setFhName("");
				}
				// String monthyear2 = "";
				/*
				 * if (!tempInfo[8].equals("XXX") && !srno.equals("")) {
				 * 
				 * log.info(tempInfo[8]); String convertedDate = commonUtil
				 * .convertDateFormat(tempInfo[8].trim());
				 * log.info("converted date is " + convertedDate); int index =
				 * tempInfo[8].trim().indexOf("-"); String count[] =
				 * tempInfo[8].split("-"); log.info(" countlength " +
				 * count.length); if (index == -1 || count.length != 3) { throw
				 * new InvalidDataException( "PFID " + bean.getPfid().trim() +
				 * " doesn't have valide date format(i.e dd-Mon-yyyy) in Column I of the Uploaded sheet "
				 * ); } String sheetDateMonthYear = tempInfo[8]; String
				 * sheetDateMonthyear[] = tempInfo[8].split("-"); // String
				 * sheetDateMonthyear[] = tempInfo[8].split("-"); String
				 * sheetMonthYear = sheetDateMonthyear[1] + "-" +
				 * sheetDateMonthyear[2]; if (!monthyear.equals(sheetMonthYear))
				 * { String monthyear1[] = tempInfo[8].split("-"); String month1
				 * = monthyear1[1]; String year1 = monthyear1[2]; throw new
				 * InvalidDataException(
				 * "Please make sure that the Salary Month Selected above (i.e "
				 * + convertedMonthYear +
				 * " is matching with month given in the excel sheet at Column I against PFID "
				 * + tempInfo[1].trim() + " ( i.e " + sheetMonthYear + ")"); } }
				 * 
				 * if (!tempInfo[8].equals("XXX") &&
				 * !bean.getPfid().trim().equals("")) { String monthyearQuery =
				 * "SELECT  to_char(add_months('" + tempInfo[8].trim() +
				 * "',1),'dd-Mon-yyyy') as monthyear from dual	";
				 * log.info(monthyearQuery);
				 * 
				 * rs = st1.executeQuery(monthyearQuery); if (rs.next()) {
				 * monthyear2 = rs.getString(1); } } log.info("monthyear 2 " +
				 * monthyear2);
				 */

				if (!tempInfo[7].equals("XXX")) {
					bean.setDateofBirth(tempInfo[7].trim());
				} else {
					bean.setDateofBirth("");
				}

				if (!tempInfo[8].equals("XXX")) {
					monthYear1 = tempInfo[8].trim();
				} else {
					monthYear1 = "";
				}

				String finyear = "";
				// Date transdate = null;
				log.info("monthyear1 " + monthYear1);
				/*
				 * if (!tempInfo[8].equals("XXX") &&
				 * !bean.getPfid().trim().equals("")) { DateFormat df = new
				 * SimpleDateFormat("dd-MMM-yyyy"); transdate =
				 * df.parse(monthYear); /if (transdate.after(new
				 * Date("31-Mar-2009")) && transdate.before(new
				 * Date("1-Apr-2010"))) { finyear = "2009-10"; } else if
				 * (transdate.after(new Date("31-Mar-2010")) &&
				 * transdate.before(new Date("1-Apr-2011"))) { finyear =
				 * "2010-11"; }
				 */
				/* } */

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.00");
				}

				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.00");
				}

				if (!tempInfo[11].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[11].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.00");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.00");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.00");
				}

				if (!tempInfo[18].equals("XXX")) {
					bean.setStation(tempInfo[18].trim());
				} else {
					bean.setStation("");
				}
				if (airportcode != null && !bean.getPfid().trim().equals("")
						&& region.equals("CHQIAD")) {
					log.info("sheet airportcode "
							+ bean.getStation().replaceAll(" ", "")
							+ " selected airportcode "
							+ airportcode.replaceAll(" ", "") + "srno " + srno);
					if (!bean.getStation().replaceAll(" ", "").equals(
							airportcode.replaceAll(" ", ""))
							&& !srno.equals("")) {
						throw new InvalidDataException(
								"Please make sure that the Seleted Airportcode above  (i.e "
										+ airportcode
										+ ") and is matching with AirportCode given in the excel sheet at Column 18. i.e"
										+ bean.getStation());
					}
				}
				log.info("cpfaccno " + bean.getCpfAcNo() + " " + bean.getPfid()
						+ "bean.getPfid().trim().equals()"
						+ bean.getPfid().trim().equals("")
						+ "bean.getCpfAcNo().trim().equals()"
						+ bean.getCpfAcNo().trim().equals(""));
				if (!srno.equals("") && bean.getPfid().trim().equals("")) {
					throw new InvalidDataException("PFID "
							+ bean.getPfid().trim() + " doesn't Exist"
							+ " for  Employee " + bean.getEmpName()
							+ ". PFID is Mandatory for All The Employees");
				}
				if (!bean.getPfid().trim().equals("")) {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ tempInfo[8]
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st1.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}

					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}

					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());

					foundSalaryDate = this.checkFinanceDuplicate1(conn,
							monthYear1, bean.getCpfAcNo(), bean.getEmpNumber(),
							bean.getRegion(), bean.getPfid(), airportcode, "");
					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = commonDAO.calclatedPF(monthYear1,
							retirementDate, dateofbirth, bean.getEmoluments(),
							bean.getWetherOption(), "", days, "1");

					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;

				}

				if (foundSalaryDate.equals("") && !bean.getPfid().equals("")
						&& !srno.equals("")) {
					pst.setString(1, bean.getCpfAcNo().trim());
					pst.setString(2, bean.getEmoluments().trim());
					pst.setString(3, bean.getEmployeePF().trim());
					pst.setString(4, bean.getStation());
					pst.setString(5, monthYear1.trim());
					pst.setString(6, bean.getEmpName().trim());
					pst.setString(7, bean.getEmpNumber().trim());
					pst.setString(8, bean.getDesegnation().trim());
					pst.setString(9, bean.getRegion().trim());
					pst.setString(10, bean.getPfid().trim());
					pst.setString(11, bean.getEmployeeVPF().trim());
					pst.setString(12, bean.getPrincipal().trim());
					pst.setString(13, bean.getInterest().trim());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, finyear);
					pst.setString(17, "arrears amount added "
							+ bean.getEmoluments());
					log.info("cpfaccno " + bean.getCpfAcNo() + " emoluments "
							+ bean.getEmoluments() + "," + bean.getEmployeePF()
							+ "PFID " + bean.getPfid() + ","
							+ bean.getEmpName() + "," + bean.getEmpNumber()
							+ "," + bean.getDesegnation());
					// pst.executeUpdate();
					pst.addBatch();
					// pst.close();
					addflag = true;
				} else if (!bean.getPfid().equals("") && !srno.equals("")) {
					String insertArrearCount = "";
					float basicDaSum = 0;
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthYear1.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					if (bean.getWetherOption().equals("B")
							&& String.valueOf(calculatedPension).equals("541")) {
						calculatedPension = 0;
						log.info("calculatedPension testing for wetheroption");
					}
					insertArrearCount = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'"
							+ calculatedPension
							+ "')),PF=to_char(TO_NUMBER(nvl(PF,0)+'"
							+ pf
							+ "')),remarks='arrears amount added "
							+ bean.getEmoluments()
							+ "'  where region='"
							+ bean.getRegion().trim()
							+ "' and airportcode='"
							+ bean.getStation()
							+ "' and cpfaccno='"
							+ bean.getCpfAcNo().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "'";
					st.addBatch(insertArrearCount);
					log.info("update query=" + insertArrearCount);
					updateflag = true;
				}
				// }
			}

			if (addflag) {
				addBatchcount = pst.executeBatch();
				log.info("Inserted Records Count is " + addBatchcount.length);
			}
			if (updateflag) {
				updatedBatchCount = st.executeBatch();
				log
						.info("Updated Records count is "
								+ updatedBatchCount.length);
			}
			String importStausupdate = "update payment_recov_mnth_upload_log  set IMPORTSTATUS='Y' where filename='"
					+ fileName + "'";
			st.executeUpdate(importStausupdate);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				st1.close();
				st.close();
				pst.close();
				rs.close();
				conn.close();
			} catch (Exception e) {

			}
		}

		log.info("ImportDao :importArrearTrData leaving method");
		if (addflag == true) {
			message = String.valueOf(addBatchcount.length);
		} else if (updateflag == true) {
			message = String.valueOf(updatedBatchCount.length);
		}
		return message;
	}

	public String checkFinanceDuplicate3(Connection con, String fromDate,
			String cpfaccno, String employeeNo, String region,
			String airportcode) {

		// log.info("PensionDAO :checkPensionDuplicate() entering method ");
		String foundEmpFlag = "";
		Statement st = null;

		ResultSet rs = null;
		// System.out.println("fromDate" + fromDate + "cpfaccno" + cpfaccno);
		/** for Eastern Region and Northern region* */
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "";
			if (region.equals("CHQIAD")) {
				query = "select CPFACCNO as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='"
						+ region
						+ "' and airportcode='"
						+ airportcode + "' and empflag='Y' ";
			} else {
				query = "select CPFACCNO as COLUMNNM from employee_Pension_validate where to_char(monthyear,'dd-Mon-yy') like '%"
						+ transMonthYear
						+ "' and cpfaccno='"
						+ cpfaccno
						+ "' and region='" + region + "' and empflag='Y' ";
			}
			st = con.createStatement();
			rs = st.executeQuery(query);
			log.info("query" + query);
			if (rs.next()) {
				if (rs.getString("COLUMNNM") != null) {
					foundEmpFlag = rs.getString("COLUMNNM");
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		// log.info("PensionDAO :checkPensionDuplicate() leaving method");
		return foundEmpFlag;
	}

	public void importMissingMonthsUpdate(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		log.info("ImportDao :importMissingMonthsUpdate() entering method");
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String foundSalaryDate = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "";
		String retirementDate = "", dateofbirth = "";
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			String transMonthYear = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setFromDate(tempInfo[4].trim());
				} else {
					bean.setFromDate("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].replaceAll(",", "").trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}

				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].trim());
				} else {
					bean.setEmoluments("0.0");
				}
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].trim());
				} else {
					bean.setEmployeePF("0.0");
				}

				DateFormat df = new SimpleDateFormat("dd-MMM-yy");

				if (!tempInfo[11].equals("XXX")) {
					bean.setEmployeeVPF(tempInfo[11].trim());
				} else {
					bean.setEmployeeVPF("0.0");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].trim());
				} else {
					bean.setPrincipal("0.0");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].trim());
				} else {
					bean.setInterest("0.0");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setRegion(tempInfo[15].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[16].equals("XXX")) {
					bean.setRemarks(tempInfo[16].trim());
				} else {
					bean.setRemarks("");
				}
				String arrearFlag = "";
				if (!tempInfo[17].equals("XXX")) {
					arrearFlag = tempInfo[17].trim();
				} else {
					arrearFlag = "";
				}
				int countEmployeeInfo = 0;
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(empserialnumber,cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks,MAPPINGFLAG) VALUES "
							+ "(?,?,?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(sql);
					pst.setString(1, bean.getPfid());
					pst.setString(2, bean.getCpfAcNo());
					pst.setString(3, bean.getStation());
					pst.setString(4, bean.getEmpNumber());
					pst.setString(5, bean.getEmpName());
					pst.setString(6, bean.getDesegnation());
					// for southern region Data
					pst.setString(7, bean.getRegion().trim());
					pst.setString(8, "new records from"
							+ bean.getRegion().trim());
					pst.setString(9, "Y".trim());
					// pst.executeUpdate();
					// pst.close();
				} else {
					String sql = "update employee_info set empserialnumber='"
							+ bean.getPfid()
							+ "',MAPPINGFLAG='Y' where cpfacno='"
							+ bean.getCpfAcNo() + "' and region='"
							+ bean.getRegion() + "'";
					// st.executeUpdate(sql);
				}
				double pensioncontri = 0.00, pf = 0.00, calculatedPension = 0.00;
				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,remarks,arrearflag)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				if ((!bean.getCpfAcNo().trim().equals("") || !bean.getPfid()
						.trim().equals(""))
						&& bean.getFromDate() != "") {

					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ bean.getFromDate()
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}

					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}

					foundSalaryDate = this.checkFinanceDuplicate2(conn, bean
							.getFromDate(), bean.getCpfAcNo(), bean
							.getEmpNumber(), bean.getRegion(), bean
							.getStation(), bean.getPfid());
					FinancialReportDAO fdao = new FinancialReportDAO();
					calculatedPension = fdao.calclatedPF1(bean.getFromDate(),
							retirementDate, dateofbirth, String
									.valueOf(Double.parseDouble(bean
											.getEmployeePF()) * 100 / 12), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());

					calculatedPension = Math.round(calculatedPension);
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;
					log.info("inside loop pf is " + pf + "calculatedPension"
							+ calculatedPension);
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					FinancialReportDAO FDAO = new FinancialReportDAO();
					String updatedDate = commonUtil
							.getCurrentDate("dd-MMM-yyyy");
					String emoluments_log = "", emoluments_log_history = "";
					String oldemppfstatuary = "", oldemoluments = "";
					Date transdate1 = df.parse(bean.getFromDate());
					oldemoluments = this.getEmoluments(conn,
							bean.getFromDate(), bean.getCpfAcNo(), "", bean
									.getRegion(), bean.getPfid());
					if ((transdate1.after(new Date("31-Mar-98"))
							&& oldemoluments != "" && Float
							.parseFloat(oldemoluments) != 0.00)) {
						oldemppfstatuary = String.valueOf(Float
								.parseFloat(oldemoluments) * 12 / 100);
					} else if (oldemoluments != ""
							&& Float.parseFloat(oldemoluments) != 0.00) {
						oldemppfstatuary = String.valueOf(Float
								.parseFloat(oldemoluments) * 10 / 100);
					}
					String selectEmolumentsLog = "select count(*) as count from emoluments_log where cpfacno='"
							+ bean.getCpfAcNo().trim()
							+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and region='"
							+ bean.getRegion() + "' ";
					rs = st.executeQuery(selectEmolumentsLog);
					while (rs.next()) {
						int count = rs.getInt(1);
						if (count == 0) {
							emoluments_log = "insert into emoluments_log(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
									+ oldemoluments.trim()
									+ "','"
									+ bean.getEmoluments().trim()
									+ "','"
									+ oldemppfstatuary.trim()
									+ "','"
									+ bean.getEmployeePF().trim()
									+ "','"
									+ bean.getFromDate()
									+ "','"
									+ updatedDate
									+ "','"
									+ bean.getPfid()
									+ "','"
									+ bean.getCpfAcNo()
									+ "','"
									+ bean.getRegion()
									+ "','"
									+ userName
									+ "','" + ipAddress + "')";
						} else {
							emoluments_log = "update emoluments_log set oldemoluments='"
									+ oldemoluments.trim()
									+ "',newemoluments='"
									+ bean.getEmoluments().trim()
									+ "',oldemppfstatuary='"
									+ oldemppfstatuary.trim()
									+ "',newemppfstatuary='"
									+ bean.getEmployeePF().trim()
									+ "',monthyear='"
									+ bean.getFromDate()
									+ "',UPDATEDDATE='"
									+ updatedDate
									+ "',pensionno='"
									+ bean.getPfid()
									+ "',region='"
									+ bean.getRegion()
									+ "',username='"
									+ userName
									+ "',computername='"
									+ ipAddress
									+ "' where pensionno='"
									+ bean.getPfid()
									+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
									+ transMonthYear
									+ "' and region='"
									+ bean.getRegion() + "'";

						}
						emoluments_log_history = "insert into emoluments_log_history(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
								+ oldemoluments
								+ "','"
								+ bean.getEmoluments().trim()
								+ "','"
								+ oldemppfstatuary
								+ "','"
								+ bean.getEmployeePF()
								+ "','"
								+ bean.getFromDate()
								+ "','"
								+ updatedDate
								+ "','"
								+ bean.getPfid()
								+ "','"
								+ bean.getCpfAcNo()
								+ "','"
								+ bean.getRegion()
								+ "','" + userName + "','" + ipAddress + "')";
						System.out.println(emoluments_log);
						System.out.println(emoluments_log_history);

						st.executeUpdate(emoluments_log);
						st.executeUpdate(emoluments_log_history);
						System.out.println("after excecution");
					}
				}
				String updateemoluments = "";
				// code commented on 20-04-2010 , foundSalaryDate.equals("") &&
				if (foundSalaryDate.equals("") && bean.getFromDate() != "") {

					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmployeePF());
					pst.setString(4, bean.getStation());
					pst.setString(5, bean.getFromDate());
					pst.setString(6, bean.getEmpName());
					pst.setString(7, bean.getEmpNumber());
					pst.setString(8, bean.getDesegnation());
					pst.setString(9, bean.getRegion());
					pst.setString(10, bean.getPfid());
					pst.setString(11, bean.getEmployeeVPF());
					pst.setString(12, bean.getPrincipal());
					pst.setString(13, bean.getInterest());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, bean.getRemarks());
					pst.setString(17, arrearFlag);
					pst.executeUpdate();
					pst.close();

				} else if (bean.getFromDate() != ""
						&& bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");

					updateemoluments = "update employee_pension_validate set emoluments='"
							+ bean.getEmoluments()
							+ "' , EMPPFSTATUARY='"
							+ bean.getEmployeePF().trim()
							+ "' ,empvpf='"
							+ bean.getEmployeeVPF()
							+ "',EMPADVRECPRINCIPAL='"
							+ bean.getPrincipal()
							+ "',EMPADVRECINTEREST='"
							+ bean.getInterest()
							+ "',EMPFLAG='Y',pensionno='"
							+ bean.getPfid()
							+ "',pf='"
							+ pf
							+ "',pensioncontri='"
							+ calculatedPension
							+ "',remarks=REMARKS||'"
							+ bean.getRemarks()
							+ "' where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and airportcode='"
							+ bean.getStation()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "' and EMPFLAG='Y'";

					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);

				} else if (bean.getFromDate() != ""
						&& !bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					updateemoluments = "update employee_pension_validate set emoluments='"
							+ bean.getEmoluments()
							+ "' , EMPPFSTATUARY='"
							+ bean.getEmployeePF().trim()
							+ "',empvpf='"
							+ bean.getEmployeeVPF()
							+ "',EMPADVRECPRINCIPAL='"
							+ bean.getPrincipal()
							+ "',EMPADVRECINTEREST='"
							+ bean.getInterest()
							+ "',EMPFLAG='Y',pf='"
							+ pf
							+ "',pensioncontri='"
							+ calculatedPension
							+ "',pensionno='"
							+ bean.getPfid()
							+ "',remarks=REMARKS||'"
							+ bean.getRemarks()
							+ "' where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear + "' and EMPFLAG='Y'";
					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);
				}

			}
		} catch (Exception e) {
			throw new InvalidDataException(e.getMessage());
		} finally {
			commonDB.closeConnection(conn, st, rs);
		}

		log.info("ImportDao :importMissingMonthsUpdate leaving method");

	}

	public void importMissingMonthsAdd(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		log.info("ImportDao :importMissingMonthsAdd() entering method");
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		String foundSalaryDate = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "", arrearFlag = "";
		;
		String xlsEmpName = "";
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		String retirementDate = "", dateofbirth = "";

		// log.info("xlsData " + xlsData + "Size" + xlsDataList.size());
		PreparedStatement pst = null;
		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			String transMonthYear = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				double pf = 0.00, calculatedPension = 0.00;
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[1].trim().equals("XXX")) {
					bean.setPfid(commonUtil.getSearchPFID1(tempInfo[1].trim()));
				} else {
					bean.setPfid("");
				}
				// log.info(bean.getPfid());

				if (!tempInfo[2].equals("XXX")) {
					bean.setCpfAcNo(tempInfo[2].trim());
				} else {
					bean.setCpfAcNo("");
				}
				if (!tempInfo[3].equals("XXX")) {
					bean.setEmpNumber(tempInfo[3].trim());
				} else {
					bean.setEmpNumber("");
				}

				if (!tempInfo[4].equals("XXX")) {
					bean.setFromDate(tempInfo[4].trim());
				} else {
					bean.setFromDate("");
				}
				if (!tempInfo[5].equals("XXX")) {
					bean.setEmpName(tempInfo[5].replaceAll(",", "").trim());
				} else {
					bean.setEmpName("");
				}
				if (!tempInfo[6].equals("XXX")) {
					bean.setDesegnation(tempInfo[6].trim());
				} else {
					bean.setDesegnation("");
				}
				log.info("emoluments" + tempInfo[9].trim());
				if (!tempInfo[9].equals("XXX")) {
					bean.setEmoluments(tempInfo[9].replaceAll(",", "").trim());
				} else {
					bean.setEmoluments("0.0");
				}
				log.info("emoluments" + bean.getEmoluments());
				if (!tempInfo[10].equals("XXX")) {
					bean.setEmployeePF(tempInfo[10].replaceAll(",", "").trim());
				} else {
					bean.setEmployeePF("0.0");
				}

				DateFormat df = new SimpleDateFormat("dd-MMM-yy");

				if (!tempInfo[11].equals("XXX")) {
					bean
							.setEmployeeVPF(tempInfo[11].replaceAll(",", "")
									.trim());
				} else {
					bean.setEmployeeVPF("0.0");
				}
				if (!tempInfo[12].equals("XXX")) {
					bean.setPrincipal(tempInfo[12].replaceAll(",", "").trim());
				} else {
					bean.setPrincipal("0.0");
				}
				if (!tempInfo[13].equals("XXX")) {
					bean.setInterest(tempInfo[13].replaceAll(",", "").trim());
				} else {
					bean.setInterest("0.0");
				}
				if (!tempInfo[14].equals("XXX")) {
					bean.setStation(tempInfo[14].trim());
				} else {
					bean.setStation("");
				}
				if (!tempInfo[15].equals("XXX")) {
					bean.setRegion(tempInfo[15].trim());
				} else {
					bean.setRegion("");
				}
				if (!tempInfo[16].equals("XXX")) {
					bean.setRemarks(tempInfo[16].trim());
				} else {
					bean.setRemarks("");
				}
				if (!tempInfo[17].equals("XXX")) {
					arrearFlag = tempInfo[17].trim();
				} else {
					arrearFlag = "";
				}

				/*
				 * if (!tempInfo[18].equals("XXX")) {
				 * calculatedPension=Double.parseDouble(tempInfo[18].trim()); }
				 * else { calculatedPension=0.00; }
				 * pf=Math.round(Double.parseDouble(bean.getEmployeePF())-
				 * calculatedPension);
				 */

				int countEmployeeInfo = 0;
				countEmployeeInfo = commonDAO.checkEmployeeInfo(conn, bean
						.getEmpNumber(), bean.getCpfAcNo(), bean.getEmpName(),
						bean.getRegion());
				if (countEmployeeInfo == 0) {
					String sql = "insert into employee_info(empserialnumber,cpfacno,airportCode, employeeno,employeeName,desegnation,region,remarks,MAPPINGFLAG) VALUES "
							+ "(?,?,?,?,?,?,?,?,?)";
					pst = conn.prepareStatement(sql);
					pst.setString(1, bean.getPfid());
					pst.setString(2, bean.getCpfAcNo());
					pst.setString(3, bean.getStation());
					pst.setString(4, bean.getEmpNumber());
					pst.setString(5, bean.getEmpName());
					pst.setString(6, bean.getDesegnation());
					pst.setString(7, bean.getRegion().trim());
					pst.setString(8, "new records from"
							+ bean.getRegion().trim());
					pst.setString(9, "Y".trim());
					// pst.executeUpdate();
					pst.close();
				} else {
					String sql = "update employee_info set empserialnumber='"
							+ bean.getPfid()
							+ "',MAPPINGFLAG='Y' where cpfacno='"
							+ bean.getCpfAcNo() + "' and region='"
							+ bean.getRegion() + "'";
					// st.executeUpdate(sql);
				}
				double pensioncontri = 0.00;
				// pf = 0.00, calculatedPension = 0.00;
				log.info(" Principle " + bean.getPrincipal() + "interest  "
						+ bean.getInterest() + " vpf " + bean.getEmployeeVPF());
				String finaceInsert = "insert into employee_pension_validate(cpfaccno,emoluments,emppfstatuary,AIRPORTCODE,"
						+ "MONTHYEAR,employeeName,employeeno,DESEGNATION,region,PENSIONNO,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,REMARKS,arrearflag)"
						+ " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
				if ((!bean.getCpfAcNo().trim().equals("") || !bean.getPfid()
						.trim().equals(""))
						&& bean.getFromDate() != "") {
					// if(!tempInfo[1].equals("XXX")){
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ bean.getFromDate()
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
							+ bean.getPfid() + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);

					if (!rs.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs.getString("wetheroption") != null) {
						bean.setWetherOption(rs.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs.getString("REIREMENTDATE") != null) {
						retirementDate = rs.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs.getString("dateofbirth") != null) {
						dateofbirth = rs.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs.getString("days") != null) {
						days = rs.getString("days");
					} else {
						days = "0";
					}

					if (tempInfo[1].equals("XXX")) {
						throw new InvalidDataException("PFID is Blank for "
								+ bean.getCpfAcNo());
					}

					log.info(" Principle " + bean.getPrincipal() + "interest  "
							+ bean.getInterest() + " vpf "
							+ bean.getEmployeeVPF());

					foundSalaryDate = this.checkFinanceDuplicate2(conn, bean
							.getFromDate(), bean.getCpfAcNo(), bean
							.getEmpNumber(), bean.getRegion(), bean
							.getStation(), bean.getPfid());
					FinancialReportDAO fdao = new FinancialReportDAO();

					calculatedPension = fdao.calclatedPF1(bean.getFromDate(),
							retirementDate, dateofbirth, String
									.valueOf(Double.parseDouble(bean
											.getEmployeePF()) * 100 / 12), bean
									.getWetherOption(), "", days, "1", bean
									.getEmployeePF());

					calculatedPension = Math.round(calculatedPension);
					pf = Double.parseDouble(bean.getEmployeePF().toString())
							- calculatedPension;
					log.info("wetheroption " + bean.getWetherOption());
					if (bean.getWetherOption().trim().equals("B")) {
						pf = Math.round(Double.parseDouble(bean.getEmployeePF()
								.trim()));
						calculatedPension = 0;
					}

					/*
					 * foundSalaryDate = this.checkFinanceDuplicate(conn, bean
					 * .getFromDate(), bean.getCpfAcNo(), bean .getEmpNumber(),
					 * bean.getRegion());
					 */

					// inserting log
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					FinancialReportDAO FDAO = new FinancialReportDAO();
					String updatedDate = commonUtil
							.getCurrentDate("dd-MMM-yyyy");

					String emoluments_log = "", emoluments_log_history = "";
					String oldemppfstatuary = "0.00", oldemoluments = "0.00";
					Date transdate1 = df.parse(bean.getFromDate());
					oldemoluments = this.getEmoluments(conn,
							bean.getFromDate(), bean.getCpfAcNo(), "", bean
									.getRegion(), bean.getPfid());
					if (oldemoluments == "") {
						oldemoluments = "0.00";
					}
					if (oldemppfstatuary == "") {
						oldemppfstatuary = "0.00";
					}
					if ((transdate1.after(new Date("31-Mar-98"))
							&& oldemoluments != "" && Float
							.parseFloat(oldemoluments) != 0.00)) {
						oldemppfstatuary = String.valueOf(Float
								.parseFloat(oldemoluments) * 12 / 100);
					} else if (oldemoluments != ""
							&& Float.parseFloat(oldemoluments) != 0.00) {
						oldemppfstatuary = String.valueOf(Float
								.parseFloat(oldemoluments) * 10 / 100);
					}
					String selectEmolumentsLog = "select count(*) as count from emoluments_log where pensionno='"
							+ bean.getPfid().trim()
							+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and region='"
							+ bean.getRegion() + "' ";

					rs = st.executeQuery(selectEmolumentsLog);
					float newemppfstatuary = Float.parseFloat(bean
							.getEmployeePF())
							+ Float.parseFloat(oldemppfstatuary);
					float newemoluments = Float
							.parseFloat(bean.getEmoluments())
							+ Float.parseFloat(oldemoluments);
					while (rs.next()) {
						int count = rs.getInt(1);
						if (count == 0) {
							emoluments_log = "insert into emoluments_log(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
									+ oldemoluments
									+ "','"
									+ newemoluments
									+ "','"
									+ oldemppfstatuary
									+ "','"
									+ newemppfstatuary
									+ "','"
									+ bean.getFromDate()
									+ "','"
									+ updatedDate
									+ "','"
									+ bean.getPfid()
									+ "','"
									+ bean.getCpfAcNo()
									+ "','"
									+ bean.getRegion()
									+ "','"
									+ userName
									+ "','" + ipAddress + "')";
						} else {
							emoluments_log = "update emoluments_log set oldemoluments='"
									+ oldemoluments
									+ "',newemoluments='"
									+ newemoluments
									+ "',oldemppfstatuary='"
									+ oldemppfstatuary
									+ "',newemppfstatuary='"
									+ newemppfstatuary
									+ "',monthyear='"
									+ bean.getFromDate()
									+ "',UPDATEDDATE='"
									+ updatedDate
									+ "',pensionno='"
									+ bean.getPfid()
									+ "',region='"
									+ bean.getRegion()
									+ "',username='"
									+ userName
									+ "',computername='"
									+ ipAddress
									+ "' where pensionno='"
									+ bean.getPfid()
									+ "' and  to_char(monthyear,'dd-Mon-yyyy') like '%"
									+ transMonthYear
									+ "' and region='"
									+ bean.getRegion() + "'";

						}
						emoluments_log_history = "insert into emoluments_log_history(oldemoluments,newemoluments,oldemppfstatuary,newemppfstatuary,monthyear,UPDATEDDATE,pensionno,cpfacno,region,username,computername)values('"
								+ oldemoluments
								+ "','"
								+ bean.getEmoluments()
								+ "','"
								+ oldemppfstatuary
								+ "','"
								+ bean.getEmployeePF()
								+ "','"
								+ bean.getFromDate()
								+ "','"
								+ updatedDate
								+ "','"
								+ bean.getPfid()
								+ "','"
								+ bean.getCpfAcNo()
								+ "','"
								+ bean.getRegion()
								+ "','" + userName + "','" + ipAddress + "')";
						st.executeUpdate(emoluments_log);
						st.executeUpdate(emoluments_log_history);
						log.info("emoluments_log" + emoluments_log);
						log.info("emoluments_log_history"
								+ emoluments_log_history);
					}
				}
				String insertarrear = "";
				if (arrearFlag.trim().equals("Y")) {
					insertarrear = "insert into employee_pension_arrear(CPFACCNO,EMPLOYEENO,EMPLOYEENAME,ARREARDATE,ARREARAMT,AIRPORTCODE,REGION,REMARKS,PENSIONNO)values('"
							+ bean.getCpfAcNo()
							+ "','"
							+ bean.getEmpNumber()
							+ "','"
							+ bean.getEmpName()
							+ "','"
							+ bean.getFromDate()
							+ "','"
							+ bean.getEmoluments()
							+ "','"
							+ bean.getStation()
							+ "','"
							+ bean.getRegion()
							+ "','"
							+ bean.getRemarks()
							+ "','" + bean.getPfid() + "')";
					log.info("insertarrear" + insertarrear);
					st.executeUpdate(insertarrear);
				}
				String updateemoluments = "";
				// code commented on 20-04-2010 , foundSalaryDate.equals("") &&
				if (foundSalaryDate.equals("") && bean.getFromDate() != "") {
					pst = conn.prepareStatement(finaceInsert);
					pst.setString(1, bean.getCpfAcNo());
					pst.setString(2, bean.getEmoluments());
					pst.setString(3, bean.getEmployeePF());
					pst.setString(4, bean.getStation());
					pst.setString(5, bean.getFromDate());
					pst.setString(6, bean.getEmpName());
					pst.setString(7, bean.getEmpNumber());
					pst.setString(8, bean.getDesegnation());
					pst.setString(9, bean.getRegion());
					pst.setString(10, bean.getPfid());
					pst.setString(11, bean.getEmployeeVPF());
					pst.setString(12, bean.getPrincipal());
					pst.setString(13, bean.getInterest());
					pst.setDouble(14, calculatedPension);
					pst.setDouble(15, pf);
					pst.setString(16, bean.getRemarks());
					pst.setString(17, arrearFlag.trim());
					pst.executeUpdate();
					pst.close();
					log.info("inside insert");

				} else if (bean.getFromDate() != ""
						&& bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					updateemoluments = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),remarks=remarks||'"
							+ bean.getRemarks()
							+ "',EMPFLAG='Y',pensionno='"
							+ bean.getPfid()
							+ "',ARREARFLAG='"
							+ arrearFlag
							+ "',pf= to_char(TO_NUMBER(nvl(pf,0)+'"
							+ pf
							+ "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'"
							+ calculatedPension
							+ "')) where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and empflag='Y' and airportcode='"
							+ bean.getStation() + "'";

					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);
				} else if (bean.getFromDate() != ""
						&& !bean.getRegion().equals("CHQIAD")) {
					log.info(bean.getFromDate().trim());
					float basicDaSum = 0;
					transMonthYear = commonUtil.converDBToAppFormat(bean
							.getFromDate().trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					updateemoluments = "update employee_pension_validate set emoluments=to_char(TO_NUMBER(nvl(emoluments,0)+'"
							+ bean.getEmoluments()
							+ "')) , EMPPFSTATUARY=to_char(TO_NUMBER(nvl(EMPPFSTATUARY,0)+'"
							+ bean.getEmployeePF().trim()
							+ "')),EMPADVRECPRINCIPAL=to_char(TO_NUMBER(nvl(EMPADVRECPRINCIPAL,0)+'"
							+ bean.getPrincipal().trim()
							+ "')),EMPADVRECINTEREST= to_char(TO_NUMBER(nvl(EMPADVRECINTEREST,0)+'"
							+ bean.getInterest().trim()
							+ "')),EMPVPF=to_char(TO_NUMBER(nvl(EMPVPF,0)+'"
							+ bean.getEmployeeVPF().trim()
							+ "')),remarks=remarks||'"
							+ bean.getRemarks()
							+ "',EMPFLAG='Y',pensionno='"
							+ bean.getPfid()
							+ "',ARREARFLAG='"
							+ arrearFlag
							+ "',pf= to_char(TO_NUMBER(nvl(pf,0)+'"
							+ pf
							+ "')),PENSIONCONTRI=to_char(TO_NUMBER(nvl(PENSIONCONTRI,0)+'"
							+ calculatedPension
							+ "')) where region='"
							+ bean.getRegion().trim()
							+ "' and pensionno='"
							+ bean.getPfid().trim()
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and airportcode='"
							+ bean.getStation() + "' and empflag='Y'";

					log.info("update query " + updateemoluments);
					int count = st.executeUpdate(updateemoluments);
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {

			commonDB.closeConnection(conn, st, rs);
			/*
			 * try { //st1.close(); st.close(); pst.close(); rs.close();
			 * conn.close(); } catch (Exception e) {
			 * 
			 * throw new InvalidDataException(e.getMessage()); }
			 */
		}
		log.info("ImportDao :importMissingMonthsAdd leaving method");

	}

	public String arrearBreakupFormat(String xlsData, String userName,String ipAddress,String fileName) throws InvalidDataException {
		log.info("ImportDao :arrearBreakupFormat() entering method");
			String message = "";
			ArrayList xlsDataList = new ArrayList();
			ArrayList fnlDataList = new ArrayList();
			FinancialReportDAO fDao = new FinancialReportDAO();
			xlsDataList = commonUtil.getTheList(xlsData, "***");
			Connection conn = null;
			Statement st = null;
			String tempData = "", tempData1 = "";
			char[] delimiters = { '"', ',', '\'', '*', ',' };
			String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
			String uploadFilePath = "";
			String xlsEmpName = "", monthYear = "", dateofbirth = "";
			PreparedStatement pst = null;
			ResultSet rs = null;
			ResultSet rs1 = null;
			String foundSalaryDate = "", retirementDate = "",username="";
			boolean addflag = false;
			boolean updateflag = false;
			String[] tempInfo = {};
			String[] tempInfo1 = {};
			int updatedBatchCount[] = { 0 };
			int count1 = 0;
			int updateRecordsCount = 0;
			uploadFilePath = "C:\\Pension_Upload";
			File filePath = new File(uploadFilePath);
			FileWriter fw = null;
			FileWriter fw1 = null;
			EmpMasterBean bean = null;
			try {
				fw = new FileWriter(new File(filePath
						+ "\\arrearbreakupFailure1.txt"));
				 fw1 = new FileWriter(new File(filePath
							+ "\\arrearbreakuperrors.txt"));
				conn = commonDB.getConnection();
				conn.setAutoCommit(false);
				st = conn.createStatement();
				String srno = "", pensionNo = "", empNo = "", cpfAcno = "", empName = "", desig = "", dateofBirh = "", dateofJoin = "", monthyear = "";
				String duewages = "", drawnwages = "", diffwages = "",diffadjwages="";
				String duecontri = "", drawncontri = "", diffcontri = "", remarks = "", region = "",diffadjcontri="";
				String arrearfromDate = "";
				String arreartoDate = "";
				String employee_arrear_breakup = "";
				String employee_arrear_breakup_recordexist = "";
				String wetheroption = "",checkfalg="";
				
				String tempPensionno = "", tempEmployeename = "", airportcode = "", tempStation = "", tempRegion = "", tempCpfaccno = "";
				for (int i = 1; i < xlsDataList.size(); i++) {
					double calculatedPension = 0.00;
					tempData = xlsDataList.get(i).toString();
					bean = new EmpMasterBean();
					tempInfo = tempData.split("@");
					if (i == 1) {
						tempPensionno = commonUtil.getSearchPFID1(tempInfo[1]
								.trim());
						arrearfromDate = tempInfo[8].trim();
					}

					if (!tempInfo[0].equals("XXX")) {
						srno = tempInfo[0];
					} else {
						srno = "";
					}
					if (!tempInfo[1].equals("XXX")) {
						pensionNo = commonUtil.getSearchPFID1(tempInfo[1].trim());
					} else {
						pensionNo = "";
					}
					if (!tempPensionno.equals(pensionNo)) {
						tempData1 = xlsDataList.get(i - 1).toString();
						tempInfo1 = tempData1.split("@");
						arreartoDate = tempInfo1[8].trim();
						tempPensionno = commonUtil.getSearchPFID1(tempInfo1[1]
								.trim());
						tempEmployeename = tempInfo1[4].trim();
						if (!tempInfo1[11].trim().equals("XXX")) {
							tempStation = tempInfo1[11].trim();
						} else {
							tempStation = "";
						}
						if (!tempInfo1[12].trim().equals("XXX")) {
							tempRegion = tempInfo1[12].trim();
						} else {
							tempRegion = "";
						}
						if (!tempInfo1[3].trim().equals("XXX")) {
							tempCpfaccno = tempInfo1[3].trim();
						} else {
							tempCpfaccno = "";
						}
						log.info("tempPensionno ** " + tempPensionno
								+ "pensionNo ** " + pensionNo);
					}
					if (!tempInfo[2].equals("XXX")) {
						empNo = tempInfo[2].trim();
					} else {
						empNo = "";
					}
					if (!tempInfo[3].equals("XXX")) {
						cpfAcno = tempInfo[3].trim();
					} else {
						cpfAcno = "";
					}
					if (!tempInfo[4].equals("XXX")) {
						empName = tempInfo[4].trim();
					} else {
						empName = "";
					}
					if (!tempInfo[5].equals("XXX")) {
						desig = tempInfo[5].trim();
					} else {
						desig = "";
					}
					if (!tempInfo[6].equals("XXX")) {
						dateofBirh = tempInfo[6].trim();
					} else {
						dateofBirh = "";
					}
					if (!tempInfo[7].equals("XXX")) {
						dateofJoin = tempInfo[7].trim();
					} else {
						dateofJoin = "";
					}

					if (!tempInfo[8].equals("XXX")) {
						monthyear = tempInfo[8].trim();
					} else {
						monthyear = "";
					}
					Date transdate = null;
					log.info("monthyear" + monthyear);
					String monthyear2 = "";

					if (!tempInfo[8].equals("XXX") && !pensionNo.trim().equals("")) {
						String monthyearQuery = "SELECT  to_char(add_months('"
								+ tempInfo[8].trim()
								+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
						

						rs = st.executeQuery(monthyearQuery);
						if (rs.next()) {
							monthyear2 = rs.getString(1);
						}
					}
					// log.info("monthyear 2 " + monthyear2);

					if (!tempInfo[9].equals("XXX")) {
						duewages = tempInfo[9].replaceAll(",", "").trim();
					} else {
						duewages = "0.00";
					}
					if (!tempInfo[10].equals("XXX")) {
						diffcontri = tempInfo[10].replaceAll(",", "").trim();
					} else {
						diffcontri = "0.00";
					}
					if (!tempInfo[11].equals("XXX")) {
						airportcode = tempInfo[11].trim();
					} else {
						airportcode = "";
					}
					if (!tempInfo[12].equals("XXX")) {
						region = tempInfo[12].trim();
					} else {
						region = "";
					}
					if (!tempInfo[13].equals("XXX")) {
						remarks = tempInfo[13].trim();
					} else {
						remarks = "";
					}
					if (!tempInfo[14].equals("XXX")) {
						checkfalg = tempInfo[14].trim();
					} else {
						checkfalg = "";
					}
					if (!tempInfo[15].equals("XXX")) {
						username = tempInfo[15].trim();
					} else {
						username = "";
					}
					if (!srno.equals("") && pensionNo.trim().equals("")) {
						throw new InvalidDataException("PFID " + pensionNo.trim()
								+ " doesn't Exist" + " for  Employee " + empName
								+ ". PFID is Mandatory for All The Employees");
					}

					String emoluments = this.checkEmoluments(conn, monthyear,
							pensionNo, drawnwages);
					String adjcrtnemoluments=this.checkAdjCrtnEmoluments(conn, monthyear,
							pensionNo, drawnwages);
					// log.info("emoluments"+emoluments);
					String transMonthYear = commonUtil.converDBToAppFormat(
							monthyear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					//checking the dueemoluments correct or not
					if(checkfalg.equals("Y")){
					String dbemoluments=this.checkEmoluments(conn, monthyear,
							pensionNo, drawnwages);
					if(dbemoluments.equals("")){	
						dbemoluments="0.00";
					}
					String str="";
				if ((Math.round(Double.parseDouble(dbemoluments)))>(Math.round(Double.parseDouble(duewages)))) {
					bean.setEmpSerialNo(pensionNo.trim());
					bean.setEmoluments(duewages);
					bean.setBasic(dbemoluments);
					bean.setEmpName(empName.trim());
					bean.setEmpNumber(empNo);
					bean.setDesegnation(desig);
			        bean.setPaidDate(monthyear);				
					str=" For the PFID " + pensionNo.trim()
								+ " Employeename "+empName.trim()+" and monthyear "+monthyear+" Due emoluments " + duewages
								+ " is lessthan" + " Drawn emoluments " + dbemoluments
								+ ". ";
						System.out.println("str"+str);	
		           }
			if(!str.equals(""))	{
	          fw1.write("" + str +"\r\n");
	            fw1.flush();
			}
					}
					if (!emoluments.equals("") && emoluments != "0") {
						if (!pensionNo.trim().equals("")) {
							// if(!tempInfo[1].equals("XXX")){
							String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
									+ tempInfo[8]
									+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
									+ pensionNo + "'";
							log.info(checkPFID);
							rs = st.executeQuery(checkPFID);

							if (!rs.next()) {
								throw new InvalidDataException(
										"PFID "
												+ pensionNo
												+ " doesn't Exist"
												+ " for  Employee "
												+ empName
												+ ". PFID is Mandatory for All The Employees");
							}
							if (rs.getString("wetheroption") != null) {
								wetheroption = rs.getString("wetheroption")
										.toString();
							} else {
								wetheroption = "";
							}
							if (rs.getString("REIREMENTDATE") != null) {
								retirementDate = rs.getString("REIREMENTDATE");
							} else {
								retirementDate = "";
							}
							if (rs.getString("dateofbirth") != null) {
								dateofbirth = rs.getString("dateofbirth");
							} else {
								dateofbirth = "";
							}
							String days = "0";
							if (rs.getString("days") != null) {
								days = rs.getString("days");
							} else {
								days = "0";
							}
if(adjcrtnemoluments.equals("")){
	adjcrtnemoluments=duewages;
}
							diffwages = String.valueOf(Math.round(Double
									.parseDouble(duewages)
									- Double.parseDouble(emoluments)));
							log.info("adjcrtnemoluments"+adjcrtnemoluments);
							diffadjwages=String.valueOf(Math.round(Double
									.parseDouble(duewages)
									- Double.parseDouble(adjcrtnemoluments)));
							log.info("diffadjwages"+diffadjwages);
							diffcontri = String.valueOf(Math.round((Double
									.parseDouble(diffwages) * 8.33 / 100)));
							diffadjcontri=String.valueOf(Math.round((Double
									.parseDouble(diffadjwages) * 8.33 / 100)));
							FinancialReportDAO fdao = new FinancialReportDAO();
							diffcontri = String.valueOf(Math.round(commonDAO
									.calclatedPF(monthyear, retirementDate,
											dateofbirth, diffwages, wetheroption,
											"", days, "1")));
							diffadjcontri=String.valueOf(Math.round(commonDAO
									.calclatedPF(monthyear, retirementDate,
											dateofbirth, diffadjwages, wetheroption,
											"", days, "1")));
							
							if (diffcontri.equals("0")) {
								diffwages = "0";
							} else if ((Integer.parseInt(days) >= 0 && Integer
									.parseInt(days) <= 1)
									|| (Integer.parseInt(days) < 0 && Integer
											.parseInt(days) > -29)) {
								diffwages = String.valueOf(Math.round(Double
										.parseDouble(diffcontri)
										* (100 / 8.33)));
							}	

							if (diffadjcontri.equals("0")) {
								diffadjwages = "0";
							} else if ((Integer.parseInt(days) >= 0 && Integer
									.parseInt(days) <= 1)
									|| (Integer.parseInt(days) < 0 && Integer
											.parseInt(days) > -29)) {
								diffadjwages = String.valueOf(Math.round(Double
										.parseDouble(diffadjcontri)
										* (100 / 8.33)));
							}
						}
						if (wetheroption.trim().equals("A")) {
							String addArrears = "update employee_pension_validate set arrearamount='"
									+ diffcontri
									+ "',dueemoluments='"
									+ diffwages
									+ "',arrearsbreakup='Y',FORM7NARRATION='"+remarks+"' where pensionno='"
									+ pensionNo
									+ "' and to_char(monthyear,'Mon-yyyy') like to_char(ADD_MONTHS('"
									+ monthyear
									+ "',1),'Mon-yyyy') AND EMPFLAG='Y'";
							st.executeUpdate(addArrears);
							updateRecordsCount = updateRecordsCount + 1;
							log.info("updateRecordsCount " + updateRecordsCount);
							log.info("addArrears" + addArrears);
							updateflag = true;
							log.info("adjcrtnemoluments" + adjcrtnemoluments);
							if (!adjcrtnemoluments.equals("") && adjcrtnemoluments != "0") {
								String addAdjCrtnArrears = "update epis_adj_crtnback set arrearamount='"
									+ diffadjcontri
									+ "',dueemoluments='"
									+ diffadjwages
									+ "',arrearsbreakup='Y',FORM7NARRATION='"+remarks+"' where pensionno='"
									+ pensionNo
									+ "' and to_char(monthyear,'Mon-yyyy') like to_char(ADD_MONTHS('"
									+ monthyear
									+ "',1),'Mon-yyyy') AND EMPFLAG='Y'";
								log.info("addAdjCrtnArrears"+addAdjCrtnArrears);
							st.executeUpdate(addAdjCrtnArrears);
							}
						}
					} else {
						if (!pensionNo.trim().equals("")) {
							// if(!tempInfo[1].equals("XXX")){
							String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
									+ tempInfo[8]
									+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
									+ pensionNo + "'";
							log.info(checkPFID);
							rs = st.executeQuery(checkPFID);

							if (!rs.next()) {
								throw new InvalidDataException(
										"PFID "
												+ pensionNo
												+ " doesn't Exist"
												+ " for  Employee "
												+ empName
												+ ". PFID is Mandatory for All The Employees");
							}
							if (rs.getString("wetheroption") != null) {
								wetheroption = rs.getString("wetheroption")
										.toString();
							} else {
								wetheroption = "";
							}
							if (rs.getString("REIREMENTDATE") != null) {
								retirementDate = rs.getString("REIREMENTDATE");
							} else {
								retirementDate = "";
							}
							if (rs.getString("dateofbirth") != null) {
								dateofbirth = rs.getString("dateofbirth");
							} else {
								dateofbirth = "";
							}
							String days = "0";
							if (rs.getString("days") != null) {
								days = rs.getString("days");
							} else {
								days = "0";
							}
							diffwages = String.valueOf(Math.round(Double
									.parseDouble(duewages)));
							log.info("diffwages" + diffwages);							
							diffcontri = String.valueOf(Math.round((Double
									.parseDouble(diffwages) * 8.33 / 100)));
							FinancialReportDAO fdao = new FinancialReportDAO();
							diffcontri = String.valueOf(Math.round(commonDAO
									.calclatedPF(monthyear, retirementDate,
											dateofbirth, diffwages, wetheroption,
											"", days, "1")));

							if (diffcontri.equals("0") && diffcontri == "0") {
								diffwages = "0";
							} else if ((Integer.parseInt(days) >= 0 && Integer
									.parseInt(days) <= 1)
									|| (Integer.parseInt(days) < 0 && Integer
											.parseInt(days) > -29)) {
								diffwages = String.valueOf(Math.round(Double
										.parseDouble(diffcontri)
										* (100 / 8.33)));
							}
						}
						if (wetheroption.trim().equals("A")) {
							String insertarrears = "insert into employee_pension_validate(pensionno,arrearamount,dueemoluments,arrearsbreakup,employeename,emoluments,emppfstatuary,empvpf,empadvrecprincipal,empadvrecinterest,monthyear,remarks,FORM7NARRATION) values('"
									+ pensionNo
									+ "','"
									+ diffcontri
									+ "','"
									+ duewages
									+ "','Y','"
									+ empName
									+ "','0','0','0','0','0',to_char(ADD_MONTHS('"
									+ monthyear + "',1),'dd-Mon-yyyy'),'MonthlyBreakupData','"+remarks+"')";
							st.executeUpdate(insertarrears);
						}
						if (!filePath.exists()) {
							filePath.mkdirs();
						}
						fw.write("PensionNo" + pensionNo + "/n");
						fw.flush();
						count1 = count1 + 1;
						log.info("count1= " + count1);
						log.info("Inserted Records count is " + count1);
					}
					if (!tempPensionno.equals(pensionNo)) {
						arrearfromDate = commonUtil.converDBToAppFormat(
								arrearfromDate
										.substring(2, arrearfromDate.length()),
								"MMM-yyyy", "MM-yyyy");
						arreartoDate = commonUtil.converDBToAppFormat(arreartoDate
								.substring(2, arreartoDate.length()), "MMM-yyyy",
								"MM-yyyy");
						String fromMonth = arrearfromDate.substring(0, 2);
						String fromYear = arrearfromDate.substring(3,
								arrearfromDate.length());
						String toMonth = arreartoDate.substring(0, 2);
						String toYear = arreartoDate.substring(3, arreartoDate
								.length());
						System.out.println("arrearfromDate " + arrearfromDate + ""
								+ "arreartoDate " + arreartoDate);
						System.out.println("fromMonth " + fromMonth + ""
								+ "fromYear " + fromYear);
						if (Integer.parseInt(fromMonth) >= 1
								&& Integer.parseInt(fromMonth) <= 3) {
							arrearfromDate = "01-Apr-"
									+ String
											.valueOf(Integer.parseInt(fromYear) - 1);
						} else {
							arrearfromDate = "01-Apr-" + fromYear;
						}
						if (Integer.parseInt(toMonth) >= 1
								&& Integer.parseInt(toMonth) <= 3) {
							arreartoDate = "31-Mar-" + toYear;
						} else {
							arreartoDate = "31-Mar-"
									+ String.valueOf(Integer.parseInt(toYear) + 1);
						}
						employee_arrear_breakup_recordexist = "select b.*,to_char(b.arrearformdate,'yyyy') arrfromyear from employee_arrear_breakup b where pensionno='"
								+ tempPensionno + "'";
						rs1 = st.executeQuery(employee_arrear_breakup_recordexist);
						int counter = 0;
						while (rs1.next()) {
							counter++;
							arrearfromDate="01-Apr-"+rs1.getString("arrfromyear");
							// process columns
						}
						if (counter < 1) {
							employee_arrear_breakup = "insert into employee_arrear_breakup (pensionno,cpfaccno,employeename,arrearformdate,arreartodate,airportcode,region,filename,username)values('"
									+ tempPensionno
									+ "','"
									+ tempCpfaccno
									+ "','"
									+ tempEmployeename
									+ "','"
									+ arrearfromDate
									+ "','"
									+ arreartoDate
									+ "','"
									+ tempStation
									+ "','" + tempRegion 
									+ "','"
									+fileName.trim()
									+"','"
									+username.trim()+"')";
							log.info(employee_arrear_breakup);
							st.executeUpdate(employee_arrear_breakup);
							conn.commit();
						}else{
							employee_arrear_breakup = "update employee_arrear_breakup set arreartodate ='"+arreartoDate+"' where pensionno = '"	+ tempPensionno +"' ";						
							log.info(employee_arrear_breakup);
							st.executeUpdate(employee_arrear_breakup);
							conn.commit();
							
					}

						if (wetheroption.trim().equals("A")) {
						String updatevalidatetableflag = "update employee_pension_validate set ARREARSBREAKUP='Y' where monthyear between '"
								+ arrearfromDate
								+ "' and '"
								+ arreartoDate
								+ "' and pensionno='" + tempPensionno + "'";
						log.info("updatevalidatetableflag" + updatevalidatetableflag);
						st.executeUpdate(updatevalidatetableflag);
						String updateImpacttableflag = "update epis_adj_crtnback set ARREARSBREAKUP='Y' where monthyear between '"
							+ arrearfromDate
							+ "' and '"
							+ arreartoDate
							+ "' and pensionno='" + tempPensionno + "'";
					log.info("updateImpacttableflag" + updateImpacttableflag);
					st.executeUpdate(updatevalidatetableflag);
						conn.commit();
						arrearfromDate = tempInfo[8].trim();
						}
						conn.commit();		
						arrearfromDate = tempInfo[8].trim();
					}
					if (wetheroption.trim().equals("B")) {
						String deleteArrearsbreakupQuery = "delete from employee_arrear_breakup where pensionno='"
								+ pensionNo + "'";
						st.executeUpdate(deleteArrearsbreakupQuery);
					}
					fnlDataList.add(bean);
				}
				File outputFile = null;
				outputFile = new File("c://DueDrawnDiffStmt.xls");
				WorkbookSettings ws = new WorkbookSettings();
				ws.setLocale(new Locale("en", "EN"));
				WritableWorkbook workbook = Workbook.createWorkbook(outputFile, ws);
				CommonUtil cUtil = new CommonUtil();
				ArrayList hdrsList = new ArrayList();
				cUtil.createSheet(fnlDataList, "test", workbook, hdrsList);
				workbook.write();
				workbook.close();
				
			} catch (SQLException e) {
				log.printStackTrace(e);
				throw new InvalidDataException(e.getMessage());

			} catch (Exception e) {
				log.printStackTrace(e);
				throw new InvalidDataException(e.getMessage());
			} finally {
				try {
					fw.close();
					st.close();
					rs.close();
					rs1.close();
					conn.close();
				} catch (Exception e) {

				}
			}
			try {
				// updatedBatchCount = st1.executeBatch();
				//System.out.println("updatedBatchCount "+updatedBatchCount.length);
				conn.commit();
			} catch (Exception e) {

			}
			log.info("ImportDao :arrearBreakoutFormat leaving method");
			String Recordinfo = updateRecordsCount + "  Inserted Records count - "
					+ count1;
			message = String.valueOf(Recordinfo);
			return message;
			}	
	public String checkEmoluments(Connection con, String monthyear,
			String Pensionno, String drawnwages) {
		String foundEmpFlag = "", emoluments = "";
		Statement st = null;
		ResultSet rs = null;
		try {
			String query = "select to_number(nvl(emoluments,0)) as emoluments from employee_pension_validate where pensionno='"
					+ Pensionno
					+ "' and to_char(monthyear,'Mon-yyyy') like to_char(ADD_MONTHS('"
					+ monthyear + "',1),'Mon-yyyy') and empflag='Y' ";
			log.info("query" + query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					emoluments = rs.getString("emoluments");
				} else {
					emoluments = "";
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {
			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}
			//this.closeConnection(con, st, rs);
		}
		log.info("emoluments" + emoluments);
		return emoluments;
	}
	public String checkAdjCrtnEmoluments(Connection con, String monthyear,
			String Pensionno, String drawnwages) {
		String foundEmpFlag = "", emoluments = "";
		Statement st = null;
		ResultSet rs = null;
		try {
			String query = "select to_number(nvl(emoluments,0)) as emoluments from epis_adj_crtnback where pensionno='"
					+ Pensionno
					+ "' and to_char(monthyear,'Mon-yyyy') like to_char(ADD_MONTHS('"
					+ monthyear + "',1),'Mon-yyyy') and empflag='Y' ";
			log.info("query" + query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					emoluments = rs.getString("emoluments");
				} else {
					emoluments = "";
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {
			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}
			//this.closeConnection(con, st, rs);
		}
		log.info("emoluments" + emoluments);
		return emoluments;
	}

	public String arrearBreakoutSinglelineSt(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
		log.info("ImportDao :arrearBreakoutSinglelineSt() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		String tempData = "", tempData1 = "";
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		String[] tempInfo = {};
		String[] tempInfo1 = {};
		int updatedBatchCount[] = { 0 };
		int count1 = 0;
		int updateRecordsCount = 0;
		uploadFilePath = "C:\\Pension_Upload";
		File filePath = new File(uploadFilePath);
		FileWriter fw = null;
		try {
			fw = new FileWriter(new File(filePath
					+ "\\arrearbreakupFailure1.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			String srno = "", pensionNo = "", empNo = "", cpfAcno = "", empName = "", desig = "", dateofBirh = "", dateofJoin = "", monthyear = "";
			String arrearamount = "", arrearcontri = "";
			String remarks = "", region = "",checkflag="",form7narration="";
			String count = "";
			String updatesingleline = "";
			String insertsingleline = "";
			String wetheroption = "";
			String airportcode = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				double calculatedPension = 0.00;
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					pensionNo = commonUtil.getSearchPFID1(tempInfo[1].trim());
				} else {
					pensionNo = "";
				}
				if (!tempInfo[2].equals("XXX")) {
					empNo = tempInfo[2].trim();
				} else {
					empNo = "";
				}
				if (!tempInfo[3].equals("XXX")) {
					cpfAcno = tempInfo[3].trim();
				} else {
					cpfAcno = "";
				}
				if (!tempInfo[4].equals("XXX")) {
					empName = tempInfo[4].trim();
				} else {
					empName = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					desig = tempInfo[5].trim();
				} else {
					desig = "";
				}
				if (!tempInfo[6].equals("XXX")) {
					dateofBirh = tempInfo[6].trim();
				} else {
					dateofBirh = "";
				}
				if (!tempInfo[7].equals("XXX")) {
					dateofJoin = tempInfo[7].trim();
				} else {
					dateofJoin = "";
				}
				if (!tempInfo[8].equals("XXX")) {
					monthyear = tempInfo[8].trim();
				} else {
					monthyear = "";
				}
				if (!tempInfo[9].equals("XXX")) {
					arrearamount = tempInfo[9].replaceAll(",", "").trim();
				} else {
					arrearamount = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					arrearcontri = tempInfo[10].replaceAll(",", "").trim();
				} else {
					arrearcontri = "0.00";
				}
				if (!tempInfo[11].equals("XXX")) {
					airportcode = tempInfo[11].trim();
				} else {
					airportcode = "";
				}
				if (!tempInfo[12].equals("XXX")) {
					region = tempInfo[12].trim();
				} else {
					region = "";
				}
				if (!tempInfo[13].equals("XXX")) {
					remarks = tempInfo[13].trim();
				} else {
					remarks = "";
				}
				if (!tempInfo[14].equals("XXX")) {
					checkflag = tempInfo[14].trim();
				} else {
					checkflag = "";
				}
				if (!tempInfo[15].equals("XXX")) {
					form7narration = tempInfo[15].trim();
				} else {
					form7narration = "";
				}
				if (!srno.equals("") && pensionNo.trim().equals("")) {
					throw new InvalidDataException("PFID " + pensionNo.trim()
							+ " doesn't Exist" + " for  Employee " + empName
							+ ". PFID is Mandatory for All The Employees");
				}
				String arrearssum="";
				String transMonthYear = commonUtil.converDBToAppFormat(monthyear.trim(), "dd-MMM-yyyy", "-MMM-yy");
				String arrearsum="select sum(arrearamount) as arrearssum from employee_pension_validate where pensionno='"+pensionNo+"' and arrearsbreakup='Y'";
				rs = st.executeQuery(arrearsum);
				while (rs.next()) {
					if (rs.getString("arrearssum") != null) {
						arrearssum = rs.getString("arrearssum").trim();
					} else {
						arrearssum = "0.00";
					}
				}
				String arrearscontri = String.valueOf(Math.round(Double.parseDouble(arrearamount) * 8.33 / 100));
				if(checkflag.equals("Y")){
				if ((Math.round(Double.parseDouble(arrearssum)))!=(Math.round(Double.parseDouble(arrearscontri)))) {
					throw new InvalidDataException("monthwise arrears sum imported in pensionsystem" + arrearssum
							+ " is not equalto" + " Single line arrears " + arrearscontri
							+ ". For the PFID " + pensionNo.trim()
							+ " and monthyear "+monthyear+"");
				}
				}
				String emoluments = this.checkEmolumentSingleLine(conn,
						monthyear, pensionNo, arrearamount);
				log.info("emoluments" + emoluments);
				//String transMonthYear = commonUtil.converDBToAppFormat(
						//monthyear.trim(), "dd-MMM-yyyy", "-MMM-yy");
				// if(Integer.parseInt(emoluments.trim())>=Integer.parseInt(
				// arrearamount.trim())){
				if (!pensionNo.trim().equals("")) {
					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
							+ tempInfo[8]
							+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
							+ pensionNo + "'";
					log.info(checkPFID);
					rs = st.executeQuery(checkPFID);
					while (rs.next()) {
						if (rs.getString("wetheroption") != null) {
							wetheroption = rs.getString("wetheroption").trim();
						} else {
							wetheroption = "";
						}
						if (rs.getString("REIREMENTDATE") != null) {
							retirementDate = rs.getString("REIREMENTDATE");
						} else {
							retirementDate = "";
						}
						if (rs.getString("dateofbirth") != null) {
							dateofbirth = rs.getString("dateofbirth");
						} else {
							dateofbirth = "";
						}
						String days = "0";
						if (rs.getString("days") != null) {
							days = rs.getString("days");
						} else {
							days = "0";
						}
					}
					FinancialReportDAO fdao = new FinancialReportDAO();
					if (wetheroption.equals("B")) {
						arrearamount = "0";
					}
					arrearcontri = String.valueOf(Math.round(Double.parseDouble(arrearamount) * 8.33 / 100));
					String arrearcheck = "select count(*) as count from employee_pension_arrear where to_char(pensionno)='"
							+ pensionNo
							+ "' and to_char(ARREARDATE,'dd-Mon-yy') like '%"
							+ transMonthYear + "'";
					log.info(arrearcheck);
					rs1 = st.executeQuery(arrearcheck);
					if (rs1.next()) {
						if (rs1.getString("count") != null) {
							count = rs1.getString("count");
						}

					}

					if (!count.trim().equals("0")) {
						if (wetheroption.trim().equals("A")) {
							updatesingleline = "update employee_pension_arrear set ORIGINALARREARAMOUNT='"
									+ arrearamount
									+ "',ORIGINALARREARCONTRIBUTION='"
									+ arrearcontri
									+ "' where pensionno='"
									+ pensionNo
									+ "' and to_char(ARREARDATE,'dd-Mon-yy') like '%"
									+ transMonthYear + "'";
							log.info(updatesingleline);
							st.executeUpdate(updatesingleline);
						}
					} else {
						if (wetheroption.trim().equals("A")) {
							insertsingleline = "insert into employee_pension_arrear (cpfaccno,employeeno,EMPLOYEENAME,arreardate,airportcode,region,remarks,pensionno,ORIGINALARREARAMOUNT,ORIGINALARREARCONTRIBUTION) values('"
									+ cpfAcno
									+ "','"
									+ empNo
									+ "','"
									+ empName
									+ "','"
									+ monthyear
									+ "','"
									+ airportcode
									+ "','"
									+ region
									+ "','"
									+ remarks
									+ "','"
									+ pensionNo
									+ "','"
									+ arrearamount
									+ "','"
									+ arrearcontri + "')";
							log.info(insertsingleline);
							st.executeUpdate(insertsingleline);
						}
					}
				}
				String updateform7narration="update employee_pension_validate set FORM7NARRATION='"+form7narration+"' where pensionno='"+pensionNo+"' and to_char(monthyear,'dd-Mon-yy') like '%"+transMonthYear+"'";
				log.info(updateform7narration);
				st.executeUpdate(updateform7narration);
				// }

				/*
				 * else if(!pensionNo.trim().equals("") &&
				 * (emoluments.trim().equals
				 * ("")||(Integer.parseInt(emoluments.trim
				 * ())<Integer.parseInt(arrearamount.trim())))){ throw new
				 * InvalidDataException
				 * ("Sinlgeline statement emoluments "+arrearamount
				 * +" should not exceed the total emoluments of "
				 * +emoluments.trim
				 * ()+". for pfid "+pensionNo+" monthyear "+monthyear+" "); }
				 */
			}

		} catch (SQLException e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				fw.close();
				st.close();
				rs.close();
				rs1.close();
				conn.close();
			} catch (Exception e) {

			}
		}
		try {
			conn.commit();
		} catch (Exception e) {

		}
		log.info("ImportDao :arrearBreakoutSinglelineSt leaving method");
		return message;

	}

	public String checkEmolumentSingleLine(Connection con, String monthyear,
			String Pensionno, String drawnwages) {
		String foundEmpFlag = "", emoluments = "0";
		Statement st = null;
		ResultSet rs = null;
		try {
			String transMonthYear = commonUtil.converDBToAppFormat(monthyear
					.trim(), "dd-MMM-yyyy", "-MMM-yy");
			String query = "select to_number(nvl(emoluments,0)) as emoluments from employee_pension_validate where pensionno='"
					+ Pensionno
					+ "' and to_char(monthyear,'dd-Mon-yy') like '%"
					+ transMonthYear + "' and empflag='Y' ";
			log.info("query" + query);
			st = con.createStatement();
			rs = st.executeQuery(query);
			if (rs.next()) {
				if (rs.getString("emoluments") != null) {
					emoluments = rs.getString("emoluments");
				} else {
					emoluments = "0";
				}
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {
			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}
			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}
		log.info("emoluments" + emoluments);
		return emoluments;
	}
//	By Radha On 09-Jan-2012 implementing upto 2011-12 Fin Year
	public void pentionContributionProcessAfterOptionChange(String Pfid) {
		log
				.info("ImportDao :pentionContributionProcessAfterOptionChange() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "", pensionno = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			st2 = conn.createStatement();
			CommonUtil cu = new CommonUtil();
			String todate = cu.getDateTime("dd-MMM-yyyy");
			String updatePensionCon = "";
			bean = new EmpMasterBean();
			String checkcontributionUpto = "select pensionno,to_char(monthyear,'dd-Mon-yyyy') as monthyear from employee_pension_validate where pensionno='"
					+ Pfid
					+ "' and monthyear>=to_date('01-Apr-2008','dd-Mon-yyyy') and monthyear<=to_date('31-Mar-2011','dd-Mon-yyyy') and empflag='Y'";

			rs = st1.executeQuery(checkcontributionUpto);

			while (rs.next()) {
				double calculatedPension = 0.00, pf = 0.00;
				bean = new EmpMasterBean();

				if (rs.getString("monthyear") != null) {
					monthYear = rs.getString("monthyear").toString();
				} else {
					monthYear = "";
				}
				if (rs.getString("pensionno") != null) {
					pensionno = rs.getString("pensionno").trim();
				} else {
					pensionno = "";
				}

				String transMonthYear = "";
				if (!pensionno.trim().equals("")) {

					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date(to_char(add_months(TO_DATE('"
							+ monthYear
							+ "'), -1),'dd-Mon-yyyy'),'DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 697),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ pensionno + "'";
					// log.info(checkPFID);
					rs1 = st.executeQuery(checkPFID);

					if (!rs1.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs1.getString("wetheroption") != null) {
						bean.setWetherOption(rs1.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs1.getString("REIREMENTDATE") != null) {
						retirementDate = rs1.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs1.getString("dateofbirth") != null) {
						dateofbirth = rs1.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs1.getString("days") != null) {
						days = rs1.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs1.getString("calPensionupto") != null) {
						calPensionupto = rs1.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					String emolumentsQuery = "select emoluments,EMPPFSTATUARY,airportcode from employee_pension_validate where pensionno='"
							+ pensionno
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and empflag='Y' order by monthyear";
					rs2 = st.executeQuery(emolumentsQuery);
					while (rs2.next()) {
						if (rs2.getString("EMPPFSTATUARY") != null) {
							bean.setEmployeePF(rs2.getString("EMPPFSTATUARY"));
						} else {
							bean.setEmployeePF("0.00");
						}

						if (rs2.getString("emoluments") != null) {
							bean.setEmoluments(rs2.getString("emoluments"));
						} else {
							bean.setEmoluments("0.00");
						}
						if (rs2.getString("airportcode") != null) {
							bean.setStation(rs2.getString("airportcode"));
						}
						DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
						FinancialReportDAO fdao = new FinancialReportDAO();
						calculatedPension = fdao.calclatedPF1(monthYear,
								calPensionupto, dateofbirth, String
										.valueOf(Double.parseDouble(bean
												.getEmployeePF()) * 100 / 12),
								bean.getWetherOption(), "", days, "1", bean
										.getEmployeePF());
						calculatedPension = Math.round(calculatedPension);
						pf = Double.parseDouble(bean.getEmployeePF())
								- calculatedPension;
						String condition = "";
						if ((bean.getStation() != null && bean.getStation() != "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
						updatePensionCon = "update employee_pension_validate set OPCHANGEPF='"
								+ pf
								+ "',OPCHANGEPENSIONCONTRI='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and EMPPFSTATUARY='"
								+ bean.getEmployeePF() + "'";
						st2.executeUpdate(updatePensionCon);
					}
					if (!pensionno.equals("")) {
						String condition = "";
						if ((bean.getStation() != null || bean.getStation() == "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

						updatePensionCon = "update employee_pension_validate set OPCHANGEPF='"
								+ pf
								+ "',OPCHANGEPENSIONCONTRI='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and EMPPFSTATUARY='"
								+ bean.getEmployeePF() + "'";
						st.executeUpdate(updatePensionCon);

					}
					log.info("===pentionContributionProcessAfterOptionChange=="+updatePensionCon);
					

				}

			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} finally {
			try {
				pst.close();
				rs.close();
				rs2.close();
				st1.close();
				st2.close();
				st.close();
				conn.close();
			} catch (Exception e) {

			}
		}

	}

	public void pentionContributionProcessAfterOptionChangeforarrearbreakup(
			String Pfid) {
		log
				.info("ImportDao :pentionContributionProcessAfterOptionChangeforarrearbreakup entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "", pensionno = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			st2 = conn.createStatement();
			CommonUtil cu = new CommonUtil();
			String todate = cu.getDateTime("dd-MMM-yyyy");
			String updatePensionCon = "";
			bean = new EmpMasterBean();
			String checkcontributionUpto = "select pensionno,to_char(monthyear,'dd-Mon-yyyy') as monthyear from employee_pension_validate where pensionno='"
					+ Pfid
					+ "' and (to_number(dueemoluments)>=0 or to_number(dueemoluments)<=0) and empflag='Y'";
			log.info(checkcontributionUpto);
			rs = st1.executeQuery(checkcontributionUpto);

			while (rs.next()) {
				double calculatedPension = 0.00, pf = 0.00;
				bean = new EmpMasterBean();

				if (rs.getString("monthyear") != null) {
					monthYear = rs.getString("monthyear").toString();
				} else {
					monthYear = "";
				}
				if (rs.getString("pensionno") != null) {
					pensionno = rs.getString("pensionno").trim();
				} else {
					pensionno = "";
				}

				String transMonthYear = "";
				if (!pensionno.trim().equals("")) {

					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date(to_char(add_months(TO_DATE('"
							+ monthYear
							+ "'), -1),'dd-Mon-yyyy'),'DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 697),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ pensionno + "'";
					// log.info(checkPFID);
					rs1 = st.executeQuery(checkPFID);

					if (!rs1.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs1.getString("wetheroption") != null) {
						bean.setWetherOption(rs1.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs1.getString("REIREMENTDATE") != null) {
						retirementDate = rs1.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs1.getString("dateofbirth") != null) {
						dateofbirth = rs1.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs1.getString("days") != null) {
						days = rs1.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs1.getString("calPensionupto") != null) {
						calPensionupto = rs1.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					String emolumentsQuery = "select dueemoluments,airportcode from employee_pension_validate where pensionno='"
							+ pensionno
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and empflag='Y' order by monthyear";
					rs2 = st.executeQuery(emolumentsQuery);
					while (rs2.next()) {

						if (rs2.getString("dueemoluments") != null) {
							bean.setDueEmoluments(rs2
									.getString("dueemoluments"));
						}
						if (rs2.getString("airportcode") != null) {
							bean.setStation(rs2.getString("airportcode"));
						}
						DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
						FinancialReportDAO fdao = new FinancialReportDAO();
						calculatedPension = commonDAO.calclatedPF(monthYear,
								calPensionupto, dateofbirth, bean
										.getDueEmoluments(), bean
										.getWetherOption(), "", days, "1");
						calculatedPension = Math.round(calculatedPension);
						String condition = "";
						if ((bean.getStation() != null && bean.getStation() != "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
						updatePensionCon = "update employee_pension_validate set arrearamount='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and dueemoluments='"
								+ bean.getDueEmoluments() + "'";
						log.info(updatePensionCon);
						st2.executeUpdate(updatePensionCon);

					}
					if (!pensionno.equals("")) {
						String condition = "";
						if ((bean.getStation() != null || bean.getStation() == "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

						updatePensionCon = "update employee_pension_validate set arrearamount='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and dueemoluments='"
								+ bean.getDueEmoluments() + "'";
						st.executeUpdate(updatePensionCon);
						log.info(updatePensionCon);
					}

				}

			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} finally {
			try {
				pst.close();
				rs.close();
				rs2.close();
				st1.close();
				st2.close();
				st.close();
				conn.close();
			} catch (Exception e) {

			}
		}

	}
//	 New  readPensionOptionChangeData
	public String readPensionOptionChangeData(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
	 
		log.info("ImportDao :readPensionOptionChangeData() entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		ResultSet rs = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "",OldPensionOption ="",newPensionOption = "",insert_pension_option_data="",select_pension_option_data = "";
		String xlsEmpName = "",message = "",statusFlag ="",insertStatus = "N",updateDate="";
		StringBuffer  existedRecord = new StringBuffer();
		int[] insertBatchCount = null;
		int count =0,dateDiffCnt = 0;
		boolean insertFlag = false;
	    long dateDiff =  0;
		String currentDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
		// cpfAccNum = this.getMaxValue();
		// bean.setCpfAcNo(cpfAccNum);
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//pensionoption.txt"));
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			log.info("--------xlsDataList-------"+xlsDataList.size());
			for (int i = 0; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				log.info("hedername" + tempInfo[0].trim());
				
				if (!tempInfo[0].equals("XXX")) {
					bean.setPensionNumber(tempInfo[0].trim());
				} else {
					bean.setPensionNumber("");
				}
				if (!tempInfo[1].equals("XXX")) {
					bean.setWetherOption(tempInfo[1].trim());
				} else {
					bean.setWetherOption("");
				}
				 								
				 select_pension_option_data ="select status,to_char(UPDATEDDATE,'dd-Mon-yyyy') as UPDATEDDATE from employee_pension_option where pensionno="+bean.getPensionNumber();
				 rs = st1.executeQuery(select_pension_option_data);
			  log.info("-----inseide-------"+select_pension_option_data);
				 if(rs.next()){						 
					 if((rs.getString("status"))!=null){
						 statusFlag = rs.getString("status") ;
					 }else{
						 statusFlag = "";					 
					 }					  
					 if((rs.getString("UPDATEDDATE"))!=null){
						updateDate = rs.getString("UPDATEDDATE");
					 }else{
						 updateDate = "";						 
					 }					 
					 	insertStatus = "Y";						 	
					  dateDiff =  commonUtil.getDateDifference(currentDate,updateDate);
						   
				 	}
				 
				  
				 log.info("-insertStatus--"+insertStatus+"--statusFlag---"+statusFlag+"--dateDiff--"+dateDiff);
				 if(insertStatus.equals("Y") && statusFlag.equals("N") && dateDiff==0){
					 dateDiffCnt++;
				 }	 
				if((insertStatus.equals("N")) ||((insertStatus.equals("Y") && statusFlag.equals("N") && dateDiff == 0))) {
					  
					insert_pension_option_data  ="insert into employee_pension_option (PENSIONNO,EMPLOYEENAME,DATEOFBIRTH ,OLDWETHEROPTION ,NEWWETHEROPTION , USERNAME ,COMPUTERNAME, UPDATEDDATE ,STATUS)"
						     + "select PENSIONNO,EMPLOYEENAME,DATEOFBIRTH,trim(WETHEROPTION),'"+bean.getWetherOption()+"', '"+userName+"', '"+ipAddress+"','"+currentDate+"','N' from employee_personal_info where pensionno ="+bean.getPensionNumber();
					
					st.addBatch(insert_pension_option_data);
					insertFlag = true;
					log.info("--insert_pension_option_data---"+insert_pension_option_data);
				}else {					
					count++;
					existedRecord.append(bean.getPensionNumber());
					existedRecord.append(",");
				}
			} 		
			if(dateDiffCnt==0){
				if (insertFlag) {
					insertBatchCount = st.executeBatch();
					log.info("inserted Records count is "+ insertBatchCount.length);
					log.info("Already Existed Records count is "+ count +"--Pension Nos Are ----"+existedRecord.toString());
					if(count!=0){
						message = "No.of Records inserted "+insertBatchCount.length+" And No.of Records Already Existed "+count;	
					}else{
						message = "No.of Records inserted "+insertBatchCount.length;	
					}					
				}else{
					log.info("Already Existed Records count is "+ count +"--Pension Nos Are ----"+existedRecord.toString());
					message = "No.of Records Already Existed "+count;	
					}	
			  }else{
				  log.info("dateDiffCnt -- count is "+ dateDiffCnt); 
				  message = "Please Process the pfids First";
			  }
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				log.printStackTrace(e);
				throw new InvalidDataException(e.getMessage());

			} catch (Exception e) {
				// TODO Auto-generated catch block
				log.printStackTrace(e);
				throw new InvalidDataException(e.getMessage());
			} finally {
				try {					 
					st.close();	
					st1.close();
					 rs.close();
					conn.close();
				} catch (Exception e) {
				}
		}		
		 
		log.info("ImportDao :readPensionOptionChangeData() leaving method");
	 return message;
	}
	public String eRarrearbreakoutformat(String xlsData, String userName,
			String ipAddress) throws InvalidDataException {
    	log.info("ImportDao :arrearBreakupFormat() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		String tempData = "", tempData1 = "";
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		String[] tempInfo = {};
		String[] tempInfo1 = {};
		int updatedBatchCount[] = { 0 };
		int count1 = 0;
		int updateRecordsCount = 0;
		uploadFilePath = "C:\\Pension_Upload";
		File filePath = new File(uploadFilePath);
		FileWriter fw = null;
		try {
			fw = new FileWriter(new File(filePath
					+ "\\arrearbreakupFailure1.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			String srno = "", pensionNo = "", empNo = "", cpfAcno = "", empName = "", desig = "", dateofBirh = "", dateofJoin = "", monthyear = "";
			String duewages = "", drawnwages = "", diffwages = "";
			String duecontri = "", drawncontri = "", diffcontri = "", remarks = "", region = "";
			String arrearfromDate = "";
			String arreartoDate = "";
			String employee_arrear_breakup = "";
			String employee_arrear_breakup_recordexist = "";
			String wetheroption = "";
			String tempPensionno = "", tempEmployeename = "", airportcode = "", tempStation = "", tempRegion = "", tempCpfaccno = "";
			for (int i = 1; i < xlsDataList.size(); i++) {
				double calculatedPension = 0.00;
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				if (i == 1) {
					tempPensionno = commonUtil.getSearchPFID1(tempInfo[1]
							.trim());
					arrearfromDate = tempInfo[8].trim();
				}

				if (!tempInfo[0].equals("XXX")) {
					srno = tempInfo[0];
				} else {
					srno = "";
				}
				if (!tempInfo[1].equals("XXX")) {
					pensionNo = commonUtil.getSearchPFID1(tempInfo[1].trim());
				} else {
					pensionNo = "";
				}
				if (!tempPensionno.equals(pensionNo)) {
					tempData1 = xlsDataList.get(i - 1).toString();
					tempInfo1 = tempData1.split("@");
					arreartoDate = tempInfo1[8].trim();
					tempPensionno = commonUtil.getSearchPFID1(tempInfo1[1]
							.trim());
					tempEmployeename = tempInfo1[4].trim();
					if (!tempInfo1[11].trim().equals("XXX")) {
						tempStation = tempInfo1[11].trim();
					} else {
						tempStation = "";
					}
					if (!tempInfo1[12].trim().equals("XXX")) {
						tempRegion = tempInfo1[12].trim();
					} else {
						tempRegion = "";
					}
					if (!tempInfo1[3].trim().equals("XXX")) {
						tempCpfaccno = tempInfo1[3].trim();
					} else {
						tempCpfaccno = "";
					}
					log.info("tempPensionno ** " + tempPensionno
							+ "pensionNo ** " + pensionNo);
				}
				if (!tempInfo[2].equals("XXX")) {
					empNo = tempInfo[2].trim();
				} else {
					empNo = "";
				}
				if (!tempInfo[3].equals("XXX")) {
					cpfAcno = tempInfo[3].trim();
				} else {
					cpfAcno = "";
				}
				if (!tempInfo[4].equals("XXX")) {
					empName = tempInfo[4].trim();
				} else {
					empName = "";
				}
				if (!tempInfo[5].equals("XXX")) {
					desig = tempInfo[5].trim();
				} else {
					desig = "";
				}
				if (!tempInfo[6].equals("XXX")) {
					dateofBirh = tempInfo[6].trim();
				} else {
					dateofBirh = "";
				}
				if (!tempInfo[7].equals("XXX")) {
					dateofJoin = tempInfo[7].trim();
				} else {
					dateofJoin = "";
				}

				if (!tempInfo[8].equals("XXX")) {
					monthyear = tempInfo[8].trim();
				} else {
					monthyear = "";
				}
				Date transdate = null;
				log.info("monthyear" + monthyear);
				String monthyear2 = "";
				if (!tempInfo[8].equals("XXX") && !pensionNo.trim().equals("")) {
					String monthyearQuery = "SELECT  to_char(add_months('"
							+ tempInfo[8].trim()
							+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
					rs = st.executeQuery(monthyearQuery);
					if (rs.next()) {
						monthyear2 = rs.getString(1);
					}
				}
				// log.info("monthyear 2 " + monthyear2);
				if (!tempInfo[9].equals("XXX")) {
					duewages = tempInfo[9].replaceAll(",", "").trim();
				} else {
					duewages = "0.00";
				}
				if (!tempInfo[10].equals("XXX")) {
					diffcontri = tempInfo[10].replaceAll(",", "").trim();
				} else {
					diffcontri = "0.00";
				}
				if (!tempInfo[11].equals("XXX")) {
					airportcode = tempInfo[11].trim();
				} else {
					airportcode = "";
				}
				if (!tempInfo[12].equals("XXX")) {
					region = tempInfo[12].trim();
				} else {
					region = "";
				}
				if (!tempInfo[13].equals("XXX")) {
					remarks = tempInfo[13].trim();
				} else {
					remarks = "";
				}
				if (!srno.equals("") && pensionNo.trim().equals("")) {
					throw new InvalidDataException("PFID " + pensionNo.trim()
							+ " doesn't Exist" + " for  Employee " + empName
							+ ". PFID is Mandatory for All The Employees");
				}

				String emoluments = this.checkEmoluments(conn, monthyear,
						pensionNo, drawnwages);
				// log.info("emoluments"+emoluments);
				String transMonthYear = commonUtil.converDBToAppFormat(
						monthyear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
				if (!emoluments.equals("") && emoluments != "0") {
					if (!pensionNo.trim().equals("")) {
						// if(!tempInfo[1].equals("XXX")){
						String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
								+ tempInfo[8]
								+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
								+ pensionNo + "'";
						log.info(checkPFID);
						rs = st.executeQuery(checkPFID);

						if (!rs.next()) {
							throw new InvalidDataException(
									"PFID "
											+ pensionNo
											+ " doesn't Exist"
											+ " for  Employee "
											+ empName
											+ ". PFID is Mandatory for All The Employees");
						}
						if (rs.getString("wetheroption") != null) {
							wetheroption = rs.getString("wetheroption")
									.toString();
						} else {
							wetheroption = "";
						}
						if (rs.getString("REIREMENTDATE") != null) {
							retirementDate = rs.getString("REIREMENTDATE");
						} else {
							retirementDate = "";
						}
						if (rs.getString("dateofbirth") != null) {
							dateofbirth = rs.getString("dateofbirth");
						} else {
							dateofbirth = "";
						}
						String days = "0";
						if (rs.getString("days") != null) {
							days = rs.getString("days");
						} else {
							days = "0";
						}

						/*comment for biswas
						  diffwages = String.valueOf(Math.round(Double
								.parseDouble(duewages)
								- Double.parseDouble(emoluments)));*/
						diffwages=duewages;
					 log.info("diffwages"+diffwages);
					 /*comment for biswas
						diffcontri = String.valueOf(Math.round((Double
								.parseDouble(diffwages) * 8.33 / 100)));*/
						 diffcontri=diffcontri;
					
						  FinancialReportDAO fdao = new FinancialReportDAO();
						String calccontri = String.valueOf(Math.round(commonDAO
								.calclatedPF(monthyear, retirementDate,
										dateofbirth, diffwages, wetheroption,
										"", days, "1")));				
						if (calccontri.equals("0")) {
							diffwages = "0";
							diffcontri="0";
						} else if ((Integer.parseInt(days) >= 0 && Integer
								.parseInt(days) <= 1)
								|| (Integer.parseInt(days) < 0 && Integer
										.parseInt(days) > -29)) {
							diffwages = String.valueOf(Math.round(Double
									.parseDouble(diffcontri)
									* (100 / 8.33)));
						}						
					}
					if (wetheroption.trim().equals("A")) {
						String addArrears = "update employee_pension_validate set arrearamount='"
								+ diffcontri
								+ "',dueemoluments='"
								+ diffwages
								+ "',arrearsbreakup='Y' where pensionno='"
								+ pensionNo
								+ "' and to_char(monthyear,'Mon-yyyy') like to_char(ADD_MONTHS('"
								+ monthyear
								+ "',1),'Mon-yyyy') AND EMPFLAG='Y'";
						st.executeUpdate(addArrears);

						updateRecordsCount = updateRecordsCount + 1;
						log.info("updateRecordsCount " + updateRecordsCount);
						log.info("addArrears" + addArrears);
						updateflag = true;
					}
				} else {
					if (!pensionNo.trim().equals("")) {
						// if(!tempInfo[1].equals("XXX")){
						String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
								+ tempInfo[8]
								+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days from employee_personal_info where to_char(pensionno)='"
								+ pensionNo + "'";
						log.info(checkPFID);
						rs = st.executeQuery(checkPFID);

						if (!rs.next()) {
							throw new InvalidDataException(
									"PFID "
											+ pensionNo
											+ " doesn't Exist"
											+ " for  Employee "
											+ empName
											+ ". PFID is Mandatory for All The Employees");
						}
						if (rs.getString("wetheroption") != null) {
							wetheroption = rs.getString("wetheroption")
									.toString();
						} else {
							wetheroption = "";
						}
						if (rs.getString("REIREMENTDATE") != null) {
							retirementDate = rs.getString("REIREMENTDATE");
						} else {
							retirementDate = "";
						}
						if (rs.getString("dateofbirth") != null) {
							dateofbirth = rs.getString("dateofbirth");
						} else {
							dateofbirth = "";
						}
						String days = "0";
						if (rs.getString("days") != null) {
							days = rs.getString("days");
						} else {
							days = "0";
						}
						diffwages = String.valueOf(Math.round(Double
								.parseDouble(duewages)));
						log.info("diffwages" + diffwages);
						/*comment for biswas
						 * diffcontri = String.valueOf(Math.round((Double
								.parseDouble(diffwages) * 8.33 / 100)));*/

						FinancialReportDAO fdao = new FinancialReportDAO();
						String calccontri = String.valueOf(Math.round(commonDAO
								.calclatedPF(monthyear, retirementDate,
										dateofbirth, diffwages, wetheroption,
										"", days, "1")));

						if (calccontri.equals("0") && calccontri == "0") {
							diffwages = "0";
							diffcontri="0";
						} else if ((Integer.parseInt(days) >= 0 && Integer
								.parseInt(days) <= 1)
								|| (Integer.parseInt(days) < 0 && Integer
										.parseInt(days) > -29)) {
							diffwages = String.valueOf(Math.round(Double
									.parseDouble(diffcontri)
									* (100 / 8.33)));
						}					
					}
					if (wetheroption.trim().equals("A")) {
						String insertarrears = "insert into employee_pension_validate(pensionno,arrearamount,dueemoluments,arrearsbreakup,employeename,emoluments,emppfstatuary,empvpf,empadvrecprincipal,empadvrecinterest,monthyear) values('"
								+ pensionNo
								+ "','"
								+ diffcontri
								+ "','"
								+ duewages
								+ "','Y','"
								+ empName
								+ "','0','0','0','0','0',to_char(ADD_MONTHS('"
								+ monthyear + "',1),'dd-Mon-yyyy'))";
						st.executeUpdate(insertarrears);
					}
					if (!filePath.exists()) {
						filePath.mkdirs();
					}

					fw.write("PensionNo" + pensionNo + "/n");
					fw.flush();
					count1 = count1 + 1;
					log.info("count1= " + count1);
					log.info("Inserted Records count is " + count1);
				}

				if (!tempPensionno.equals(pensionNo)) {
					arrearfromDate = commonUtil.converDBToAppFormat(
							arrearfromDate
									.substring(2, arrearfromDate.length()),
							"MMM-yyyy", "MM-yyyy");
					arreartoDate = commonUtil.converDBToAppFormat(arreartoDate
							.substring(2, arreartoDate.length()), "MMM-yyyy",
							"MM-yyyy");
					String fromMonth = arrearfromDate.substring(0, 2);
					String fromYear = arrearfromDate.substring(3,
							arrearfromDate.length());
					String toMonth = arreartoDate.substring(0, 2);
					String toYear = arreartoDate.substring(3, arreartoDate
							.length());
					System.out.println("arrearfromDate " + arrearfromDate + ""
							+ "arreartoDate " + arreartoDate);
					System.out.println("fromMonth " + fromMonth + ""
							+ "fromYear " + fromYear);
					if (Integer.parseInt(fromMonth) >= 1
							&& Integer.parseInt(fromMonth) <= 3) {
						arrearfromDate = "01-Apr-"
								+ String
										.valueOf(Integer.parseInt(fromYear) - 1);
					} else {
						arrearfromDate = "01-Apr-" + fromYear;
					}
					if (Integer.parseInt(toMonth) >= 1
							&& Integer.parseInt(toMonth) <= 3) {
						arreartoDate = "31-Mar-" + toYear;
					} else {
						arreartoDate = "31-Mar-"
								+ String.valueOf(Integer.parseInt(toYear) + 1);
					}
					employee_arrear_breakup_recordexist = "select * from employee_arrear_breakup where pensionno='"
							+ tempPensionno + "'";
					rs1 = st.executeQuery(employee_arrear_breakup_recordexist);
					int counter = 0;
					while (rs1.next()) {
						counter++;
						// process columns
					}
					if (counter < 1) {
						employee_arrear_breakup = "insert into employee_arrear_breakup (pensionno,cpfaccno,employeename,arrearformdate,arreartodate,airportcode,region)values('"
								+ tempPensionno
								+ "','"
								+ tempCpfaccno
								+ "','"
								+ tempEmployeename
								+ "','"
								+ arrearfromDate
								+ "','"
								+ arreartoDate
								+ "','"
								+ tempStation
								+ "','" + tempRegion + "')";
						log.info(employee_arrear_breakup);
						st.executeUpdate(employee_arrear_breakup);
						conn.commit();
					}
					if (wetheroption.trim().equals("A")) {
					String updatevalidatetableflag = "update employee_pension_validate set ARREARSBREAKUP='Y' where monthyear between '"
							+ arrearfromDate
							+ "' and '"
							+ arreartoDate
							+ "' and pensionno='" + tempPensionno + "'";
					log.info("" + updatevalidatetableflag);
					st.executeUpdate(updatevalidatetableflag);
					}
					conn.commit();
					arrearfromDate = tempInfo[8].trim();
				}	
				if (wetheroption.trim().equals("B")) {
					String deleteArrearsbreakupQuery = "delete from employee_arrear_breakup where pensionno='"
							+ pensionNo + "'";
					st.executeUpdate(deleteArrearsbreakupQuery);
				}
			}
			
		} catch (SQLException e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());

		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
		} finally {
			try {
				fw.close();
				st.close();
				rs.close();
				rs1.close();
				conn.close();
			} catch (Exception e) {

			}
		}
		try {
			// updatedBatchCount = st1.executeBatch();
			//System.out.println("updatedBatchCount "+updatedBatchCount.length);
			conn.commit();
		} catch (Exception e) {

		}
		log.info("ImportDao :arrearBreakoutFormat leaving method");
		String Recordinfo = updateRecordsCount + "  Inserted Records count - "
				+ count1;
		message = String.valueOf(Recordinfo);
		return message;
	}
	  
	 public void pentionContributionProcess2008to11(String region, String Pfid) {
		log.info("ImportDao :pentionContributionProcess() entering method");
		String message = "";
		ArrayList xlsDataList = new ArrayList();
		FinancialReportDAO fDao = new FinancialReportDAO();
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "";
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "", monthYear = "", dateofbirth = "", pensionno = "";
		PreparedStatement pst = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		String foundSalaryDate = "", retirementDate = "";
		boolean addflag = false;
		boolean updateflag = false;
		int addBatchcount[] = { 0 };
		try {
			conn = commonDB.getConnection();
			st = conn.createStatement();
			st1 = conn.createStatement();
			st2 = conn.createStatement();
			String airportQuery = "select nvl(airportcode,'X')as airportcode from epis_bulk_print_pfids where pensionno='"
					+ Pfid + "'";
			rs1 = st.executeQuery(airportQuery);
			String airportcode = "";
			if (rs1.next()) {
				airportcode = rs1.getString("airportcode");
			}
			CommonUtil cu = new CommonUtil();
			String todate = cu.getDateTime("dd-MMM-yyyy");
			String checkcontributionUpto = "select pensionno,to_char(monthyear,'dd-Mon-yyyy') as monthyear from employee_pension_validate where pensionno='"
					+ Pfid
					+ "' and monthyear>=to_date('01-Apr-2010','dd-Mon-yyyy') and monthyear<=to_date('"
					+ todate
					+ "','dd-Mon-yyyy') and edittrans='N' AND empflag='Y'";
			rs = st1.executeQuery(checkcontributionUpto);

			while (rs.next()) {
				double calculatedPension = 0.00, pf = 0.00;
				bean = new EmpMasterBean();

				if (rs.getString("monthyear") != null) {
					monthYear = rs.getString("monthyear").toString();
				} else {
					monthYear = "";
				}
				if (rs.getString("pensionno") != null) {
					pensionno = rs.getString("pensionno").trim();
				} else {
					pensionno = "";
				}

				String transMonthYear = "";

				if (!pensionno.trim().equals("")) {

					String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date(to_char(add_months(TO_DATE('"
							+ monthYear
							+ "'), -1),'dd-Mon-yyyy'),'DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
							+ pensionno + "'";
					// log.info(checkPFID);
					rs1 = st.executeQuery(checkPFID);

					if (!rs1.next()) {
						throw new InvalidDataException("PFID "
								+ bean.getPfid().trim() + " doesn't Exist"
								+ " for  Employee " + bean.getEmpName()
								+ ". PFID is Mandatory for All The Employees");
					}
					if (rs1.getString("wetheroption") != null) {
						bean.setWetherOption(rs1.getString("wetheroption"));
					} else {
						bean.setWetherOption("");
					}
					if (rs1.getString("REIREMENTDATE") != null) {
						retirementDate = rs1.getString("REIREMENTDATE");
					} else {
						retirementDate = "";
					}
					if (rs1.getString("dateofbirth") != null) {
						dateofbirth = rs1.getString("dateofbirth");
					} else {
						dateofbirth = "";
					}
					String days = "0";
					if (rs1.getString("days") != null) {
						days = rs1.getString("days");
					} else {
						days = "0";
					}
					String calPensionupto = "";
					if (rs1.getString("calPensionupto") != null) {
						calPensionupto = rs1.getString("calPensionupto");
					} else {
						calPensionupto = "0";
					}

					transMonthYear = commonUtil.converDBToAppFormat(monthYear
							.trim(), "dd-MMM-yyyy", "-MMM-yyyy");
					String emolumentsQuery = "select emoluments,EMPPFSTATUARY,airportcode from employee_pension_validate where pensionno='"
							+ pensionno
							+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
							+ transMonthYear
							+ "' and edittrans='N' and empflag='Y' order by monthyear";
					// log.info(emolumentsQuery);
					rs2 = st.executeQuery(emolumentsQuery);

					// code changed as on 25-Oct-2010
					/*
					 * if (rs2.next()) {
					 * 
					 * if (rs2.getString("emoluments") != null) {
					 * bean.setEmoluments(rs2.getString("emoluments")); } } else
					 * { bean.setEmoluments("0.00"); }
					 */
					while (rs2.next()) {
						if (rs2.getString("EMPPFSTATUARY") != null) {
							bean.setEmployeePF(rs2.getString("EMPPFSTATUARY"));
						} else {
							bean.setEmployeePF("0.00");
						}

						if (rs2.getString("emoluments") != null) {
							bean.setEmoluments(rs2.getString("emoluments"));
						} else {
							bean.setEmoluments("0.00");
						}
						if (rs2.getString("airportcode") != null) {
							bean.setStation(rs2.getString("airportcode"));
						}

						// log.info("emoluments" + bean.getEmoluments() +
						// "monthYear "+ monthYear);
						Date transdate = null;
						DateFormat df = new SimpleDateFormat("dd-MMM-yyyy");
						transdate = df.parse(monthYear);
						float cpfarrear = 0;
						String emolumetns = "0";
						if (airportcode.equals("CHQNAD")
								|| airportcode.equals("OFFICE COMPLEX")) {
							if (transdate.after(new Date("31-Mar-1998"))
									&& transdate
											.before(new Date("31-Mar-2008"))) {
								bean.setEmployeePF(String
										.valueOf(Float.parseFloat(bean
												.getEmoluments()) * 12 / 100));
							} else {
								// bean.setEmployeePF(String.valueOf(Float.
								// parseFloat(bean.getEmoluments()) * 10 /
								// 100));
							}
							emolumetns = bean.getEmoluments();
						} else {
							if (transdate.after(new Date("31-Mar-1998"))
									&& transdate
											.before(new Date("31-Mar-2008"))) {
								bean.setEmployeePF(String.valueOf(Math
										.round(Double.parseDouble(bean
												.getEmoluments()) * 12 / 100)));
								log.info(" pf is : " + bean.getEmployeePF());
							} else {
								// bean.setEmployeePF(String.valueOf(Math.round(
								// Double.parseDouble(bean.getEmoluments())* 10
								// / 100)));
							}
							emolumetns = String.valueOf(Math.round(Double
									.parseDouble(bean.getEmoluments())));
						}
						// log.info(" pf is : " + bean.getEmployeePF());
						FinancialReportDAO fdao = new FinancialReportDAO();
						calculatedPension = fdao.calclatedPF1(monthYear,
								calPensionupto, dateofbirth, String
										.valueOf(Double.parseDouble(bean
												.getEmployeePF()) * 100 / 12),
								bean.getWetherOption(), "", days, "1", bean
										.getEmployeePF());
						if (airportcode.equals("CHQNAD")
								|| airportcode.equals("OFFICE COMPLEX")) {
							calculatedPension = Math.round(calculatedPension);
							pf = Double.parseDouble(bean.getEmployeePF()
									.toString())
									- calculatedPension;
							// pf = Math.round(pf);
						} else {
							calculatedPension = Math.round(calculatedPension);
							pf = Double.parseDouble(bean.getEmployeePF())
									- calculatedPension;

						}

						String condition = "";
						if ((bean.getStation() != null && bean.getStation() != "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						String insertPensionCon = "", updatePensionCon = "";
						float basicDaSum = 0;
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

						insertPensionCon = "update employee_pension_validate set pf='"
								+ pf
								+ "',PENSIONCONTRI='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and edittrans='N' and EMPPFSTATUARY='"
								+ bean.getEmployeePF() + "'";

						// log.info(insertPensionCon);
						// log.info(updatePensionCon);
						st2.executeUpdate(insertPensionCon);

					}
					if (!pensionno.equals("")) {
						String condition = "";
						if ((bean.getStation() != null || bean.getStation() == "")) {
							condition = "and airportcode='" + bean.getStation()
									+ "'";
						}
						String insertPensionCon = "", updatePensionCon = "";
						float basicDaSum = 0;
						transMonthYear = commonUtil.converDBToAppFormat(
								monthYear.trim(), "dd-MMM-yyyy", "-MMM-yyyy");

						insertPensionCon = "update employee_pension_validate set pf='"
								+ pf
								+ "',PENSIONCONTRI='"
								+ calculatedPension
								+ "'  where pensionno='"
								+ pensionno
								+ "' and to_char(monthyear,'dd-Mon-yyyy') like '%"
								+ transMonthYear
								+ "' "
								+ condition
								+ " and empflag='Y' and edittrans='N' and EMPPFSTATUARY='"
								+ bean.getEmployeePF() + "'";
						// log.info(insertPensionCon);
						// log.info(updatePensionCon);
						st.executeUpdate(insertPensionCon);

					}

				}

			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} catch (Exception e) {
			// TODO Auto-generated catch block
			log.printStackTrace(e);

		} finally {
			try {
				pst.close();
				rs.close();
				rs2.close();
				st1.close();
				st.close();
				conn.close();
			} catch (Exception e) {

			}
		}

	}
	
	public void importCpfData(String xlsData) throws InvalidDataException {
		log.info("ImportDao :importCpfData entering method");
		ArrayList xlsDataList = new ArrayList();
		xlsDataList = commonUtil.getTheList(xlsData, "***");
		Connection conn = null;
		Statement st = null;
		Statement st1 = null;
		Statement upst = null;
		EmpMasterBean bean = null;
		String tempInfo[] = null;
		String tempData = "",userName="";
		int pensionno=0;
		FileWriter fw = null;
		char[] delimiters = { '"', ',', '\'', '*', ',' };
		String quats[] = { "Mrs.", "DR.", "Mr.", "Ms.", "SH.", "smt." };
		String uploadFilePath = "";
		String xlsEmpName = "",editransflag="";
		boolean flag= false;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		int result=0;
		log.debug("xlsData " + xlsData + "Size" + xlsDataList.size());

		try {
			ResourceBundle bundle = ResourceBundle
					.getBundle("aims.resource.DbProperties");
			uploadFilePath = bundle.getString("upload.folder.path");
			File filePath = new File(uploadFilePath);
			if (!filePath.exists()) {
				filePath.mkdirs();
			}
			fw = new FileWriter(new File(filePath + "//recordMissing.txt"));
			conn = commonDB.getConnection();
			conn.setAutoCommit(false);
			st = conn.createStatement();
			st1 = conn.createStatement();
			upst=conn.createStatement();
			for (int i = 1; i < xlsDataList.size(); i++) {
				bean = new EmpMasterBean();
				tempData = xlsDataList.get(i).toString();
				tempInfo = tempData.split("@");
				String  monthyear = "", emoluments = "",pc="", epf = "", principle = "", interest = "",airportcCode="",region="";
				
				String monthYear = "", pensionNo = "";
				if (!tempInfo[0].equals("XXX")) {
					pensionno = Integer.parseInt(tempInfo[0].trim());
				} else {
					pensionno = 0;
				}
				if (!tempInfo[1].equals("XXX")) {
					monthYear = tempInfo[1].trim();
				} else {
					monthYear = "";
				}

				if (!tempInfo[2].equals("XXX")) {
					emoluments=tempInfo[2].trim();
				} else {
					emoluments ="0.00";
				}

				if (!tempInfo[3].equals("XXX")) {
					epf = tempInfo[3].trim();
				} else {
					epf = "0.00";
				}
				if (!tempInfo[4].equals("XXX")) {
					principle = tempInfo[4].trim();
				} else {
					principle = "0.00";
				}
				if (!tempInfo[5].equals("XXX")) {
					interest = tempInfo[5].trim();
				} else {
					interest = "0.00";
				}
				if (!tempInfo[6].equals("XXX")) {
					pc = tempInfo[6].trim();
				} else {
					pc = "0.00";
				}
				if (!tempInfo[9].equals("XXX")) {
					editransflag = tempInfo[9].trim();
				} else {
					editransflag = "N";
				}
				//airportcode&region
				if (!tempInfo[7].equals("XXX")) {
					airportcCode = tempInfo[7].trim();
				} else {
					airportcCode = "";
				}
				if (!tempInfo[8].equals("XXX")) {
					region = tempInfo[8].trim();
				} else {
					region = "";
				}
				if (!tempInfo[10].equals("XXX")) {
					userName = tempInfo[10].trim();
				} else {
					throw new Exception("User Name Mandatory");
				}
				log.info("username "+userName);
			
				log.info("editransflag"+editransflag+"monthYear"+monthYear);
					String monthYear1="01-"+ monthYear;
				//new code
				//String monthYear1=commonUtil.converDBToAppFormat(monthYear,"dd MM yyyy hh:mm:ss","dd-MMM-yyyy");
				String checkMonthyear="select to_char(MONTHYEAR,'Mon-yyyy') as MONTHYEAR from epis_adj_crtn where pensionno='"+pensionno+"'";
				log.info("checkMonthyear"+checkMonthyear);
				String monthy=commonUtil.converDBToAppFormat(monthYear,"MMM-yy","MMM-yyyy");

				String insertCpfData = "insert into epis_adj_crtn_temp (PENSIONNO,MONTHYEAR,EMOLUMENTS,EMPPFSTATUARY,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,AIRPORTCODE,REGION,username) values('"
						+ pensionno
						+ "','"
						+ monthYear1
						+ "','"
						+ emoluments
						+ "','"
						+ epf
						+ "','"
						+ principle
						+ "','"
						+interest
						+"','"
						+ airportcCode
						+ "','"
						+ region
						+ "','"
						+ userName+"')";
				rs=st.executeQuery(checkMonthyear);
				while(rs.next()){
					//log.info("monthYear"+monthYear+"monthYear11"+rs.getString("MONTHYEAR"));
					
					log.info("monthy"+monthy+"22"+rs.getString("MONTHYEAR"));
					flag=commonUtil.compareTwoDates1(monthy,rs.getString("MONTHYEAR"));
					log.info("flag"+flag);
					if(flag==true){
						break;
					}
				}
				
				if(flag==false){
				
					log.info("insertCpfData "+insertCpfData);
					st1.addBatch(insertCpfData);
					}

					String updateCPFData="";
					
					if (editransflag.equals("Y")){
						 updateCPFData ="UPDATE epis_adj_crtn_temp SET PENSIONCONTRI="+pc+",DEPUTATIONFLAG='Y' WHERE PENSIONNO="+pensionno+" AND MONTHYEAR BETWEEN '"+monthYear1+"' AND LAST_DAY('"+monthYear1+"')";
						 log.info("updateCPFData"+updateCPFData);
						 upst.addBatch(updateCPFData);
					}
	
					
			}
			int[] total = st1.executeBatch();
			conn.commit();
			log.info("result"+total);
			
			String updateUserNameInTracking="update epis_adj_crtn_pfid_tracking set username='"+userName+"' where pensionno=" +pensionno;
			log.info("updateUserNameInTracking"+updateUserNameInTracking);
			upst.addBatch(updateUserNameInTracking);
			
			int[] total1 = upst.executeBatch();
			
			log.info("result"+total1);
		} catch (Exception e) {
			log.printStackTrace(e);
			throw new InvalidDataException(e.getMessage());
			
			
		}finally{
			try{
			conn.close();	
			st.close();
			upst.close();
			
			}catch(Exception e){
				e.printStackTrace();
				
			}
		}
		log.info("ImportDao :importCpfData leaving method");
	 
	}
	public String FreezedpennoData(Connection con, String fromDate,String pensionno) {

		log.info("PensionDAO :FreezedpennoData() entering method ");
		String foundEmpFlag = "";
		Statement st = null;
		ResultSet rs = null;
		String pensionno1 = "", username = "", region1 = "";
		try {
			String query = "";
			String transMonthYear = commonUtil.converDBToAppFormat(fromDate.trim(), "dd-MMM-yy", "-MMM-yy");
			query = "select pensionno,USERREQ from epis_pfid_year_wise_frozen where TO_DATE('"
				     +fromDate.trim()+"','dd-Mon-yy')>= FROMDATE and TO_DATE('"
				     +fromDate.trim()+"','dd-Mon-yy')<= TODATE and pensionno='"
					 + pensionno
					 + "'";

			log.info(query);
			st = con.createStatement();
			rs = st.executeQuery(query);

			if (rs.next()) {
				if (rs.getString("pensionno") != null) {
					pensionno1 = rs.getString("pensionno");
				}
				if (rs.getString("USERREQ") != null) {
					username = rs.getString("USERREQ");
				} else {
					username = "";
				}				
				foundEmpFlag = pensionno1 + "_" + username;
			}
		} catch (SQLException e) {
			// e.printStackTrace();
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
			// e.printStackTrace();
		} finally {

			if (rs != null) {
				try {
					rs.close();
					rs = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Resultset ");
				}
			}

			if (st != null) {
				try {
					st.close();
					st = null;
				} catch (SQLException se) {
					System.out.println("Problem in closing Statement.");
				}
			}

			// this.closeConnection(con, st, rs);
		}

		return foundEmpFlag;
	}
	public ArrayList getform3deviation(String region,String year,String month,String airportcode) {
	DecimalFormat df = new DecimalFormat("#########0.00");
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;
		EmployeeValidateInfo validateInfo = null;
		ArrayList pensionList = new ArrayList();
		boolean flag = false;
		boolean contrFlag = false, chkDOBFlag = false;
		String checkDate = "", chkMnthYear = "Apr-1995";
		String monthYear = "", days = "", getMonth = "", sqlQuery = "",editIDsqlQuery="",pfidset="";
		int getDaysBymonth = 0;
		long transMntYear = 0, empRetriedDt = 0;
		log.info("checkDate==" + checkDate + "flag===" + flag);
		double totalAdvancePFWPaid = 0, loanPFWPaid = 0, advancePFWPaid = 0, empNet = 0, aaiNet = 0, advPFDrawn = 0, empCumlative = 0.0, aaiPF = 0.0, aaiNetCumlative = 0.0;
		double pensionAsPerOption = 0.0;
		
		String convertedMonthYear = commonUtil.getMonthYear(month, year);
		String fromDate = "01" + "-" + convertedMonthYear;  
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();
		editIDsqlQuery="select pensionno as editno from  employee_form3_temporary where monthyear=add_months('"+fromDate+"',1) and AIRPORTCODE='"+airportcode+"' and region='"+region+"' and EditId='Y'";
		log.info("editIDsqlQuery"+editIDsqlQuery);
		rs = st.executeQuery(editIDsqlQuery);
		log.info("rs=="+rs);
		if(rs!=null){
			while (rs.next()) {
				if (rs.getString("editno") != null) {
					pfidset=pfidset+","+rs.getString("editno");							
				}			
			}
		}else{	
			pfidset="";
		}
		log.info("pfidset=="+pfidset);
		sqlQuery = "select PENSIONNO,EMPLOYEENAME,DATEOFBIRTH,WETHEROPTION,MONTHYEAR,PREVEMOL,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,AIRPORTCODE,REGION,REMARKSTYPE,REMARKS "
			+"from employee_form3_temporary where monthyear=add_months('"+fromDate+"',1) and AIRPORTCODE='"+airportcode+"' and region='"+region+"' and DEVIATIONFLAG='Y'";
		log.info("ImportDAO::getform3deviation  " + sqlQuery);
		ArrayList OBList = new ArrayList();
			rs = st.executeQuery(sqlQuery);
         if(rs!=null){
			while (rs.next()) {
				validateInfo = new EmployeeValidateInfo();
				double total = 0.0;
				if (rs.getString("PENSIONNO") != null) {
					validateInfo.setPensionNumber(rs.getString("PENSIONNO"));
				} 
				if (rs.getString("EMPLOYEENAME") != null) {
					validateInfo.setEmployeeName(rs.getString("EMPLOYEENAME"));
				} 
				if (rs.getString("DATEOFBIRTH") != null) {
					validateInfo.setDateOfBirth(CommonUtil.getDatetoString(rs
							.getDate("DATEOFBIRTH"), "dd-MMM-yyyy"));	
				}else{
					validateInfo.setDateOfBirth("---");
				}
				if (rs.getString("WETHEROPTION") != null) {
					validateInfo.setWetherOption(rs.getString("WETHEROPTION"));
				} else{
					validateInfo.setDateOfBirth("---");
				}
				if (rs.getString("MONTHYEAR") != null) {
					validateInfo.setMonthYear(CommonUtil.getDatetoString(rs
							.getDate("MONTHYEAR"), "dd-MMM-yyyy"));	
				}			
				if (rs.getString("PREVEMOL") != null) {
					validateInfo.setBasic(rs.getString("PREVEMOL"));
				} else {
					validateInfo.setBasic("0");
				}
				if (rs.getString("EMOLUMENTS") != null) {
					validateInfo.setEmoluments(rs.getString("EMOLUMENTS"));
				} else {
					validateInfo.setEmoluments("0");
				}
				if (rs.getString("EMPPFSTATUARY") != null) {
					validateInfo.setEmpPFStatuary(rs.getString("EMPPFSTATUARY"));
				} else {
					validateInfo.setEmpPFStatuary("0");
				}
				if (rs.getString("EMPVPF") != null) {
					validateInfo.setEmpVPF(rs.getString("EMPVPF"));
				} else {
					validateInfo.setEmpVPF("0");
				}

					if (rs.getString("EMPADVRECPRINCIPAL") != null) {
						validateInfo.setEmpAdvRecPrincipal(rs
								.getString("EMPADVRECPRINCIPAL"));
					} else {
						validateInfo.setEmpAdvRecPrincipal("0");
					}
				
				if (rs.getString("EMPADVRECINTEREST") != null) {
					validateInfo.setEmpAdvRecInterest(rs.getString("EMPADVRECINTEREST"));
				} else {
					validateInfo.setEmpAdvRecInterest("0");
				}		
				if (rs.getString("AIRPORTCODE") != null) {
					validateInfo.setAirportCD(rs.getString("AIRPORTCODE"));
				} else {
					validateInfo.setAirportCD("---");
				}
				if (rs.getString("REGION") != null) {
					validateInfo.setRegion(rs.getString("REGION"));
				} else {
					validateInfo.setRegion("---");
				}
				if (rs.getString("REMARKSTYPE") != null) {
					validateInfo.setIpAddress(rs.getString("REMARKSTYPE"));
				} else {
					validateInfo.setIpAddress("");
				}
				if (rs.getString("REMARKS") != null) {
					validateInfo.setRemarks(rs.getString("REMARKS"));
				} else {
					validateInfo.setRemarks("");
				}
				pensionList.add(validateInfo);
			}
			if(validateInfo==null) {
				validateInfo=new EmployeeValidateInfo();
			}
			
			
			validateInfo.setDailyAllowance(pfidset);
		}} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);
		}
		return pensionList;	
	}
	public ArrayList getform3deviationdirect(String username) {
		DecimalFormat df = new DecimalFormat("#########0.00");
			Connection con = null;
			Statement st = null;
			ResultSet rs = null;
			Statement st1 = null;
			ResultSet rs1 = null;
			EmployeeValidateInfo validateInfo = null;
			ArrayList pensionList = new ArrayList();
			String sqlQuery="";
			String airportcode="", region="",accounttype="",condition="",editIDsqlQuery="",pfid="",pfidset="";
			try {
			String getairports="select AIRPORTCODE,REGION,ACCOUNTTYPE from employee_login_info where username='"+username+"'";
			con = DBUtils.getConnection();
			log.info("getairports"+getairports);
			st = con.createStatement();
			rs = st.executeQuery(getairports);
			while (rs.next()) {
				if (rs.getString("AIRPORTCODE") != null) {
					airportcode=rs.getString("AIRPORTCODE");
				}else{
					airportcode="";
				}
				if (rs.getString("REGION") != null) {
					region=rs.getString("REGION");
				}else{
					region="";
				}
				if (rs.getString("ACCOUNTTYPE") != null) {
					accounttype=rs.getString("ACCOUNTTYPE");
				}else{
					accounttype="";
				}
			}
			if(!airportcode.equals("")){
				condition="AIRPORTCODE='"+airportcode+"' and ";
			}			
			editIDsqlQuery="select pensionno as editno from  employee_form3_temporary where " + condition + " region='"+region+"'  and ACCOUNTTYPE='"+accounttype+"' and EditId='Y'";
			log.info("editIDsqlQuery"+editIDsqlQuery);
			rs = st.executeQuery(editIDsqlQuery);
			if(rs!=null){
			while (rs.next()) {
				if (rs.getString("editno") != null) {
					pfidset=pfidset+","+rs.getString("editno");							
				}			
			}}else{
				pfidset="";
			}
			
			sqlQuery = "select PENSIONNO,EMPLOYEENAME,DATEOFBIRTH,WETHEROPTION,MONTHYEAR,PREVEMOL,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,AIRPORTCODE,REGION,REMARKSTYPE,REMARKS "
				+"from employee_form3_temporary where " + condition + " region='"+region+"'  and ACCOUNTTYPE='"+accounttype+"' and DEVIATIONFLAG='Y'";
			log.info("ImportDAO::getform3deviation  " + sqlQuery);
			st1 = con.createStatement();
				rs1 = st1.executeQuery(sqlQuery);				
				while (rs1.next()) {
					validateInfo = new EmployeeValidateInfo();
					double total = 0.0;
					if (rs1.getString("PENSIONNO") != null) {
						validateInfo.setPensionNumber(rs1.getString("PENSIONNO"));
					} 
					if (rs1.getString("EMPLOYEENAME") != null) {
						validateInfo.setEmployeeName(rs1.getString("EMPLOYEENAME"));
					} 
					if (rs1.getString("DATEOFBIRTH") != null) {
						validateInfo.setDateOfBirth(CommonUtil.getDatetoString(rs1
								.getDate("DATEOFBIRTH"), "dd-MMM-yyyy"));	
					}else{
						validateInfo.setDateOfBirth("---");
					}
					if (rs1.getString("WETHEROPTION") != null) {
						validateInfo.setWetherOption(rs1.getString("WETHEROPTION"));
					} else{
						validateInfo.setDateOfBirth("---");
					}
					if (rs1.getString("MONTHYEAR") != null) {
						validateInfo.setMonthYear(CommonUtil.getDatetoString(rs1
								.getDate("MONTHYEAR"), "dd-MMM-yyyy"));	
					}
								
					if (rs1.getString("PREVEMOL") != null) {
						validateInfo.setBasic(rs1.getString("PREVEMOL"));
					} else {
						validateInfo.setBasic("0");
					}					
					if (rs1.getString("EMOLUMENTS") != null) {
						validateInfo.setEmoluments(rs1.getString("EMOLUMENTS"));
					} else {
						validateInfo.setEmoluments("0");
					}
					if (rs1.getString("EMPPFSTATUARY") != null) {
						validateInfo.setEmpPFStatuary(rs1.getString("EMPPFSTATUARY"));
					} else {
						validateInfo.setEmpPFStatuary("0");
					}
					if (rs1.getString("EMPVPF") != null) {
						validateInfo.setEmpVPF(rs1.getString("EMPVPF"));
					} else {
						validateInfo.setEmpVPF("0");
					}

						if (rs1.getString("EMPADVRECPRINCIPAL") != null) {
							validateInfo.setEmpAdvRecPrincipal(rs1
									.getString("EMPADVRECPRINCIPAL"));
						} else {
							validateInfo.setEmpAdvRecPrincipal("0");
						}
					
					if (rs1.getString("EMPADVRECINTEREST") != null) {
						validateInfo.setEmpAdvRecInterest(rs1.getString("EMPADVRECINTEREST"));
					} else {
						validateInfo.setEmpAdvRecInterest("0");
					}		
					if (rs1.getString("AIRPORTCODE") != null) {
						validateInfo.setAirportCD(rs1.getString("AIRPORTCODE"));
					} else {
						validateInfo.setAirportCD("---");
					}
					if (rs1.getString("REGION") != null) {
						validateInfo.setRegion(rs1.getString("REGION"));
					} else {
						validateInfo.setRegion("---");
					}
					if (rs1.getString("REMARKSTYPE") != null) {
						validateInfo.setIpAddress(rs1.getString("REMARKSTYPE"));
					} else {
						validateInfo.setIpAddress("");
					}
					if (rs1.getString("REMARKS") != null) {
						validateInfo.setRemarks(rs1.getString("REMARKS"));
					} else {
						validateInfo.setRemarks("");
					}
					pensionList.add(validateInfo);
				}
				validateInfo.setDailyAllowance(pfidset);
				log.info("PfidList"+validateInfo.getDailyAllowance());				
				log.info("pensionList"+pensionList.size());
			} catch (SQLException e) {
				log.printStackTrace(e);
			} catch (Exception e) {
				log.printStackTrace(e);
			} finally {
				commonDB.closeConnection(con, st, rs);
			}
			log.info("pensionList"+pensionList.size());
			return pensionList;	
		}
	public void editimportedprocess(String pfid,String dateofbirth,String wetheroption,String monthYear,String emoluments,String epf,String vpf,String principle,String interest,String region,String airportcode,String remarkstype,String Remarks,String userId){
	String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
	String years[] = null;
	double pensionCOntr = 0.0;
	Connection con = null;
	Statement st = null;
	Statement st1 = null;
	ResultSet rs = null;
	String Wetheroption="",retirementDate="",dateofBirth="",leavepensionno="",seperationreson="";
	String sqlQuery = "", transMonthYear = "",NCPDays="",updatequery="";
	try {
		con = DBUtils.getConnection();
		st = con.createStatement();	
		st1 = con.createStatement();	
		double calculatedPension=0.00,calculatedEmoluments = 0.00,pf=0.00;		
		String DateMonth[] = monthYear.split("-");			
		String monthyear =01+"-"+DateMonth[1] + "-"+ DateMonth[2];		
		if(remarkstype.trim().equals("EOL") || remarkstype.trim().equals("HPL") || remarkstype.trim().equals("NCP") || remarkstype.trim().equals("paystop")){
			String getLeaveData="select PENSIONNO from employee_monthly_leaves  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
			rs=st.executeQuery(getLeaveData);
			while (rs.next()) {
				if (rs.getString("PENSIONNO") != null){
					leavepensionno=rs.getString("PENSIONNO");
				}else{
					leavepensionno="";
				}
			}
			String leaveflaginsert="";
			String leaveflagquery="update employee_form3_temporary set leaveflag='Y' where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
			if(leavepensionno.equals("")){
			 leaveflaginsert="insert into employee_monthly_leaves (PENSIONNO,MONTHYEAR,LEAVETYPE,NOOFLEAVES,AIRPORTCODE,REGION,USERNAME) values('"+pfid.trim()+"','"+monthyear+"','"+remarkstype.trim()+"','"+Remarks+"','"+airportcode+"','"+region+"','"+userId+"')";
			}else{
			 leaveflaginsert="update employee_monthly_leaves set LEAVETYPE='"+remarkstype.trim()+"',NOOFLEAVES='"+Remarks+"',USERNAME='"+userId+"'  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
			}
			log.info("leaveflagquery"+leaveflagquery);
			log.info("leaveflaginsert"+leaveflaginsert);
			st.executeQuery(leaveflagquery);
			st.executeQuery(leaveflaginsert);
		}
		String getSeperationData="select PENSIONNO from employee_form3_remarks  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
		log.info("leaveflaginsert"+getSeperationData);
		rs=st.executeQuery(getSeperationData);
		while (rs.next()) {
			if (rs.getString("PENSIONNO") != null){
				seperationreson=rs.getString("PENSIONNO");
			}else{
				seperationreson="";
			}
		}			
			String seperationstatus="";
				if(seperationreson.equals("")){
					seperationstatus="insert into employee_form3_remarks (PENSIONNO,MONTHYEAR,EMOLDIFFREMARKS,EMOLDIFFREMARKSAMOUNT,AIRPORTCODE,REGION,USERNAME) values('"+pfid.trim()+"','"+monthyear+"','"+remarkstype.trim()+"','"+Remarks+"','"+airportcode+"','"+region+"','"+userId+"')";
			}else{
				seperationstatus="update employee_form3_remarks set EMOLDIFFREMARKS='"+remarkstype.trim()+"',EMOLDIFFREMARKSAMOUNT='"+Remarks+"'  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
			}
			log.info("leaveflaginsert"+seperationstatus);
			st.executeQuery(seperationstatus);			
			updatequery = "update  employee_form3_temporary set REMARKSTYPE='"+remarkstype
				+"',EDITId='Y',REMARKS = '"+Remarks+"', USERNAME = '"+userId+"'  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"' and DEVIATIONFLAG='Y'";
				log.info("sqlQuery"+updatequery);
		st.executeQuery(updatequery);
		if(remarkstype.trim().equals("WageArrear")){
		String loginsert="insert into employee_form3_templog(pensionno,MONTHYEAR,emoluments,emppfstatuary,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,AIRPORTCODE,region)(select pensionno,MONTHYEAR,emoluments,emppfstatuary,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,pf,AIRPORTCODE,region from employee_form3_temporary where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"')";
		st1.executeQuery(loginsert);
		if (!pfid.trim().equals("")) {
			String sheetDateMonth[] = monthYear.split("-");			
			String monthyearsheet =01+"-"+sheetDateMonth[1] + "-"+ sheetDateMonth[2];
			//changed the caliculation upto as 696
			String checkPFID = "select wetheroption,pensionno, to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS REIREMENTDATE,to_char(dateofbirth,'dd-Mon-yyyy') as dateofbirth,to_date('"
					+ monthyearsheet
					+ "','DD-Mon-RRRR')-to_date(add_months(TO_DATE(dateofbirth), 696),'dd-Mon-RRRR')+1 as days,to_char(add_months(dateofbirth, 696),'dd-Mon-yyyy')AS calPensionupto from employee_personal_info where to_char(pensionno)='"
					+ pfid.trim() + "'";
			log.info(checkPFID);
			rs = st.executeQuery(checkPFID);
			while (rs.next()) {
			if (rs.getString("wetheroption") != null) {
				Wetheroption=rs.getString("wetheroption");
			} else {
				Wetheroption="";
			}
			if (rs.getString("REIREMENTDATE") != null) {
				retirementDate = rs.getString("REIREMENTDATE");
			} else {
				retirementDate = "";
			}
			if (rs.getString("dateofbirth") != null) {
				dateofBirth = rs.getString("dateofbirth");
			} else {
				dateofBirth = "";
			}
			String days = "0";
			if (rs.getString("days") != null) {
				days = rs.getString("days");
			} else {
				days = "0";
			}
			String calPensionupto = "";
			if (rs.getString("calPensionupto") != null) {
				calPensionupto = rs.getString("calPensionupto");
			} else {
				calPensionupto = "0";
			}			
			FinancialReportDAO fdao = new FinancialReportDAO();
			calculatedPension = this.calclatedPF1(monthyearsheet,
					calPensionupto, dateofbirth, emoluments, Wetheroption, "", days, "1", epf);
			calculatedPension = Math.round(calculatedPension);
			pf = Double.parseDouble(epf)- calculatedPension;
			if(Wetheroption.trim().equals("A")){
				calculatedEmoluments = Math.round((calculatedPension*100)/8.33);
				
		}else{
			if(calculatedPension!=0 && calculatedPension==541){
				calculatedEmoluments=6500;
			}else if(calculatedPension==0){
				calculatedEmoluments=0;
			}else{
				calculatedEmoluments = Math.round((calculatedPension*100)/8.33);
			}
			}
			log.info("calculatedEmoluments=="+calculatedEmoluments);
		}
    }
		sqlQuery = "update  employee_form3_temporary set emoluments='"
			+ emoluments + "',emppfstatuary='" + epf
			+ "'  ,PENSIONCONTRI='"
			+ calculatedPension + "',pf='"
			+ pf + "',EMPVPF='"
			+ vpf +"' ,EMPADVRECPRINCIPAL='"+ principle
			+ "',EMPADVRECINTEREST='" + interest
			+ "',REMARKSTYPE='"+remarkstype
			+"',EDITId='Y',CALCEMOLUMENTS='"+calculatedEmoluments
			+"',REMARKS = '"+Remarks+"', USERNAME = '"+userId+"'  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"' and DEVIATIONFLAG='Y'";
			log.info("sqlQuery"+sqlQuery);
			st.executeQuery(sqlQuery);
		}
	} catch (SQLException e) {
		log.printStackTrace(e);
	} catch (Exception e) {
		log.printStackTrace(e);
	} finally {
		commonDB.closeConnection(con, st, rs);
	}
}
	public void edittransferstatus(String pfid,String monthYear,String remarkstype,String userId,String airportcode,String region){
		String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
		String years[] = null;
		double pensionCOntr = 0.0;
		Connection con = null;
		Statement st = null;
		Statement st1 = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		String Wetheroption="",retirementDate="",dateofBirth="",leavepensionno="",accounttype="",pensionno="";
		String sqlQuery = "", transMonthYear = "",NCPDays="";
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();	
			st1 = con.createStatement();	
			double calculatedPension=0.00,calculatedEmoluments = 0.00,pf=0.00;
			String DateMonth[] = monthYear.split("-");			
			String monthyear =01+"-"+DateMonth[1] + "-"+ DateMonth[2];	
			String getSeperationData="select PENSIONNO from employee_form3_remarks  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"' and airportcode='"+airportcode+"' and region='"+region+"'";
			rs=st.executeQuery(getSeperationData);
			while (rs.next()) {
				if (rs.getString("PENSIONNO") != null){
					leavepensionno=rs.getString("PENSIONNO");
				}else{
					leavepensionno="";
				}
			}
			
				String seperationstatus="";
					if(leavepensionno.equals("")){
						seperationstatus="insert into employee_form3_remarks (PENSIONNO,MONTHYEAR,SEPERATIONREMARKS,USERNAME,AIRPORTCODE,REGION) values('"+pfid.trim()+"','"+monthyear+"','"+remarkstype.trim()+"','"+userId+"','"+airportcode+"','"+region+"')";
				}else{
					seperationstatus="update employee_form3_remarks set SEPERATIONREMARKS='"+remarkstype.trim()+"'  where pensionno='"+pfid.trim()+"' and  monthyear='"+monthyear+"'";
				}	
				log.info("leaveflaginsert"+seperationstatus);
				st.executeQuery(seperationstatus);			
			if(remarkstype.trim().equals("salarynotDrawn")){
				String getaccounttype="select ACCOUNTTYPE from employee_login_info  where USERNAME='"+userId.trim()+"'";
				rs=st.executeQuery(getaccounttype);
				while (rs.next()) {
					if (rs.getString("ACCOUNTTYPE") != null){
						accounttype=rs.getString("ACCOUNTTYPE");
					}else{
						accounttype="";
					}
				}
				String getpenno="select pensionno from employee_form3_temporary  where pensionno='"+pfid.trim()+"' and monthyear='"+monthyear+"'";
				log.info("getpenno"+getpenno);
				rs1=st1.executeQuery(getpenno);
				while (rs1.next()) {
					if (rs1.getString("pensionno") != null){
						pensionno=rs1.getString("pensionno");
					}else{
						pensionno="";
					}
				}
				if(pensionno.equals("")){
					String getvalidatepenno="select pensionno from employee_pension_validate where pensionno='"+pfid.trim()+"' and monthyear='"+monthyear+"'";
					log.info("getvalidatepenno"+getvalidatepenno);
					rs1=st1.executeQuery(getvalidatepenno);
					while (rs1.next()) {
						if (rs1.getString("pensionno") != null){
							pensionno=rs1.getString("pensionno");
						}else{
							pensionno="";
						}
					}	
				}
				if(pensionno.equals("")){
				String query="insert into employee_form3_temporary (PENSIONNO,MONTHYEAR,EMOLUMENTS,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PENSIONCONTRI,PF,AIRPORTCODE,REGION,ACCOUNTTYPE)values('"+pfid.trim()+"','"+monthyear+"','0','0','0','0','0','0','0','"+airportcode+"','"+region+"','"+accounttype+"')";
				log.info("query=="+query);
				st.executeQuery(query);	
				}
			}
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			try{
			st1.close();
			rs1.close();
			commonDB.closeConnection(con, st, rs);
			}catch(Exception e){				
			}			
		}
	}	
	public int loadimportedprocess(String monthYear,String region,String airportcode){
		log.info("Importdao:loadimportedprocess Entering method");
		String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
		String years[] = null;
		double pensionCOntr = 0.0;
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;
		String count="";
		String Wetheroption="",retirementDate="",dateofBirth="",sqlQuery1="";
		String sqlQuery = "", transMonthYear = "",message="";
		int totrecords=0;
		
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();	
			String DateMonth[] = monthYear.split("-");			
			String monthyear =01+"-"+DateMonth[1] + "-"+ DateMonth[2];
		
				sqlQuery = "insert into employee_pension_validate(pensionno,CPFACCNO,gross,employeeno,monthyear,emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,FORM3REMARKS,EMPFLAG,LEAVEFLAG,CALCEMOLUMENTS,additionalcontri)(select pensionno,CPFACCNO,gross,employeeno,monthyear,emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,REMARKS,'Y',LEAVEFLAG,CALCEMOLUMENTS,additionalcontri from employee_form3_temporary where monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"')";
				log.info("sqlQuery"+sqlQuery);
				totrecords=st.executeUpdate(sqlQuery);
				log.info("totrecords"+totrecords);
				 sqlQuery1= "delete from employee_form3_temporary where monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"' ";
				 log.info("sqlQuery"+sqlQuery1);
				 st.executeQuery(sqlQuery1);
				log.info("totrecords"+totrecords)	;		
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);
		}
		log.info("Importdao:loadimportedprocess leaving method");
		return totrecords;
	}
	public int deleteimportsheet(String monthYear,String region,String airportcode){
		log.info("Importdao:deleteimportsheet Entering method");
		String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");
		String years[] = null;
		double pensionCOntr = 0.0;
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;
		String count="";
		String Wetheroption="",retirementDate="",dateofBirth="",sqlQuery1="";
		String sqlQuery = "", transMonthYear = "",message="",sqlQuery3="",sqlQuery4="";
		int totrecords=0;
		
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();	
			String DateMonth[] = monthYear.split("-");			
			String monthyear =01+"-"+DateMonth[1] + "-"+ DateMonth[2];
				 sqlQuery1= "delete from employee_form3_temporary where monthyear='"+monthyear+"' and AIRPORTCODE='"+airportcode+"' and region='"+region+"' ";
				 log.info("sqlQuery"+sqlQuery1);
				 totrecords=st.executeUpdate(sqlQuery1);
				log.info("totrecords"+totrecords);
				sqlQuery="delete from payment_recov_mnth_upload_log where lower(filename) like('%"+airportcode.toLowerCase()+"%') and monthyear=to_char(add_months('"+monthyear+"',-1),'dd-Mon-yyyy') and region='"+region+"' ";
				log.info(sqlQuery);
				st.executeQuery(sqlQuery);
				sqlQuery3="delete from employee_monthly_leaves where AIRPORTCODE='"+airportcode+"' and MONTHYEAR='"+monthyear+"' and region='"+region+"'";
				log.info(sqlQuery3);
				st.executeQuery(sqlQuery3);
				sqlQuery4="delete from employee_form3_remarks where AIRPORTCODE='"+airportcode+"' and MONTHYEAR='"+monthyear+"' and region='"+region+"'";
				log.info(sqlQuery4);
				st.executeQuery(sqlQuery4);
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);
		}
		log.info("Importdao:deleteimportsheet leaving method");
		return totrecords;
	}
	public ArrayList getTransferInOutRecordsDirect(String username,String monthYear) {
		Connection con = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;
		ResultSet rs3 = null;
		EmployeePersonalInfo data = null;
		ArrayList empinfo = new ArrayList();
		ArrayList rauList = new ArrayList();
		ArrayList totInfoList = new ArrayList();
		ArrayList cntInfo = new ArrayList();	
		String sqlQuery = "", pfidWithRegion = "", findFromYear = "", pensionAppednQry = "",selCrntCntQry="",selPrvCntQry="";
		String airportcode="",region="",accounttype="",pfidset="";
		String condition = "",condition1="",editIDsqlQuery="";
		int restltmentYear = 0,transferInCnt=0,transferOutCnt=0;
		try {
			con = commonDB.getConnection();
			st = con.createStatement();
			st2 = con.createStatement();
			log.info("monthYear"+monthYear+"username"+username);
			if(monthYear.equals("")){
				String query="select distinct to_char(MONTHYEAR,'dd-Mon-yyyy') as MONTHYEAR from employee_form3_temporary";
				rs = st.executeQuery(query);
				while (rs.next()) {
					if (rs.getString("MONTHYEAR") != null) {
						monthYear=rs.getString("MONTHYEAR");
					}
				}
			}
			String getairports="select AIRPORTCODE,REGION,ACCOUNTTYPE from employee_login_info where username='"+username+"'";
			log.info("getairports"+getairports);
			rs = st.executeQuery(getairports);
			while (rs.next()) {
				if (rs.getString("AIRPORTCODE") != null) {
					airportcode=rs.getString("AIRPORTCODE");
				}else{
					airportcode="";
				}
				if (rs.getString("REGION") != null) {
					region=rs.getString("REGION");
				}else{
					region="";
				}
				if (rs.getString("ACCOUNTTYPE") != null) {
					accounttype=rs.getString("ACCOUNTTYPE");
				}else{
					accounttype="";
				}
			}
			if (!airportcode.equals("") && airportcode != "") {
				condition = "and AIRPORTCODE='" + airportcode + "'";
			} else {
				condition = "";
			}
			log.info("ACCOUNTTYPE"+accounttype);
			if(accounttype.trim().equals("RAU")){				
				String rauairports="select airportcode from(select unitname from employee_unit_master where region = '"+region+"' and accounttype = 'RAU' ) tab1,(select distinct airportcode  from employee_form3_temporary where region = '"+region+"' and accounttype = 'RAU') tab2 where tab1.unitname=tab2.airportcode order by airportcode";
				log.info("getairports"+rauairports);
				rs1 = st.executeQuery(rauairports);
				if(rs1!=null){
				while (rs1.next()){					
					rauList=this.getTranInOutRecordsDirect(region,rs1.getString("airportcode"),monthYear);
					if(rauList.size()>0){
					totInfoList.add(rauList);
					}
				}
				}
			}else if(accounttype.trim().equals("SAU")){
				String count="";
				log.info("airportcode"+airportcode+"region"+region+"accounttype"+accounttype);
				String getairportcode="select count(*) as count  from employee_form3_temporary where region = '"+region+"' and airportcode='"+airportcode+"'";
				log.info("getairports"+getairportcode);
				rs3 = st.executeQuery(getairportcode);
				if (rs3.next()) {
					if (rs3.getString("count") != null) {
						count = rs3.getString("count");
					}

				}
				if(!count.trim().equals("0")){
				if (!airportcode.equals("") && airportcode != "") {
					condition = "and AIRPORTCODE='" + airportcode + "' ";
				} else {
					condition = "";	
	            }
				if (!airportcode.equals("") && airportcode != "") {
					condition1 = " AIRPORTCODE='" + airportcode + "' and ";
				} else {
					condition1 = "";	
	            }
				
				
			
				editIDsqlQuery="select pensionno as editno from  employee_form3_remarks where " + condition1 + " region='"+region+"' and monthyear='"+monthYear+"' and SEPERATIONREMARKS is not null";
				log.info("editIDsqlQuery"+editIDsqlQuery);
				rs = st.executeQuery(editIDsqlQuery);
				if(rs!=null){
				while (rs.next()) {
					if (rs.getString("editno") != null) {
						pfidset=pfidset+","+rs.getString("editno");							
					}			
				}}else{
					pfidset="";
				}
				sqlQuery = "select transrec.monthyear as monthyear,transrec.pensionno as pensionno,transrec.employeename as employeename,transrec.dateofbirth as dateofbirth,transrec.dateofjoining as dateofjoining,transrec.wetheroption as wetheroption,transrec.region as region,transrec.airportcode as airportcode,remarks.SEPERATIONREMARKS as transferstatus,transrec.transferstatus1 as transferstatus1  from(select '"
					+ monthYear
					+ "' as monthyear,info.pensionno, info.employeename, info.dateofbirth, info.dateofjoining,info.wetheroption,"
					+ "(CASE     WHEN trans.cnt2 =0    THEN 'Salary not Drawn' ELSE 'Newly Salary Drawn'     END) as transferstatus1, trans.region,trans.airportcode"
					+ " from (select pensionno,airportcode, region, count(src1) CNT1, count(src2) CNT2  from (select a.pensionno,a.airportcode, a.region, 1 src1,"
					+ " to_number(null) src2  from employee_pension_validate a where monthyear between add_months('"
					+ monthYear
					+ "',-1) and  last_day(add_months('"
					+ monthYear
					+ "',-1))"
					+ " and empflag = 'Y' and  region = '"
					+ region
					+ "' and airportcode='"
					+ airportcode
					+ "' and suppliflag='N'   union all select distinct pensionno,airportcode,region,1 src1,to_number(null) src2 from(select c.pensionno,c.airportcode, c.region, 1 src1,"
					+ " to_number(null) src2  from employee_supplimentory_data c where monthyear between add_months('"
					+ monthYear
					+ "',-1) and  last_day(add_months('"
					+ monthYear
					+ "',-1))"
					+ " and empflag = 'Y' and  region = '"
					+ region
					+ "' and airportcode='"
					+ airportcode
					+ "' and suppliflag='N'   union all select d.pensionno,d.airportcode, d.region, 1 src1,"
					+ " to_number(null) src2  from employee_supplimentory_data d where SALMONTH between add_months('"
					+ monthYear
					+ "',-2) and  last_day(add_months('"
					+ monthYear
					+ "',-2))"
					+ " and empflag = 'Y' and  region = '"
					+ region
					+ "' and airportcode='"
					+ airportcode
					+ "' and suppliflag='S')   union all  select b.pensionno,b.airportcode, b.region, to_number(null) src1, 2 src2 from"
					+ " employee_form3_temporary b WHERE monthyear between '"
					+ monthYear
					+ "' and  last_day('"
					+ monthYear
					+ "') and  region = '"
					+ region
					+ "' and airportcode= '"
					+ airportcode
					+ "' union all  select e.pensionno,e.airportcode, e.region, to_number(null) src1, 2 src2 from"
					+ " employee_supplimentory_data e WHERE SALMONTH between to_char(add_months('"
					+monthYear+"', -1),'dd-Mon-yyyy') and  last_day(to_char(add_months('"
					+monthYear+"', -1),'dd-Mon-yyyy')) and  region = '"
					+ region
					+ "' and airportcode= '"
					+ airportcode
					+ "' and suppliflag='S') group by pensionno, region ,airportcode   having count(src1) <> count(src2)) trans,(select pensionno,"
					+ "employeeno,cpfacno,employeename, dateofbirth,dateofjoining, wetheroption from employee_personal_info) info where info.pensionno = trans.pensionno order by info.pensionno) transrec,"
					+"(select pensionno,SEPERATIONREMARKS from employee_form3_remarks WHERE monthyear between '"
					+ monthYear
					+ "' and  last_day('"
					+ monthYear
					+ "') and  region = '"
					+ region
					+ "' and airportcode= '"
					+ airportcode
					+ "') remarks where transrec.pensionno =  remarks.pensionno(+)";

			log.info("ImportDAO::getTransferInOutPrinting" + sqlQuery);
			rs = st.executeQuery(sqlQuery);
			while (rs.next()) {
				data = new EmployeePersonalInfo();

				if (rs.getString("pensionno") != null) {
					data.setPfID(rs.getString("pensionno"));
				} else {
					data.setPfID("");
				}

				if (rs.getString("dateofbirth") != null) {
					data.setDateOfBirth(commonUtil.getDatetoString(rs
							.getDate("dateofbirth"), "dd-MMM-yyyy"));
				} else {
					data.setDateOfBirth("---");
				}
				if (rs.getString("dateofjoining") != null) {
					data.setDateOfJoining(commonUtil.getDatetoString(rs
							.getDate("dateofjoining"), "dd-MMM-yyyy"));
				} else {
					data.setDateOfJoining("---");
				}
				if (rs.getString("employeename") != null) {
					data.setEmployeeName(rs.getString("employeename"));
				} else {
					data.setEmployeeName("---");
				}
				if (rs.getString("wetheroption") != null) {
					data.setWetherOption(rs.getString("wetheroption"));
				} else {
					data.setWetherOption("---");
				}
				if (rs.getString("transferstatus1") != null) {
					data.setSeperationReason(rs.getString("transferstatus1"));
				} else {
					data.setSeperationReason("---");
				}
				if (rs.getString("transferstatus") != null) {
					data.setRemarks(rs.getString("transferstatus"));
				} else {
					data.setRemarks("---");
				}
				if (rs.getString("transferstatus1") != null) {
				if(rs.getString("transferstatus1").equals("Newly Salary Drawn")){
					transferInCnt++;
				}
				if(rs.getString("transferstatus1").equals("Salary not Drawn")){
					transferOutCnt++;
				}
				}
				if (rs.getString("region") != null) {
					data.setRegion(rs.getString("region"));
				} else {
					data.setRegion("---");
				}
				if (rs.getString("airportcode") != null) {
					data.setAirportCode(rs.getString("airportcode"));
				} else {
					data.setAirportCode("---");
				}
				data.setMonthyear(rs.getString("monthyear"));
				empinfo.add(data);
			}
			if(!pfidset.equals("")){
				data.setRefPensionNumber(pfidset);
				}else{
					data.setRefPensionNumber("");	
				}
			String  prevMnthCount="",curntMnthCount="",prevMnth="";
			EmployeePersonalInfo cntData = new EmployeePersonalInfo();
			selPrvCntQry=" select   count(*) as PrevMnthCount ,to_char(add_months('"+monthYear+"', -1),'dd-Mon-yyyy') as PrevMnth from employee_pension_validate   where monthyear between add_months('"+monthYear+"', -1) and  last_day(add_months('"+monthYear+"', -1))  and empflag = 'Y' and region = '"+region+"'" +condition;
			 st1=con.createStatement();
			 rs1 = st1.executeQuery(selPrvCntQry);
			 if(rs1.next()){
				 prevMnthCount = rs1.getString("PrevMnthCount");
				 prevMnth = rs1.getString("PrevMnth");
			 }
			 selCrntCntQry="select   count(*) as CurntMnthCount   from employee_form3_temporary   where monthyear between  '"+monthYear+"' and  last_day('"+monthYear+"')  and region = '"+region+"'" +condition;
			 st2=con.createStatement();
			 rs2 = st2.executeQuery(selCrntCntQry);
			 if(rs2.next()){
				 curntMnthCount = rs2.getString("CurntMnthCount");
			 }
				 cntData.setPrevMntCnt(prevMnthCount);
				 cntData.setCurntMntCnt(curntMnthCount);
				 cntData.setPrevMnth(prevMnth);
				 cntData.setCurntMnth(monthYear);
				 cntData.setTransferInCnt(String.valueOf(transferInCnt));
				 cntData.setTransferOutCnt(String.valueOf(transferOutCnt));
				 cntInfo.add(cntData);
				 
				if(empinfo.size()>0){ 
					rauList.add(empinfo);
					rauList.add(cntInfo);
					totInfoList.add(rauList);
				}
			}
				}
				} catch (SQLException e) {
					log.printStackTrace(e);
				} catch (Exception e) {
					log.printStackTrace(e);
				} finally {
					commonDB.closeConnection(con, st, rs);					
				}
				log.info(" getTransferInOutRecords Leaving method=="+totInfoList.size());
				return totInfoList;
	}
	public ArrayList getTranInOutRecordsDirect(String region,String airportcode,String monthYear) {
		log.info("getTransferInOutRecordsDirect Entering method");		
		Connection con = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;		
		String sqlQuery = "", pfidWithRegion = "", findFromYear = "", pensionAppednQry = "",selCrntCntQry="",selPrvCntQry="";
		EmployeePersonalInfo data = null;
		String condition = "",condition1="",editIDsqlQuery="",pfidset="";
		int restltmentYear = 0,transferInCnt=0,transferOutCnt=0;
		ArrayList empinfo = new ArrayList();
		ArrayList rauList = new ArrayList();
		ArrayList totInfoList = new ArrayList();
		ArrayList cntInfo = new ArrayList();		
		try {
			con = commonDB.getConnection();
			st = con.createStatement();
			st2 = con.createStatement();
			if (!airportcode.equals("") && airportcode != "") {
				condition = "and AIRPORTCODE='" + airportcode + "' ";
			} else {
				condition = "";	
            }
			if (!airportcode.equals("") && airportcode != "") {
				condition1 = " AIRPORTCODE='" + airportcode + "' and ";
			} else {
				condition1 = "";	
            }	
			editIDsqlQuery="select pensionno as editno from  employee_form3_remarks where " + condition1 + " region='"+region+"' and monthyear='"+monthYear+"' and SEPERATIONREMARKS is not null";
			log.info("editIDsqlQuery"+editIDsqlQuery);
			rs = st.executeQuery(editIDsqlQuery);
			if(rs!=null){
			while (rs.next()) {
				if (rs.getString("editno") != null) {
					pfidset=pfidset+","+rs.getString("editno");							
				}			
			}}else{
				pfidset="";
			}
			log.info("monthYear"+monthYear+"airportcode"+airportcode);
					sqlQuery = "select transrec.monthyear as monthyear,transrec.pensionno as pensionno,transrec.employeename as employeename,transrec.dateofbirth as dateofbirth,transrec.dateofjoining as dateofjoining,transrec.wetheroption as wetheroption,transrec.region as region,transrec.airportcode as airportcode,remarks.SEPERATIONREMARKS as transferstatus,transrec.transferstatus1 as transferstatus1 from(select '"
						+ monthYear
						+ "' as monthyear,info.pensionno, info.employeename as employeename, info.dateofbirth as dateofbirth, info.dateofjoining as dateofjoining,info.wetheroption as wetheroption,"
						+ "(CASE     WHEN trans.cnt2 =0    THEN 'Salary not Drawn' ELSE 'Newly Salary Drawn'     END) as transferstatus1, trans.region as region,trans.airportcode as airportcode"
						+ " from (select pensionno,airportcode, region,count(src1) CNT1, count(src2) CNT2  from (select a.pensionno,a.airportcode, a.region, 1 src1,"
						+ " to_number(null) src2  from employee_pension_validate a where monthyear between add_months('"
						+ monthYear
						+ "',-1) and  last_day(add_months('"
						+ monthYear
						+ "',-1))"
						+ " and empflag = 'Y' and  region = '"
						+ region
						+ "' and airportcode='"
						+ airportcode
						+ "' and suppliflag='N'   union all select distinct pensionno,airportcode,region,1 src1,to_number(null) src2 from(select c.pensionno,c.airportcode, c.region, 1 src1,"
					    + " to_number(null) src2  from employee_supplimentory_data c where monthyear between add_months('"
					    + monthYear
					    + "',-1) and  last_day(add_months('"
					    + monthYear
					    + "',-1))"
					    + " and empflag = 'Y' and  region = '"
					    + region
					    + "' and airportcode='"
					    + airportcode
					    + "' and suppliflag='N'   union all select d.pensionno,d.airportcode, d.region, 1 src1,"
					    + " to_number(null) src2  from employee_supplimentory_data d where SALMONTH between add_months('"
					    + monthYear
					    + "',-2) and  last_day(add_months('"
					    + monthYear
					    + "',-2))"
					    + " and empflag = 'Y' and  region = '"
					    + region
					    + "' and airportcode='"
					    + airportcode
					    + "' and suppliflag='S')  union all select b.pensionno,b.airportcode, b.region, to_number(null) src1, 2 src2 from"
						+ " employee_form3_temporary b WHERE monthyear between '"
						+ monthYear
						+ "' and  last_day('"
						+ monthYear
						+ "') and  region = '"
						+ region
						+ "' and airportcode= '"
						+ airportcode
						+ "' union all  select e.pensionno,e.airportcode, e.region, to_number(null) src1, 2 src2 from"
					    + " employee_supplimentory_data e WHERE SALMONTH between to_char(add_months('"
					    +monthYear+"', -1),'dd-Mon-yyyy') and  last_day(to_char(add_months('"
					    +monthYear+"', -1),'dd-Mon-yyyy')) and  region = '"
					    + region
					    + "' and airportcode= '"
					    + airportcode
					    + "' and suppliflag='S') group by pensionno, region ,airportcode   having count(src1) <> count(src2)) trans,(select pensionno,"
						+ "employeeno,cpfacno,employeename, dateofbirth,dateofjoining, wetheroption from employee_personal_info) info where info.pensionno = trans.pensionno order by info.pensionno) transrec,"
						+"(select pensionno,SEPERATIONREMARKS from employee_form3_remarks WHERE monthyear between '"
						+ monthYear
						+ "' and  last_day('"
						+ monthYear
						+ "') and  region = '"
						+ region
						+ "' and airportcode= '"
						+ airportcode
						+ "') remarks where transrec.pensionno=  remarks.pensionno(+)";

				log.info("ImportDAO::getTransferInOutPrinting" + sqlQuery);
				rs = st.executeQuery(sqlQuery);
				while (rs.next()) {
					data = new EmployeePersonalInfo();

					if (rs.getString("pensionno") != null) {
						data.setPfID(rs.getString("pensionno"));
					} else {
						data.setPfID("");
					}
					if (rs.getString("dateofbirth") != null) {
						data.setDateOfBirth(commonUtil.getDatetoString(rs
								.getDate("dateofbirth"), "dd-MMM-yyyy"));
					} else {
						data.setDateOfBirth("---");
					}
					if (rs.getString("dateofjoining") != null) {
						data.setDateOfJoining(commonUtil.getDatetoString(rs
								.getDate("dateofjoining"), "dd-MMM-yyyy"));
					} else {
						data.setDateOfJoining("---");
					}
					if (rs.getString("employeename") != null) {
						data.setEmployeeName(rs.getString("employeename"));
					} else {
						data.setEmployeeName("---");
					}
					if (rs.getString("wetheroption") != null) {
						data.setWetherOption(rs.getString("wetheroption"));
					} else {
						data.setWetherOption("---");
					}
					if (rs.getString("transferstatus") != null) {
						data.setRemarks(rs.getString("transferstatus"));
					} else {
						data.setRemarks("---");
					}
					if (rs.getString("transferstatus1") != null) {
						data.setSeperationReason(rs.getString("transferstatus1"));
					} else {
						data.setSeperationReason("---");
					}
					if (rs.getString("transferstatus1") != null) {
					if(rs.getString("transferstatus1").equals("Newly Salary Drawn")){
						transferInCnt++;
					}
					if(rs.getString("transferstatus1").equals("Salary not Drawn")){
						transferOutCnt++;
					}
					}
					if (rs.getString("region") != null) {
						data.setRegion(rs.getString("region"));
					} else {
						data.setRegion("---");
					}
					if (rs.getString("airportcode") != null) {
						data.setAirportCode(rs.getString("airportcode"));
					} else {
						data.setAirportCode("---");
					}
					data.setMonthyear(rs.getString("monthyear"));
					empinfo.add(data);
				}
				if(!pfidset.equals("")){
				data.setRefPensionNumber(pfidset);
				}else{
					data.setRefPensionNumber("");	
				}
				String  prevMnthCount="",curntMnthCount="",prevMnth="";
				EmployeePersonalInfo cntData = new EmployeePersonalInfo();
				selPrvCntQry=" select   count(*) as PrevMnthCount ,to_char(add_months('"+monthYear+"', -1),'dd-Mon-yyyy') as PrevMnth from employee_pension_validate   where monthyear between add_months('"+monthYear+"', -1) and  last_day(add_months('"+monthYear+"', -1))  and empflag = 'Y' and region = '"+region+"'" +condition;
				log.info("selPrvCntQry"+selPrvCntQry);
				st1=con.createStatement();
				 rs1 = st1.executeQuery(selPrvCntQry);
				 if(rs1.next()){
					 prevMnthCount = rs1.getString("PrevMnthCount");
					 prevMnth = rs1.getString("PrevMnth");
				 }
				 selCrntCntQry="select   count(*) as CurntMnthCount   from employee_form3_temporary   where monthyear between  '"+monthYear+"' and  last_day('"+monthYear+"')  and region = '"+region+"'" +condition;
				 log.info("selCrntCntQry"+selCrntCntQry);
				 st2=con.createStatement();
				 rs2 = st2.executeQuery(selCrntCntQry);
				 if(rs2.next()){
					 curntMnthCount = rs2.getString("CurntMnthCount");
				 }
					 cntData.setPrevMntCnt(prevMnthCount);
					 cntData.setCurntMntCnt(curntMnthCount);
					 cntData.setPrevMnth(prevMnth);
					 cntData.setCurntMnth(monthYear);
					 cntData.setTransferInCnt(String.valueOf(transferInCnt));
					 cntData.setTransferOutCnt(String.valueOf(transferOutCnt));
					 cntInfo.add(cntData);
					if(empinfo.size()>0){ 
						totInfoList.add(empinfo);
						totInfoList.add(cntInfo);
					}				
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);			
		}
		log.info("raugetTransferInOutRecords Leaving method=="+totInfoList.size());
		return totInfoList;
	}
	public ArrayList getStationInOutRecords(String region,String year, String month,String airportcode) {
		log.info("ImportDAO:getStationInOutRecords Entering method");		
		Connection con = null;
		Statement st = null;
		Statement st1 = null;
		Statement st2 = null;
		ResultSet rs = null;
		ResultSet rs1 = null;
		ResultSet rs2 = null;		
		String sqlQuery = "", pfidWithRegion = "", findFromYear = "", pensionAppednQry = "",selCrntCntQry="",selPrvCntQry="";
		EmployeePersonalInfo data = null;
		String condition = "",condition1="",editIDsqlQuery="",monthYear="";
		int restltmentYear = 0,transferInCnt=0,transferOutCnt=0;
		ArrayList empinfo = new ArrayList();
		ArrayList rauList = new ArrayList();
		ArrayList totInfoList = new ArrayList();
		ArrayList cntInfo = new ArrayList();		
		try {
			con = commonDB.getConnection();
			st = con.createStatement();
			st1 = con.createStatement();
			st2 = con.createStatement();
			if (!airportcode.equals("") && airportcode != "") {
				condition = "and AIRPORTCODE='" + airportcode + "' ";
			} else {
				condition = "";	
            }	
			String convertedMonthYear = commonUtil.getMonthYear(month, year);
			String sheetmonthyear = "01" + "-" + convertedMonthYear;
			String monthyearQuery = "SELECT  to_char(add_months('"+ sheetmonthyear.trim()+ "',1),'dd-Mon-yyyy') as monthyear from dual	";
		log.info(monthyearQuery);
		rs = st1.executeQuery(monthyearQuery);
		if (rs.next()) {
			monthYear = rs.getString(1);
		}
			log.info("monthYear"+monthYear+"airportcode"+airportcode);
					sqlQuery = "select transrec.monthyear as monthyear,transrec.pensionno as pensionno,transrec.employeename as employeename,transrec.dateofbirth as dateofbirth,transrec.dateofjoining as dateofjoining,transrec.wetheroption as wetheroption,transrec.region as region,transrec.airportcode as airportcode,remarks.SEPERATIONREMARKS as transferstatus,transrec.transferstatus1 as transferstatus1 from(select '"
						+ monthYear
						+ "' as monthyear,info.pensionno, info.employeename as employeename, info.dateofbirth as dateofbirth, info.dateofjoining as dateofjoining,info.wetheroption as wetheroption,"
						+ "(CASE     WHEN trans.cnt2 =0    THEN 'Salary not Drawn' ELSE 'Newly Salary Drawn'     END) as transferstatus1, trans.region as region,trans.airportcode as airportcode"
						+ " from (select pensionno,airportcode, region,count(src1) CNT1, count(src2) CNT2  from (select a.pensionno,a.airportcode, a.region, 1 src1,"
						+ " to_number(null) src2  from employee_pension_validate a where monthyear between add_months('"
						+ monthYear
						+ "',-1) and  last_day(add_months('"
						+ monthYear
						+ "',-1))"
						+ " and empflag = 'Y' and  region = '"
						+ region
						+ "' and airportcode='"
						+ airportcode
						+ "' and suppliflag='N'   union all select distinct pensionno,airportcode,region,1 src1,to_number(null) src2 from(select c.pensionno,c.airportcode, c.region, 1 src1,"
					    + " to_number(null) src2  from employee_supplimentory_data c where monthyear between add_months('"
					    + monthYear
					    + "',-1) and  last_day(add_months('"
					    + monthYear
					    + "',-1))"
					    + " and empflag = 'Y' and  region = '"
					    + region
					    + "' and airportcode='"
					    + airportcode
					    + "' and suppliflag='N'   union all select d.pensionno,d.airportcode, d.region, 1 src1,"
					    + " to_number(null) src2  from employee_supplimentory_data d where SALMONTH between add_months('"
					    + monthYear
					    + "',-2) and  last_day(add_months('"
					    + monthYear
					    + "',-2))"
					    + " and empflag = 'Y' and  region = '"
					    + region
					    + "' and airportcode='"
					    + airportcode
					    + "' and suppliflag='S') union all select b.pensionno,b.airportcode, b.region, to_number(null) src1, 2 src2 from"
						+ " employee_form3_temporary b WHERE monthyear between '"
						+ monthYear
						+ "' and  last_day('"
						+ monthYear
						+ "') and  region = '"
						+ region
						+ "' and airportcode= '"
						+ airportcode
						+ "' union all  select e.pensionno,e.airportcode, e.region, to_number(null) src1, 2 src2 from"
					    + " employee_supplimentory_data e WHERE SALMONTH between to_char(add_months('"
					    +monthYear+"', -1),'dd-Mon-yyyy') and  last_day(to_char(add_months('"
					    +monthYear+"', -1),'dd-Mon-yyyy')) and  region = '"
					    + region
					    + "' and airportcode= '"
					    + airportcode
					    + "' and suppliflag='S') group by pensionno, region ,airportcode   having count(src1) <> count(src2)) trans,(select pensionno,"
						+ "employeeno,cpfacno,employeename, dateofbirth,dateofjoining, wetheroption from employee_personal_info) info where info.pensionno = trans.pensionno order by info.pensionno) transrec,"
						+"(select pensionno,SEPERATIONREMARKS from employee_form3_remarks WHERE monthyear between '"
						+ monthYear
						+ "' and  last_day('"
						+ monthYear
						+ "') and  region = '"
						+ region
						+ "' and airportcode= '"
						+ airportcode
						+ "') remarks where transrec.pensionno=  remarks.pensionno(+)";

				log.info("ImportDAO::getTransferInOutPrinting" + sqlQuery);
				rs = st.executeQuery(sqlQuery);
				while (rs.next()) {
					data = new EmployeePersonalInfo();

					if (rs.getString("pensionno") != null) {
						data.setPfID(rs.getString("pensionno"));
					} else {
						data.setPfID("");
					}
					if (rs.getString("dateofbirth") != null) {
						data.setDateOfBirth(commonUtil.getDatetoString(rs
								.getDate("dateofbirth"), "dd-MMM-yyyy"));
					} else {
						data.setDateOfBirth("---");
					}
					if (rs.getString("dateofjoining") != null) {
						data.setDateOfJoining(commonUtil.getDatetoString(rs
								.getDate("dateofjoining"), "dd-MMM-yyyy"));
					} else {
						data.setDateOfJoining("---");
					}
					if (rs.getString("employeename") != null) {
						data.setEmployeeName(rs.getString("employeename"));
					} else {
						data.setEmployeeName("---");
					}
					if (rs.getString("wetheroption") != null) {
						data.setWetherOption(rs.getString("wetheroption"));
					} else {
						data.setWetherOption("---");
					}
					if (rs.getString("transferstatus") != null) {
						data.setRemarks(rs.getString("transferstatus"));
					} else {
						data.setRemarks("---");
					}
					if (rs.getString("transferstatus1") != null) {
						data.setSeperationReason(rs.getString("transferstatus1"));
					} else {
						data.setSeperationReason("---");
					}
					if (rs.getString("transferstatus1") != null) {
					if(rs.getString("transferstatus1").equals("Newly Salary Drawn")){
						transferInCnt++;
					}
					if(rs.getString("transferstatus1").equals("Salary not Drawn")){
						transferOutCnt++;
					}
					}
					if (rs.getString("region") != null) {
						data.setRegion(rs.getString("region"));
					} else {
						data.setRegion("---");
					}
					if (rs.getString("airportcode") != null) {
						data.setAirportCode(rs.getString("airportcode"));
					} else {
						data.setAirportCode("---");
					}
					data.setMonthyear(rs.getString("monthyear"));
					empinfo.add(data);
				}				
				String  prevMnthCount="",curntMnthCount="",prevMnth="";
				EmployeePersonalInfo cntData = new EmployeePersonalInfo();
				selPrvCntQry=" select   count(*) as PrevMnthCount ,to_char(add_months('"+monthYear+"', -1),'dd-Mon-yyyy') as PrevMnth from employee_pension_validate   where monthyear between add_months('"+monthYear+"', -1) and  last_day(add_months('"+monthYear+"', -1))  and empflag = 'Y' and region = '"+region+"'" +condition;
				log.info("selPrvCntQry"+selPrvCntQry);
				st1=con.createStatement();
				 rs1 = st1.executeQuery(selPrvCntQry);
				 if(rs1.next()){
					 prevMnthCount = rs1.getString("PrevMnthCount");
					 prevMnth = rs1.getString("PrevMnth");
				 }
				 selCrntCntQry="select   count(*) as CurntMnthCount   from employee_form3_temporary   where monthyear between  '"+monthYear+"' and  last_day('"+monthYear+"')  and region = '"+region+"'" +condition;
				 log.info("selCrntCntQry"+selCrntCntQry);
				 st2=con.createStatement();
				 rs2 = st2.executeQuery(selCrntCntQry);
				 if(rs2.next()){
					 curntMnthCount = rs2.getString("CurntMnthCount");
				 }
					 cntData.setPrevMntCnt(prevMnthCount);
					 cntData.setCurntMntCnt(curntMnthCount);
					 cntData.setPrevMnth(prevMnth);
					 cntData.setCurntMnth(monthYear);
					 cntData.setTransferInCnt(String.valueOf(transferInCnt));
					 cntData.setTransferOutCnt(String.valueOf(transferOutCnt));
					 cntInfo.add(cntData);
					 log.info("empinfo.size"+empinfo.size());
					 log.info("cntInfo.size"+cntInfo.size());
					if(empinfo.size()>0){ 
						totInfoList.add(empinfo);
						totInfoList.add(cntInfo);
					}				
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);			
		}		
		log.info("getStationInOutRecords Leaving method=="+totInfoList.size());
		return totInfoList;
	}
	public int loadimportedprocessdirectly(String username){
		log.info("Importdao:loadimportedprocessdirectly Entering method");
		String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");		
		String years[] = null;
		double pensionCOntr = 0.0;
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;			
		String sqlQuery = "",count="",sqlQuery1="";
		int totrecords=0;
		String condition="",airportcode="",region="",accounttype="";
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();	
			log.info("username"+username);
			String getairports="select AIRPORTCODE,REGION,ACCOUNTTYPE from employee_login_info where username='"+username+"'";
			rs = st.executeQuery(getairports);
			while (rs.next()) {
				if (rs.getString("AIRPORTCODE") != null) {
					airportcode=rs.getString("AIRPORTCODE");
				}else{
					airportcode="";
				}
				if (rs.getString("REGION") != null) {
					region=rs.getString("REGION");
				}else{
					region="";
				}
				if (rs.getString("ACCOUNTTYPE") != null) {
					accounttype=rs.getString("ACCOUNTTYPE");
				}else{
					accounttype="";
				}
			}
			log.info("airportcode"+airportcode+"region"+region+"accounttype"+accounttype);
			if(!airportcode.equals("")){
				condition="AIRPORTCODE='"+airportcode+"' and region='"+region+"' and ACCOUNTTYPE='"+accounttype+"'";
			}else{
				condition="region='"+region+"' and ACCOUNTTYPE='"+accounttype+"'";
			}			
			
				sqlQuery = "insert into employee_pension_validate(pensionno,CPFACCNO,monthyear,emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,FORM3REMARKS,EMPFLAG,LEAVEFLAG,CALCEMOLUMENTS,additionalcontri,gross)(select pensionno,CPFACCNO,monthyear,emoluments,EMPPFSTATUARY,EMPVPF,EMPADVRECPRINCIPAL,EMPADVRECINTEREST,PF,PENSIONCONTRI,EMPLOYEENAME,AIRPORTCODE,REGION,REMARKS,'Y',LEAVEFLAG,CALCEMOLUMENTS,additionalcontri,gross from employee_form3_temporary where "+condition+")";
				log.info("sqlQuery"+sqlQuery);
				totrecords=st.executeUpdate(sqlQuery);
			   sqlQuery1= "delete from employee_form3_temporary where "+condition+" ";
			   st.executeQuery(sqlQuery1);
				
							
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);

		}
		log.info("Importdao:loadimportedprocessdirectly leaving method");
		return totrecords;
	}
	public int deleteimportsheetdirectly(String monthyear,String username){
		log.info("Importdao:deleteimportsheetdirectly Entering method");
		String updatedDate = commonUtil.getCurrentDate("dd-MMM-yyyy");		
		String years[] = null;
		double pensionCOntr = 0.0;
		Connection con = null;
		Statement st = null;
		ResultSet rs = null;			
		String sqlQuery = "",count="",sqlQuery1="";
		int totrecords=0;
		String condition="",airportcode="",region="",accounttype="",sqlQuery3="",sqlQuery4="";
		try {
			con = DBUtils.getConnection();
			st = con.createStatement();	
			String getairports="select AIRPORTCODE,REGION,ACCOUNTTYPE from employee_login_info where username='"+username+"'";
			con = DBUtils.getConnection();
			st = con.createStatement();
			rs = st.executeQuery(getairports);
			while (rs.next()) {
				if (rs.getString("AIRPORTCODE") != null) {
					airportcode=rs.getString("AIRPORTCODE");
				}else{
					airportcode="";
				}
				if (rs.getString("REGION") != null) {
					region=rs.getString("REGION");
				}else{
					region="";
				}
				if (rs.getString("ACCOUNTTYPE") != null) {
					accounttype=rs.getString("ACCOUNTTYPE");
				}else{
					accounttype="";
				}
			}
			if(!airportcode.equals("")){
				condition="AIRPORTCODE='"+airportcode+"' and region='"+region+"' and ACCOUNTTYPE='"+accounttype+"'";
			}else{
				condition="region='"+region+"' and ACCOUNTTYPE='"+accounttype+"'";
			}			
			 String getleavepensionno="select pensionno from employee_form3_temporary where DEVIATIONFLAG='Y' and monthyear='"+monthyear+"' and "+condition+" ";
			 log.info("getleavepensionno=="+getleavepensionno);
			 rs = st.executeQuery(getleavepensionno);
			if(rs!=null){
				while (rs.next()) {
					if (rs.getString("pensionno") != null) {
						sqlQuery3="delete from employee_monthly_leaves where pensionno='"+rs.getString("pensionno")+"' and MONTHYEAR='"+monthyear+"' and region='"+region+"'";
					log.info("sqlQuery3=="+sqlQuery3);
						st.executeQuery(sqlQuery3);							
					}			
				}}
			String getairportslog="select distinct airportcode from employee_form3_temporary where  monthyear='"+monthyear+"' and "+condition+" ";
			 log.info("getairportslog=="+getairportslog);
			rs = st.executeQuery(getairportslog);
			if(rs!=null){
				while (rs.next()) {
					if (rs.getString("airportcode") != null) {
						sqlQuery="delete from payment_recov_mnth_upload_log where lower(filename) like('%"+rs.getString("airportcode").toLowerCase()+"%') and monthyear=to_char(add_months('"+monthyear+"',-1),'dd-Mon-yyyy') and region='"+region+"'";
						log.info("sqlQuery=="+sqlQuery);
						st.executeQuery(sqlQuery);							
					}			
				}}
			sqlQuery1= "delete from employee_form3_temporary where monthyear='"+monthyear+"' and "+condition+"";
			 log.info("sqlQuery"+sqlQuery1);
			 totrecords=st.executeUpdate(sqlQuery1);
			log.info("totrecords"+totrecords);
		} catch (SQLException e) {
			log.printStackTrace(e);
		} catch (Exception e) {
			log.printStackTrace(e);
		} finally {
			commonDB.closeConnection(con, st, rs);

		}
		log.info("Importdao:deleteimportsheetdirectly leaving method");
		return totrecords;
	}

}
